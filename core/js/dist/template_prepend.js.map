{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./core/js/merged-template-prepend.js","webpack:///./core/js/jquery.ocdialog.js","webpack:///./core/js/js.js","webpack:///./core/js/l10n.js","webpack:///./core/js/octemplate.js","webpack:///./core/js/eventsource.js","webpack:///./core/js/public/appconfig.js","webpack:///./core/js/public/comments.js","webpack:///./core/js/public/whatsnew.js","webpack:///./core/js/config.js","webpack:///./core/js/oc-requesttoken.js","webpack:///./core/js/apps.js","webpack:///./core/js/mimetype.js","webpack:///./core/js/mimetypelist.js","webpack:///./core/js/oc-backbone.js","webpack:///./core/js/select2-toggleselect.js","webpack:///./core/js/placeholder.js","webpack:///./core/js/jquery.avatar.js","webpack:///./core/js/jquery.contactsmenu.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","$","jQuery","widget","options","width","height","closeButton","closeOnEscape","modal","_create","self","this","originalCss","display","element","style","originalTitle","attr","title","$dialog","tabIndex","role","insertBefore","append","detach","removeAttr","addClass","appendTo","css","position","enterCallback","document","on","event","target","find","length","keyCode","type","stopImmediatePropagation","close","preventDefault","$buttonrow","$button","prop","trigger","_setOptions","_createOverlay","_init","focus","_trigger","_setOption","$title","text","prependTo","_setSizes","empty","each","idx","val","classes","defaultButton","$defaultButton","click","apply","arguments","removeClass","undefined","buttons","$closeButton","prepend","remove","closeCB","Widget","lessHeight","outerHeight","overlay","stopPropagation","_destroyOverlay","off","setEnterCallback","callback","unsetEnterCallback","setTimeout","destroy","oc_webroot","oc_current_user","getElementsByTagName","getAttribute","oc_requesttoken","window","oc_config","pos","location","pathname","indexOf","substr","lastIndexOf","console","log","noOp","methods","OC","PERMISSION_NONE","PERMISSION_CREATE","PERMISSION_READ","PERMISSION_UPDATE","PERMISSION_DELETE","PERMISSION_SHARE","PERMISSION_ALL","TAG_FAVORITE","webroot","_capabilities","oc_capabilities","appswebroots","oc_appswebroots","currentUser","config","appConfig","oc_appconfig","theme","oc_defaults","coreApps","requestToken","menuSpeed","linkTo","app","file","filePath","linkToRemoteBase","service","getRootPath","linkToRemote","protocol","host","linkToOCS","version","generateUrl","url","params","allOptions","_","defaults","escape","_build","vars","replace","a","b","encodeURIComponent","charAt","modRewriteWorking","isCore","link","substring","encodeURI","fileIsBlacklisted","match","blacklist_files_regex","redirect","targetURL","reload","getProtocol","split","getHost","getHostName","hostname","getPort","port","getCapabilities","getCurrentUser","isUndefined","_currentUserDisplayName","uid","displayName","imagePath","encodePath","path","parts","result","push","join","addScript","script","ready","deferred","loaded","Deferred","getScript","resolve","addStyle","createStyleSheet","addTranslations","L10N","load","basename","dirname","isSamePath","path1","path2","filterDot","pathSections1","filter","pathSections2","joinPaths","args","Array","slice","arg","lastArg","leadingSlash","trailingSlash","sections","concat","first","search","query","Search","dialogs","OCdialogs","parseQueryString","queryString","components","part","decodeURIComponent","buildQueryString","map","appSettings","appid","message","props","scriptName","cache","extend","settings","popup","hasClass","is","hide","arrowclass","data","html","show","loadJS","scriptname","ajaxSetup","fail","jqxhr","e","registerMenu","$toggle","$menuEl","toggle","headerMenu","_currentMenu","hideMenus","parent","slideToggle","_currentMenuToggle","unregisterMenu","complete","lastMenu","Event","slideUp","showMenu","isFunction","_matchMedia","media","matchMedia","getCanonicalLocale","locale","getLocale","getLanguage","isUserAdmin","oc_isadmin","_ajaxConnectionLostHandler","throttle","Notification","showTemporary","trailing","_processAjaxError","xhr","status","statusText","_reloadCalled","contains","_userIsNavigatingAway","timer","interval","setInterval","showUpdate","clearInterval","registerXHRForErrorProcessing","addEventListener","readyState","Plugins","_plugins","register","targetName","plugin","plugins","getPlugins","attach","targetObject","customResults","resultTypes","msg","startSaving","selector","startAction","stop","finishedSaving","response","finishedAction","finishedSuccess","finishedError","delay","fadeOut","queuedNotifications","getDefaultNotificationFunction","notificationTimers","setDefault","$row","$notification","warn","defer","isHidden","showHtml","timeout","fadeIn","one","$html","isHTML","PasswordConfirmation","pageLoadTime","init","requirePasswordConfirmation","moment","now","requiresPasswordConfirmation","serverTimeDiff","nc_pageLoad","timeSinceLogin","nc_lastLogin","backendAllowsPasswordConfirmation","rejectCallback","confirm","label","error","prompt","password","_confirmPassword","then","$error","$buttons","eq","ajax","success","lastLogin","contents","globalEval","$menu","userAgent","navigator","msie","trident","edge","cssVars","_unloadCalled","request","allowAuthErrors","session_keepalive","NaN","session_lifetime","Math","floor","isNaN","max","min","resp","token","initSessionHeartBeat","$el","closest","$navigation","$appmenu","delegate","$app","which","ctrlKey","metaKey","setupMainMenu","$page","ContactsMenu","el","caretPosition","offset","left","toggleClass","resizeMenu","appList","rightHeaderWidth","outerWidth","availableWidth","isMobile","lastShownApp","appCount","k","children","resize","snapper","Snap","getElementById","disable","maxPosition","minDragDistance","toggleSnapperOnButton","state","open","keypress","$target","navigationBarSlideGestureEnabled","navigationBarSlideGestureAllowed","navigationBarSlideGestureEnablePending","allowNavigationBarSlideGesture","enable","disallowNavigationBarSlideGesture","toggleSnapperOnSize","debounce","Util","relativeModifiedDate","parseInt","fn","filterAttr","attr_name","attr_value","humanFileSize","size","skipSmallSizes","humanList","order","readableFormat","relativeSize","pow","toFixed","parseFloat","toLocaleString","computerFileSize","string","toLowerCase","trim","bytes","matches","isFinite","kb","mb","gb","g","tb","pb","round","formatDate","timestamp","format","diff","fromNow","isIE","getScrollBarWidth","_scrollBarWidth","inner","createElement","outer","top","visibility","overflow","appendChild","body","w1","offsetWidth","w2","clientWidth","removeChild","stripTime","date","Date","getFullYear","getMonth","getDate","_chunkify","tz","x","y","naturalSortCompare","aa","bb","aNum","Number","bNum","localeCompare","waitFor","internalCallback","isCookieSetToValue","cookies","cookie","History","_handlers","_pushState","strParams","history","pushState","pop","pattern","patterns","querySelectorAll","ii","fill","stroke","removeAttribute","setAttribute","replaceState","hash","_cancelPop","addOnPopStateHandler","handler","_parseHashQuery","_decodeQuery","parseUrlQuery","_onPopState","isString","onpopstate","namespaces","tail","context","set","documentElement","msViewportStyle","createTextNode","OCA","selectRange","start","end","setSelectionRange","createTextRange","range","collapse","moveEnd","moveStart","select","exists","tipsy","argument","_typeof","placement","container","gravity","delayIn","delayOut","fallback","tooltip","_bundles","_pluralFunctions","appName","promise","translations","pluralForm","bundle","_getPlural","translate","count","translation","DOMPurify","sanitize","escapeHTML","translatePlural","textSingular","textPlural","identifier","isArray","plural","number","Handlebars","registerHelper","Template","elem","escapeFunction","keys","_html","outerHTML","octemplate","EventSource","src","joinChar","dataStr","typelessListeners","closed","listeners","useFallBack","iframeId","iframeCount","fallBackSources","iframe","source","onmessage","JSON","parse","listen","fallBackCallBack","id","done","lastLength","OCP","AppConfig","_call","method","endpoint","toUpperCase","getApps","getKeys","getValue","defaultValue","setValue","deleteKey","Comments","urlRegex","plainToRich","content","formatLinksRich","richToPlain","formatLinksPlain","leadingSpace","trailingSpace","linkText","$content","$this","WhatsNew","dismissOptions","dismiss","_onQuerySuccess","_onQueryError","_onDismissSuccess","_onDismissError","debug","item","menuItem","icon","div","classList","add","list","className","innerText","onclick","whatsNewTextItem","innerHTML","href","rel","elm","crossDomain","setRequestHeader","dynamicSlideToggleEnabled","Apps","enableDynamicSlideToggle","showAppSidebar","direction","hideAppSidebar","$appSidebar","index","button","areaSelector","area","hideArea","slideDown","input","showArea","MimeType","_mimeTypeIcons","_getFile","mimeType","files","RegExp","inArray","getIconUrl","MimeTypeList","aliases","gotIcon","folder","themes","Theming","cacheBuster","application/coreldraw","application/epub+zip","application/font-sfnt","application/font-woff","application/gpx+xml","application/illustrator","application/javascript","application/json","application/msaccess","application/msexcel","application/msonenote","application/mspowerpoint","application/msword","application/octet-stream","application/postscript","application/rss+xml","application/vnd.android.package-archive","application/vnd.lotus-wordpro","application/vnd.garmin.tcx+xml","application/vnd.google-earth.kml+xml","application/vnd.google-earth.kmz","application/vnd.ms-excel","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-fontobject","application/vnd.ms-powerpoint","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-visio.drawing.macroEnabled.12","application/vnd.ms-visio.drawing","application/vnd.ms-visio.stencil.macroEnabled.12","application/vnd.ms-visio.stencil","application/vnd.ms-visio.template.macroEnabled.12","application/vnd.ms-visio.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.presentation-template","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.text-master","application/vnd.oasis.opendocument.text-template","application/vnd.oasis.opendocument.text-web","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.visio","application/vnd.wordperfect","application/x-7z-compressed","application/x-bzip2","application/x-cbr","application/x-compressed","application/x-dcraw","application/x-deb","application/x-fictionbook+xml","application/x-font","application/x-gimp","application/x-gzip","application/x-iwork-keynote-sffkey","application/x-iwork-numbers-sffnumbers","application/x-iwork-pages-sffpages","application/x-mobipocket-ebook","application/x-perl","application/x-photoshop","application/x-php","application/x-rar-compressed","application/x-tar","application/x-tex","application/xml","application/yaml","application/zip","database","httpd/unix-directory","text/css","text/csv","text/html","text/x-c","text/x-c++src","text/x-h","text/x-java-source","text/x-ldif","text/x-python","text/x-shellscript","web","application/internet-shortcut","Backbone","noConflict","Select2","Select2FindHighlightableChoices","class","multi","findHighlightableChoices","opts","toggleSelect","results","Select2TriggerSelect","triggerSelect","selectionEls","unselect","clearSearch","String","toRgb","Color","mixPalette","steps","color1","color2","palette","step","ends","stepCalc","md5","red","yellow","blue","palette1","palette2","palette3","maximum","finalInt","j","hashToInt","imageplaceholder","seed","rgb","clearimageplaceholder","avatar","user","ie8fix","hidedefault","displayname","setAvatarForUnknownUser","$div","ceil","devicePixelRatio","oc_userconfig","img","Image","onload","onerror","alt","contactsMenu","shareWith","shareType","$list","actions","topAction","hyperlink","forEach","action","template","Templates","jqXHR","clickedList","has","clickedTarget"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,6CClFAnC,EAAAkB,EAAAkB,GAAApC,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,IAAAA,EAAA,mBCAC,IAASqC,KAwPRC,QAvPCC,OAAO,cAAe,CACvBC,QAAS,CACRC,MAAO,OACPC,OAAQ,OACRC,aAAa,EACbC,eAAe,EACfC,OAAO,GAERC,QAAS,WACR,IAAIC,EAAOC,KAEXA,KAAKC,YAAc,CAClBC,QAASF,KAAKG,QAAQ,GAAGC,MAAMF,QAC/BT,MAAOO,KAAKG,QAAQ,GAAGC,MAAMX,MAC7BC,OAAQM,KAAKG,QAAQ,GAAGC,MAAMV,QAG/BM,KAAKK,cAAgBL,KAAKG,QAAQG,KAAK,SACvCN,KAAKR,QAAQe,MAAQP,KAAKR,QAAQe,OAASP,KAAKK,cAEhDL,KAAKQ,QAAUnB,EAAE,6BACfiB,KAAK,CAELG,UAAW,EACXC,KAAM,WAENC,aAAaX,KAAKG,SACpBH,KAAKQ,QAAQI,OAAOZ,KAAKG,QAAQU,UACjCb,KAAKG,QAAQW,WAAW,SAASC,SAAS,qBAAqBC,SAAShB,KAAKQ,SAE7ER,KAAKQ,QAAQS,IAAI,CAChBf,QAAS,eACTgB,SAAU,UAGXlB,KAAKmB,cAAgB,KAErB9B,EAAE+B,UAAUC,GAAG,gBAAiB,SAASC,GACxC,GACCA,EAAMC,SAAWxB,EAAKS,QAAQvC,IAAI,IACY,IAA9C8B,EAAKS,QAAQgB,KAAKnC,EAAEiC,EAAMC,SAASE,OAFpC,CAOA,GACmB,KAAlBH,EAAMI,SACS,YAAfJ,EAAMK,MACN5B,EAAKP,QAAQI,cAIb,OAFA0B,EAAMM,2BACN7B,EAAK8B,SACE,EAGR,GAAqB,KAAlBP,EAAMI,QAAgB,CAExB,GADAJ,EAAMM,2BACqB,OAAvB7B,EAAKoB,cAGR,OAFApB,EAAKoB,gBACLG,EAAMQ,kBACC,EAER,GAAkB,UAAfR,EAAMK,KAER,OADAL,EAAMQ,kBACC,EAGR,GACC/B,EAAKgC,YAC4C,IAAjDhC,EAAKgC,WAAWP,KAAKnC,EAAEiC,EAAMC,SAASE,OACrC,CACD,IAAIO,EAAUjC,EAAKgC,WAAWP,KAAK,kBAChCQ,IAAYA,EAAQC,KAAK,aAC3BD,EAAQE,QAAQ,cAERnC,EAAKgC,YACd1C,EAAEiC,EAAMC,QAAQW,QAAQ,SAEzB,OAAO,MAITlC,KAAKmC,YAAYnC,KAAKR,SACtBQ,KAAKoC,kBAENC,MAAO,WACNrC,KAAKQ,QAAQ8B,QACbtC,KAAKuC,SAAS,SAEfC,WAAY,SAAS7D,EAAKN,GACzB,IAAI0B,EAAOC,KACX,OAAOrB,GACN,IAAK,QACJ,GAAGqB,KAAKyC,OACPzC,KAAKyC,OAAOC,KAAKrE,OACX,CACN,IAAIoE,EAASpD,EAAE,+BACZhB,EACA,SACH2B,KAAKyC,OAASA,EAAOE,UAAU3C,KAAKQ,SAErCR,KAAK4C,YACL,MACD,IAAK,UACJ,GAAG5C,KAAK+B,WACP/B,KAAK+B,WAAWc,YACV,CACN,IAAId,EAAa1C,EAAE,uCACnBW,KAAK+B,WAAaA,EAAWf,SAAShB,KAAKQ,SAEvB,IAAjBnC,EAAMoD,OACTzB,KAAK+B,WAAWhB,SAAS,aACE,IAAjB1C,EAAMoD,OAChBzB,KAAK+B,WAAWhB,SAAS,cACE,IAAjB1C,EAAMoD,QAChBzB,KAAK+B,WAAWhB,SAAS,gBAE1B1B,EAAEyD,KAAKzE,EAAO,SAAS0E,EAAKC,GAC3B,IAAIhB,EAAU3C,EAAE,YAAYqD,KAAKM,EAAIN,MACjCM,EAAIC,SACPjB,EAAQjB,SAASiC,EAAIC,SAEnBD,EAAIE,gBACNlB,EAAQjB,SAAS,WACjBhB,EAAKoD,eAAiBnB,GAEvBjC,EAAKgC,WAAWnB,OAAOoB,GACvBA,EAAQoB,MAAM,WACbJ,EAAII,MAAMC,MAAMtD,EAAKI,QAAQ,GAAImD,eAGnCtD,KAAK+B,WAAWP,KAAK,UACnBH,GAAG,QAAS,SAASC,GACrBvB,EAAKgC,WAAWP,KAAK,UAAU+B,YAAY,WAC3ClE,EAAEW,MAAMe,SAAS,aAEnBf,KAAK4C,YACL,MACD,IAAK,aACkBY,IAAlBnF,EAAMoF,SACTzD,KAAK+B,WAAWhB,SAAS1C,EAAMoF,SAEhC,MACD,IAAK,cACJ,GAAGpF,EAAO,CACT,IAAIqF,EAAerE,EAAE,mCACrBW,KAAKQ,QAAQmD,QAAQD,GACrBA,EAAarC,GAAG,QAAS,WACxBtB,EAAK8B,eAGN7B,KAAKQ,QAAQgB,KAAK,oBAAoBoC,SAEvC,MACD,IAAK,QACJ5D,KAAKQ,QAAQS,IAAI,QAAS5C,GAC1B,MACD,IAAK,SACJ2B,KAAKQ,QAAQS,IAAI,SAAU5C,GAC3B,MACD,IAAK,QACJ2B,KAAK6D,QAAUxF,EAIjBgB,EAAEyE,OAAO9E,UAAUwD,WAAWa,MAAMrD,KAAMsD,YAE3CnB,YAAa,SAAS3C,GAErBH,EAAEyE,OAAO9E,UAAUmD,YAAYkB,MAAMrD,KAAMsD,YAE5CV,UAAW,WACV,IAAImB,EAAa,EACd/D,KAAKyC,SACPsB,GAAc/D,KAAKyC,OAAOuB,aAAY,IAEpChE,KAAK+B,aACPgC,GAAc/D,KAAK+B,WAAWiC,aAAY,IAE3ChE,KAAKG,QAAQc,IAAI,CAChBvB,OAAU,eAAiBqE,EAAa,SAG1C3B,eAAgB,WACf,GAAIpC,KAAKR,QAAQK,MAAjB,CAIA,IAAIE,EAAOC,KACXA,KAAKiE,QAAU5E,EAAE,SACf0B,SAAS,iBACTC,SAAS3B,EAAE,aACbW,KAAKiE,QAAQ5C,GAAG,sBAAuB,SAASC,GAC/C,GAAGA,EAAMC,SAAWxB,EAAKS,QAAQvC,IAAI,IAAoD,IAA9C8B,EAAKS,QAAQgB,KAAKnC,EAAEiC,EAAMC,SAASE,OAG7E,OAFAH,EAAMQ,sBACNR,EAAM4C,sBAKTC,gBAAiB,WACXnE,KAAKR,QAAQK,OAIdG,KAAKiE,UACRjE,KAAKiE,QAAQG,IAAI,uBACjBpE,KAAKiE,QAAQL,SACb5D,KAAKiE,QAAU,OAGjB1E,OAAQ,WACP,OAAOS,KAAKQ,SAEb6D,iBAAkB,SAASC,GAC1BtE,KAAKmB,cAAgBmD,GAEtBC,mBAAoB,WACnBvE,KAAKmB,cAAgB,MAEtBU,MAAO,WACN7B,KAAKmE,kBACL,IAAIpE,EAAOC,KAEXwE,WAAW,WACVzE,EAAKwC,SAAS,QAASxC,IACrB,KAEHA,EAAKS,QAAQoD,SACb5D,KAAKyE,WAENA,QAAS,WACLzE,KAAKyC,QACPzC,KAAKyC,OAAOmB,SAEV5D,KAAK+B,YACP/B,KAAK+B,WAAW6B,SAGd5D,KAAKK,eACPL,KAAKG,QAAQG,KAAK,QAASN,KAAKK,eAEjCL,KAAKG,QAAQoD,YAAY,qBACtBtC,IAAIjB,KAAKC,aAAaY,SAASF,aAAaX,KAAKQ,SACpDR,KAAKQ,QAAQoD,gRCnPhB,IACIc,EAEAC,EAAkBvD,SAASwD,qBAAqB,QAAQ,GAAGC,aAAa,aACxEC,EAAkB1D,SAASwD,qBAAqB,QAAQ,GAAGC,aAAa,qBAI5E,GAFAE,OAAOC,UAAYD,OAAOC,WAAa,QAEb,IAAfN,EAA4B,CAEtC,IAAIO,GADJP,EAAaQ,SAASC,UACDC,QAAQ,eAE5BV,GADY,IAATO,EACUP,EAAWW,OAAO,EAAGJ,GAGrBP,EAAWW,OAAO,EAAGX,EAAWY,YAAY,MAG3D,GAAuB,oBAAZC,cAAkD,IAAhBA,QAAQC,IAAqB,CACpET,OAAOQ,UACXR,OAAOQ,QAAU,IAIlB,IAFA,IAAIE,EAAO,aACPC,EAAU,CAAC,MAAO,QAAS,OAAQ,OAAQ,QAAS,SAAU,OAAQ,WACjEtI,EAAI,EAAGA,EAAIsI,EAAQjE,OAAQrE,IACnCmI,QAAQG,EAAQtI,IAAMqI,EAcxB,IAICE,EAAK,CACLC,gBAAgB,EAChBC,kBAAkB,EAClBC,gBAAgB,EAChBC,kBAAkB,EAClBC,kBAAkB,EAClBC,iBAAiB,GACjBC,eAAe,GACfC,aAAc,mBAWdC,QAAQ1B,EAOR2B,cAAetB,OAAOuB,iBAAmB,KAEzCC,aAAyC,oBAApBC,iBAAmCA,gBAOxDC,iBAAsC,IAAlB9B,GAA+BA,EACnD+B,OAAQ3B,OAAOC,UACf2B,UAAW5B,OAAO6B,cAAgB,GAClCC,MAAO9B,OAAO+B,aAAe,GAC7BC,SAAS,CAAC,GAAI,QAAQ,MAAM,cAAc,WAAW,OAAO,YAC5DC,aAAclC,EACdmC,UAAW,GAQXC,OAAO,SAASC,EAAIC,GACnB,OAAOzB,EAAG0B,SAASF,EAAI,GAAGC,IAQ3BE,iBAAiB,SAASC,GACzB,OAAO5B,EAAG6B,cAAgB,eAAiBD,GAQ5CE,aAAa,SAASF,GACrB,OAAOxC,OAAOG,SAASwC,SAAW,KAAO3C,OAAOG,SAASyC,KAAOhC,EAAG2B,iBAAiBC,IASrFK,UAAW,SAASL,EAASM,GAE5B,OADAA,EAAuB,IAAZA,EAAiB,EAAI,EACzB9C,OAAOG,SAASwC,SAAW,KAAO3C,OAAOG,SAASyC,KAAOhC,EAAG6B,cAAgB,SAAWK,EAAU,QAAUN,EAAU,KAY7HO,YAAa,SAASC,EAAKC,EAAQxI,GAClC,IAGCyI,EAAazI,GAAW,GACzB0I,EAAEC,SAASF,EAJU,CACnBG,QAAQ,IAKV,IAAIC,EAAS,SAAU3F,EAAM4F,GAE5B,OADAA,EAAOA,GAAQ,GACR5F,EAAK6F,QAAQ,cACnB,SAAUC,EAAGC,GACZ,IAAIvK,EAAKoK,EAAKG,GACd,OAAGR,EAAWG,OACQ,iBAANlK,GAA+B,iBAANA,EAAkBwK,mBAAmBxK,GAAKwK,mBAAmBF,GAEhF,iBAANtK,GAA+B,iBAANA,EAAkBA,EAAIsK,KAUlE,MALsB,MAAlBT,EAAIY,OAAO,KACdZ,EAAM,IAAMA,GAIqB,GAA/B/C,UAAU4D,kBACLjD,EAAG6B,cAAgBa,EAAON,EAAKC,GAGhCrC,EAAG6B,cAAgB,aAAea,EAAON,EAAKC,IAUtDX,SAAS,SAASF,EAAIxF,EAAKyF,GAC1B,IAAIyB,GAAmC,IAA5BlD,EAAGoB,SAAS3B,QAAQ+B,GAC9B2B,EAAKnD,EAAG6B,cAsCT,MArCqC,QAAlCJ,EAAK2B,UAAU3B,EAAK3F,OAAO,IAAiBoH,EASJ,QAAlCzB,EAAK2B,UAAU3B,EAAK3F,OAAO,IAAiBoH,GAcnDC,GAJW,YAAP3B,GAA4B,QAAPA,GAAwB,UAAPA,GAA4B,QAARxF,EAIxD,IAHA,cAKHkH,IACHC,GAAM,SAEK,KAAR3B,IAEH2B,GADA3B,GAAK,KAGHxF,IACFmH,GAAMnH,EAAK,KAEZmH,GAAM1B,IAzBN0B,EAAKnD,EAAGY,aAAaY,GAClBxF,IACFmH,GAAO,IAAInH,EAAK,KAEoB,MAAlCmH,EAAKC,UAAUD,EAAKrH,OAAO,KAC7BqH,GAAM,KAEPA,GAAM1B,IAhBN0B,GAAM,mBAAqB3B,EACf,aAARC,IACH0B,GAAM,IACHnH,IACFmH,GAAME,UAAUrH,EAAO,MAExBmH,GAAO1B,IA8BF0B,GAORG,kBAAmB,SAAS7B,GAC3B,QAAUA,EAAK8B,MAAMlE,UAAUmE,wBAOhCC,SAAU,SAASC,GAClBtE,OAAOG,SAAWmE,GAMnBC,OAAQ,WACPvE,OAAOG,SAASoE,UAOjBC,YAAa,WACZ,OAAOxE,OAAOG,SAASwC,SAAS8B,MAAM,KAAK,IAgB5CC,QAAS,WACR,OAAO1E,OAAOG,SAASyC,MAUxB+B,YAAa,WACZ,OAAO3E,OAAOG,SAASyE,UAUxBC,QAAS,WACR,OAAO7E,OAAOG,SAAS2E,MAYxBrC,YAAa,WACZ,OAAO7B,EAAGS,SAWX0D,gBAAiB,WAChB,OAAOnE,EAAGU,eAUX0D,eAAgB,WAIf,OAHI7B,EAAE8B,YAAYhK,KAAKiK,2BACtBjK,KAAKiK,wBAA0B7I,SAASwD,qBAAqB,QAAQ,GAAGC,aAAa,0BAE/E,CACNqF,IAAKlK,KAAKyG,YACV0D,YAAanK,KAAKiK,0BAYpBG,UAAU,SAASjD,EAAIC,GAItB,OAHuB,GAApBA,EAAKhC,QAAQ,OACfgC,GAAM,QAEAzB,EAAG0B,SAASF,EAAI,MAAMC,IAS9BiD,WAAY,SAASC,GACpB,IAAKA,EACJ,OAAOA,EAIR,IAFA,IAAIC,EAAQD,EAAKd,MAAM,KACnBgB,EAAS,GACJpN,EAAI,EAAGA,EAAImN,EAAM9I,OAAQrE,IACjCoN,EAAOC,KAAK/B,mBAAmB6B,EAAMnN,KAEtC,OAAOoN,EAAOE,KAAK,MAUpBC,UAAU,SAASxD,EAAIyD,EAAOC,GAC7B,IAAIC,EAAUR,EAAK3E,EAAG0B,SAASF,EAAI,KAAKyD,EAAO,OAY/C,OAXIjF,EAAGgF,UAAUI,OAAOT,GAOnBO,GACHA,KAPDC,EAAWzL,EAAE2L,WACb3L,EAAE4L,UAAUX,EAAM,WACjBQ,EAASI,YAEVvF,EAAGgF,UAAUI,OAAOT,GAAQQ,GAMtBnF,EAAGgF,UAAUI,OAAOT,IAO5Ba,SAAS,SAAShE,EAAI/G,GACrB,IAAIkK,EAAK3E,EAAG0B,SAASF,EAAI,MAAM/G,EAAM,SACE,IAApCuF,EAAGwF,SAASJ,OAAO3F,QAAQkF,KAC7B3E,EAAGwF,SAASJ,OAAON,KAAKH,GACpBlJ,SAASgK,iBACZhK,SAASgK,iBAAiBd,IAE1BlK,EAAMf,EAAE,gDAAgDiL,EAAK,OAC7DjL,EAAE,QAAQuB,OAAOR,MAYpBiL,gBAAiB,SAASlE,EAAK7C,GAC9B,OAAOqB,EAAG2F,KAAKC,KAAKpE,EAAK7C,IAU1BkH,SAAU,SAASlB,GAClB,OAAOA,EAAK/B,QAAQ,MAAM,KAAKA,QAAS,OAAQ,KAUjDkD,QAAS,SAASnB,GACjB,OAAOA,EAAK/B,QAAQ,MAAM,KAAKA,QAAQ,YAAa,KAcrDmD,WAAY,SAASC,EAAOC,GAC3B,IAAIC,EAAY,SAAS3M,GACxB,MAAa,MAANA,GAEJ4M,EAAgB5D,EAAE6D,QAAQJ,GAAS,IAAInC,MAAM,KAAMqC,GACnDG,EAAgB9D,EAAE6D,QAAQH,GAAS,IAAIpC,MAAM,KAAMqC,GAGvD,OAFAF,EAAQhG,EAAGsG,UAAU5I,MAAMsC,EAAImG,OAC/BF,EAAQjG,EAAGsG,UAAU5I,MAAMsC,EAAIqG,KAchCC,UAAW,WACV,GAAI3I,UAAU7B,OAAS,EACtB,MAAO,GAER,IAAI6I,EAAO,GAEP4B,EAAOC,MAAMnN,UAAUoN,MAAM7O,KAAK+F,WAKtC,IAHA4I,EAAOhE,EAAE6D,OAAOG,EAAM,SAASG,GAC9B,OAAOA,EAAI5K,OAAS,KAEZA,OAAS,EACjB,MAAO,GAGR,IAIIrE,EAJAkP,EAAUJ,EAAKA,EAAKzK,OAAS,GAC7B8K,EAAqC,MAAtBL,EAAK,GAAGvD,OAAO,GAC9B6D,EAAuD,MAAvCF,EAAQ3D,OAAO2D,EAAQ7K,OAAS,GAChDgL,EAAW,GAEf,IAAKrP,EAAI,EAAGA,EAAI8O,EAAKzK,OAAQrE,IAC5BqP,EAAWA,EAASC,OAAOR,EAAK9O,GAAGoM,MAAM,MAE1C,IAAImD,GAASJ,EACb,IAAKnP,EAAI,EAAGA,EAAIqP,EAAShL,OAAQrE,IACZ,KAAhBqP,EAASrP,KACRuP,EACHA,GAAQ,EAERrC,GAAQ,IAETA,GAAQmC,EAASrP,IAQnB,OAJIoP,IAEHlC,GAAQ,KAEFA,GAORsC,OAAQ,SAAUC,GACjBlH,EAAGmH,OAAOF,OAAOC,EAAO,KAAM,EAAG,KAOlCE,QAAQC,UAMRC,iBAAiB,SAASC,GACzB,IAAI3C,EACHtF,EACAkI,EAEAxO,EADA6L,EAAS,GAGV,IAAK0C,EACJ,OAAO,MAERjI,EAAMiI,EAAY9H,QAAQ,OACf,IACV8H,EAAcA,EAAY7H,OAAOJ,EAAM,IAExCsF,EAAQ2C,EAAY3E,QAAQ,MAAO,OAAOiB,MAAM,KAChD,IAAK,IAAIpM,EAAI,EAAGA,EAAImN,EAAM9I,OAAQrE,IAAI,CAErC,IAAIgQ,EAAO7C,EAAMnN,IAGhB+P,GAFDlI,EAAMmI,EAAKhI,QAAQ,OACR,EACG,CACZgI,EAAK/H,OAAO,EAAGJ,GACfmI,EAAK/H,OAAOJ,EAAM,IAKN,CAACmI,IAEC3L,UAGhB9C,EAAM0O,mBAAmBF,EAAW,OAKhCA,EAAW1L,OAAS,EACvB+I,EAAO7L,GAAO0O,mBAAmBF,EAAW,IAI5C3C,EAAO7L,GAAO,OAGhB,OAAO6L,GAQR8C,iBAAkB,SAAStF,GAC1B,OAAKA,EAGE3I,EAAEkO,IAAIvF,EAAQ,SAAS3J,EAAOM,GACpC,IAAIQ,EAAIuJ,mBAAmB/J,GAI3B,OAHIN,UACHc,GAAK,IAAMuJ,mBAAmBrK,IAExBc,IACLuL,KAAK,KARA,IAoBT8C,YAAY,SAAStB,GACpB,QAAmB,IAATA,QAA8C,IAAfA,EAAKuB,MAC7C,KAAM,CAAE9P,KAAM,mBAAoB+P,QAAS,kCAE5C,IAAIC,EAAQ,CAACC,WAAW,eAAgBC,OAAM,GAC9CxO,EAAEyO,OAAOH,EAAOzB,GAChB,IAAI6B,EAAW1O,EAAE,gBACjB,GAAuB,IAApB0O,EAAStM,OACX,KAAM,CAAE9D,KAAM,oBAAqB+P,QAAS,2EAE7C,IAAIM,EAAQ3O,EAAE,sBAMd,GALoB,IAAjB2O,EAAMvM,SACRpC,EAAE,QAAQsE,QAAQ,4DAClBqK,EAAQ3O,EAAE,uBACJ0B,SAASgN,EAASE,SAAS,YAAc,WAAa,eAE1DD,EAAME,GAAG,YACXF,EAAMG,OAAOvK,aAEb,KAAIwK,EAAaL,EAASE,SAAS,YAAc,KAAO,OAC5C5O,EAAEpB,IAAI0H,EAAG0B,SAASsG,EAAMF,MAAO,GAAIE,EAAMC,YAAa,SAASS,GAC1EL,EAAMM,KAAKD,GAAMxD,MAAM,WAKtB,GAJAmD,EAAMrK,QAAQ,sBAAsByK,EAAW,gBAAgB9P,EAAE,OAAQ,YAAY,8BAA8BiQ,OACnHP,EAAMxM,KAAK,UAAU5C,KAAK,QAAS,WAClCoP,EAAMpK,gBAEoB,IAAjB+J,EAAMa,OAAwB,CACvC,IAAIC,EACJ,IAAoB,IAAjBd,EAAMa,OACRC,EAAa,kBACP,IAA2B,iBAAjBd,EAAMa,OAGtB,KAAM,CAAE7Q,KAAM,mBAAoB+P,QAAS,8DAF3Ce,EAAad,EAAMa,OAIjBb,EAAME,OACRxO,EAAEqP,UAAU,CAACb,OAAO,IAErBxO,EAAE4L,UAAUtF,EAAG0B,SAASsG,EAAMF,MAAO,KAAMgB,IAC1CE,KAAK,SAASC,EAAOb,EAAUc,GAC/B,MAAMA,OAGNN,QACD,UAcLO,aAAc,SAASC,EAASC,EAASC,EAAQC,GAChD,IAAInP,EAAOC,KACXgP,EAAQjO,SAAS,QAIjBgO,EAAQ1N,GAA+B,MAA5B0N,EAAQ9M,KAAK,WACrB,aACA,wBAAyB,SAASX,GAEpCA,EAAMQ,iBAGFR,EAAM3C,KAAqB,UAAd2C,EAAM3C,MAInBqQ,EAAQd,GAAGvI,EAAGwJ,cACjBpP,EAAKqP,aAIGzJ,EAAGwJ,cAEXpP,EAAKqP,aAGa,IAAfF,GACHF,EAAQK,SAAStO,SAAS,cAI3BgO,EAAQzO,KAAK,iBAAiB,GAE9B0O,EAAQM,YAAY3J,EAAGsB,UAAWgI,GAClCtJ,EAAGwJ,aAAeH,EAClBrJ,EAAG4J,mBAAqBR,OAO1BS,eAAgB,SAAST,EAASC,GAE7BA,EAAQd,GAAGvI,EAAGwJ,eACjBnP,KAAKoP,YAENL,EAAQ3K,IAAI,cAAcb,YAAY,cACtCyL,EAAQzL,YAAY,SAQrB6L,UAAW,SAASK,GACnB,GAAI9J,EAAGwJ,aAAc,CACpB,IAAIO,EAAW/J,EAAGwJ,aAClBxJ,EAAGwJ,aAAajN,QAAQ,IAAI7C,EAAEsQ,MAAM,eACpChK,EAAGwJ,aAAaS,QAAQjK,EAAGsB,UAAW,WACrCyI,EAASxN,QAAQ,IAAI7C,EAAEsQ,MAAM,cACzBF,GACHA,EAASpM,MAAMrD,KAAMsD,aAMxBjE,EAAE,eAAeiB,KAAK,iBAAiB,GAEvCjB,EAAE,eAAekE,YAAY,cAC7BoC,EAAGwJ,aAAe,KAClBxJ,EAAG4J,mBAAqB,MAUzBM,SAAU,SAASd,EAASC,EAASS,GAChCT,EAAQd,GAAGvI,EAAGwJ,gBAGlBnP,KAAKoP,YACLzJ,EAAGwJ,aAAeH,EAClBrJ,EAAG4J,mBAAqBR,EACxBC,EAAQ9M,QAAQ,IAAI7C,EAAEsQ,MAAM,eAC5BX,EAAQT,OACRS,EAAQ9M,QAAQ,IAAI7C,EAAEsQ,MAAM,cAExBzH,EAAE4H,WAAWL,IAChBA,MAWFM,YAAa,SAASC,GACrB,QAAIjL,OAAOkL,YACHlL,OAAOkL,WAAWD,IAU3BE,mBAAoB,WACnB,IAAIC,EAASnQ,KAAKoQ,YAClB,MAAyB,iBAAXD,EAAsBA,EAAO5H,QAAQ,KAAM,KAAO4H,GAQjEC,UAAW,WACV,OAAO/Q,EAAE,QAAQgP,KAAK,WAQvBgC,YAAa,WACZ,OAAOhR,EAAE,QAAQ4C,KAAK,SASvBqO,YAAa,WACZ,OAAOC,YAURC,2BAA4BtI,EAAEuI,SAAS,WACtC9K,EAAG+K,aAAaC,cAAcrS,EAAE,OAAQ,+BACtC,IAAU,CAACsS,UAAU,IAMxBC,kBAAmB,SAASC,GAC3B,IAAI/Q,EAAOC,MAIQ,IAAf8Q,EAAIC,QAAoC,UAAnBD,EAAIE,YAA6C,YAAnBF,EAAIE,aAA4BjR,EAAKkR,iBAIxF/I,EAAEgJ,SAAS,CAAC,IAAK,IAAK,IAAK,KAAMJ,EAAIC,SAAWpL,EAAGc,YAEtDjC,WAAW,WACV,IAAKzE,EAAKoR,wBAA0BpR,EAAKkR,cAAe,CACvD,IAAIG,EAAQ,EAERC,EAAWC,YAAa,WAC3B3L,EAAG+K,aAAaa,WAAW1S,EAAE,OAAQ,+CAAgD,gDAFxE,EAEmIuS,IAC5IA,GAHS,IAIZI,cAAcH,GACd1L,EAAG2D,UAEJ8H,KACG,KAIJrR,EAAKkR,eAAgB,IAEpB,KACqB,IAAfH,EAAIC,QAEbvM,WAAW,WACLzE,EAAKoR,uBAA0BpR,EAAKkR,eACxClR,EAAKyQ,8BAEJ,OAYLiB,8BAA+B,SAASX,GAmBnCA,EAAIY,mBACPZ,EAAIY,iBAAiB,OAnBH,WACK,IAAnBZ,EAAIa,aAIJb,EAAIC,QAAU,KAAOD,EAAIC,OAAS,KAAsB,MAAfD,EAAIC,QAKjD1R,EAAE+B,UAAUc,QAAQ,IAAI7C,EAAEsQ,MAAM,aAAcmB,MAU9CA,EAAIY,iBAAiB,QAPF,WAEnBrS,EAAE+B,UAAUc,QAAQ,IAAI7C,EAAEsQ,MAAM,aAAcmB,QAuBjDnL,EAAGiM,QAAU,CAIZC,SAAU,GAQVC,SAAU,SAASC,EAAYC,GAC9B,IAAIC,EAAUjS,KAAK6R,SAASE,GACvBE,IACJA,EAAUjS,KAAK6R,SAASE,GAAc,IAEvCE,EAAQxH,KAAKuH,IAUdE,WAAY,SAASH,GACpB,OAAO/R,KAAK6R,SAASE,IAAe,IAUrCI,OAAQ,SAASJ,EAAYK,EAAc5S,GAE1C,IADA,IAAIyS,EAAUjS,KAAKkS,WAAWH,GACrB3U,EAAI,EAAGA,EAAI6U,EAAQxQ,OAAQrE,IAC/B6U,EAAQ7U,GAAG+U,QACdF,EAAQ7U,GAAG+U,OAAOC,EAAc5S,IAYnCqB,OAAQ,SAASkR,EAAYK,EAAc5S,GAE1C,IADA,IAAIyS,EAAUjS,KAAKkS,WAAWH,GACrB3U,EAAI,EAAGA,EAAI6U,EAAQxQ,OAAQrE,IAC/B6U,EAAQ7U,GAAGyD,QACdoR,EAAQ7U,GAAGyD,OAAOuR,EAAc5S,KAuBpCmG,EAAGiH,OAAOyF,cAAgB,GAI1B1M,EAAGiH,OAAO0F,YAAc,GAExB3M,EAAGwF,SAASJ,OAAO,GACnBpF,EAAGgF,UAAUI,OAAO,GASpBpF,EAAG4M,IAAM,CAMRC,YAAa,SAASC,GACrBzS,KAAK0S,YAAYD,EAAUnU,EAAE,OAAQ,eAStCoU,YAAa,SAASD,EAAU/E,GAC/BrO,EAAEoT,GAAU/P,KAAKgL,GACfnK,YAAY,WACZA,YAAY,SACZoP,MAAK,GAAM,GACXpE,QAaHqE,eAAgB,SAASH,EAAUI,GAClC7S,KAAK8S,eAAeL,EAAUI,IAa/BC,eAAgB,SAASL,EAAUI,GACV,YAApBA,EAAS9B,OACZ/Q,KAAK+S,gBAAgBN,EAAUI,EAASxE,KAAKX,SAE7C1N,KAAKgT,cAAcP,EAAUI,EAASxE,KAAKX,UAU7CqF,gBAAiB,SAASN,EAAU/E,GACnCrO,EAAEoT,GAAU/P,KAAKgL,GACf3M,SAAS,WACTwC,YAAY,SACZoP,MAAK,GAAM,GACXM,MAAM,KACNC,QAAQ,KACR3E,QASHyE,cAAe,SAASP,EAAU/E,GACjCrO,EAAEoT,GAAU/P,KAAKgL,GACf3M,SAAS,SACTwC,YAAY,WACZgL,SAQJ5I,EAAG+K,aAAa,CACfyC,oBAAqB,GACrBC,+BAAgC,KAMhCC,mBAAoB,GAMpBC,WAAY,SAAShP,GACpBqB,EAAG+K,aAAa0C,+BAAiC9O,GAYlD6J,KAAM,SAASoF,EAAMjP,GACpB,IAAIvE,EAAOC,KACPwT,EAAgBnU,EAAE,iBActB,GAZI6I,EAAE4H,WAAWyD,KAEhBjP,EAAWiP,EACXA,OAAO/P,GAGH+P,IACJhO,QAAQkO,KAAK,0HAEbF,EAAOC,EAAchS,KAAK,eAGvB+R,GAAQC,EAAchS,KAAK,QAAQC,OAAS,EAM/C,OAJA8R,EAAK3P,cACDU,GACHA,EAAS/G,QAKX2K,EAAEwL,MAAM,WAQHF,EAAchS,KAAK,QAAQC,OAAS,EACvC8R,EAAK3P,SAKN4P,EAAcN,QAAQ,MAAO,WACxBnT,EAAK4T,YACJ5T,EAAKqT,gCACRrT,EAAKqT,+BAA+B7V,OAGlC+G,GACHA,EAAS/G,OAEViW,EAAc3Q,aAgBjB+Q,SAAU,SAAStF,EAAM9O,GACxBA,EAAUA,GAAW,GACrB0I,EAAEC,SAAS3I,EAAS,CACnBqU,QAAS,IAGV,IAAI9T,EAAOC,KACPwT,EAAgBnU,EAAE,iBAClBW,KAAK2T,YACRH,EAAcM,SAAS7S,IAAI,UAAU,gBAEtC,IAAIsS,EAAOlU,EAAE,2BAIb,GAHIG,EAAQmC,MACX4R,EAAKxS,SAAS,QAAUvB,EAAQmC,MAEZ,UAAjBnC,EAAQmC,KAAkB,CAE7B,IAAI+B,EAAerE,EAAE,oDACrBqE,EAAapD,KAAK,MAAOhC,EAAE,OAAQ,YACnCiV,EAAK3S,OAAO8C,GACZA,EAAaqQ,IAAI,QAAS,WAEzB,OADAhU,EAAKoO,KAAKoF,IACH,IAERA,EAAKxS,SAAS,aAaf,OAVAwS,EAAK5P,QAAQ2K,GACbkF,EAAc5S,OAAO2S,GAElB/T,EAAQqU,QAAU,GAEpB7T,KAAKqT,mBAAmB5I,KAAKjG,WAAW,WACvCzE,EAAKoO,KAAKoF,IACW,IAAlB/T,EAAQqU,UAGNN,GAYRhF,KAAM,SAAS7L,EAAMlD,GACpB,OAAOQ,KAAK4T,SAASvU,EAAE,UAAUqD,KAAKA,GAAM4L,OAAQ9O,IASrD+R,WAAY,SAAS7O,GACpB,IAAI8Q,EAAgBnU,EAAE,iBAElB2U,EAAQ3U,EAAE,UAAUqD,KAAKA,GAAM4L,OAGnC,GAAI5L,GAA6C,GAArC8Q,EAAchS,KAAK,QAAQC,OACtC,OAAOzB,KAAK4T,SAASI,GAGtB,IAAIT,EAAOlU,EAAE,2BAA2BsE,QAAQqQ,GAKhD,OAFAR,EAAclF,KAAKiF,GAEZA,GAaR5C,cAAe,SAASjO,EAAMlD,GAe7B,OAVAA,EAAUA,GAAW,GAErB0I,EAAEC,SAAS3I,EANI,CACdyU,QAAQ,EACRJ,QAAS,IAOPrU,EAAQyU,OACHjU,KAAK4T,SAASlR,EAAMlD,GAEpBQ,KAAKuO,KAAK7L,EAAMlD,IASzBmU,SAAU,WACT,OAAQtU,EAAE,iBAAiBmC,KAAK,QAAQC,SAgb1CkE,EAAGuO,qBAAuB,CACzB5P,SAAU,KACV6P,aAAc,KACdC,KAAM,WACL/U,EAAE,8BAA8BgC,GAAG,QAAS6G,EAAEtJ,KAAKoB,KAAKqU,4BAA6BrU,OACrFA,KAAKmU,aAAeG,OAAOC,OAG5BC,6BAA8B,WAC7B,IAAIC,EAAiBzU,KAAKmU,aAA8B,IAAdO,YACtCC,EAAiBL,OAAOC,OAASE,EAAiC,IAAfG,cAGvD,OAAQC,mCAAqCF,EAAiB,MAM/DN,4BAA6B,SAAS/P,EAAU9E,EAASsV,GACxDtV,OAA6B,IAAZA,EAA0BA,EAAU,GACrD,IAAI2I,EAAW,CACd5H,MAAOjC,EAAE,OAAO,2BAChBoE,KAAMpE,EACL,OACA,qDAEDyW,QAASzW,EAAE,OAAQ,WACnB0W,MAAO1W,EAAE,OAAO,YAChB2W,MAAO,IAGJvO,EAASwB,EAAE4F,OAAO3F,EAAU3I,GAE5BO,EAAOC,KAEPA,KAAKwU,gCACR7O,EAAGoH,QAAQmI,OACVxO,EAAOhE,KACPgE,EAAOnG,MACP,SAAUiK,EAAQ2K,GACb3K,GAAuB,KAAb2K,EACbpV,EAAKqV,iBAAiBD,EAAUzO,GACtBwB,EAAE4H,WAAWgF,IACvBA,MAGF,EACApO,EAAOsO,OACP,GACCK,KAAK,WACN,IAAI7U,EAAUnB,EAAE,sBAGhB,GAFAmB,EAAQgB,KAAK,YAAYoC,SACzBpD,EAAQO,SAAS,yBACI,KAAjB2F,EAAOuO,MACV,IAAIK,EAASjW,EAAE,WAAW0B,SAAS,eAAe2B,KAAKgE,EAAOuO,OAE/DzU,EAAQgB,KAAK,sBAAsBZ,OAAO0U,GAC1C9U,EAAQgB,KAAK,wBAAwBT,SAAS,SAE9C,IAAIwU,EAAW/U,EAAQgB,KAAK,UAC5B+T,EAASC,GAAG,GAAGrH,OACfoH,EAASC,GAAG,GAAG9S,KAAKgE,EAAOqO,WAI7B/U,KAAKsE,SAAWA,GAGjB8Q,iBAAkB,SAASD,EAAUzO,GACpC,IAAI3G,EAAOC,KAEXX,EAAEoW,KAAK,CACN1N,IAAKpC,EAAGmC,YAAY,kBACpBuG,KAAM,CACL8G,SAAUA,GAEXxT,KAAM,OACN+T,QAAS,SAAS7C,GACjB+B,aAAe/B,EAAS8C,UAEpBzN,EAAE4H,WAAW/P,EAAKuE,WACrBvE,EAAKuE,YAGP2Q,MAAO,WACNvO,EAAOuO,MAAQ3W,EAAE,OAAQ,qCACzBqH,EAAGuO,qBAAqBG,4BAA4BtU,EAAKuE,SAAUoC,QAMvErH,EAAE+B,UAAUyJ,MAtgBZ,WAUCxL,EAAEqP,UAAU,CACXkH,SAAU,CACThL,QAAQ,KAWVtL,OAAOuW,WAAa,aAKpBvB,OAAOnE,OAAOxK,EAAGyK,aAEjB,IAmKK0F,EAnKDC,EAAYhR,OAAOiR,UAAUD,UAC7BE,EAAOF,EAAU3Q,QAAQ,SACzB8Q,EAAUH,EAAU3Q,QAAQ,YAC5B+Q,EAAOJ,EAAU3Q,QAAQ,SAEzB6Q,EAAO,GAAKC,EAAU,EAEzB7W,EAAE,QAAQ0B,SAAS,MACToV,EAAO,GAEjB9W,EAAE,QAAQ0B,SAAS,SAIhBkV,EAAO,GAAKC,EAAU,IACzBE,UAGD/W,EAAE0F,QAAQ1D,GAAG,cAAe,WAC3BsE,EAAG0Q,eAAgB,IAEpBhX,EAAE0F,QAAQ1D,GAAG,oBAAqB,WAOjCmD,WAAW,WACVmB,EAAGwL,uBAAwB,EAK3B3M,WAAW,WACLmB,EAAG0Q,gBACP1Q,EAAGwL,uBAAwB,IAE1B,MACF,KAEH9R,EAAE+B,UAAUC,GAAG,iBAAkB,SAAUC,EAAOgV,EAASvI,GACtDA,GAAYA,EAASwI,iBAGzB5Q,EAAGkL,kBAAkByF,WAgCsB,IAAjCtR,UAAUwR,mBAClBxR,UAAUwR,oBA1Bb,WAEC,IAAInF,EAAWoF,IACXzR,UAAU0R,mBACbrF,EAAWsF,KAAKC,MAAM5R,UAAU0R,iBAAmB,IAEpDrF,EAAWwF,MAAMxF,GAAW,IAAKA,EAGjCA,EAAWsF,KAAKG,IAAI,GAAIzF,GAExBA,EAAWsF,KAAKI,IAAI,MAAW1F,GAE/B,IAAItJ,EAAMpC,EAAGmC,YAAY,cACzBwJ,YAAY,WACXjS,EAAEoW,KAAK1N,GAAKsN,KAAK,SAAS2B,GACzBlS,EAAkBkS,EAAKC,MACvBtR,EAAGqB,aAAegQ,EAAKC,QACrBtI,KAAK,SAASE,GAChBtJ,QAAQ0P,MAAM,2BAA4BpG,MAE9B,IAAXwC,GAOH6F,GAGDvR,EAAGmJ,aAAazP,EAAE,WAAYA,EAAE,eAAe,GAAO,GAItDA,EAAE+B,UAAUC,GAAG,qBAAsB,SAASC,GAO7C,IAAI6V,EAAM9X,EAAEiC,EAAMC,QAClB,GAAI4V,EAAIC,QAAQ,SAAS3V,QAAU0V,EAAIC,QAAQ,eAAe3V,OAE7D,OAAO,EAGRkE,EAAGyJ,cAQJ,WAGCzJ,EAAGmJ,aAAazP,EAAE,kBAAmBA,EAAE,gBAGvC,IAAI0P,EAAU1P,EAAE,qCACZgY,EAAchY,EAAE,eAChBiY,EAAWjY,EAAE,YAGjBsG,EAAGmJ,aAAaC,EAASsI,GACzBtI,EAAQV,KAAK,UAAWU,EAAQzO,KAAK,SACrCyO,EAAQzO,KAAK,OAAQ,KACrB+W,EAAYlJ,OAGZkJ,EAAYE,SAAS,IAAK,QAAS,SAASjW,GAC3C,IAAIkW,EAAOnY,EAAEiC,EAAMC,QACfiW,EAAKtJ,GAAG,OACXsJ,EAAOA,EAAKJ,QAAQ,MAEF,IAAhB9V,EAAMmW,OAAgBnW,EAAMoW,SAAYpW,EAAMqW,QAKhDhS,EAAGyJ,UAAU,WAAW,OAAO,IAJ/BoI,EAAKzW,SAAS,iBAQhBsW,EAAYE,SAAS,IAAK,UAAW,SAASjW,GAC1B,IAAhBA,EAAMmW,OAGR9R,EAAGyJ,UAAU,WAAW,OAAO,MAIjCkI,EAASC,SAAS,IAAK,QAAS,SAASjW,GACxC,IAAIkW,EAAOnY,EAAEiC,EAAMC,QACfiW,EAAKtJ,GAAG,OACXsJ,EAAOA,EAAKJ,QAAQ,MAEF,IAAhB9V,EAAMmW,OAAgBnW,EAAMoW,SAAYpW,EAAMqW,QAKhDhS,EAAGyJ,UAAU,WAAW,OAAO,IAJ/BoI,EAAKzW,SAAS,iBA6CjB6W,IAnCK9B,EAAQzW,EAAE,sBAGRkY,SAAS,IAAK,QAAS,SAASjW,GACrC,IAAIuW,EAAQxY,EAAEiC,EAAMC,QACfsW,EAAM3J,GAAG,OACb2J,EAAQA,EAAMT,QAAQ,MAEJ,IAAhB9V,EAAMmW,OAAgBnW,EAAMoW,SAAYpW,EAAMqW,QAOhDhS,EAAGyJ,UAAU,WAAW,OAAO,KAN/ByI,EAAMrW,KAAK,OAAOoC,SAClBiU,EAAMrW,KAAK,OAAOoC,SAClBiU,EAAMlU,QAAQtE,EAAE,UAAU0B,SAAS,0BAQrC+U,EAAMyB,SAAS,IAAK,UAAW,SAASjW,GACpB,IAAhBA,EAAMmW,OAGR9R,EAAGyJ,UAAU,WAAW,OAAO,MAMjC,IAAIzJ,EAAGmS,aAAa,CACnBC,GAAI1Y,EAAE,uBACN6C,QAAS7C,EAAE,+BAUVA,EAAE,eAAeoC,SACnBpC,EAAE,oCAAoCgC,GAAG,QAAS,WACjDhC,EAAE,oBAAoBuE,SACtB,IAAIoU,EAAgB3Y,EAAE,iCAAiC4Y,SAASC,KAAO,EACpEF,EAAgB,KAIlB3Y,EAAE,QAAQuB,OAAO,yDAA0DoX,EAAe,mBAG5F3Y,EAAE,gCAAgCgC,GAAG,QAAS,WAC7ChC,EAAE,YAAY8Y,YAAY,aACvB9Y,EAAE,YAAY6O,GAAG,aACnB7O,EAAE,oBAAoBuE,YAKzB,IAAIwU,EAAa,WAChB,IAAIC,EAAUhZ,EAAE,eACZiZ,EAAmBjZ,EAAE,iBAAiBkZ,aAItCC,EAHcnZ,EAAE,UAAUkZ,aAGMlZ,EAAE,cAAckZ,cAAgBD,EAAmB,IAAMA,EAAmB,KAC5GG,EAAWpZ,EAAE0F,QAAQtF,QAAU,IAC9BgZ,IACJD,GAL+B,KAOhC,IAcIE,EAdAC,EAAWhC,KAAKC,MAAO4B,EAAiBnZ,EAAEgZ,GAAS5Y,SACnDgZ,GAAYE,EAPK,IAQpBA,EARoB,IAUhBF,GAAYE,EAVI,IAWpBA,EAXoB,GAelBN,EAAQ5W,OAAO,EAAEkX,GAAY,GAC/BA,IAGDtZ,EAAE,gBAAgBkE,YAAY,UAE9B,IAAK,IAAIqV,EAAI,EAAGA,EAAIP,EAAQ5W,OAAO,EAAGmX,IAAK,CAC1C,IAAIjb,EAAO0B,EAAEgZ,EAAQO,IAAIvK,KAAK,MAC3BuK,EAAID,GACNtZ,EAAEgZ,EAAQO,IAAIrV,YAAY,UAC1BlE,EAAE,oBAAsB1B,EAAO,KAAKoD,SAAS,aAC7C2X,EAAeL,EAAQO,KAEvBvZ,EAAEgZ,EAAQO,IAAI7X,SAAS,UACvB1B,EAAE,oBAAsB1B,EAAO,KAAK4F,YAAY,aAE7CoV,EAAW,GAAKtZ,EAAEgZ,EAAQO,IAAIC,SAAS,KAAK5K,SAAS,YACvD5O,EAAEqZ,GAAc3X,SAAS,UACzB1B,EAAE,oBAAsBA,EAAEqZ,GAAcrK,KAAK,MAAQ,KAAK9K,YAAY,aACtElE,EAAEgZ,EAAQO,IAAIrV,YAAY,UAC1BlE,EAAE,oBAAsB1B,EAAO,KAAKoD,SAAS,eAMJ,IAAzC1B,EAAE,4BAA4BoC,QAChCpC,EAAE,cAAc8O,OAChB9O,EAAE,eAAe8O,QAEjB9O,EAAE,cAAckP,QAOlB,GAJAlP,EAAE0F,QAAQ+T,OAAOV,GACjB5T,WAAW4T,EAAY,GAGpB/Y,EAAE,mBAAmBoC,SAAWpC,EAAE,QAAQ4O,SAAS,QAAS,CAG9D,IAAI8K,EAAU,IAAIC,KAAK,CACtB7Y,QAASiB,SAAS6X,eAAe,eACjCC,QAAS,QACTC,YAAa,IACbC,gBAAiB,MAGlB/Z,EAAE,gBAAgBsE,QAAQ,+FAE1B,IAAI0V,EAAwB,WACC,QAAzBN,EAAQO,QAAQA,MAClBP,EAAQlX,QAERkX,EAAQQ,KAAK,SAIfla,EAAE,0BAA0B+D,MAAM,WACjCiW,MAGDha,EAAE,0BAA0Bma,SAAS,SAAS3K,GAC/B,IAAXA,EAAE4I,OACJ4B,MAKmBha,EAAE,mBACRkY,SAAS,aAAc,QAAS,SAASjW,GACvD,IAAImY,EAAUpa,EAAEiC,EAAMC,QAEnBkY,EAAQvL,GAAG,4BACbuL,EAAQrC,QAAQ,2BAA2B3V,QAGzCgY,EAAQvL,GAAG,4CACbuL,EAAQrC,QAAQ,2CAA2C3V,QAGzDgY,EAAQvL,GAAG,aACbuL,EAAQrC,QAAQ,YAAY3V,QAG1BgY,EAAQvL,GAAG,kBACbuL,EAAQrC,QAAQ,iBAAiB3V,QAGlCsX,EAAQlX,UAGT,IAAI6X,GAAmC,EACnCC,GAAmC,EACnCC,GAAyC,EAE7CjU,EAAGkU,+BAAiC,WACnCF,GAAmC,EAE/BC,IACHb,EAAQe,SAERJ,GAAmC,EACnCE,GAAyC,IAI3CjU,EAAGoU,kCAAoC,WACtCJ,GAAmC,EAE/BD,IAEHX,EAAQG,SADa,GAGrBQ,GAAmC,EACnCE,GAAyC,IAI3C,IAAII,EAAsB,WACtB3a,EAAE0F,QAAQtF,QAAU,KACtBsZ,EAAQlX,QACRkX,EAAQG,UAERQ,GAAmC,EACnCE,GAAyC,GAC/BD,GACVZ,EAAQe,SAERJ,GAAmC,EACnCE,GAAyC,GAEzCA,GAAyC,GAI3Cva,EAAE0F,QAAQ+T,OAAO5Q,EAAE+R,SAASD,EAAqB,MAGjDA,IAKD1I,YAAY,WACXjS,EAAE,4BAA4ByD,KAAK,WAClCzD,EAAEW,MAAM0C,KAAKiD,EAAGuU,KAAKC,qBAAqBC,SAAS/a,EAAEW,MAAMM,KAAK,kBAAmB,SAElF,KAEHqF,EAAGuO,qBAAqBE,SAqGzB/U,EAAEgb,GAAGC,WAAa,SAASC,EAAWC,GACrC,OAAOxa,KAAK+L,OAAO,WAAa,OAAO1M,EAAEW,MAAMM,KAAKia,KAAeC,KA2EpE7U,EAAGuU,KAAO,CAETO,cApED,SAAuBC,EAAMC,GAC5B,IAAIC,EAAY,CAAC,IAAK,KAAM,KAAM,KAAM,MAEpCC,EAAQH,EAAO,EAAI/D,KAAKC,MAAMD,KAAKnR,IAAIkV,GAAQ/D,KAAKnR,IAAI,OAAS,EAGjEsV,EAAiBF,EADrBC,EAAQlE,KAAKI,IAAI6D,EAAUnZ,OAAS,EAAGoZ,IAEnCE,GAAgBL,EAAO/D,KAAKqE,IAAI,KAAMH,IAAQI,QAAQ,GAC1D,OAAsB,IAAnBN,GAAqC,IAAVE,EACT,QAAjBE,EACK,SAEA,QAIRA,EADEF,EAAQ,EACKK,WAAWH,GAAcE,QAAQ,GAEM,OAA/CF,EAAa1V,OAAO0V,EAAatZ,OAAO,EAAE,GACpCsZ,EAAa1V,OAAO,EAAE0V,EAAatZ,OAAO,GAGxCyZ,WAAWH,GAAcI,eAAexV,EAAGuK,uBAErC,IAAM4K,GAuD5BM,iBAAkB,SAAUC,GAC3B,GAAsB,iBAAXA,EACV,OAAO,KAGR,IAAIlc,EAAIkc,EAAOC,cAAcC,OACzBC,EAAQ,KAgBRC,EAAUtc,EAAE+J,MAAM,mDACtB,OAAgB,OAAZuS,EAMI,MALPD,EAAQN,WAAW/b,GACduc,SAASF,IAMXC,EAAQ,KACXD,GAxBgB,CAChB/S,EAAM,EACNmQ,EAAM,KACN+C,GAAM,KACNC,GAAM,QACNpe,EAAM,QACNqe,GAAM,WACNC,EAAM,WACNC,GAAM,cACNzd,EAAM,cACN0d,GAAM,gBACN9c,EAAM,iBAaqBuc,EAAQ,KAGpCD,EAAQ7E,KAAKsF,MAAMT,IATV,OAkBVU,WAAY,SAAUC,EAAWC,GAEhC,OADAA,EAASA,GAAU,MACZ9H,OAAO6H,GAAWC,OAAOA,IAOjCjC,qBAAsB,SAAUgC,GAC/B,IAAIE,EAAO/H,SAAS+H,KAAK/H,OAAO6H,IAChC,OAAIE,GAAQ,GAAKA,EAAO,KAChB/d,EAAE,OAAQ,eAEXgW,OAAO6H,GAAWG,WAQ1BC,KAAM,WACL,OAAOld,EAAE,QAAQ4O,SAAS,OAQ3BuO,kBAAmB,WAClB,GAAIxc,KAAKyc,gBACR,OAAOzc,KAAKyc,gBAGb,IAAIC,EAAQtb,SAASub,cAAc,KACnCD,EAAMtc,MAAMX,MAAQ,OACpBid,EAAMtc,MAAMV,OAAS,QAErB,IAAIkd,EAAQxb,SAASub,cAAc,OACnCC,EAAMxc,MAAMc,SAAW,WACvB0b,EAAMxc,MAAMyc,IAAM,MAClBD,EAAMxc,MAAM8X,KAAO,MACnB0E,EAAMxc,MAAM0c,WAAa,SACzBF,EAAMxc,MAAMX,MAAQ,QACpBmd,EAAMxc,MAAMV,OAAS,QACrBkd,EAAMxc,MAAM2c,SAAW,SACvBH,EAAMI,YAAaN,GAEnBtb,SAAS6b,KAAKD,YAAaJ,GAC3B,IAAIM,EAAKR,EAAMS,YACfP,EAAMxc,MAAM2c,SAAW,SACvB,IAAIK,EAAKV,EAAMS,YASf,OARGD,IAAOE,IACTA,EAAKR,EAAMS,aAGZjc,SAAS6b,KAAKK,YAAaV,GAE3B5c,KAAKyc,gBAAmBS,EAAKE,EAEtBpd,KAAKyc,iBASbc,UAAW,SAASC,GAGnB,OAAO,IAAIC,KAAKD,EAAKE,cAAeF,EAAKG,WAAYH,EAAKI,YAG3DC,UAAW,SAASvf,GAInB,IAFA,IAAyCb,EAArCqgB,EAAK,GAAIC,EAAI,EAAGC,GAAK,EAAGnf,EAAI,EAEzBkf,EAAIzf,EAAEmD,QAAQ,CACpBhE,EAAIa,EAAEqK,OAAOoV,GAEb,IAAIvgB,GAAOqB,GAAW,MAANpB,GAAeA,GAAK,KAAOA,GAAK,IAC5CD,IAAMqB,IAGTif,IADAE,GACQ,GACRnf,EAAIrB,GAELsgB,EAAGE,IAAMvgB,EACTsgB,IAED,OAAOD,GASRG,mBAAoB,SAASzV,EAAGC,GAC/B,IAAIsV,EACAG,EAAKvY,EAAGuU,KAAK2D,UAAUrV,GACvB2V,EAAKxY,EAAGuU,KAAK2D,UAAUpV,GAE3B,IAAKsV,EAAI,EAAGG,EAAGH,IAAMI,EAAGJ,GAAIA,IAC3B,GAAIG,EAAGH,KAAOI,EAAGJ,GAAI,CACpB,IAAIK,EAAOC,OAAOH,EAAGH,IAAKO,EAAOD,OAAOF,EAAGJ,IAE3C,OAAIK,GAAQF,EAAGH,IAAMO,GAAQH,EAAGJ,GACxBK,EAAOE,EAOPJ,EAAGH,GAAGQ,cAAcJ,EAAGJ,GAAI,MAIrC,OAAOG,EAAGzc,OAAS0c,EAAG1c,QAOvB+c,QAAS,SAASla,EAAU+M,IACJ,SAAnBoN,KACe,IAAfna,KACFE,WAAWia,EAAkBpN,GAI/BoN,IAQDC,mBAAoB,SAAS/gB,EAAMU,GAElC,IADA,IAAIsgB,EAAUvd,SAASwd,OAAOpV,MAAM,KAC3BpM,EAAE,EAAGA,EAAIuhB,EAAQld,OAAQrE,IAAK,CACtC,IAAIwhB,EAASD,EAAQvhB,GAAGoM,MAAM,KAC9B,GAAIoV,EAAO,GAAGrD,SAAW5d,GAAQihB,EAAO,GAAGrD,SAAWld,EACrD,OAAO,EAGT,OAAO,IAWTsH,EAAGuU,KAAK2E,QAAU,CACjBC,UAAW,GAcXC,WAAY,SAAS/W,EAAQD,EAAKQ,GACjC,IAAIyW,EAOJ,GALCA,EADsB,iBAAZhX,EACEA,EAGArC,EAAG2H,iBAAiBtF,GAE7BjD,OAAOka,QAAQC,UAAW,CAK7B,GAJAnX,EAAMA,GAAO7C,SAASC,SAAW,IAAM6Z,EAGvBhJ,UAAUD,UAAUuF,cAAclW,QAAQ,YAAc,GACvDgV,SAASpE,UAAUD,UAAUvM,MAAM,KAAK2V,OAAS,GAEjE,IADA,IACsCC,EADlCC,EAAWje,SAASke,iBAAiB,+DAChCliB,EAAI,EAAGmiB,EAAKF,EAAS5d,OAAiBrE,EAAImiB,EAAIniB,KACtDgiB,EAAUC,EAASjiB,IACXgD,MAAMof,KAAOJ,EAAQhf,MAAMof,KACnCJ,EAAQhf,MAAMqf,OAASL,EAAQhf,MAAMqf,OACrCL,EAAQM,gBAAgB,UACxBN,EAAQO,aAAa,SAAU,gBAG7BpX,EACHxD,OAAOka,QAAQW,aAAa5X,EAAQ,GAAID,GAExChD,OAAOka,QAAQC,UAAUlX,EAAQ,GAAID,QAKtChD,OAAOG,SAAS2a,KAAO,IAAMb,EAG7Bhf,KAAK8f,YAAa,GAepBZ,UAAW,SAASlX,EAAQD,GAC3B,OAAO/H,KAAK+e,WAAW/W,EAAQD,GAAK,IAcrC6X,aAAc,SAAS5X,EAAQD,GAC9B,OAAO/H,KAAK+e,WAAW/W,EAAQD,GAAK,IAQrCgY,qBAAsB,SAASC,GAC9BhgB,KAAK8e,UAAUrU,KAAKuV,IAOrBC,gBAAiB,WAChB,IAAIJ,EAAO9a,OAAOG,SAAS2a,KAC1B5a,EAAM4a,EAAKza,QAAQ,KACpB,OAAIH,GAAO,EACH4a,EAAKxa,OAAOJ,EAAM,GAEtB4a,EAAKpe,OAEDoe,EAAKxa,OAAO,GAEb,IAGR6a,aAAc,SAASrT,GACtB,OAAOA,EAAMtE,QAAQ,MAAO,MAS7B4X,cAAe,WACd,IACCnY,EADG6E,EAAQ7M,KAAKigB,kBAQjB,OALIpT,IACH7E,EAASrC,EAAGsH,iBAAiBjN,KAAKkgB,aAAarT,MAGhD7E,EAASE,EAAE4F,OAAO9F,GAAU,GAAIrC,EAAGsH,iBAAiBjN,KAAKkgB,aAAahb,SAAS0H,YAC9D,IAGlBwT,YAAa,SAASvR,GAKrB,IAAI7G,EAJJ,GAAIhI,KAAK8f,WACR9f,KAAK8f,YAAa,OAInB,GAAK9f,KAAK8e,UAAUrd,OAApB,CAGAuG,EAAU6G,GAAKA,EAAEyK,MACbpR,EAAEmY,SAASrY,GACdA,EAASrC,EAAGsH,iBAAiBjF,GAClBA,IACXA,EAAShI,KAAKmgB,iBAAmB,IAElC,IAAK,IAAI/iB,EAAI,EAAGA,EAAI4C,KAAK8e,UAAUrd,OAAQrE,IAC1C4C,KAAK8e,UAAU1hB,GAAG4K,MAMjBjD,OAAOka,QAAQC,UAClBna,OAAOub,WAAapY,EAAEtJ,KAAK+G,EAAGuU,KAAK2E,QAAQuB,YAAaza,EAAGuU,KAAK2E,SAGhExf,EAAE0F,QAAQ1D,GAAG,aAAc6G,EAAEtJ,KAAK+G,EAAGuU,KAAK2E,QAAQuB,YAAaza,EAAGuU,KAAK2E,UAQxElZ,EAAG1H,IAAI,SAASN,GAKf,IAJA,IAAI4iB,EAAa5iB,EAAK6L,MAAM,KACxBgX,EAAOD,EAAWpB,MAClBsB,EAAQ1b,OAEJ3H,EAAI,EAAGA,EAAImjB,EAAW9e,OAAQrE,IAErC,KADAqjB,EAAUA,EAAQF,EAAWnjB,KAE5B,OAAO,EAGT,OAAOqjB,EAAQD,IAQhB7a,EAAG+a,IAAI,SAAS/iB,EAAMU,GAKrB,IAJA,IAAIkiB,EAAa5iB,EAAK6L,MAAM,KACxBgX,EAAOD,EAAWpB,MAClBsB,EAAQ1b,OAEJ3H,EAAI,EAAGA,EAAImjB,EAAW9e,OAAQrE,IACjCqjB,EAAQF,EAAWnjB,MACtBqjB,EAAQF,EAAWnjB,IAAI,IAExBqjB,EAAUA,EAAQF,EAAWnjB,IAE9BqjB,EAAQD,GAAMniB,GAIf,WACC,GAAI,oBAAqB+C,SAASuf,gBAAgBvgB,OAAS4V,UAAUD,UAAU7M,MAAM,mBAAoB,CACxG,IAAI0X,EAAkBxf,SAASub,cAAc,SAC7CiE,EAAgB5D,YACf5b,SAASyf,eAAe,wCAEzBzf,SAASwD,qBAAqB,QAAQ,GAAGoY,YAAY4D,IANvD,GAcA7b,OAAO+b,IAAM,GAQbxhB,OAAO+a,GAAG0G,YAAc,SAASC,EAAOC,GACvC,OAAOjhB,KAAK8C,KAAK,WAChB,GAAI9C,KAAKkhB,kBACRlhB,KAAKsC,QACLtC,KAAKkhB,kBAAkBF,EAAOC,QACxB,GAAIjhB,KAAKmhB,gBAAiB,CAChC,IAAIC,EAAQphB,KAAKmhB,kBACjBC,EAAMC,UAAS,GACfD,EAAME,QAAQ,YAAaL,GAC3BG,EAAMG,UAAU,YAAaP,GAC7BI,EAAMI,aAUTliB,OAAO+a,GAAGoH,OAAS,WAClB,OAAOzhB,KAAKyB,OAAS,GAMtBnC,OAAO+a,GAAGqH,MAAQ,SAASC,GAE1B,GADApc,QAAQkO,KAAK,kEACU,WAApBmO,EAAOD,IAAsC,OAAbA,EAAmB,CAGrD,IAAIniB,EAAU,CACbqiB,UAAW,SACX5O,MAAO,CAAE1E,KAAQ,EAAGJ,KAAQ,GAC5BjM,QAAS,QACToM,MAAM,EACNwT,UAAW,QAEZ,GAAGH,EAASI,QACX,OAAOJ,EAASI,SACf,IAAK,IACL,IAAK,KACL,IAAK,KACJviB,EAAQqiB,UAAU,SAClB,MACD,IAAK,IACL,IAAK,KACL,IAAK,KACJriB,EAAQqiB,UAAU,MAClB,MACD,IAAK,IACJriB,EAAQqiB,UAAU,QAClB,MACD,IAAK,IACJriB,EAAQqiB,UAAU,OAIlBF,EAASzf,UACX1C,EAAQ0C,QAAUyf,EAASzf,SAEzByf,EAASK,UACXxiB,EAAQyT,MAAM1E,KAAOoT,EAASK,SAE5BL,EAASM,WACXziB,EAAQyT,MAAM9E,KAAOwT,EAASM,UAE5BN,EAASrT,OACX9O,EAAQ8O,MAAO,GAEbqT,EAASO,WACX1iB,EAAQe,MAAQohB,EAASO,UAG1B5iB,OAAO+a,GAAG8H,QAAQ5kB,KAAKyC,KAAM,WAC7BV,OAAO+a,GAAG8H,QAAQ5kB,KAAKyC,KAAMR,QAE7BQ,KAAKmiB,QAAQR,GACbriB,OAAO+a,GAAG8H,QAAQ5kB,KAAKyC,KAAM2hB,GAE9B,OAAO3hB,0PCj3ER2F,GAAG2F,KAAO,CAKT8W,SAAU,GAMVC,iBAAkB,GAUlB9W,KAAM,SAAS+W,EAAShe,GAEvB,GAAItE,KAAKoiB,SAASE,IAA+B,OAAnB3c,GAAGyK,YAAsB,CACtD,IAAItF,EAAWzL,EAAE2L,WACbuX,EAAUzX,EAASyX,UAGvB,OAFAA,EAAQlN,KAAK/Q,GACbwG,EAASI,UACFqX,EAGR,IAAIxiB,EAAOC,KACP+H,EAAMpC,GAAG0B,SAASib,EAAS,OAAQ3c,GAAGyK,YAAc,SAGxD,OAAO/Q,EAAEpB,IAAI8J,GACXsN,KACA,SAAS7K,GACJA,EAAOgY,cACVziB,EAAK+R,SAASwQ,EAAS9X,EAAOgY,aAAchY,EAAOiY,cAGrDpN,KAAK/Q,IAURwN,SAAU,SAASwQ,EAASI,EAAQD,GAE/Bva,EAAE8B,YAAYhK,KAAKoiB,SAASE,KAC/BtiB,KAAKoiB,SAASE,GAAWI,GAAU,GAGnC1iB,KAAKqiB,iBAAiBC,GAAWtiB,KAAK2iB,YAGtCza,EAAE4F,OARQ9N,KAQIoiB,SAASE,GAAUI,IAcnCE,UAAW,SAASzb,EAAKzE,EAAM4F,EAAMua,EAAOrjB,GAC3C,IAGCyI,EAAazI,GAAW,GACzB0I,EAAEC,SAASF,EAJU,CACnBG,QAAQ,IAQV,IAgBI0a,EAAcpgB,EAEdrE,GADS2B,KAAKoiB,SAASjb,IAAQ,IAChBzE,GAKnB,YAJsB,IAAXrE,IACVykB,EAAczkB,GAGI,WAAhBujB,EAAOtZ,SAA+B9E,IAAVqf,EACvBE,UAAUC,SAxBL,SAAUtgB,EAAM4F,EAAMua,GAClC,OAAOngB,EAAK6F,QAAQ,MAAOsa,GAAOta,QAAQ,cACzC,SAAUC,EAAGC,GACZ,IAAIvK,EAAIoK,EAAKG,GACb,MAAgB,iBAANvK,GAA+B,iBAANA,EAC/B+J,EAAWG,OACN2a,UAAUC,SAASC,WAAW/kB,IAE9B6kB,UAAUC,SAAS9kB,GAGpB6kB,UAAUC,SAASxa,KAaHH,CAAOya,EAAaxa,EAAMua,IAE7CE,UAAUC,SAASF,IAe5BI,gBAAiB,SAAS/b,EAAKgc,EAAcC,EAAYP,EAAOva,EAAM9I,GACrE,IAAI6jB,EAAa,IAAMF,EAAe,OAASC,EAAa,IAExD/kB,GADS2B,KAAKoiB,SAASjb,IAAQ,IAChBkc,GACnB,QAAsB,IAAXhlB,EAAwB,CAClC,IAAIykB,EAAczkB,EAClB,GAAIgB,EAAEikB,QAAQR,GAAc,CAC3B,IAAIS,EAASvjB,KAAKqiB,iBAAiBlb,GAAK0b,GACxC,OAAO7iB,KAAK4iB,UAAUzb,EAAK2b,EAAYS,GAASjb,EAAMua,EAAOrjB,IAI/D,OAAa,IAAVqjB,EACK7iB,KAAK4iB,UAAUzb,EAAKgc,EAAc7a,EAAMua,EAAOrjB,GAG/CQ,KAAK4iB,UAAUzb,EAAKic,EAAY9a,EAAMua,EAAOrjB,IAWtDmjB,WAAY,SAASa,GACpB,IAAIrT,EAASxK,GAAGyK,YAMhB,GALI,UAAYD,IAEfA,EAAS,YAGY,IAAXA,EACV,OAAQ,GAAKqT,EAAU,EAAI,EAY5B,OATIrT,EAAO1O,OAAS,IACnB0O,EAASA,EAAOpH,UAAU,EAAGoH,EAAO7K,YAAY,OAQzC6K,GACP,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACJ,OAAO,EAER,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACJ,OAAQ,GAAKqT,EAAU,EAAI,EAE5B,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,MACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,MACL,IAAK,MACL,IAAK,KACL,IAAK,KACJ,OAAS,GAAKA,GAAY,GAAKA,EAAW,EAAI,EAE/C,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACL,IAAK,KACJ,OAAS,GAAKA,EAAS,IAAQ,IAAMA,EAAS,IAAQ,EAAOA,EAAS,IAAM,GAAOA,EAAS,IAAM,IAAQA,EAAS,IAAM,IAAQA,EAAS,KAAO,IAAQ,EAAI,EAE9J,IAAK,KACL,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAOA,GAAU,GAAOA,GAAU,EAAM,EAAI,EAEpE,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAM,GAAKA,EAAU,EAAI,EAEjD,IAAK,KACJ,OAAS,GAAKA,EAAS,IAAQ,IAAMA,EAAS,IAAQ,EAAOA,EAAS,IAAM,IAAQA,EAAS,IAAM,IAAQA,EAAS,KAAO,IAAQ,EAAI,EAExI,IAAK,KACJ,OAAQ,GAAKA,EAAS,IAAO,EAAM,GAAKA,EAAS,IAAO,EAAO,GAAKA,EAAS,KAAS,GAAKA,EAAS,IAAQ,EAAI,EAEjH,IAAK,KACJ,OAAQ,GAAKA,EAAS,GAAM,EAAI,EAEjC,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAO,GAAKA,GAAaA,EAAS,IAAM,GAAOA,EAAS,IAAM,GAAQ,EAAOA,EAAS,IAAM,IAAQA,EAAS,IAAM,GAAO,EAAI,EAEtJ,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAO,GAAKA,EAAS,IAAQ,IAAMA,EAAS,IAAQ,EAAI,EAEhF,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAOA,EAAS,IAAM,GAAOA,EAAS,IAAM,IAAQA,EAAS,IAAM,IAAQA,EAAS,IAAM,IAAQ,EAAI,EAE9H,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAM,GAAKA,EAAU,EAAO,GAAKA,GAAY,IAAMA,EAAW,EAAI,EAE1F,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAO,GAAKA,GAAaA,EAAS,IAAM,GAAOA,EAAS,IAAM,GAAQ,EAAI,EAElG,IAAK,KACJ,OAAQ,GAAKA,EAAU,EAAM,GAAKA,EAAU,EAAM,GAAKA,EAAU,EAAOA,EAAS,KAAO,GAAOA,EAAS,KAAO,GAAO,EAAOA,EAAS,KAAO,IAAQA,EAAS,KAAO,GAAO,EAAI,EAEjL,QACC,OAAO,KAaXze,OAAOzG,EAAI4J,EAAEtJ,KAAK+G,GAAG2F,KAAKsX,UAAWjd,GAAG2F,MAWxCvG,OAAOlG,EAAIqJ,EAAEtJ,KAAK+G,GAAG2F,KAAK4X,gBAAiBvd,GAAG2F,MAE9CmY,WAAWC,eAAe,IAAK,SAASvc,EAAKzE,GAC5C,OAAOiD,GAAG2F,KAAKsX,UAAUzb,EAAKzE,oBCvS/B,IAAWrD,EAKNskB,EALMtkB,EAqDPC,OAhDCqkB,EAAW,CACdvP,KAAM,SAAS9L,EAAM9I,EAASokB,GAE7B5jB,KAAKsI,KAAOA,EACZtI,KAAKR,QAAUH,EAAEyO,OAAO,GAAG9N,KAAKR,QAAQA,GAExCQ,KAAK4jB,KAAOA,EAGZ,GAA0C,mBAAhC5jB,KAAKR,QAAQqkB,eAEtB,IADA,IAAIC,EAAOhmB,OAAOgmB,KAAK9jB,KAAKsI,MACnB3J,EAAM,EAAGA,EAAMmlB,EAAKriB,OAAQ9C,IACD,iBAAzBqB,KAAKsI,KAAKwb,EAAKnlB,MACxBqB,KAAKsI,KAAKwb,EAAKnlB,IANPqB,KAMoBR,QAAQqkB,eAAe7jB,KAAKsI,KAAKwb,EAAKnlB,MAKrE,IAAIolB,EAAQ/jB,KAAKqI,OAAOrI,KAAKsI,MAC7B,OAAOjJ,EAAE0kB,IAGV1b,OAAQ,SAASxK,GAChB,IAAIwQ,EAAkC,kBAA3BrO,KAAK4jB,KAAKtjB,KAAK,QAA8BN,KAAK4jB,KAAKtV,OAAStO,KAAK4jB,KAAK3lB,IAAI,GAAG+lB,UAC5F,IACC,OAAO3V,EAAK9F,QAAQ,cACnB,SAAUC,EAAGC,GACZ,IAAIvK,EAAIL,EAAE4K,GACV,MAAoB,iBAANvK,GAA+B,iBAANA,EAAiBA,EAAIsK,IAG7D,MAAMqG,GACPtJ,QAAQ0P,MAAMpG,EAAG,QAASR,KAG5B7O,QAAS,CACRqkB,eAAgBZ,aAIlB5jB,EAAEgb,GAAG4J,WAAa,SAAS3b,EAAM9I,GAEhC,GADA8I,EAAOA,GAAQ,GACZtI,KAAKyB,OAEP,OADgB3D,OAAOY,OAAOilB,GACbvP,KAAK9L,EAAM9I,EAASQ,sBC5DxC2F,GAAGue,YAAY,SAASC,EAAI9V,GAC3B,IACI1Q,EACAymB,EAFAC,EAAQ,GAMZ,GAHArkB,KAAKskB,kBAAkB,GACvBtkB,KAAKukB,QAAS,EACdvkB,KAAKwkB,UAAU,GACZnW,EACF,IAAI1Q,KAAQ0Q,EACXgW,GAAS1mB,EAAK,IAAI+K,mBAAmB2F,EAAK1Q,IAAO,IAInD,GADA0mB,GAAS,gBAAgB3b,mBAAmB5D,iBACxC9E,KAAKykB,aAAsC,oBAAhBP,YAW1B,CACJ,IAAIQ,EAAS,yBAAyB/e,GAAGue,YAAYS,YACrDhf,GAAGue,YAAYU,gBAAgBjf,GAAGue,YAAYS,aAAa3kB,KAC3DA,KAAK6kB,OAAOxlB,EAAE,aACdW,KAAK6kB,OAAOvkB,KAAK,KAAKokB,GACtB1kB,KAAK6kB,OAAO1W,OAEZiW,EAAW,KACc,IAAtBD,EAAI/e,QAAQ,OACdgf,EAAW,KAEZpkB,KAAK6kB,OAAOvkB,KAAK,MAAM6jB,EAAIC,EAAS,6BAA6Bze,GAAGue,YAAYS,YAAY,IAAIN,GAChGhlB,EAAE,QAAQuB,OAAOZ,KAAK6kB,QACtB7kB,KAAKykB,aAAY,EACjB9e,GAAGue,YAAYS,mBAxBfP,EAAW,KACc,IAAtBD,EAAI/e,QAAQ,OACdgf,EAAW,KAEZpkB,KAAK8kB,OAAQ,IAAIZ,YAAYC,EAAIC,EAASC,GAC1CrkB,KAAK8kB,OAAOC,UAAU,SAASlW,GAC9B,IAAI,IAAIzR,EAAE,EAAEA,EAAE4C,KAAKskB,kBAAkB7iB,OAAOrE,IAC3C4C,KAAKskB,kBAAkBlnB,GAAG4nB,KAAKC,MAAMpW,EAAER,QAEvCzP,KAAKoB,MAkBRA,KAAKklB,OAAO,eAAe,SAAS7W,GACvB,UAATA,GACFrO,KAAK6B,SAELjD,KAAKoB,QAER2F,GAAGue,YAAYU,gBAAgB,GAC/Bjf,GAAGue,YAAYS,YAAY,EAC3Bhf,GAAGue,YAAYiB,iBAAiB,SAASC,EAAGzjB,EAAK0M,GAChD1I,GAAGue,YAAYU,gBAAgBQ,GAAID,iBAAiBxjB,EAAK0M,IAE1D1I,GAAGue,YAAYllB,UAAU,CACxBslB,kBAAkB,GAClBO,OAAO,KACPL,UAAU,GACVC,aAAY,EAWZU,iBAAiB,SAASxjB,EAAK0M,GAC9B,IAAIjR,EAEJ,IAAI4C,KAAKukB,OAGT,GAAG5iB,GACF,QAAmC,IAAxB3B,KAAKwkB,UAAUa,KACzB,IAAIjoB,EAAE,EAAEA,EAAE4C,KAAKwkB,UAAU7iB,GAAMF,OAAOrE,IACrC4C,KAAKwkB,UAAU7iB,GAAMvE,GAAGiR,QAI1B,IAAIjR,EAAE,EAAEA,EAAE4C,KAAKskB,kBAAkB7iB,OAAOrE,IACvC4C,KAAKskB,kBAAkBlnB,GAAGiR,IAI7BiX,WAAW,EAOXJ,OAAO,SAASvjB,EAAK2C,GACjBA,GAAYA,EAAS/G,OAEpBoE,EACC3B,KAAKykB,aACHzkB,KAAKwkB,UAAU7iB,KAClB3B,KAAKwkB,UAAU7iB,GAAM,IAEtB3B,KAAKwkB,UAAU7iB,GAAM8I,KAAKnG,IAE1BtE,KAAK8kB,OAAOpT,iBAAiB/P,EAAK,SAASkN,QACpB,IAAXA,EAAER,KACZ/J,EAAS0gB,KAAKC,MAAMpW,EAAER,OAEtB/J,EAAS,MAET,GAGHtE,KAAKskB,kBAAkB7Z,KAAKnG,KAO/BzC,MAAM,WACL7B,KAAKukB,QAAS,OACa,IAAhBvkB,KAAK8kB,QACf9kB,KAAK8kB,OAAOjjB;;;;;;;;;;;;;;;;;;;;ACxIf0jB,IAAIC,UAAY,CAUfC,MAAO,SAASC,EAAQC,EAAUnmB,GACjB,SAAXkmB,GAAgC,WAAXA,IAAwB/f,GAAGuO,qBAAqBM,gCAK1EhV,EAAUA,GAAW,GACrBH,EAAEoW,KAAK,CACN9T,KAAM+jB,EAAOE,cACb7d,IAAKpC,GAAGiC,UAAU,+BAAgC,GAAK,cAAgB+d,EACvEtX,KAAM7O,EAAQ6O,MAAQ,GACtBqH,QAASlW,EAAQkW,QACjBT,MAAOzV,EAAQyV,SAVftP,GAAGuO,qBAAqBG,4BAA4BnM,EAAEtJ,KAAKoB,KAAKylB,MAAOzlB,KAAM0lB,EAAQC,EAAUnmB,KAmBjGqmB,QAAS,SAASrmB,GACjBQ,KAAKylB,MAAM,MAAO,GAAIjmB,IAUvBsmB,QAAS,SAAS3e,EAAK3H,GACtBQ,KAAKylB,MAAM,MAAO,IAAMte,EAAK3H,IAY9BumB,SAAU,SAAS5e,EAAKxI,EAAKqnB,EAAcxmB,IAC1CA,EAAUA,GAAW,IACb6O,KAAO,CACd2X,aAAcA,GAGfhmB,KAAKylB,MAAM,MAAO,IAAMte,EAAM,IAAMxI,EAAKa,IAY1CymB,SAAU,SAAS9e,EAAKxI,EAAKN,EAAOmB,IACnCA,EAAUA,GAAW,IACb6O,KAAO,CACdhQ,MAAOA,GAGR2B,KAAKylB,MAAM,OAAQ,IAAMte,EAAM,IAAMxI,EAAKa,IAW3C0mB,UAAW,SAAS/e,EAAKxI,EAAKa,GAC7BQ,KAAKylB,MAAM,SAAU,IAAMte,EAAM,IAAMxI,EAAKa,qBC1G9C,SAAU+lB,GACT,aAEAA,EAAIY,SAAW,CAWdC,SAAU,6FAEVC,YAAa,SAASC,GAErB,OADAA,EAAUtmB,KAAKumB,gBAAgBD,IAIhCE,YAAa,SAASF,GAErB,OADAA,EAAUtmB,KAAKymB,iBAAiBH,IAIjCC,gBAAiB,SAASD,GACzB,OAAOA,EAAQ/d,QAAQvI,KAAKomB,SAAU,SAASle,EAAGwe,EAAchf,EAAUK,EAAK4e,GAC9E,IAAIC,EAAW7e,EAOf,OANIL,EAEoB,YAAbA,IACVkf,EAAWlf,EAAWK,GAFtBL,EAAW,WAKLgf,EAAe,uEAAyEhf,EAAWK,EAAM,KAAO6e,EAAW,OAASD,KAI7IF,iBAAkB,SAASH,GAC1B,IAAIO,EAAWxnB,EAAE,eAAeiP,KAAKgY,GAKrC,OAJAO,EAASrlB,KAAK,KAAKsB,KAAK,WACvB,IAAIgkB,EAAQznB,EAAEW,MACd8mB,EAAMxY,KAAKwY,EAAMxmB,KAAK,WAEhBumB,EAASvY,SA7CnB,CAiDGiX,qBCjDH,SAAUA,GACT,aAEAA,EAAIwB,SAAW,CAEdla,MAAO,SAASrN,GAEf,IAAIwnB,GADJxnB,EAAUA,GAAW,IACQynB,SAAW,GACxC5nB,EAAEoW,KAAK,CACN9T,KAAM,MACNoG,IAAKvI,EAAQuI,KAAOpC,GAAGiC,UAAU,OAAQ,GAAK,uBAC9C8N,QAASlW,EAAQkW,SAAW,SAASrH,EAAM2C,EAAYF,GACtDyU,EAAIwB,SAASG,gBAAgB7Y,EAAM2C,EAAYF,EAAKkW,IAErD/R,MAAOzV,EAAQyV,OAASjV,KAAKmnB,iBAI/BF,QAAS,SAASpf,EAASrI,GAC1BA,EAAUA,GAAW,GACrBH,EAAEoW,KAAK,CACN9T,KAAM,OACNoG,IAAKvI,EAAQuI,KAAOpC,GAAGiC,UAAU,OAAQ,GAAK,WAC9CyG,KAAM,CAACxG,QAASa,mBAAmBb,IACnC6N,QAASlW,EAAQkW,SAAW1V,KAAKonB,kBACjCnS,MAAOzV,EAAQyV,OAASjV,KAAKqnB,kBAG9BhoB,EAAE,oBAAoBuE,UAGvBsjB,gBAAiB,SAAS7Y,EAAM2C,EAAYF,EAAKkW,GAIhD,GAHAzhB,QAAQ+hB,MAAM,2CAA6CtW,GAC3DzL,QAAQ+hB,MAAMjZ,GAEI,MAAfyC,EAAIC,OAAP,CAIA,IAAIwW,EAAMC,EAAU9kB,EAAM+kB,EAEtBC,EAAMtmB,SAASub,cAAc,OACjC+K,EAAIC,UAAUC,IAAI,cAAe,OAAQ,kBAAmB,aAE5D,IAAIC,EAAOzmB,SAASub,cAAc,MAuBlC,IAAK,IAAIvf,KApBTmqB,EAAOnmB,SAASub,cAAc,OAC9B6K,EAAWpmB,SAASub,cAAc,SACzBmL,UAAY,YAErBplB,EAAOtB,SAASub,cAAc,SACzBoL,UAAYzpB,EAAE,OAAQ,UAAY,IAAM+P,EAAI,IAAJ,aAC7C3L,EAAKolB,UAAY,UACjBN,EAASxK,YAAYta,IAErB+kB,EAAOrmB,SAASub,cAAc,SACzBmL,UAAY,aACjBL,EAAKO,QAAU,WACdzC,EAAIwB,SAASE,QAAQ5Y,EAAI,IAAJ,aAAgC2Y,IAEtDQ,EAASxK,YAAYyK,GAErBF,EAAKvK,YAAYwK,GACjBK,EAAK7K,YAAYuK,GAGHlZ,EAAI,IAAJ,sBAA4C,CACzD,IAAI4Z,EAAmB5Z,EAAI,IAAJ,sBAA2CjR,GAClEmqB,EAAOnmB,SAASub,cAAc,OAE9B6K,EAAWpmB,SAASub,cAAc,SACzBmL,UAAY,YAErBL,EAAOrmB,SAASub,cAAc,SACzBmL,UAAY,iBACjBN,EAASxK,YAAYyK,IAErB/kB,EAAOtB,SAASub,cAAc,MACzBuL,UAAYhgB,EAAEE,OAAO6f,GAC1BT,EAASxK,YAAYta,GAErB6kB,EAAKvK,YAAYwK,GACjBK,EAAK7K,YAAYuK,GAIdrf,EAAE8B,YAAYqE,EAAI,IAAJ,qBACjBkZ,EAAOnmB,SAASub,cAAc,OAE9B6K,EAAWpmB,SAASub,cAAc,MACzBwL,KAAO9Z,EAAI,IAAJ,kBAChBmZ,EAASY,IAAM,sBACfZ,EAASjmB,OAAS,UAElBkmB,EAAOrmB,SAASub,cAAc,SACzBmL,UAAY,YACjBN,EAASxK,YAAYyK,IAErB/kB,EAAOtB,SAASub,cAAc,SACzBoL,UAAYzpB,EAAE,OAAQ,kBAC3BkpB,EAASxK,YAAYta,GAErB6kB,EAAKvK,YAAYwK,GACjBK,EAAK7K,YAAYuK,IAGlBG,EAAI1K,YAAY6K,GAChBzmB,SAAS6b,KAAKD,YAAY0K,KAG3BP,cAAe,SAAUpJ,EAAGzf,EAAGuQ,GAC9BtJ,QAAQ+hB,MAAM,iDAAmDhpB,EAAIuQ,GACrEtJ,QAAQ+hB,MAAMvJ,IAGfqJ,kBAAmB,SAAS/Y,KAI5BgZ,gBAAiB,SAAUhZ,GAC1B9I,QAAQ+hB,MAAM,mDAAqDjZ,KAzHtE,CA4HGkX;;;;;;;;;;;;;;;;;;;;AC7GH5f,GAAG6f,UAAU,CAIZO,SAAS,SAAS5e,EAAIxI,EAAIqnB,EAAa1hB,GACtCihB,IAAIC,UAAUO,SAAS5e,EAAKxI,EAAKqnB,EAAc,CAC9CtQ,QAASpR,KAOX2hB,SAAS,SAAS9e,EAAIxI,EAAIN,GACzBknB,IAAIC,UAAUS,SAAS9e,EAAKxI,EAAKN,IAMlCwnB,QAAQ,SAASvhB,GAChBihB,IAAIC,UAAUK,QAAQ,CACrBnQ,QAASpR,KAOXwhB,QAAQ,SAAS3e,EAAI7C,GACpBihB,IAAIC,UAAUM,QAAQ3e,EAAK,CAC1BuO,QAASpR,KAOX4hB,UAAU,SAAS/e,EAAIxI,GACtB4mB,IAAIC,UAAUU,UAAU/e,EAAKxI,oBC/D/BU,EAAE+B,UAAUC,GAAG,WAAW,SAASgnB,EAAKvX,EAAK/C,IAChB,IAAzBA,EAASua,cACXxX,EAAIyX,iBAAiB,eAAgBzjB,iBACrCgM,EAAIyX,iBAAiB,iBAAkB,2BCOxC,SAAUnnB,EAAU/B,EAAGnC,GAEvB,aAEA,IAAIsrB,GAA4B,EAEhCtrB,EAAQurB,KAAO,CACdC,yBAA0B,WACzBF,GAA4B,IAS9BtrB,EAAQurB,KAAKE,eAAiB,SAASxR,IACpBA,GAAO9X,EAAE,iBACfkE,YAAY,aACtBgL,KAAK,QAAS,CAAEqa,UAAW,SAAW,KACxCvpB,EAAE,gBAAgB6C,QAAQ,IAAI7C,EAAEsQ,MAAM,gBASvCzS,EAAQurB,KAAKI,eAAiB,SAAS1R,GACtC,IAAI2R,EAAc3R,GAAO9X,EAAE,gBAC3BypB,EAAY3a,KAAK,QAAS,CAAEya,UAAW,SAAW,IACjD,WACCE,EAAY/nB,SAAS,eAEvB1B,EAAE,gBAAgB6C,QAAQ,IAAI7C,EAAEsQ,MAAM,gBA2EvCtQ,EAAE+B,GAAUyJ,MAAM,WA/DY,IACzBpH,EAEmB,KAFnBA,EAAUpE,EAAE,6BAEJoC,QACXpC,EAAE,mBAAmB0B,SAAS,wBAG/B1B,EAAE+B,GAAUgC,MAAM,SAAU9B,GAEvBknB,IACH/kB,EAAUpE,EAAE,6BAGboE,EAAQX,KAAK,SAAUimB,EAAOC,GAE7B,IAAIC,EAAe5pB,EAAE2pB,GAAQ3a,KAAK,qBAC9B6a,EAAO7pB,EAAE4pB,GAEb,SAASE,IACRD,EAAKtZ,QAAqB,EAAbjK,GAAGsB,UAAa,WAC5BiiB,EAAKhnB,QAAQ,IAAI7C,EAAEsQ,MAAM,WAE1BuZ,EAAK3lB,YAAY,UACjBlE,EAAE2pB,GAAQzlB,YAAY,UAevB,IAAK2lB,EAAKhb,GAAG,aAGZ,GAAI7O,EAAE2pB,GAAQ9a,GAAG7O,EAAEiC,EAAMC,QAAQ6V,QAAQ,6BACpC8R,EAAKhb,GAAG,YACXib,IAlBH,WACCD,EAAKE,UAAuB,EAAbzjB,GAAGsB,UAAa,WAC9BiiB,EAAKhnB,QAAQ,IAAI7C,EAAEsQ,MAAM,WAE1BuZ,EAAKnoB,SAAS,UACd1B,EAAE2pB,GAAQjoB,SAAS,UACnB,IAAIsoB,EAAQhqB,EAAE4pB,EAAe,gBACR,IAAjBI,EAAM5nB,QACT4nB,EAAM/mB,QAYLgnB,OAKK,CACN,IAAIlS,EAAU/X,EAAEiC,EAAMC,QAAQ6V,QAAQ6R,GAClCC,EAAKhb,GAAG,aAAekJ,EAAQ,KAAO8R,EAAK,IAC9CC,WArGN,CAmHC/nB,SAAU9B,OAAQqG;;;;;;;;;;;;;;;;;;;;ACpGpBA,GAAG4jB,SAAW,CAKbC,eAAgB,GAUhBC,SAAU,SAASC,EAAUC,GAC5B,IAAIlC,EAAOiC,EAASnhB,QAAQ,IAAIqhB,OAAO,IAAK,KAAM,KAGlD,MAAiB,QAAbF,IAAsD,IAAhCrqB,EAAEwqB,QAAQ,SAAUF,GACtC,SACgB,kBAAbD,IAA0E,IAA1CrqB,EAAEwqB,QAAQ,mBAAoBF,GACjE,mBACgB,eAAbD,IAAoE,IAAvCrqB,EAAEwqB,QAAQ,gBAAiBF,GAC3D,gBACgB,eAAbD,IAAoE,IAAvCrqB,EAAEwqB,QAAQ,gBAAiBF,GAC3D,gBACgB,iBAAbD,IAAwE,IAAzCrqB,EAAEwqB,QAAQ,kBAAmBF,GAC/D,mBAC+B,IAA5BtqB,EAAEwqB,QAAQpC,EAAMkC,GACnBlC,GAC6C,IAA1CpoB,EAAEwqB,QAAQpC,EAAKje,MAAM,KAAK,GAAImgB,GACjClC,EAAKje,MAAM,KAAK,IACiB,IAA9BnK,EAAEwqB,QAAQ,OAAQF,GACrB,OAGD,MASRG,WAAY,SAASJ,GACpB,IAAIxhB,EAAE8B,YAAY0f,GAAlB,CAIA,KAAOA,KAAY/jB,GAAGokB,aAAaC,SAClCN,EAAW/jB,GAAGokB,aAAaC,QAAQN,GAEpC,GAAIA,KAAY/jB,GAAG4jB,SAASC,eAC3B,OAAO7jB,GAAG4jB,SAASC,eAAeE,GAInC,IAAIO,EAAU,KACV3f,EAAO,GACX,GAAwB,KAApB3E,GAAGkB,MAAMqjB,QAAiB7qB,EAAEikB,QAAQ3d,GAAGokB,aAAaI,OAAOxkB,GAAGkB,MAAMqjB,SAAU,CACjF5f,EAAO3E,GAAG6B,cAAgB,WAAa7B,GAAGkB,MAAMqjB,OAAS,uBACzD,IAAIzC,EAAO9hB,GAAG4jB,SAASE,SAASC,EAAU/jB,GAAGokB,aAAaI,OAAOxkB,GAAGkB,MAAMqjB,SAE7D,OAATzC,IACHwC,GAAU,EACV3f,GAAQmd,GAuBV,OApBG3G,IAAIsJ,SAAuB,OAAZH,IACjB3f,EAAO3E,GAAGmC,YAAY,qCACtBwC,GAAQ3E,GAAG4jB,SAASE,SAASC,EAAU/jB,GAAGokB,aAAaJ,OACvDM,GAAU,GAIK,OAAZA,IACH3f,EAAO3E,GAAG6B,cAAgB,uBAC1B8C,GAAQ3E,GAAG4jB,SAASE,SAASC,EAAU/jB,GAAGokB,aAAaJ,QAGxDrf,GAAQ,OAELwW,IAAIsJ,UACN9f,GAAQ,MAAQwW,IAAIsJ,QAAQC,aAI7B1kB,GAAG4jB,SAASC,eAAeE,GAAYpf,EAChCA,oBC3GT3E,GAAGokB,aAAa,CACfC,QAAS,CACNM,wBAAyB,QACzBC,uBAAwB,OACxBC,wBAAyB,QACzBC,wBAAyB,QACzBC,sBAAuB,WACvBC,0BAA2B,QAC3BC,yBAA0B,YAC1BC,mBAAoB,YACpBC,uBAAwB,OACxBC,sBAAuB,uBACvBC,wBAAyB,oBACzBC,2BAA4B,wBAC5BC,qBAAsB,oBACtBC,2BAA4B,OAC5BC,yBAA0B,QAC1BC,sBAAuB,kBACvBC,0CAA2C,oBAC3CC,gCAAiC,oBACjCC,iCAAkC,WAClCC,uCAAwC,WACxCC,mCAAoC,WACpCC,2BAA4B,uBAC5BC,iDAAkD,uBAClDC,wDAAyD,uBACzDC,iDAAkD,uBAClDC,oDAAqD,uBACrDC,gCAAiC,QACjCC,gCAAiC,wBACjCC,sDAAuD,wBACvDC,6DAA8D,wBAC9DC,0DAA2D,wBAC3DC,yDAA0D,wBAC1DC,mDAAoD,wBACpDC,mCAAoC,wBACpCC,mDAAoD,wBACpDC,mCAAoC,wBACpCC,oDAAqD,wBACrDC,oCAAqC,wBACrCC,mDAAoD,oBACpDC,mDAAoD,oBACpDC,kDAAmD,wBACnDC,2DAA4D,wBAC5DC,iDAAkD,uBAClDC,0DAA2D,uBAC3DC,0CAA2C,oBAC3CC,iDAAkD,oBAClDC,mDAAoD,oBACpDC,8CAA+C,oBAC/CC,4EAA6E,wBAC7EC,yEAA0E,wBAC1EC,wEAAyE,wBACzEC,oEAAqE,uBACrEC,uEAAwE,uBACxEC,0EAA2E,oBAC3EC,0EAA2E,oBAC3EC,wBAAyB,oBACzBC,8BAA+B,oBAC/BC,8BAA+B,oBAC/BC,sBAAuB,oBACvBC,oBAAqB,OACrBC,2BAA4B,oBAC5BC,sBAAuB,QACvBC,oBAAqB,oBACrBC,gCAAiC,OACjCC,qBAAsB,QACtBC,qBAAsB,QACtBC,qBAAsB,oBACtBC,qCAAsC,wBACtCC,yCAA0C,uBAC1CC,qCAAsC,oBACtCC,iCAAkC,OAClCC,qBAAsB,YACtBC,0BAA2B,QAC3BC,oBAAqB,YACrBC,+BAAgC,oBAChCC,oBAAqB,oBACrBC,oBAAqB,OACrBC,kBAAmB,YACnBC,mBAAoB,YACpBC,kBAAmB,oBACnBC,SAAY,OACZC,uBAAwB,MACxBC,WAAY,YACZC,WAAY,uBACZC,YAAa,YACbC,WAAY,YACZC,gBAAiB,YACjBC,WAAY,YACZC,qBAAsB,YACtBC,cAAe,YACfC,gBAAiB,YACjBC,qBAAsB,YACtBC,IAAO,YACPC,gCAAiC,QAEpCxG,MAAO,CACJ,cACA,kBACA,QACA,OACA,SACA,qBACA,mBACA,kBACA,gBACA,gBACA,iBACA,QACA,OACA,WACA,oBACA,OACA,gBACA,YACA,aACA,QACA,oBACA,wBACA,wBAEHQ,OAAQ,mBCvHLjiB,EAAE8B,YAAYomB,YACjBzqB,GAAGyqB,SAAWA,SAASC,8BCGxB,SAAUC,GAET,IAAIC,EAAkCD,EAAQE,MAAMC,MAAMzxB,UAAU0xB,yBACpEJ,EAAQE,MAAMC,MAAMzxB,UAAU0xB,yBAA2B,WACxD,OAAI1wB,KAAK2wB,KAAKC,aACN5wB,KAAK6wB,QAAQrvB,KAAK,qDAEnB+uB,EAAgCltB,MAAMrD,KAAMsD,YAGpD,IAAIwtB,EAAuBR,EAAQE,MAAMC,MAAMzxB,UAAU+xB,cACzDT,EAAQE,MAAMC,MAAMzxB,UAAU+xB,cAAgB,SAAU1iB,GACvD,GAAIrO,KAAK2wB,KAAKC,eAAuD,IAAvC5wB,KAAKgD,MAAMoC,QAAQpF,KAAKolB,GAAG/W,IAAe,CACvE,IAAItO,EAAOC,KACPgD,EAAMhD,KAAKolB,GAAG/W,GAEd2iB,EAAehxB,KAAK8hB,UAAUtgB,KAAK,0BAA0BuK,OAAO,WACvE,OAAQhM,EAAKqlB,GAAG/lB,EAAEW,MAAMqO,KAAK,mBAAqBrL,IAcnD,OAXIhD,KAAKixB,SAASD,KAEjBhxB,KAAK6wB,QAAQrvB,KAAK,oCAAoCsB,KAAK,WAC1D,IAAIgkB,EAAQznB,EAAEW,MACVD,EAAKqlB,GAAG0B,EAAMzY,KAAK,mBAAqBrL,GAC3C8jB,EAAMvjB,YAAY,sBAGpBvD,KAAKkxB,gBAGC,EAEP,OAAOJ,EAAqBztB,MAAMrD,KAAMsD,YAjC3C,CAqCGgtB,wBCSF,IAAUjxB,IAgHTC,OA9GD6xB,OAAOnyB,UAAUoyB,MAAQ,WAExB,IAAIvR,EAAO7f,KAAKsb,cAShB,SAAS+V,EAAMnzB,EAAE4d,EAAErT,GAClBzI,KAAK9B,EAAIA,EACT8B,KAAK8b,EAAIA,EACT9b,KAAKyI,EAAIA,EAWV,SAAS6oB,EAAWC,EAAOC,EAAQC,GAClC,IACIC,EAAU,IAAIvlB,MAClBulB,EAAQjnB,KAAK+mB,GAEb,IADA,IAAIG,EAZL,SAAkBJ,EAAOK,GACxB,IAAID,EAAO,IAAIxlB,MAAM,GAIrB,OAHAwlB,EAAK,IAAMC,EAAK,GAAG1zB,EAAI0zB,EAAK,GAAG1zB,GAAKqzB,EACpCI,EAAK,IAAMC,EAAK,GAAG9V,EAAI8V,EAAK,GAAG9V,GAAKyV,EACpCI,EAAK,IAAMC,EAAK,GAAGnpB,EAAImpB,EAAK,GAAGnpB,GAAK8oB,EAC7BI,EAOIE,CAASN,EAAO,CAACC,EAAQC,IAC3Br0B,EAAI,EAAGA,EAAIm0B,EAAOn0B,IAAK,CAC/B,IAAIc,EAAIkc,SAASoX,EAAOtzB,EAAKyzB,EAAK,GAAKv0B,GACnC0e,EAAI1B,SAASoX,EAAO1V,EAAK6V,EAAK,GAAKv0B,GACnCqL,EAAI2R,SAASoX,EAAO/oB,EAAKkpB,EAAK,GAAKv0B,GACtCs0B,EAAQjnB,KAAK,IAAI4mB,EAAMnzB,EAAE4d,EAAErT,IAE7B,OAAOipB,EA/BmC,OAAvC7R,EAAK3W,MAAM,0BACd2W,EAAOiS,IAAIjS,IAGZA,EAAOA,EAAKtX,QAAQ,aAAc,IA8BlC,IAAIwpB,EAAM,IAAIV,EAAM,IAAK,GAAI,KACzBW,EAAS,IAAIX,EAAM,IAAK,IAAK,IAC7BY,EAAO,IAAIZ,EAAM,EAAG,IAAK,KAKzBa,EAAWZ,EAFH,EAEqBS,EAAKC,GAClCG,EAAWb,EAHH,EAGqBU,EAAQC,GACrCG,EAAWd,EAJH,EAIqBW,EAAMF,GAsBvC,OApBmBG,EAASxlB,OAAOylB,GAAUzlB,OAAO0lB,GAGpD,SAAmBvS,EAAMwS,GAKxB,IAJA,IAAIC,EAAW,EACX9nB,EAAS2B,QAGJ/O,EAAE,EAAGA,EAAEyiB,EAAKpe,OAAQrE,IAE5BoN,EAAOC,KAAK2P,SAASyF,EAAKlX,OAAOvL,GAAI,IAAM,IAG5C,IAAK,IAAIm1B,KAAK/nB,EACb8nB,GAAY9nB,EAAO+nB,GAIpB,OAAOnY,SAASA,SAASkY,GAAYD,GAElBG,CAAU3S,EAAM0R,MAGrClyB,EAAEgb,GAAGoY,iBAAmB,SAASC,EAAMhwB,EAAMgY,GAC5ChY,EAAOA,GAAQgwB,EAGf,IAAIC,EAAMD,EAAKtB,QACfpxB,KAAKiB,IAAI,mBAAoB,OAAO0xB,EAAIz0B,EAAE,KAAKy0B,EAAI7W,EAAE,KAAK6W,EAAIlqB,EAAE,KAGhE,IAAI/I,EAASM,KAAKN,UAAYgb,GAAQ,GACtC1a,KAAKN,OAAOA,GACZM,KAAKP,MAAMC,GAGXM,KAAKiB,IAAI,QAAS,QAClBjB,KAAKiB,IAAI,cAAe,UACxBjB,KAAKiB,IAAI,aAAc,UAGvBjB,KAAKiB,IAAI,cAAevB,EAAS,MACjCM,KAAKiB,IAAI,YAAuB,IAATvB,EAAiB,MAE5B,OAATgzB,GAAiBA,EAAKjxB,QACxBzB,KAAKsO,KAAK5L,EAAK,GAAGkjB,gBAIpBvmB,EAAEgb,GAAGuY,sBAAwB,WAC5B5yB,KAAKiB,IAAI,mBAAoB,IAC7BjB,KAAKiB,IAAI,QAAS,IAClBjB,KAAKiB,IAAI,cAAe,IACxBjB,KAAKiB,IAAI,aAAc,IACvBjB,KAAKiB,IAAI,cAAe,IACxBjB,KAAKiB,IAAI,YAAa,IACtBjB,KAAKsO,KAAK,IACVtO,KAAKuD,YAAY,gBACjBvD,KAAKuD,YAAY,sCC1BjBjE,OAhGC+a,GAAGwY,OAAS,SAASC,EAAMpY,EAAMqY,EAAQC,EAAa1uB,EAAU2uB,GACjE,IAAIC,EAA0B,SAAS3xB,GACtCA,EAAOkxB,iBAAiB,KACxBlxB,EAAON,IAAI,mBAAoB,YAuBhC,QApBqB,IAAV6xB,IACVA,EAAO3B,OAAO2B,SAEa,IAAjBG,IACVA,EAAc9B,OAAO8B,SAGD,IAAVvY,IAETA,EADG1a,KAAKN,SAAW,EACZM,KAAKN,SACFM,KAAKqO,KAAK,QAAU,EACvBrO,KAAKqO,KAAK,QAEV,IAITrO,KAAKN,OAAOgb,GACZ1a,KAAKP,MAAMib,QAEU,IAAVoY,EAAuB,CACjC,QAAkC,IAAvB9yB,KAAKqO,KAAK,QAIpB,YADA6kB,EAAwBlzB,MAFxB8yB,EAAO9yB,KAAKqO,KAAK,QAQnBykB,EAAO3B,OAAO2B,GAAMvqB,QAAQ,MAAM,IAElC,IACIR,EADAorB,EAAOnzB,KAKV+H,EADG+qB,IAASntB,GAAGoE,iBAAiBG,IAC1BvE,GAAGmC,YACR,oCACA,CACCgrB,KAAMA,EACNpY,KAAM/D,KAAKyc,KAAK1Y,EAAO3V,OAAOsuB,kBAC9BxrB,QAASyrB,cAAcT,OAAOhrB,UAG1BlC,GAAGmC,YACR,wBACA,CACCgrB,KAAMA,EACNpY,KAAM/D,KAAKyc,KAAK1Y,EAAO3V,OAAOsuB,oBAIjC,IAAIE,EAAM,IAAIC,MAGdD,EAAIE,OAAS,WACZN,EAAKP,wBACLO,EAAKvyB,OAAO2yB,GAEW,mBAAbjvB,GACTA,KAMFivB,EAAIG,QAAU,WACbP,EAAKP,6BACuB,IAAjBK,EACVE,EAAKV,iBAAiBK,EAAMG,GAE5BC,EAAwBC,GAGF,mBAAb7uB,GACTA,KAIEoW,EAAO,GACVyY,EAAKpyB,SAAS,sBAEdoyB,EAAKpyB,SAAS,gBAEfwyB,EAAI9zB,MAAQib,EACZ6Y,EAAI7zB,OAASgb,EACb6Y,EAAIpP,IAAMpc,EACVwrB,EAAII,IAAM,mBCxIX,IAAUt0B,KAsGTC,QAzFC+a,GAAGuZ,aAAe,SAASC,EAAWC,EAAW9yB,GAGlD,IAAyC,IADtB,CAAC,EAAG,EAAG,GACToE,QAAQ0uB,GAAzB,CAIA,IAAIX,EAAOnzB,KACXgB,EAASJ,OAnBC,+MAoBV,IAAImzB,EAAQ/yB,EAASQ,KAAK,4BAE1B2xB,EAAK/vB,MAAM,WACV,IAAK2wB,EAAM9lB,SAAS,UAGnB,OAFA8lB,EAAMhzB,SAAS,eACfgzB,EAAM5lB,OAIP4lB,EAAMxwB,YAAY,UAClBwwB,EAAMxlB,OAEFwlB,EAAM9lB,SAAS,YAInB8lB,EAAMhzB,SAAS,UACf1B,EAAEoW,KAAK9P,GAAGmC,YAAY,yBAA0B,CAC/C4d,OAAQ,OACRrX,KAAM,CACLylB,UAAWA,EACXD,UAAWA,KAEVxe,KAAK,SAAShH,GAGhB,IAAI2lB,EAFJD,EAAMvyB,KAAK,MAAMA,KAAK,MAAMT,SAAS,WASpCizB,EANI3lB,EAAK4lB,UAMC,CAAC5lB,EAAK4lB,WAAWvnB,OAAO2B,EAAK2lB,SAL7B,CAAC,CACVE,UAAW,IACX3zB,MAAOjC,EAAE,OAAQ,0BAMX61B,QAAQ,SAASC,GACxB,IAAIC,EAAW1uB,GAAGmS,aAAawc,UAAhB,aACfP,EAAMvyB,KAAK,MAAMZ,OAAOyzB,EAASD,MAG9BJ,EAAQvyB,QAGV,SAAS8yB,GAGX,IAAIh0B,EAFJwzB,EAAMvyB,KAAK,MAAMA,KAAK,MAAMT,SAAS,UAIpCR,EADoB,MAAjBg0B,EAAMxjB,OACDzS,EAAE,OAAQ,uBAEVA,EAAE,OAAQ,kCAGnB,IAAI+1B,EAAW1uB,GAAGmS,aAAawc,UAAhB,aACfP,EAAMvyB,KAAK,MAAMZ,OAAOyzB,EAAS,CAChCH,UAAW,IACX3zB,MAAOA,UAKVlB,EAAE+B,UAAUgC,MAAM,SAAS9B,GAC1B,IAAIkzB,EAAeT,EAAMU,IAAInzB,EAAMC,QAAQE,OAAS,EAChDizB,EAAiBvB,EAAKsB,IAAInzB,EAAMC,QAAQE,OAAS,EAErD0xB,EAAKrwB,KAAK,WACLzD,EAAEW,MAAMkO,GAAG5M,EAAMC,UACpBmzB,GAAgB,KAIdF,GAAeE,IAInBX,EAAMhzB,SAAS,UACfgzB,EAAM5lB","file":"template_prepend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","import './jquery.ocdialog.js';\nimport './oc-dialogs.js';\nimport './js.js';\nimport './l10n.js';\nimport './octemplate.js';\nimport './eventsource.js';\nimport './public/appconfig.js';\nimport './public/comments.js';\nimport './public/whatsnew.js';\nimport './config.js';\nimport './oc-requesttoken.js';\nimport './apps.js';\nimport './mimetype.js';\nimport './mimetypelist.js';\nimport './oc-backbone.js';\nimport './select2-toggleselect.js';\nimport './placeholder.js';\nimport './jquery.avatar.js';\nimport './jquery.contactsmenu.js';\n","(function($) {\n\t$.widget('oc.ocdialog', {\n\t\toptions: {\n\t\t\twidth: 'auto',\n\t\t\theight: 'auto',\n\t\t\tcloseButton: true,\n\t\t\tcloseOnEscape: true,\n\t\t\tmodal: false\n\t\t},\n\t\t_create: function() {\n\t\t\tvar self = this;\n\n\t\t\tthis.originalCss = {\n\t\t\t\tdisplay: this.element[0].style.display,\n\t\t\t\twidth: this.element[0].style.width,\n\t\t\t\theight: this.element[0].style.height\n\t\t\t};\n\n\t\t\tthis.originalTitle = this.element.attr('title');\n\t\t\tthis.options.title = this.options.title || this.originalTitle;\n\n\t\t\tthis.$dialog = $('<div class=\"oc-dialog\" />')\n\t\t\t\t.attr({\n\t\t\t\t\t// Setting tabIndex makes the div focusable\n\t\t\t\t\ttabIndex: -1,\n\t\t\t\t\trole: 'dialog'\n\t\t\t\t})\n\t\t\t\t.insertBefore(this.element);\n\t\t\tthis.$dialog.append(this.element.detach());\n\t\t\tthis.element.removeAttr('title').addClass('oc-dialog-content').appendTo(this.$dialog);\n\n\t\t\tthis.$dialog.css({\n\t\t\t\tdisplay: 'inline-block',\n\t\t\t\tposition: 'fixed'\n\t\t\t});\n\n\t\t\tthis.enterCallback = null;\n\n\t\t\t$(document).on('keydown keyup', function(event) {\n\t\t\t\tif (\n\t\t\t\t\tevent.target !== self.$dialog.get(0) &&\n\t\t\t\t\tself.$dialog.find($(event.target)).length === 0\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Escape\n\t\t\t\tif (\n\t\t\t\t\tevent.keyCode === 27 &&\n\t\t\t\t\tevent.type === 'keydown' &&\n\t\t\t\t\tself.options.closeOnEscape\n\t\t\t\t) {\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\tself.close();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Enter\n\t\t\t\tif(event.keyCode === 13) {\n\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\tif (self.enterCallback !== null) {\n\t\t\t\t\t\tself.enterCallback();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif(event.type === 'keyup') {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\t// If no button is selected we trigger the primary\n\t\t\t\t\tif (\n\t\t\t\t\t\tself.$buttonrow &&\n\t\t\t\t\t\tself.$buttonrow.find($(event.target)).length === 0\n\t\t\t\t\t) {\n\t\t\t\t\t\tvar $button = self.$buttonrow.find('button.primary');\n\t\t\t\t\t\tif($button && !$button.prop('disabled')) {\n\t\t\t\t\t\t\t$button.trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(self.$buttonrow) {\n\t\t\t\t\t\t$(event.target).trigger('click');\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._setOptions(this.options);\n\t\t\tthis._createOverlay();\n\t\t},\n\t\t_init: function() {\n\t\t\tthis.$dialog.focus();\n\t\t\tthis._trigger('open');\n\t\t},\n\t\t_setOption: function(key, value) {\n\t\t\tvar self = this;\n\t\t\tswitch(key) {\n\t\t\t\tcase 'title':\n\t\t\t\t\tif(this.$title) {\n\t\t\t\t\t\tthis.$title.text(value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar $title = $('<h2 class=\"oc-dialog-title\">'\n\t\t\t\t\t\t\t+ value\n\t\t\t\t\t\t\t+ '</h2>');\n\t\t\t\t\t\tthis.$title = $title.prependTo(this.$dialog);\n\t\t\t\t\t}\n\t\t\t\t\tthis._setSizes();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'buttons':\n\t\t\t\t\tif(this.$buttonrow) {\n\t\t\t\t\t\tthis.$buttonrow.empty();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar $buttonrow = $('<div class=\"oc-dialog-buttonrow\" />');\n\t\t\t\t\t\tthis.$buttonrow = $buttonrow.appendTo(this.$dialog);\n\t\t\t\t\t}\n\t\t\t\t\tif (value.length === 1) {\n\t\t\t\t\t\tthis.$buttonrow.addClass('onebutton');\n\t\t\t\t\t} else if (value.length === 2) {\n\t\t\t\t\t\tthis.$buttonrow.addClass('twobuttons');\n\t\t\t\t\t} else if (value.length === 3) {\n\t\t\t\t\t\tthis.$buttonrow.addClass('threebuttons');\n\t\t\t\t\t}\n\t\t\t\t\t$.each(value, function(idx, val) {\n\t\t\t\t\t\tvar $button = $('<button>').text(val.text);\n\t\t\t\t\t\tif (val.classes) {\n\t\t\t\t\t\t\t$button.addClass(val.classes);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(val.defaultButton) {\n\t\t\t\t\t\t\t$button.addClass('primary');\n\t\t\t\t\t\t\tself.$defaultButton = $button;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.$buttonrow.append($button);\n\t\t\t\t\t\t$button.click(function() {\n\t\t\t\t\t\t\tval.click.apply(self.element[0], arguments);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tthis.$buttonrow.find('button')\n\t\t\t\t\t\t.on('focus', function(event) {\n\t\t\t\t\t\t\tself.$buttonrow.find('button').removeClass('primary');\n\t\t\t\t\t\t\t$(this).addClass('primary');\n\t\t\t\t\t\t});\n\t\t\t\t\tthis._setSizes();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'style':\n\t\t\t\t\tif (value.buttons !== undefined) {\n\t\t\t\t\t\tthis.$buttonrow.addClass(value.buttons);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'closeButton':\n\t\t\t\t\tif(value) {\n\t\t\t\t\t\tvar $closeButton = $('<a class=\"oc-dialog-close\"></a>');\n\t\t\t\t\t\tthis.$dialog.prepend($closeButton);\n\t\t\t\t\t\t$closeButton.on('click', function() {\n\t\t\t\t\t\t\tself.close();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$dialog.find('.oc-dialog-close').remove();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'width':\n\t\t\t\t\tthis.$dialog.css('width', value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'height':\n\t\t\t\t\tthis.$dialog.css('height', value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'close':\n\t\t\t\t\tthis.closeCB = value;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//this._super(key, value);\n\t\t\t$.Widget.prototype._setOption.apply(this, arguments );\n\t\t},\n\t\t_setOptions: function(options) {\n\t\t\t//this._super(options);\n\t\t\t$.Widget.prototype._setOptions.apply(this, arguments);\n\t\t},\n\t\t_setSizes: function() {\n\t\t\tvar lessHeight = 0;\n\t\t\tif(this.$title) {\n\t\t\t\tlessHeight += this.$title.outerHeight(true);\n\t\t\t}\n\t\t\tif(this.$buttonrow) {\n\t\t\t\tlessHeight += this.$buttonrow.outerHeight(true);\n\t\t\t}\n\t\t\tthis.element.css({\n\t\t\t\t'height': 'calc(100% - ' + lessHeight + 'px)'\n\t\t\t});\n\t\t},\n\t\t_createOverlay: function() {\n\t\t\tif(!this.options.modal) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar self = this;\n\t\t\tthis.overlay = $('<div>')\n\t\t\t\t.addClass('oc-dialog-dim')\n\t\t\t\t.appendTo($('#content'));\n\t\t\tthis.overlay.on('click keydown keyup', function(event) {\n\t\t\t\tif(event.target !== self.$dialog.get(0) && self.$dialog.find($(event.target)).length === 0) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t_destroyOverlay: function() {\n\t\t\tif (!this.options.modal) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.overlay) {\n\t\t\t\tthis.overlay.off('click keydown keyup');\n\t\t\t\tthis.overlay.remove();\n\t\t\t\tthis.overlay = null;\n\t\t\t}\n\t\t},\n\t\twidget: function() {\n\t\t\treturn this.$dialog;\n\t\t},\n\t\tsetEnterCallback: function(callback) {\n\t\t\tthis.enterCallback = callback;\n\t\t},\n\t\tunsetEnterCallback: function() {\n\t\t\tthis.enterCallback = null;\n\t\t},\n\t\tclose: function() {\n\t\t\tthis._destroyOverlay();\n\t\t\tvar self = this;\n\t\t\t// Ugly hack to catch remaining keyup events.\n\t\t\tsetTimeout(function() {\n\t\t\t\tself._trigger('close', self);\n\t\t\t}, 200);\n\n\t\t\tself.$dialog.remove();\n\t\t\tthis.destroy();\n\t\t},\n\t\tdestroy: function() {\n\t\t\tif(this.$title) {\n\t\t\t\tthis.$title.remove();\n\t\t\t}\n\t\t\tif(this.$buttonrow) {\n\t\t\t\tthis.$buttonrow.remove();\n\t\t\t}\n\n\t\t\tif(this.originalTitle) {\n\t\t\t\tthis.element.attr('title', this.originalTitle);\n\t\t\t}\n\t\t\tthis.element.removeClass('oc-dialog-content')\n\t\t\t\t\t.css(this.originalCss).detach().insertBefore(this.$dialog);\n\t\t\tthis.$dialog.remove();\n\t\t}\n\t});\n}(jQuery));\n","/* global oc_isadmin */\n\nvar oc_debug;\nvar oc_webroot;\n\nvar oc_current_user = document.getElementsByTagName('head')[0].getAttribute('data-user');\nvar oc_requesttoken = document.getElementsByTagName('head')[0].getAttribute('data-requesttoken');\n\nwindow.oc_config = window.oc_config || {};\n\nif (typeof oc_webroot === \"undefined\") {\n\toc_webroot = location.pathname;\n\tvar pos = oc_webroot.indexOf('/index.php/');\n\tif (pos !== -1) {\n\t\toc_webroot = oc_webroot.substr(0, pos);\n\t}\n\telse {\n\t\toc_webroot = oc_webroot.substr(0, oc_webroot.lastIndexOf('/'));\n\t}\n}\nif (typeof console === \"undefined\" || typeof console.log === \"undefined\") {\n\tif (!window.console) {\n\t\twindow.console = {};\n\t}\n\tvar noOp = function() { };\n\tvar methods = ['log', 'debug', 'warn', 'info', 'error', 'assert', 'time', 'timeEnd'];\n\tfor (var i = 0; i < methods.length; i++) {\n\t\tconsole[methods[i]] = noOp;\n\t}\n}\n\n/**\n* Sanitizes a HTML string by replacing all potential dangerous characters with HTML entities\n* @param {string} s String to sanitize\n* @return {string} Sanitized string\n*/\nfunction escapeHTML(s) {\n\treturn s.toString().split('&').join('&amp;').split('<').join('&lt;').split('>').join('&gt;').split('\"').join('&quot;').split('\\'').join('&#039;');\n}\n\n/** @namespace OCP */\nvar OCP = {},\n\t/**\n\t * @namespace OC\n\t */\n\tOC = {\n\tPERMISSION_NONE:0,\n\tPERMISSION_CREATE:4,\n\tPERMISSION_READ:1,\n\tPERMISSION_UPDATE:2,\n\tPERMISSION_DELETE:8,\n\tPERMISSION_SHARE:16,\n\tPERMISSION_ALL:31,\n\tTAG_FAVORITE: '_$!<Favorite>!$_',\n\t/* jshint camelcase: false */\n\t/**\n\t * Relative path to Nextcloud root.\n\t * For example: \"/nextcloud\"\n\t *\n\t * @type string\n\t *\n\t * @deprecated since 8.2, use OC.getRootPath() instead\n\t * @see OC#getRootPath\n\t */\n\twebroot:oc_webroot,\n\n\t/**\n\t * Capabilities\n\t *\n\t * @type array\n\t */\n\t_capabilities: window.oc_capabilities || null,\n\n\tappswebroots:(typeof oc_appswebroots !== 'undefined') ? oc_appswebroots:false,\n\t/**\n\t * Currently logged in user or null if none\n\t *\n\t * @type String\n\t * @deprecated use {@link OC.getCurrentUser} instead\n\t */\n\tcurrentUser:(typeof oc_current_user!=='undefined')?oc_current_user:false,\n\tconfig: window.oc_config,\n\tappConfig: window.oc_appconfig || {},\n\ttheme: window.oc_defaults || {},\n\tcoreApps:['', 'admin','log','core/search','settings','core','3rdparty'],\n\trequestToken: oc_requesttoken,\n\tmenuSpeed: 50,\n\n\t/**\n\t * Get an absolute url to a file in an app\n\t * @param {string} app the id of the app the file belongs to\n\t * @param {string} file the file path relative to the app folder\n\t * @return {string} Absolute URL to a file\n\t */\n\tlinkTo:function(app,file){\n\t\treturn OC.filePath(app,'',file);\n\t},\n\n\t/**\n\t * Creates a relative url for remote use\n\t * @param {string} service id\n\t * @return {string} the url\n\t */\n\tlinkToRemoteBase:function(service) {\n\t\treturn OC.getRootPath() + '/remote.php/' + service;\n\t},\n\n\t/**\n\t * @brief Creates an absolute url for remote use\n\t * @param {string} service id\n\t * @return {string} the url\n\t */\n\tlinkToRemote:function(service) {\n\t\treturn window.location.protocol + '//' + window.location.host + OC.linkToRemoteBase(service);\n\t},\n\n\t/**\n\t * Gets the base path for the given OCS API service.\n\t * @param {string} service name\n\t * @param {int} version OCS API version\n\t * @return {string} OCS API base path\n\t */\n\tlinkToOCS: function(service, version) {\n\t\tversion = (version !== 2) ? 1 : 2;\n\t\treturn window.location.protocol + '//' + window.location.host + OC.getRootPath() + '/ocs/v' + version + '.php/' + service + '/';\n\t},\n\n\t/**\n\t * Generates the absolute url for the given relative url, which can contain parameters.\n\t * Parameters will be URL encoded automatically.\n\t * @param {string} url\n\t * @param [params] params\n\t * @param [options] options\n\t * @param {bool} [options.escape=true] enable/disable auto escape of placeholders (by default enabled)\n\t * @return {string} Absolute URL for the given relative URL\n\t */\n\tgenerateUrl: function(url, params, options) {\n\t\tvar defaultOptions = {\n\t\t\t\tescape: true\n\t\t\t},\n\t\t\tallOptions = options || {};\n\t\t_.defaults(allOptions, defaultOptions);\n\n\t\tvar _build = function (text, vars) {\n\t\t\tvars = vars || [];\n\t\t\treturn text.replace(/{([^{}]*)}/g,\n\t\t\t\tfunction (a, b) {\n\t\t\t\t\tvar r = (vars[b]);\n\t\t\t\t\tif(allOptions.escape) {\n\t\t\t\t\t\treturn (typeof r === 'string' || typeof r === 'number') ? encodeURIComponent(r) : encodeURIComponent(a);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn (typeof r === 'string' || typeof r === 'number') ? r : a;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t};\n\t\tif (url.charAt(0) !== '/') {\n\t\t\turl = '/' + url;\n\n\t\t}\n\n\t\tif(oc_config.modRewriteWorking == true) {\n\t\t\treturn OC.getRootPath() + _build(url, params);\n\t\t}\n\n\t\treturn OC.getRootPath() + '/index.php' + _build(url, params);\n\t},\n\n\t/**\n\t * Get the absolute url for a file in an app\n\t * @param {string} app the id of the app\n\t * @param {string} type the type of the file to link to (e.g. css,img,ajax.template)\n\t * @param {string} file the filename\n\t * @return {string} Absolute URL for a file in an app\n\t */\n\tfilePath:function(app,type,file){\n\t\tvar isCore=OC.coreApps.indexOf(app)!==-1,\n\t\t\tlink=OC.getRootPath();\n\t\tif(file.substring(file.length-3) === 'php' && !isCore){\n\t\t\tlink+='/index.php/apps/' + app;\n\t\t\tif (file != 'index.php') {\n\t\t\t\tlink+='/';\n\t\t\t\tif(type){\n\t\t\t\t\tlink+=encodeURI(type + '/');\n\t\t\t\t}\n\t\t\t\tlink+= file;\n\t\t\t}\n\t\t}else if(file.substring(file.length-3) !== 'php' && !isCore){\n\t\t\tlink=OC.appswebroots[app];\n\t\t\tif(type){\n\t\t\t\tlink+= '/'+type+'/';\n\t\t\t}\n\t\t\tif(link.substring(link.length-1) !== '/'){\n\t\t\t\tlink+='/';\n\t\t\t}\n\t\t\tlink+=file;\n\t\t}else{\n\t\t\tif ((app == 'settings' || app == 'core' || app == 'search') && type == 'ajax') {\n\t\t\t\tlink+='/index.php/';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlink+='/';\n\t\t\t}\n\t\t\tif(!isCore){\n\t\t\t\tlink+='apps/';\n\t\t\t}\n\t\t\tif (app !== '') {\n\t\t\t\tapp+='/';\n\t\t\t\tlink+=app;\n\t\t\t}\n\t\t\tif(type){\n\t\t\t\tlink+=type+'/';\n\t\t\t}\n\t\t\tlink+=file;\n\t\t}\n\t\treturn link;\n\t},\n\n\t/**\n\t * Check if a user file is allowed to be handled.\n\t * @param {string} file to check\n\t */\n\tfileIsBlacklisted: function(file) {\n\t\treturn !!(file.match(oc_config.blacklist_files_regex));\n\t},\n\n\t/**\n\t * Redirect to the target URL, can also be used for downloads.\n\t * @param {string} targetURL URL to redirect to\n\t */\n\tredirect: function(targetURL) {\n\t\twindow.location = targetURL;\n\t},\n\n\t/**\n\t * Reloads the current page\n\t */\n\treload: function() {\n\t\twindow.location.reload();\n\t},\n\n\t/**\n\t * Protocol that is used to access this Nextcloud instance\n\t * @return {string} Used protocol\n\t */\n\tgetProtocol: function() {\n\t\treturn window.location.protocol.split(':')[0];\n\t},\n\n\t/**\n\t * Returns the host used to access this Nextcloud instance\n\t * Host is sometimes the same as the hostname but now always.\n\t *\n\t * Examples:\n\t * http://example.com => example.com\n\t * https://example.com => example.com\n\t * http://example.com:8080 => example.com:8080\n\t *\n\t * @return {string} host\n\t *\n\t * @since 8.2\n\t */\n\tgetHost: function() {\n\t\treturn window.location.host;\n\t},\n\n\t/**\n\t * Returns the hostname used to access this Nextcloud instance\n\t * The hostname is always stripped of the port\n\t *\n\t * @return {string} hostname\n\t * @since 9.0\n\t */\n\tgetHostName: function() {\n\t\treturn window.location.hostname;\n\t},\n\n\t/**\n\t * Returns the port number used to access this Nextcloud instance\n\t *\n\t * @return {int} port number\n\t *\n\t * @since 8.2\n\t */\n\tgetPort: function() {\n\t\treturn window.location.port;\n\t},\n\n\t/**\n\t * Returns the web root path where this Nextcloud instance\n\t * is accessible, with a leading slash.\n\t * For example \"/nextcloud\".\n\t *\n\t * @return {string} web root path\n\t *\n\t * @since 8.2\n\t */\n\tgetRootPath: function() {\n\t\treturn OC.webroot;\n\t},\n\n\n\t/**\n\t * Returns the capabilities\n\t *\n\t * @return {array} capabilities\n\t *\n\t * @since 14.0\n\t */\n\tgetCapabilities: function() {\n\t\treturn OC._capabilities;\n\t},\n\n\t/**\n\t * Returns the currently logged in user or null if there is no logged in\n\t * user (public page mode)\n\t *\n\t * @return {OC.CurrentUser} user spec\n\t * @since 9.0.0\n\t */\n\tgetCurrentUser: function() {\n\t\tif (_.isUndefined(this._currentUserDisplayName)) {\n\t\t\tthis._currentUserDisplayName = document.getElementsByTagName('head')[0].getAttribute('data-user-displayname');\n\t\t}\n\t\treturn {\n\t\t\tuid: this.currentUser,\n\t\t\tdisplayName: this._currentUserDisplayName\n\t\t};\n\t},\n\n\t/**\n\t * get the absolute path to an image file\n\t * if no extension is given for the image, it will automatically decide\n\t * between .png and .svg based on what the browser supports\n\t * @param {string} app the app id to which the image belongs\n\t * @param {string} file the name of the image file\n\t * @return {string}\n\t */\n\timagePath:function(app,file){\n\t\tif(file.indexOf('.')==-1){//if no extension is given, use svg\n\t\t\tfile+='.svg';\n\t\t}\n\t\treturn OC.filePath(app,'img',file);\n\t},\n\n\t/**\n\t * URI-Encodes a file path but keep the path slashes.\n\t *\n\t * @param path path\n\t * @return encoded path\n\t */\n\tencodePath: function(path) {\n\t\tif (!path) {\n\t\t\treturn path;\n\t\t}\n\t\tvar parts = path.split('/');\n\t\tvar result = [];\n\t\tfor (var i = 0; i < parts.length; i++) {\n\t\t\tresult.push(encodeURIComponent(parts[i]));\n\t\t}\n\t\treturn result.join('/');\n\t},\n\n\t/**\n\t * Load a script for the server and load it. If the script is already loaded,\n\t * the event handler will be called directly\n\t * @param {string} app the app id to which the script belongs\n\t * @param {string} script the filename of the script\n\t * @param ready event handler to be called when the script is loaded\n\t */\n\taddScript:function(app,script,ready){\n\t\tvar deferred, path=OC.filePath(app,'js',script+'.js');\n\t\tif(!OC.addScript.loaded[path]) {\n\t\t\tdeferred = $.Deferred();\n\t\t\t$.getScript(path, function() {\n\t\t\t\tdeferred.resolve();\n\t\t\t});\n\t\t\tOC.addScript.loaded[path] = deferred;\n\t\t} else {\n\t\t\tif (ready) {\n\t\t\t\tready();\n\t\t\t}\n\t\t}\n\t\treturn OC.addScript.loaded[path];\n\t},\n\t/**\n\t * Loads a CSS file\n\t * @param {string} app the app id to which the css style belongs\n\t * @param {string} style the filename of the css file\n\t */\n\taddStyle:function(app,style){\n\t\tvar path=OC.filePath(app,'css',style+'.css');\n\t\tif(OC.addStyle.loaded.indexOf(path)===-1){\n\t\t\tOC.addStyle.loaded.push(path);\n\t\t\tif (document.createStyleSheet) {\n\t\t\t\tdocument.createStyleSheet(path);\n\t\t\t} else {\n\t\t\t\tstyle=$('<link rel=\"stylesheet\" type=\"text/css\" href=\"'+path+'\"/>');\n\t\t\t\t$('head').append(style);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Loads translations for the given app asynchronously.\n\t *\n\t * @param {String} app app name\n\t * @param {Function} callback callback to call after loading\n\t * @return {Promise}\n\t */\n\taddTranslations: function(app, callback) {\n\t\treturn OC.L10N.load(app, callback);\n\t},\n\n\t/**\n\t * Returns the base name of the given path.\n\t * For example for \"/abc/somefile.txt\" it will return \"somefile.txt\"\n\t *\n\t * @param {String} path\n\t * @return {String} base name\n\t */\n\tbasename: function(path) {\n\t\treturn path.replace(/\\\\/g,'/').replace( /.*\\//, '' );\n\t},\n\n\t/**\n\t * Returns the dir name of the given path.\n\t * For example for \"/abc/somefile.txt\" it will return \"/abc\"\n\t *\n\t * @param {String} path\n\t * @return {String} dir name\n\t */\n\tdirname: function(path) {\n\t\treturn path.replace(/\\\\/g,'/').replace(/\\/[^\\/]*$/, '');\n\t},\n\n\t/**\n\t * Returns whether the given paths are the same, without\n\t * leading, trailing or doubled slashes and also removing\n\t * the dot sections.\n\t *\n\t * @param {String} path1 first path\n\t * @param {String} path2 second path\n\t * @return {bool} true if the paths are the same\n\t *\n\t * @since 9.0\n\t */\n\tisSamePath: function(path1, path2) {\n\t\tvar filterDot = function(p) {\n\t\t\treturn p !== '.';\n\t\t};\n\t\tvar pathSections1 = _.filter((path1 || '').split('/'), filterDot);\n\t\tvar pathSections2 = _.filter((path2 || '').split('/'), filterDot);\n\t\tpath1 = OC.joinPaths.apply(OC, pathSections1);\n\t\tpath2 = OC.joinPaths.apply(OC, pathSections2);\n\t\treturn path1 === path2;\n\t},\n\n\t/**\n\t * Join path sections\n\t *\n\t * @param {...String} path sections\n\t *\n\t * @return {String} joined path, any leading or trailing slash\n\t * will be kept\n\t *\n\t * @since 8.2\n\t */\n\tjoinPaths: function() {\n\t\tif (arguments.length < 1) {\n\t\t\treturn '';\n\t\t}\n\t\tvar path = '';\n\t\t// convert to array\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t// discard empty arguments\n\t\targs = _.filter(args, function(arg) {\n\t\t\treturn arg.length > 0;\n\t\t});\n\t\tif (args.length < 1) {\n\t\t\treturn '';\n\t\t}\n\n\t\tvar lastArg = args[args.length - 1];\n\t\tvar leadingSlash = args[0].charAt(0) === '/';\n\t\tvar trailingSlash = lastArg.charAt(lastArg.length - 1) === '/';\n\t\tvar sections = [];\n\t\tvar i;\n\t\tfor (i = 0; i < args.length; i++) {\n\t\t\tsections = sections.concat(args[i].split('/'));\n\t\t}\n\t\tvar first = !leadingSlash;\n\t\tfor (i = 0; i < sections.length; i++) {\n\t\t\tif (sections[i] !== '') {\n\t\t\t\tif (first) {\n\t\t\t\t\tfirst = false;\n\t\t\t\t} else {\n\t\t\t\t\tpath += '/';\n\t\t\t\t}\n\t\t\t\tpath += sections[i];\n\t\t\t}\n\t\t}\n\n\t\tif (trailingSlash) {\n\t\t\t// add it back\n\t\t\tpath += '/';\n\t\t}\n\t\treturn path;\n\t},\n\n\t/**\n\t * Do a search query and display the results\n\t * @param {string} query the search query\n\t */\n\tsearch: function (query) {\n\t\tOC.Search.search(query, null, 0, 30);\n\t},\n\t/**\n\t * Dialog helper for jquery dialogs.\n\t *\n\t * @namespace OC.dialogs\n\t */\n\tdialogs:OCdialogs,\n\t/**\n\t * Parses a URL query string into a JS map\n\t * @param {string} queryString query string in the format param1=1234&param2=abcde&param3=xyz\n\t * @return {Object.<string, string>} map containing key/values matching the URL parameters\n\t */\n\tparseQueryString:function(queryString){\n\t\tvar parts,\n\t\t\tpos,\n\t\t\tcomponents,\n\t\t\tresult = {},\n\t\t\tkey,\n\t\t\tvalue;\n\t\tif (!queryString){\n\t\t\treturn null;\n\t\t}\n\t\tpos = queryString.indexOf('?');\n\t\tif (pos >= 0){\n\t\t\tqueryString = queryString.substr(pos + 1);\n\t\t}\n\t\tparts = queryString.replace(/\\+/g, '%20').split('&');\n\t\tfor (var i = 0; i < parts.length; i++){\n\t\t\t// split on first equal sign\n\t\t\tvar part = parts[i];\n\t\t\tpos = part.indexOf('=');\n\t\t\tif (pos >= 0) {\n\t\t\t\tcomponents = [\n\t\t\t\t\tpart.substr(0, pos),\n\t\t\t\t\tpart.substr(pos + 1)\n\t\t\t\t];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// key only\n\t\t\t\tcomponents = [part];\n\t\t\t}\n\t\t\tif (!components.length){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tkey = decodeURIComponent(components[0]);\n\t\t\tif (!key){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// if equal sign was there, return string\n\t\t\tif (components.length > 1) {\n\t\t\t\tresult[key] = decodeURIComponent(components[1]);\n\t\t\t}\n\t\t\t// no equal sign => null value\n\t\t\telse {\n\t\t\t\tresult[key] = null;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Builds a URL query from a JS map.\n\t * @param {Object.<string, string>} params map containing key/values matching the URL parameters\n\t * @return {string} String containing a URL query (without question) mark\n\t */\n\tbuildQueryString: function(params) {\n\t\tif (!params) {\n\t\t\treturn '';\n\t\t}\n\t\treturn $.map(params, function(value, key) {\n\t\t\tvar s = encodeURIComponent(key);\n\t\t\tif (value !== null && typeof(value) !== 'undefined') {\n\t\t\t\ts += '=' + encodeURIComponent(value);\n\t\t\t}\n\t\t\treturn s;\n\t\t}).join('&');\n\t},\n\n\t/**\n\t * Opens a popup with the setting for an app.\n\t * @param {string} appid The ID of the app e.g. 'calendar', 'contacts' or 'files'.\n\t * @param {boolean|string}loadJS If true 'js/settings.js' is loaded. If it's a string\n\t * it will attempt to load a script by that name in the 'js' directory.\n\t * @param {boolean} [cache] If true the javascript file won't be forced refreshed. Defaults to true.\n\t * @param {string} [scriptName] The name of the PHP file to load. Defaults to 'settings.php' in\n\t * the root of the app directory hierarchy.\n\t */\n\tappSettings:function(args) {\n\t\tif(typeof args === 'undefined' || typeof args.appid === 'undefined') {\n\t\t\tthrow { name: 'MissingParameter', message: 'The parameter appid is missing' };\n\t\t}\n\t\tvar props = {scriptName:'settings.php', cache:true};\n\t\t$.extend(props, args);\n\t\tvar settings = $('#appsettings');\n\t\tif(settings.length === 0) {\n\t\t\tthrow { name: 'MissingDOMElement', message: 'There has be be an element with id \"appsettings\" for the popup to show.' };\n\t\t}\n\t\tvar popup = $('#appsettings_popup');\n\t\tif(popup.length === 0) {\n\t\t\t$('body').prepend('<div class=\"popup hidden\" id=\"appsettings_popup\"></div>');\n\t\t\tpopup = $('#appsettings_popup');\n\t\t\tpopup.addClass(settings.hasClass('topright') ? 'topright' : 'bottomleft');\n\t\t}\n\t\tif(popup.is(':visible')) {\n\t\t\tpopup.hide().remove();\n\t\t} else {\n\t\t\tvar arrowclass = settings.hasClass('topright') ? 'up' : 'left';\n\t\t\tvar jqxhr = $.get(OC.filePath(props.appid, '', props.scriptName), function(data) {\n\t\t\t\tpopup.html(data).ready(function() {\n\t\t\t\t\tpopup.prepend('<span class=\"arrow '+arrowclass+'\"></span><h2>'+t('core', 'Settings')+'</h2><a class=\"close\"></a>').show();\n\t\t\t\t\tpopup.find('.close').bind('click', function() {\n\t\t\t\t\t\tpopup.remove();\n\t\t\t\t\t});\n\t\t\t\t\tif(typeof props.loadJS !== 'undefined') {\n\t\t\t\t\t\tvar scriptname;\n\t\t\t\t\t\tif(props.loadJS === true) {\n\t\t\t\t\t\t\tscriptname = 'settings.js';\n\t\t\t\t\t\t} else if(typeof props.loadJS === 'string') {\n\t\t\t\t\t\t\tscriptname = props.loadJS;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow { name: 'InvalidParameter', message: 'The \"loadJS\" parameter must be either boolean or a string.' };\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(props.cache) {\n\t\t\t\t\t\t\t$.ajaxSetup({cache: true});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$.getScript(OC.filePath(props.appid, 'js', scriptname))\n\t\t\t\t\t\t.fail(function(jqxhr, settings, e) {\n\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).show();\n\t\t\t}, 'html');\n\t\t}\n\t},\n\n\t/**\n\t * For menu toggling\n\t * @todo Write documentation\n\t *\n\t * @param {jQuery} $toggle\n\t * @param {jQuery} $menuEl\n\t * @param {function|undefined} toggle callback invoked everytime the menu is opened\n\t * @param {boolean} headerMenu is this a top right header menu?\n\t * @returns {undefined}\n\t */\n\tregisterMenu: function($toggle, $menuEl, toggle, headerMenu) {\n\t\tvar self = this;\n\t\t$menuEl.addClass('menu');\n\n\t\t// On link, the enter key trigger a click event\n\t\t// Only use the click to avoid two fired events\n\t\t$toggle.on($toggle.prop('tagName') === 'A'\n\t\t\t? 'click.menu'\n\t\t\t: 'click.menu keyup.menu', function(event) {\n\t\t\t// prevent the link event (append anchor to URL)\n\t\t\tevent.preventDefault();\n\n\t\t\t// allow enter key as a trigger\n\t\t\tif (event.key && event.key !== \"Enter\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ($menuEl.is(OC._currentMenu)) {\n\t\t\t\tself.hideMenus();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// another menu was open?\n\t\t\telse if (OC._currentMenu) {\n\t\t\t\t// close it\n\t\t\t\tself.hideMenus();\n\t\t\t}\n\n\t\t\tif (headerMenu === true) {\n\t\t\t\t$menuEl.parent().addClass('openedMenu');\n\t\t\t}\n\n\t\t\t// Set menu to expanded\n\t\t\t$toggle.attr('aria-expanded', true);\n\n\t\t\t$menuEl.slideToggle(OC.menuSpeed, toggle);\n\t\t\tOC._currentMenu = $menuEl;\n\t\t\tOC._currentMenuToggle = $toggle;\n\t\t});\n\t},\n\n\t/**\n\t *  @todo Write documentation\n\t */\n\tunregisterMenu: function($toggle, $menuEl) {\n\t\t// close menu if opened\n\t\tif ($menuEl.is(OC._currentMenu)) {\n\t\t\tthis.hideMenus();\n\t\t}\n\t\t$toggle.off('click.menu').removeClass('menutoggle');\n\t\t$menuEl.removeClass('menu');\n\t},\n\n\t/**\n\t * Hides any open menus\n\t *\n\t * @param {Function} complete callback when the hiding animation is done\n\t */\n\thideMenus: function(complete) {\n\t\tif (OC._currentMenu) {\n\t\t\tvar lastMenu = OC._currentMenu;\n\t\t\tOC._currentMenu.trigger(new $.Event('beforeHide'));\n\t\t\tOC._currentMenu.slideUp(OC.menuSpeed, function() {\n\t\t\t\tlastMenu.trigger(new $.Event('afterHide'));\n\t\t\t\tif (complete) {\n\t\t\t\t\tcomplete.apply(this, arguments);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Set menu to closed\n\t\t$('.menutoggle').attr('aria-expanded', false);\n\n\t\t$('.openedMenu').removeClass('openedMenu');\n\t\tOC._currentMenu = null;\n\t\tOC._currentMenuToggle = null;\n\t},\n\n\t/**\n\t * Shows a given element as menu\n\t *\n\t * @param {Object} [$toggle=null] menu toggle\n\t * @param {Object} $menuEl menu element\n\t * @param {Function} complete callback when the showing animation is done\n\t */\n\tshowMenu: function($toggle, $menuEl, complete) {\n\t\tif ($menuEl.is(OC._currentMenu)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.hideMenus();\n\t\tOC._currentMenu = $menuEl;\n\t\tOC._currentMenuToggle = $toggle;\n\t\t$menuEl.trigger(new $.Event('beforeShow'));\n\t\t$menuEl.show();\n\t\t$menuEl.trigger(new $.Event('afterShow'));\n\t\t// no animation\n\t\tif (_.isFunction(complete)) {\n\t\t\tcomplete();\n\t\t}\n\t},\n\n\t/**\n\t * Wrapper for matchMedia\n\t *\n\t * This is makes it possible for unit tests to\n\t * stub matchMedia (which doesn't work in PhantomJS)\n\t * @private\n\t */\n\t_matchMedia: function(media) {\n\t\tif (window.matchMedia) {\n\t\t\treturn window.matchMedia(media);\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Returns the user's locale as a BCP 47 compliant language tag\n\t *\n\t * @return {String} locale string\n\t */\n\tgetCanonicalLocale: function() {\n\t\tvar locale = this.getLocale();\n\t\treturn typeof locale === 'string' ? locale.replace(/_/g, '-') : locale;\n\t},\n\n\t/**\n\t * Returns the user's locale\n\t *\n\t * @return {String} locale string\n\t */\n\tgetLocale: function() {\n\t\treturn $('html').data('locale');\n\t},\n\n\t/**\n\t * Returns the user's language\n\t *\n\t * @returns {String} language string\n\t */\n\tgetLanguage: function () {\n\t\treturn $('html').prop('lang');\n\t},\n\n\t/**\n\t * Returns whether the current user is an administrator\n\t *\n\t * @return {bool} true if the user is an admin, false otherwise\n\t * @since 9.0.0\n\t */\n\tisUserAdmin: function() {\n\t\treturn oc_isadmin;\n\t},\n\n\t/**\n\t * Warn users that the connection to the server was lost temporarily\n\t *\n\t * This function is throttled to prevent stacked notfications.\n\t * After 7sec the first notification is gone, then we can show another one\n\t * if necessary.\n\t */\n\t_ajaxConnectionLostHandler: _.throttle(function() {\n\t\tOC.Notification.showTemporary(t('core', 'Connection to server lost'));\n\t}, 7 * 1000, {trailing: false}),\n\n\t/**\n\t * Process ajax error, redirects to main page\n\t * if an error/auth error status was returned.\n\t */\n\t_processAjaxError: function(xhr) {\n\t\tvar self = this;\n\t\t// purposefully aborted request ?\n\t\t// this._userIsNavigatingAway needed to distinguish ajax calls cancelled by navigating away\n\t\t// from calls cancelled by failed cross-domain ajax due to SSO redirect\n\t\tif (xhr.status === 0 && (xhr.statusText === 'abort' || xhr.statusText === 'timeout' || self._reloadCalled)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (_.contains([302, 303, 307, 401], xhr.status) && OC.currentUser) {\n\t\t\t// sometimes \"beforeunload\" happens later, so need to defer the reload a bit\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (!self._userIsNavigatingAway && !self._reloadCalled) {\n\t\t\t\t\tvar timer = 0;\n\t\t\t\t\tvar seconds = 5;\n\t\t\t\t\tvar interval = setInterval( function() {\n\t\t\t\t\t\tOC.Notification.showUpdate(n('core', 'Problem loading page, reloading in %n second', 'Problem loading page, reloading in %n seconds', seconds - timer));\n\t\t\t\t\t\tif (timer >= seconds) {\n\t\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t\t\tOC.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttimer++;\n\t\t\t\t\t\t}, 1000 // 1 second interval\n\t\t\t\t\t);\n\n\t\t\t\t\t// only call reload once\n\t\t\t\t\tself._reloadCalled = true;\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t} else if(xhr.status === 0) {\n\t\t\t// Connection lost (e.g. WiFi disconnected or server is down)\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (!self._userIsNavigatingAway && !self._reloadCalled) {\n\t\t\t\t\tself._ajaxConnectionLostHandler();\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\t},\n\n\t/**\n\t * Registers XmlHttpRequest object for global error processing.\n\t *\n\t * This means that if this XHR object returns 401 or session timeout errors,\n\t * the current page will automatically be reloaded.\n\t *\n\t * @param {XMLHttpRequest} xhr\n\t */\n\tregisterXHRForErrorProcessing: function(xhr) {\n\t\tvar loadCallback = function() {\n\t\t\tif (xhr.readyState !== 4) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// fire jquery global ajax error handler\n\t\t\t$(document).trigger(new $.Event('ajaxError'), xhr);\n\t\t};\n\n\t\tvar errorCallback = function() {\n\t\t\t// fire jquery global ajax error handler\n\t\t\t$(document).trigger(new $.Event('ajaxError'), xhr);\n\t\t};\n\n\t\tif (xhr.addEventListener) {\n\t\t\txhr.addEventListener('load', loadCallback);\n\t\t\txhr.addEventListener('error', errorCallback);\n\t\t}\n\n\t}\n};\n\n/**\n * Current user attributes\n *\n * @typedef {Object} OC.CurrentUser\n *\n * @property {String} uid user id\n * @property {String} displayName display name\n */\n\n/**\n * @namespace OC.Plugins\n */\nOC.Plugins = {\n\t/**\n\t * @type Array.<OC.Plugin>\n\t */\n\t_plugins: {},\n\n\t/**\n\t * Register plugin\n\t *\n\t * @param {String} targetName app name / class name to hook into\n\t * @param {OC.Plugin} plugin\n\t */\n\tregister: function(targetName, plugin) {\n\t\tvar plugins = this._plugins[targetName];\n\t\tif (!plugins) {\n\t\t\tplugins = this._plugins[targetName] = [];\n\t\t}\n\t\tplugins.push(plugin);\n\t},\n\n\t/**\n\t * Returns all plugin registered to the given target\n\t * name / app name / class name.\n\t *\n\t * @param {String} targetName app name / class name to hook into\n\t * @return {Array.<OC.Plugin>} array of plugins\n\t */\n\tgetPlugins: function(targetName) {\n\t\treturn this._plugins[targetName] || [];\n\t},\n\n\t/**\n\t * Call attach() on all plugins registered to the given target name.\n\t *\n\t * @param {String} targetName app name / class name\n\t * @param {Object} object to be extended\n\t * @param {Object} [options] options\n\t */\n\tattach: function(targetName, targetObject, options) {\n\t\tvar plugins = this.getPlugins(targetName);\n\t\tfor (var i = 0; i < plugins.length; i++) {\n\t\t\tif (plugins[i].attach) {\n\t\t\t\tplugins[i].attach(targetObject, options);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Call detach() on all plugins registered to the given target name.\n\t *\n\t * @param {String} targetName app name / class name\n\t * @param {Object} object to be extended\n\t * @param {Object} [options] options\n\t */\n\tdetach: function(targetName, targetObject, options) {\n\t\tvar plugins = this.getPlugins(targetName);\n\t\tfor (var i = 0; i < plugins.length; i++) {\n\t\t\tif (plugins[i].detach) {\n\t\t\t\tplugins[i].detach(targetObject, options);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Plugin\n\t *\n\t * @todo make this a real class in the future\n\t * @typedef {Object} OC.Plugin\n\t *\n\t * @property {String} name plugin name\n\t * @property {Function} attach function that will be called when the\n\t * plugin is attached\n\t * @property {Function} [detach] function that will be called when the\n\t * plugin is detached\n\t */\n\n};\n\n/**\n * @namespace OC.search\n */\nOC.search.customResults = {};\n/**\n * @deprecated use get/setFormatter() instead\n */\nOC.search.resultTypes = {};\n\nOC.addStyle.loaded=[];\nOC.addScript.loaded=[];\n\n/**\n * A little class to manage a status field for a \"saving\" process.\n * It can be used to display a starting message (e.g. \"Saving...\") and then\n * replace it with a green success message or a red error message.\n *\n * @namespace OC.msg\n */\nOC.msg = {\n\t/**\n\t * Displayes a \"Saving...\" message in the given message placeholder\n\t *\n\t * @param {Object} selector\tPlaceholder to display the message in\n\t */\n\tstartSaving: function(selector) {\n\t\tthis.startAction(selector, t('core', 'Saving...'));\n\t},\n\n\t/**\n\t * Displayes a custom message in the given message placeholder\n\t *\n\t * @param {Object} selector\tPlaceholder to display the message in\n\t * @param {string} message\tPlain text message to display (no HTML allowed)\n\t */\n\tstartAction: function(selector, message) {\n\t\t$(selector).text(message)\n\t\t\t.removeClass('success')\n\t\t\t.removeClass('error')\n\t\t\t.stop(true, true)\n\t\t\t.show();\n\t},\n\n\t/**\n\t * Displayes an success/error message in the given selector\n\t *\n\t * @param {Object} selector\tPlaceholder to display the message in\n\t * @param {Object} response\tResponse of the server\n\t * @param {Object} response.data\tData of the servers response\n\t * @param {string} response.data.message\tPlain text message to display (no HTML allowed)\n\t * @param {string} response.status\tis being used to decide whether the message\n\t * is displayed as an error/success\n\t */\n\tfinishedSaving: function(selector, response) {\n\t\tthis.finishedAction(selector, response);\n\t},\n\n\t/**\n\t * Displayes an success/error message in the given selector\n\t *\n\t * @param {Object} selector\tPlaceholder to display the message in\n\t * @param {Object} response\tResponse of the server\n\t * @param {Object} response.data Data of the servers response\n\t * @param {string} response.data.message Plain text message to display (no HTML allowed)\n\t * @param {string} response.status is being used to decide whether the message\n\t * is displayed as an error/success\n\t */\n\tfinishedAction: function(selector, response) {\n\t\tif (response.status === \"success\") {\n\t\t\tthis.finishedSuccess(selector, response.data.message);\n\t\t} else {\n\t\t\tthis.finishedError(selector, response.data.message);\n\t\t}\n\t},\n\n\t/**\n\t * Displayes an success message in the given selector\n\t *\n\t * @param {Object} selector Placeholder to display the message in\n\t * @param {string} message Plain text success message to display (no HTML allowed)\n\t */\n\tfinishedSuccess: function(selector, message) {\n\t\t$(selector).text(message)\n\t\t\t.addClass('success')\n\t\t\t.removeClass('error')\n\t\t\t.stop(true, true)\n\t\t\t.delay(3000)\n\t\t\t.fadeOut(900)\n\t\t\t.show();\n\t},\n\n\t/**\n\t * Displayes an error message in the given selector\n\t *\n\t * @param {Object} selector Placeholder to display the message in\n\t * @param {string} message Plain text error message to display (no HTML allowed)\n\t */\n\tfinishedError: function(selector, message) {\n\t\t$(selector).text(message)\n\t\t\t.addClass('error')\n\t\t\t.removeClass('success')\n\t\t\t.show();\n\t}\n};\n\n/**\n * @todo Write documentation\n * @namespace\n */\nOC.Notification={\n\tqueuedNotifications: [],\n\tgetDefaultNotificationFunction: null,\n\n\t/**\n\t * @type Array<int>\n\t * @description array of notification timers\n\t */\n\tnotificationTimers: [],\n\n\t/**\n\t * @param callback\n\t * @todo Write documentation\n\t */\n\tsetDefault: function(callback) {\n\t\tOC.Notification.getDefaultNotificationFunction = callback;\n\t},\n\n\t/**\n\t * Hides a notification.\n\t *\n\t * If a row is given, only hide that one.\n\t * If no row is given, hide all notifications.\n\t *\n\t * @param {jQuery} [$row] notification row\n\t * @param {Function} [callback] callback\n\t */\n\thide: function($row, callback) {\n\t\tvar self = this;\n\t\tvar $notification = $('#notification');\n\n\t\tif (_.isFunction($row)) {\n\t\t\t// first arg is the callback\n\t\t\tcallback = $row;\n\t\t\t$row = undefined;\n\t\t}\n\n\t\tif (!$row) {\n\t\t\tconsole.warn('Missing argument $row in OC.Notification.hide() call, caller needs to be adjusted to only dismiss its own notification');\n\t\t\t// assume that the row to be hidden is the first one\n\t\t\t$row = $notification.find('.row:first');\n\t\t}\n\n\t\tif ($row && $notification.find('.row').length > 1) {\n\t\t\t// remove the row directly\n\t\t\t$row.remove();\n\t\t\tif (callback) {\n\t\t\t\tcallback.call();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t_.defer(function() {\n\t\t\t// fade out is supposed to only fade when there is a single row\n\t\t\t// however, some code might call hide() and show() directly after,\n\t\t\t// which results in more than one element\n\t\t\t// in this case, simply delete that one element that was supposed to\n\t\t\t// fade out\n\t\t\t//\n\t\t\t// FIXME: remove once all callers are adjusted to only hide their own notifications\n\t\t\tif ($notification.find('.row').length > 1) {\n\t\t\t\t$row.remove();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// else, fade out whatever was present\n\t\t\t$notification.fadeOut('400', function(){\n\t\t\t\tif (self.isHidden()) {\n\t\t\t\t\tif (self.getDefaultNotificationFunction) {\n\t\t\t\t\t\tself.getDefaultNotificationFunction.call();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback.call();\n\t\t\t\t}\n\t\t\t\t$notification.empty();\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Shows a notification as HTML without being sanitized before.\n\t * If you pass unsanitized user input this may lead to a XSS vulnerability.\n\t * Consider using show() instead of showHTML()\n\t *\n\t * @param {string} html Message to display\n\t * @param {Object} [options] options\n\t * @param {string} [options.type] notification type\n\t * @param {int} [options.timeout=0] timeout value, defaults to 0 (permanent)\n\t * @return {jQuery} jQuery element for notification row\n\t */\n\tshowHtml: function(html, options) {\n\t\toptions = options || {};\n\t\t_.defaults(options, {\n\t\t\ttimeout: 0\n\t\t});\n\n\t\tvar self = this;\n\t\tvar $notification = $('#notification');\n\t\tif (this.isHidden()) {\n\t\t\t$notification.fadeIn().css('display','inline-block');\n\t\t}\n\t\tvar $row = $('<div class=\"row\"></div>');\n\t\tif (options.type) {\n\t\t\t$row.addClass('type-' + options.type);\n\t\t}\n\t\tif (options.type === 'error') {\n\t\t\t// add a close button\n\t\t\tvar $closeButton = $('<a class=\"action close icon-close\" href=\"#\"></a>');\n\t\t\t$closeButton.attr('alt', t('core', 'Dismiss'));\n\t\t\t$row.append($closeButton);\n\t\t\t$closeButton.one('click', function() {\n\t\t\t\tself.hide($row);\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\t$row.addClass('closeable');\n\t\t}\n\n\t\t$row.prepend(html);\n\t\t$notification.append($row);\n\n\t\tif(options.timeout > 0) {\n\t\t\t// register timeout to vanish notification\n\t\t\tthis.notificationTimers.push(setTimeout(function() {\n\t\t\t\tself.hide($row);\n\t\t\t}, (options.timeout * 1000)));\n\t\t}\n\n\t\treturn $row;\n\t},\n\n\t/**\n\t * Shows a sanitized notification\n\t *\n\t * @param {string} text Message to display\n\t * @param {Object} [options] options\n\t * @param {string} [options.type] notification type\n\t * @param {int} [options.timeout=0] timeout value, defaults to 0 (permanent)\n\t * @return {jQuery} jQuery element for notification row\n\t */\n\tshow: function(text, options) {\n\t\treturn this.showHtml($('<div/>').text(text).html(), options);\n\t},\n\n\t/**\n\t * Updates (replaces) a sanitized notification.\n\t *\n\t * @param {string} text Message to display\n\t * @return {jQuery} JQuery element for notificaiton row\n\t */\n\tshowUpdate: function(text) {\n\t\tvar $notification = $('#notification');\n\t\t// sanitise\n\t\tvar $html = $('<div/>').text(text).html();\n\n\t\t// new notification\n\t\tif (text && $notification.find('.row').length == 0) {\n\t\t\treturn this.showHtml($html);\n\t\t}\n\n\t\tvar $row = $('<div class=\"row\"></div>').prepend($html);\n\n\t\t// just update html in notification\n\t\t$notification.html($row);\n\n\t\treturn $row;\n\t},\n\n\t/**\n\t * Shows a notification that disappears after x seconds, default is\n\t * 7 seconds\n\t *\n\t * @param {string} text Message to show\n\t * @param {array} [options] options array\n\t * @param {int} [options.timeout=7] timeout in seconds, if this is 0 it will show the message permanently\n\t * @param {boolean} [options.isHTML=false] an indicator for HTML notifications (true) or text (false)\n\t * @param {string} [options.type] notification type\n\t */\n\tshowTemporary: function(text, options) {\n\t\tvar defaults = {\n\t\t\tisHTML: false,\n\t\t\ttimeout: 7\n\t\t};\n\t\toptions = options || {};\n\t\t// merge defaults with passed in options\n\t\t_.defaults(options, defaults);\n\n\t\tvar $row;\n\t\tif(options.isHTML) {\n\t\t\t$row = this.showHtml(text, options);\n\t\t} else {\n\t\t\t$row = this.show(text, options);\n\t\t}\n\t\treturn $row;\n\t},\n\n\t/**\n\t * Returns whether a notification is hidden.\n\t * @return {boolean}\n\t */\n\tisHidden: function() {\n\t\treturn !$(\"#notification\").find('.row').length;\n\t}\n};\n\n/**\n * Initializes core\n */\nfunction initCore() {\n\t/**\n\t * Disable automatic evaluation of responses for $.ajax() functions (and its\n\t * higher-level alternatives like $.get() and $.post()).\n\t *\n\t * If a response to a $.ajax() request returns a content type of \"application/javascript\"\n\t * JQuery would previously execute the response body. This is a pretty unexpected\n\t * behaviour and can result in a bypass of our Content-Security-Policy as well as\n\t * multiple unexpected XSS vectors.\n\t */\n\t$.ajaxSetup({\n\t\tcontents: {\n\t\t\tscript: false\n\t\t}\n\t});\n\n\t/**\n\t * Disable execution of eval in jQuery. We do require an allowed eval CSP\n\t * configuration at the moment for handlebars et al. But for jQuery there is\n\t * not much of a reason to execute JavaScript directly via eval.\n\t *\n\t * This thus mitigates some unexpected XSS vectors.\n\t */\n\tjQuery.globalEval = function(){};\n\n\t/**\n\t * Set users locale to moment.js as soon as possible\n\t */\n\tmoment.locale(OC.getLocale());\n\n\tvar userAgent = window.navigator.userAgent;\n\tvar msie = userAgent.indexOf('MSIE ');\n\tvar trident = userAgent.indexOf('Trident/');\n\tvar edge = userAgent.indexOf('Edge/');\n\n\tif (msie > 0 || trident > 0) {\n\t\t// (IE 10 or older) || IE 11\n\t\t$('html').addClass('ie');\n\t} else if (edge > 0) {\n\t\t// for edge\n\t\t$('html').addClass('edge');\n\t}\n\n\t// css variables fallback for IE\n\tif (msie > 0 || trident > 0) {\n\t\tcssVars();\n\t}\n\n\t$(window).on('unload.main', function() {\n\t\tOC._unloadCalled = true;\n\t});\n\t$(window).on('beforeunload.main', function() {\n\t\t// super-trick thanks to http://stackoverflow.com/a/4651049\n\t\t// in case another handler displays a confirmation dialog (ex: navigating away\n\t\t// during an upload), there are two possible outcomes: user clicked \"ok\" or\n\t\t// \"cancel\"\n\n\t\t// first timeout handler is called after unload dialog is closed\n\t\tsetTimeout(function() {\n\t\t\tOC._userIsNavigatingAway = true;\n\n\t\t\t// second timeout event is only called if user cancelled (Chrome),\n\t\t\t// but in other browsers it might still be triggered, so need to\n\t\t\t// set a higher delay...\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (!OC._unloadCalled) {\n\t\t\t\t\tOC._userIsNavigatingAway = false;\n\t\t\t\t}\n\t\t\t}, 10000);\n\t\t},1);\n\t});\n\t$(document).on('ajaxError.main', function( event, request, settings ) {\n\t\tif (settings && settings.allowAuthErrors) {\n\t\t\treturn;\n\t\t}\n\t\tOC._processAjaxError(request);\n\t});\n\n\t/**\n\t * Calls the server periodically to ensure that session and CSRF\n\t * token doesn't expire\n\t */\n\tfunction initSessionHeartBeat() {\n\t\t// interval in seconds\n\t\tvar interval = NaN;\n\t\tif (oc_config.session_lifetime) {\n\t\t\tinterval = Math.floor(oc_config.session_lifetime / 2);\n\t\t}\n\t\tinterval = isNaN(interval)? 900: interval;\n\n\t\t// minimum one minute\n\t\tinterval = Math.max(60, interval);\n\t\t// max interval in seconds set to 24 hours\n\t\tinterval = Math.min(24 * 3600, interval);\n\n\t\tvar url = OC.generateUrl('/csrftoken');\n\t\tsetInterval(function() {\n\t\t\t$.ajax(url).then(function(resp) {\n\t\t\t\toc_requesttoken = resp.token;\n\t\t\t\tOC.requestToken = resp.token;\n\t\t\t}).fail(function(e) {\n\t\t\t\tconsole.error('session heartbeat failed', e);\n\t\t\t});\n\t\t}, interval * 1000);\n\t}\n\n\t// session heartbeat (defaults to enabled)\n\tif (typeof(oc_config.session_keepalive) === 'undefined' ||\n\t\t!!oc_config.session_keepalive) {\n\n\t\tinitSessionHeartBeat();\n\t}\n\n\tOC.registerMenu($('#expand'), $('#expanddiv'), false, true);\n\n\t// toggle for menus\n\t//$(document).on('mouseup.closemenus keyup', function(event) {\n\t$(document).on('mouseup.closemenus', function(event) {\n\n\t\t// allow enter as a trigger\n\t\t// if (event.key && event.key !== \"Enter\") {\n\t\t// \treturn;\n\t\t// }\n\n\t\tvar $el = $(event.target);\n\t\tif ($el.closest('.menu').length || $el.closest('.menutoggle').length) {\n\t\t\t// don't close when clicking on the menu directly or a menu toggle\n\t\t\treturn false;\n\t\t}\n\n\t\tOC.hideMenus();\n\t});\n\n\t/**\n\t * Set up the main menu toggle to react to media query changes.\n\t * If the screen is small enough, the main menu becomes a toggle.\n\t * If the screen is bigger, the main menu is not a toggle any more.\n\t */\n\tfunction setupMainMenu() {\n\n\t\t// init the more-apps menu\n\t\tOC.registerMenu($('#more-apps > a'), $('#navigation'));\n\n\t\t// toggle the navigation\n\t\tvar $toggle = $('#header .header-appname-container');\n\t\tvar $navigation = $('#navigation');\n\t\tvar $appmenu = $('#appmenu');\n\n\t\t// init the menu\n\t\tOC.registerMenu($toggle, $navigation);\n\t\t$toggle.data('oldhref', $toggle.attr('href'));\n\t\t$toggle.attr('href', '#');\n\t\t$navigation.hide();\n\n\t\t// show loading feedback\n\t\t$navigation.delegate('a', 'click', function(event) {\n\t\t\tvar $app = $(event.target);\n\t\t\tif(!$app.is('a')) {\n\t\t\t\t$app = $app.closest('a');\n\t\t\t}\n\t\t\tif(event.which === 1 && !event.ctrlKey && !event.metaKey) {\n\t\t\t\t$app.addClass('app-loading');\n\t\t\t} else {\n\t\t\t\t// Close navigation when opening app in\n\t\t\t\t// a new tab\n\t\t\t\tOC.hideMenus(function(){return false;});\n\t\t\t}\n\t\t});\n\n\t\t$navigation.delegate('a', 'mouseup', function(event) {\n\t\t\tif(event.which === 2) {\n\t\t\t\t// Close navigation when opening app in\n\t\t\t\t// a new tab via middle click\n\t\t\t\tOC.hideMenus(function(){return false;});\n\t\t\t}\n\t\t});\n\n\t\t$appmenu.delegate('a', 'click', function(event) {\n\t\t\tvar $app = $(event.target);\n\t\t\tif(!$app.is('a')) {\n\t\t\t\t$app = $app.closest('a');\n\t\t\t}\n\t\t\tif(event.which === 1 && !event.ctrlKey && !event.metaKey) {\n\t\t\t\t$app.addClass('app-loading');\n\t\t\t} else {\n\t\t\t\t// Close navigation when opening app in\n\t\t\t\t// a new tab\n\t\t\t\tOC.hideMenus(function(){return false;});\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction setupUserMenu() {\n\t\tvar $menu = $('#header #settings');\n\n\t\t// show loading feedback\n\t\t$menu.delegate('a', 'click', function(event) {\n\t\t\tvar $page = $(event.target);\n\t\t\tif (!$page.is('a')) {\n\t\t\t\t$page = $page.closest('a');\n\t\t\t}\n\t\t\tif(event.which === 1 && !event.ctrlKey && !event.metaKey) {\n\t\t\t\t$page.find('img').remove();\n\t\t\t\t$page.find('div').remove(); // prevent odd double-clicks\n\t\t\t\t$page.prepend($('<div/>').addClass('icon-loading-small'));\n\t\t\t} else {\n\t\t\t\t// Close navigation when opening menu entry in\n\t\t\t\t// a new tab\n\t\t\t\tOC.hideMenus(function(){return false;});\n\t\t\t}\n\t\t});\n\n\t\t$menu.delegate('a', 'mouseup', function(event) {\n\t\t\tif(event.which === 2) {\n\t\t\t\t// Close navigation when opening app in\n\t\t\t\t// a new tab via middle click\n\t\t\t\tOC.hideMenus(function(){return false;});\n\t\t\t}\n\t\t});\n\t}\n\n\tfunction setupContactsMenu() {\n\t\tnew OC.ContactsMenu({\n\t\t\tel: $('#contactsmenu .menu'),\n\t\t\ttrigger: $('#contactsmenu .menutoggle')\n\t\t});\n\t}\n\n\tsetupMainMenu();\n\tsetupUserMenu();\n\tsetupContactsMenu();\n\n\t// move triangle of apps dropdown to align with app name triangle\n\t// 2 is the additional offset between the triangles\n\tif($('#navigation').length) {\n\t\t$('#header #nextcloud + .menutoggle').on('click', function(){\n\t\t\t$('#menu-css-helper').remove();\n\t\t\tvar caretPosition = $('.header-appname + .icon-caret').offset().left - 2;\n\t\t\tif(caretPosition > 255) {\n\t\t\t\t// if the app name is longer than the menu, just put the triangle in the middle\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\t$('head').append('<style id=\"menu-css-helper\">#navigation:after { left: '+ caretPosition +'px; }</style>');\n\t\t\t}\n\t\t});\n\t\t$('#header #appmenu .menutoggle').on('click', function() {\n\t\t\t$('#appmenu').toggleClass('menu-open');\n\t\t\tif($('#appmenu').is(':visible')) {\n\t\t\t\t$('#menu-css-helper').remove();\n\t\t\t}\n\t\t});\n\t}\n\n\tvar resizeMenu = function() {\n\t\tvar appList = $('#appmenu li');\n\t\tvar rightHeaderWidth = $('.header-right').outerWidth();\n\t\tvar headerWidth = $('header').outerWidth();\n\t\tvar usePercentualAppMenuLimit = 0.33;\n\t\tvar minAppsDesktop = 8;\n\t\tvar availableWidth =  headerWidth - $('#nextcloud').outerWidth() - (rightHeaderWidth > 210 ? rightHeaderWidth : 210)\n\t\tvar isMobile = $(window).width() < 768;\n\t\tif (!isMobile) {\n\t\t\tavailableWidth = availableWidth * usePercentualAppMenuLimit;\n\t\t}\n\t\tvar appCount = Math.floor((availableWidth / $(appList).width()));\n\t\tif (isMobile && appCount > minAppsDesktop) {\n\t\t\tappCount = minAppsDesktop;\n\t\t}\n\t\tif (!isMobile && appCount < minAppsDesktop) {\n\t\t\tappCount = minAppsDesktop;\n\t\t}\n\n\t\t// show at least 2 apps in the popover\n\t\tif(appList.length-1-appCount >= 1) {\n\t\t\tappCount--;\n\t\t}\n\n\t\t$('#more-apps a').removeClass('active');\n\t\tvar lastShownApp;\n\t\tfor (var k = 0; k < appList.length-1; k++) {\n\t\t\tvar name = $(appList[k]).data('id');\n\t\t\tif(k < appCount) {\n\t\t\t\t$(appList[k]).removeClass('hidden');\n\t\t\t\t$('#apps li[data-id=' + name + ']').addClass('in-header');\n\t\t\t\tlastShownApp = appList[k];\n\t\t\t} else {\n\t\t\t\t$(appList[k]).addClass('hidden');\n\t\t\t\t$('#apps li[data-id=' + name + ']').removeClass('in-header');\n\t\t\t\t// move active app to last position if it is active\n\t\t\t\tif(appCount > 0 && $(appList[k]).children('a').hasClass('active')) {\n\t\t\t\t\t$(lastShownApp).addClass('hidden');\n\t\t\t\t\t$('#apps li[data-id=' + $(lastShownApp).data('id') + ']').removeClass('in-header');\n\t\t\t\t\t$(appList[k]).removeClass('hidden');\n\t\t\t\t\t$('#apps li[data-id=' + name + ']').addClass('in-header');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// show/hide more apps icon\n\t\tif($('#apps li:not(.in-header)').length === 0) {\n\t\t\t$('#more-apps').hide();\n\t\t\t$('#navigation').hide();\n\t\t} else {\n\t\t\t$('#more-apps').show();\n\t\t}\n\t};\n\t$(window).resize(resizeMenu);\n\tsetTimeout(resizeMenu, 0);\n\n\t// just add snapper for logged in users\n\tif($('#app-navigation').length && !$('html').hasClass('lte9')) {\n\n\t\t// App sidebar on mobile\n\t\tvar snapper = new Snap({\n\t\t\telement: document.getElementById('app-content'),\n\t\t\tdisable: 'right',\n\t\t\tmaxPosition: 300, // $navigation-width\n\t\t\tminDragDistance: 100\n\t\t});\n\n\t\t$('#app-content').prepend('<div id=\"app-navigation-toggle\" class=\"icon-menu\" style=\"display:none;\" tabindex=\"0\"></div>');\n\n\t\tvar toggleSnapperOnButton = function(){\n\t\t\tif(snapper.state().state == 'left'){\n\t\t\t\tsnapper.close();\n\t\t\t} else {\n\t\t\t\tsnapper.open('left');\n\t\t\t}\n\t\t};\n\n\t\t$('#app-navigation-toggle').click(function(){\n\t\t\ttoggleSnapperOnButton();\n\t\t});\n\n\t\t$('#app-navigation-toggle').keypress(function(e) {\n\t\t\tif(e.which == 13) {\n\t\t\t\ttoggleSnapperOnButton();\n\t\t\t}\n\t\t});\n\n\t\t// close sidebar when switching navigation entry\n\t\tvar $appNavigation = $('#app-navigation');\n\t\t$appNavigation.delegate('a, :button', 'click', function(event) {\n\t\t\tvar $target = $(event.target);\n\t\t\t// don't hide navigation when changing settings or adding things\n\t\t\tif($target.is('.app-navigation-noclose') ||\n\t\t\t\t$target.closest('.app-navigation-noclose').length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif($target.is('.app-navigation-entry-utils-menu-button') ||\n\t\t\t\t$target.closest('.app-navigation-entry-utils-menu-button').length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif($target.is('.add-new') ||\n\t\t\t\t$target.closest('.add-new').length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif($target.is('#app-settings') ||\n\t\t\t\t$target.closest('#app-settings').length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsnapper.close();\n\t\t});\n\n\t\tvar navigationBarSlideGestureEnabled = false;\n\t\tvar navigationBarSlideGestureAllowed = true;\n\t\tvar navigationBarSlideGestureEnablePending = false;\n\n\t\tOC.allowNavigationBarSlideGesture = function() {\n\t\t\tnavigationBarSlideGestureAllowed = true;\n\n\t\t\tif (navigationBarSlideGestureEnablePending) {\n\t\t\t\tsnapper.enable();\n\n\t\t\t\tnavigationBarSlideGestureEnabled = true;\n\t\t\t\tnavigationBarSlideGestureEnablePending = false;\n\t\t\t}\n\t\t};\n\n\t\tOC.disallowNavigationBarSlideGesture = function() {\n\t\t\tnavigationBarSlideGestureAllowed = false;\n\n\t\t\tif (navigationBarSlideGestureEnabled) {\n\t\t\t\tvar endCurrentDrag = true;\n\t\t\t\tsnapper.disable(endCurrentDrag);\n\n\t\t\t\tnavigationBarSlideGestureEnabled = false;\n\t\t\t\tnavigationBarSlideGestureEnablePending = true;\n\t\t\t}\n\t\t};\n\n\t\tvar toggleSnapperOnSize = function() {\n\t\t\tif($(window).width() > 768) {\n\t\t\t\tsnapper.close();\n\t\t\t\tsnapper.disable();\n\n\t\t\t\tnavigationBarSlideGestureEnabled = false;\n\t\t\t\tnavigationBarSlideGestureEnablePending = false;\n\t\t\t} else if (navigationBarSlideGestureAllowed) {\n\t\t\t\tsnapper.enable();\n\n\t\t\t\tnavigationBarSlideGestureEnabled = true;\n\t\t\t\tnavigationBarSlideGestureEnablePending = false;\n\t\t\t} else {\n\t\t\t\tnavigationBarSlideGestureEnablePending = true;\n\t\t\t}\n\t\t};\n\n\t\t$(window).resize(_.debounce(toggleSnapperOnSize, 250));\n\n\t\t// initial call\n\t\ttoggleSnapperOnSize();\n\n\t}\n\n\t// Update live timestamps every 30 seconds\n\tsetInterval(function() {\n\t\t$('.live-relative-timestamp').each(function() {\n\t\t\t$(this).text(OC.Util.relativeModifiedDate(parseInt($(this).attr('data-timestamp'), 10)));\n\t\t});\n\t}, 30 * 1000);\n\n\tOC.PasswordConfirmation.init();\n}\n\nOC.PasswordConfirmation = {\n\tcallback: null,\n\tpageLoadTime: null,\n\tinit: function() {\n\t\t$('.password-confirm-required').on('click', _.bind(this.requirePasswordConfirmation, this));\n\t\tthis.pageLoadTime = moment.now();\n\t},\n\n\trequiresPasswordConfirmation: function() {\n\t\tvar serverTimeDiff = this.pageLoadTime - (nc_pageLoad * 1000);\n\t\tvar timeSinceLogin = moment.now() - (serverTimeDiff + (nc_lastLogin * 1000));\n\n\t\t// if timeSinceLogin > 30 minutes and user backend allows password confirmation\n\t\treturn (backendAllowsPasswordConfirmation && timeSinceLogin > 30 * 60 * 1000);\n\t},\n\n\t/**\n\t * @param {function} callback\n\t */\n\trequirePasswordConfirmation: function(callback, options, rejectCallback) {\n\t\toptions = typeof options !== 'undefined' ? options : {};\n\t\tvar defaults = {\n\t\t\ttitle: t('core','Authentication required'),\n\t\t\ttext: t(\n\t\t\t\t'core',\n\t\t\t\t'This action requires you to confirm your password'\n\t\t\t),\n\t\t\tconfirm: t('core', 'Confirm'),\n\t\t\tlabel: t('core','Password'),\n\t\t\terror: '',\n\t\t};\n\n\t\tvar config = _.extend(defaults, options);\n\n\t\tvar self = this;\n\n\t\tif (this.requiresPasswordConfirmation()) {\n\t\t\tOC.dialogs.prompt(\n\t\t\t\tconfig.text,\n\t\t\t\tconfig.title,\n\t\t\t\tfunction (result, password) {\n\t\t\t\t\tif (result && password !== '') {\n\t\t\t\t\t\tself._confirmPassword(password, config);\n\t\t\t\t\t} else if (_.isFunction(rejectCallback)) {\n\t\t\t\t\t\trejectCallback()\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t\tconfig.label,\n\t\t\t\ttrue\n\t\t\t).then(function() {\n\t\t\t\tvar $dialog = $('.oc-dialog:visible');\n\t\t\t\t$dialog.find('.ui-icon').remove();\n\t\t\t\t$dialog.addClass('password-confirmation');\n\t\t\t\tif (config.error !== '') {\n\t\t\t\t\tvar $error = $('<p></p>').addClass('msg warning').text(config.error);\n\t\t\t\t}\n\t\t\t\t$dialog.find('.oc-dialog-content').append($error);\n\t\t\t\t$dialog.find('.oc-dialog-buttonrow').addClass('aside');\n\n\t\t\t\tvar $buttons = $dialog.find('button');\n\t\t\t\t$buttons.eq(0).hide();\n\t\t\t\t$buttons.eq(1).text(config.confirm);\n\t\t\t});\n\t\t}\n\n\t\tthis.callback = callback;\n\t},\n\n\t_confirmPassword: function(password, config) {\n\t\tvar self = this;\n\n\t\t$.ajax({\n\t\t\turl: OC.generateUrl('/login/confirm'),\n\t\t\tdata: {\n\t\t\t\tpassword: password\n\t\t\t},\n\t\t\ttype: 'POST',\n\t\t\tsuccess: function(response) {\n\t\t\t\tnc_lastLogin = response.lastLogin;\n\n\t\t\t\tif (_.isFunction(self.callback)) {\n\t\t\t\t\tself.callback();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function() {\n\t\t\t\tconfig.error = t('core', 'Failed to authenticate, try again');\n\t\t\t\tOC.PasswordConfirmation.requirePasswordConfirmation(self.callback, config);\n\t\t\t}\n\t\t});\n\t}\n};\n\n$(document).ready(initCore);\n\n/**\n * Filter Jquery selector by attribute value\n */\n$.fn.filterAttr = function(attr_name, attr_value) {\n\treturn this.filter(function() { return $(this).attr(attr_name) === attr_value; });\n};\n\n/**\n * Returns a human readable file size\n * @param {number} size Size in bytes\n * @param {boolean} skipSmallSizes return '< 1 kB' for small files\n * @return {string}\n */\nfunction humanFileSize(size, skipSmallSizes) {\n\tvar humanList = ['B', 'KB', 'MB', 'GB', 'TB'];\n\t// Calculate Log with base 1024: size = 1024 ** order\n\tvar order = size > 0 ? Math.floor(Math.log(size) / Math.log(1024)) : 0;\n\t// Stay in range of the byte sizes that are defined\n\torder = Math.min(humanList.length - 1, order);\n\tvar readableFormat = humanList[order];\n\tvar relativeSize = (size / Math.pow(1024, order)).toFixed(1);\n\tif(skipSmallSizes === true && order === 0) {\n\t\tif(relativeSize !== \"0.0\"){\n\t\t\treturn '< 1 KB';\n\t\t} else {\n\t\t\treturn '0 KB';\n\t\t}\n\t}\n\tif(order < 2){\n\t\trelativeSize = parseFloat(relativeSize).toFixed(0);\n\t}\n\telse if(relativeSize.substr(relativeSize.length-2,2)==='.0'){\n\t\trelativeSize=relativeSize.substr(0,relativeSize.length-2);\n\t}\n\telse{\n\t\trelativeSize = parseFloat(relativeSize).toLocaleString(OC.getCanonicalLocale());\n\t}\n\treturn relativeSize + ' ' + readableFormat;\n}\n\n/**\n * Format an UNIX timestamp to a human understandable format\n * @param {number} timestamp UNIX timestamp\n * @return {string} Human readable format\n */\nfunction formatDate(timestamp){\n\treturn OC.Util.formatDate(timestamp);\n}\n\n//\n/**\n * Get the value of a URL parameter\n * @link http://stackoverflow.com/questions/1403888/get-url-parameter-with-jquery\n * @param {string} name URL parameter\n * @return {string}\n */\nfunction getURLParameter(name) {\n\treturn decodeURIComponent(\n\t\t(new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(\n\t\t\tlocation.search)||[,''])[1].replace(/\\+/g, '%20')\n\t\t)||'';\n}\n\n/**\n * Takes an absolute timestamp and return a string with a human-friendly relative date\n * @param {number} timestamp A Unix timestamp\n */\nfunction relative_modified_date(timestamp) {\n\t/*\n\t Were multiplying by 1000 to bring the timestamp back to its original value\n\t per https://github.com/owncloud/core/pull/10647#discussion_r16790315\n\t  */\n\treturn OC.Util.relativeModifiedDate(timestamp * 1000);\n}\n\n/**\n * Utility functions\n * @namespace\n */\nOC.Util = {\n\t// TODO: remove original functions from global namespace\n\thumanFileSize: humanFileSize,\n\n\t/**\n\t * Returns a file size in bytes from a humanly readable string\n\t * Makes 2kB to 2048.\n\t * Inspired by computerFileSize in helper.php\n\t * @param  {string} string file size in human readable format\n\t * @return {number} or null if string could not be parsed\n\t *\n\t *\n\t */\n\tcomputerFileSize: function (string) {\n\t\tif (typeof string !== 'string') {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar s = string.toLowerCase().trim();\n\t\tvar bytes = null;\n\n\t\tvar bytesArray = {\n\t\t\t'b' : 1,\n\t\t\t'k' : 1024,\n\t\t\t'kb': 1024,\n\t\t\t'mb': 1024 * 1024,\n\t\t\t'm' : 1024 * 1024,\n\t\t\t'gb': 1024 * 1024 * 1024,\n\t\t\t'g' : 1024 * 1024 * 1024,\n\t\t\t'tb': 1024 * 1024 * 1024 * 1024,\n\t\t\t't' : 1024 * 1024 * 1024 * 1024,\n\t\t\t'pb': 1024 * 1024 * 1024 * 1024 * 1024,\n\t\t\t'p' : 1024 * 1024 * 1024 * 1024 * 1024\n\t\t};\n\n\t\tvar matches = s.match(/^[\\s+]?([0-9]*)(\\.([0-9]+))?( +)?([kmgtp]?b?)$/i);\n\t\tif (matches !== null) {\n\t\t\tbytes = parseFloat(s);\n\t\t\tif (!isFinite(bytes)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t\tif (matches[5]) {\n\t\t\tbytes = bytes * bytesArray[matches[5]];\n\t\t}\n\n\t\tbytes = Math.round(bytes);\n\t\treturn bytes;\n\t},\n\n\t/**\n\t * @param timestamp\n\t * @param format\n\t * @returns {string} timestamp formatted as requested\n\t */\n\tformatDate: function (timestamp, format) {\n\t\tformat = format || \"LLL\";\n\t\treturn moment(timestamp).format(format);\n\t},\n\n\t/**\n\t * @param timestamp\n\t * @returns {string} human readable difference from now\n\t */\n\trelativeModifiedDate: function (timestamp) {\n\t\tvar diff = moment().diff(moment(timestamp));\n\t\tif (diff >= 0 && diff < 45000 ) {\n\t\t\treturn t('core', 'seconds ago');\n\t\t}\n\t\treturn moment(timestamp).fromNow();\n\t},\n\n\t/**\n\t * Returns whether this is IE\n\t *\n\t * @return {bool} true if this is IE, false otherwise\n\t */\n\tisIE: function() {\n\t\treturn $('html').hasClass('ie');\n\t},\n\n\t/**\n\t * Returns the width of a generic browser scrollbar\n\t *\n\t * @return {int} width of scrollbar\n\t */\n\tgetScrollBarWidth: function() {\n\t\tif (this._scrollBarWidth) {\n\t\t\treturn this._scrollBarWidth;\n\t\t}\n\n\t\tvar inner = document.createElement('p');\n\t\tinner.style.width = \"100%\";\n\t\tinner.style.height = \"200px\";\n\n\t\tvar outer = document.createElement('div');\n\t\touter.style.position = \"absolute\";\n\t\touter.style.top = \"0px\";\n\t\touter.style.left = \"0px\";\n\t\touter.style.visibility = \"hidden\";\n\t\touter.style.width = \"200px\";\n\t\touter.style.height = \"150px\";\n\t\touter.style.overflow = \"hidden\";\n\t\touter.appendChild (inner);\n\n\t\tdocument.body.appendChild (outer);\n\t\tvar w1 = inner.offsetWidth;\n\t\touter.style.overflow = 'scroll';\n\t\tvar w2 = inner.offsetWidth;\n\t\tif(w1 === w2) {\n\t\t\tw2 = outer.clientWidth;\n\t\t}\n\n\t\tdocument.body.removeChild (outer);\n\n\t\tthis._scrollBarWidth = (w1 - w2);\n\n\t\treturn this._scrollBarWidth;\n\t},\n\n\t/**\n\t * Remove the time component from a given date\n\t *\n\t * @param {Date} date date\n\t * @return {Date} date with stripped time\n\t */\n\tstripTime: function(date) {\n\t\t// FIXME: likely to break when crossing DST\n\t\t// would be better to use a library like momentJS\n\t\treturn new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\t},\n\n\t_chunkify: function(t) {\n\t\t// Adapted from http://my.opera.com/GreyWyvern/blog/show.dml/1671288\n\t\tvar tz = [], x = 0, y = -1, n = 0, code, c;\n\n\t\twhile (x < t.length) {\n\t\t\tc = t.charAt(x);\n\t\t\t// only include the dot in strings\n\t\t\tvar m = ((!n && c === '.') || (c >= '0' && c <= '9'));\n\t\t\tif (m !== n) {\n\t\t\t\t// next chunk\n\t\t\t\ty++;\n\t\t\t\ttz[y] = '';\n\t\t\t\tn = m;\n\t\t\t}\n\t\t\ttz[y] += c;\n\t\t\tx++;\n\t\t}\n\t\treturn tz;\n\t},\n\t/**\n\t * Compare two strings to provide a natural sort\n\t * @param a first string to compare\n\t * @param b second string to compare\n\t * @return -1 if b comes before a, 1 if a comes before b\n\t * or 0 if the strings are identical\n\t */\n\tnaturalSortCompare: function(a, b) {\n\t\tvar x;\n\t\tvar aa = OC.Util._chunkify(a);\n\t\tvar bb = OC.Util._chunkify(b);\n\n\t\tfor (x = 0; aa[x] && bb[x]; x++) {\n\t\t\tif (aa[x] !== bb[x]) {\n\t\t\t\tvar aNum = Number(aa[x]), bNum = Number(bb[x]);\n\t\t\t\t// note: == is correct here\n\t\t\t\tif (aNum == aa[x] && bNum == bb[x]) {\n\t\t\t\t\treturn aNum - bNum;\n\t\t\t\t} else {\n\t\t\t\t\t// Forcing 'en' locale to match the server-side locale which is\n\t\t\t\t\t// always 'en'.\n\t\t\t\t\t//\n\t\t\t\t\t// Note: This setting isn't supported by all browsers but for the ones\n\t\t\t\t\t// that do there will be more consistency between client-server sorting\n\t\t\t\t\treturn aa[x].localeCompare(bb[x], 'en');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn aa.length - bb.length;\n\t},\n\t/**\n\t * Calls the callback in a given interval until it returns true\n\t * @param {function} callback\n\t * @param {integer} interval in milliseconds\n\t */\n\twaitFor: function(callback, interval) {\n\t\tvar internalCallback = function() {\n\t\t\tif(callback() !== true) {\n\t\t\t\tsetTimeout(internalCallback, interval);\n\t\t\t}\n\t\t};\n\n\t\tinternalCallback();\n\t},\n\t/**\n\t * Checks if a cookie with the given name is present and is set to the provided value.\n\t * @param {string} name name of the cookie\n\t * @param {string} value value of the cookie\n\t * @return {boolean} true if the cookie with the given name has the given value\n\t */\n\tisCookieSetToValue: function(name, value) {\n\t\tvar cookies = document.cookie.split(';');\n\t\tfor (var i=0; i < cookies.length; i++) {\n\t\t\tvar cookie = cookies[i].split('=');\n\t\t\tif (cookie[0].trim() === name && cookie[1].trim() === value) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\n/**\n * Utility class for the history API,\n * includes fallback to using the URL hash when\n * the browser doesn't support the history API.\n *\n * @namespace\n */\nOC.Util.History = {\n\t_handlers: [],\n\n\t/**\n\t * Push the current URL parameters to the history stack\n\t * and change the visible URL.\n\t * Note: this includes a workaround for IE8/IE9 that uses\n\t * the hash part instead of the search part.\n\t *\n\t * @param {Object|string} params to append to the URL, can be either a string\n\t * or a map\n\t * @param {string} [url] URL to be used, otherwise the current URL will be used,\n\t * using the params as query string\n\t * @param {boolean} [replace=false] whether to replace instead of pushing\n\t */\n\t_pushState: function(params, url, replace) {\n\t\tvar strParams;\n\t\tif (typeof(params) === 'string') {\n\t\t\tstrParams = params;\n\t\t}\n\t\telse {\n\t\t\tstrParams = OC.buildQueryString(params);\n\t\t}\n\t\tif (window.history.pushState) {\n\t\t\turl = url || location.pathname + '?' + strParams;\n\t\t\t// Workaround for bug with SVG and window.history.pushState on Firefox < 51\n\t\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=652991\n\t\t\tvar isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\t\t\tif (isFirefox && parseInt(navigator.userAgent.split('/').pop()) < 51) {\n\t\t\t\tvar patterns = document.querySelectorAll('[fill^=\"url(#\"], [stroke^=\"url(#\"], [filter^=\"url(#invert\"]');\n\t\t\t\tfor (var i = 0, ii = patterns.length, pattern; i < ii; i++) {\n\t\t\t\t\tpattern = patterns[i];\n\t\t\t\t\tpattern.style.fill = pattern.style.fill;\n\t\t\t\t\tpattern.style.stroke = pattern.style.stroke;\n\t\t\t\t\tpattern.removeAttribute(\"filter\");\n\t\t\t\t\tpattern.setAttribute(\"filter\", \"url(#invert)\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (replace) {\n\t\t\t\twindow.history.replaceState(params, '', url);\n\t\t\t} else {\n\t\t\t\twindow.history.pushState(params, '', url);\n\t\t\t}\n\t\t}\n\t\t// use URL hash for IE8\n\t\telse {\n\t\t\twindow.location.hash = '?' + strParams;\n\t\t\t// inhibit next onhashchange that just added itself\n\t\t\t// to the event queue\n\t\t\tthis._cancelPop = true;\n\t\t}\n\t},\n\n\t/**\n\t * Push the current URL parameters to the history stack\n\t * and change the visible URL.\n\t * Note: this includes a workaround for IE8/IE9 that uses\n\t * the hash part instead of the search part.\n\t *\n\t * @param {Object|string} params to append to the URL, can be either a string\n\t * or a map\n\t * @param {string} [url] URL to be used, otherwise the current URL will be used,\n\t * using the params as query string\n\t */\n\tpushState: function(params, url) {\n\t\treturn this._pushState(params, url, false);\n\t},\n\n\t/**\n\t * Push the current URL parameters to the history stack\n\t * and change the visible URL.\n\t * Note: this includes a workaround for IE8/IE9 that uses\n\t * the hash part instead of the search part.\n\t *\n\t * @param {Object|string} params to append to the URL, can be either a string\n\t * or a map\n\t * @param {string} [url] URL to be used, otherwise the current URL will be used,\n\t * using the params as query string\n\t */\n\treplaceState: function(params, url) {\n\t\treturn this._pushState(params, url, true);\n\t},\n\n\t/**\n\t * Add a popstate handler\n\t *\n\t * @param handler function\n\t */\n\taddOnPopStateHandler: function(handler) {\n\t\tthis._handlers.push(handler);\n\t},\n\n\t/**\n\t * Parse a query string from the hash part of the URL.\n\t * (workaround for IE8 / IE9)\n\t */\n\t_parseHashQuery: function() {\n\t\tvar hash = window.location.hash,\n\t\t\tpos = hash.indexOf('?');\n\t\tif (pos >= 0) {\n\t\t\treturn hash.substr(pos + 1);\n\t\t}\n\t\tif (hash.length) {\n\t\t\t// remove hash sign\n\t\t\treturn hash.substr(1);\n\t\t}\n\t\treturn '';\n\t},\n\n\t_decodeQuery: function(query) {\n\t\treturn query.replace(/\\+/g, ' ');\n\t},\n\n\t/**\n\t * Parse the query/search part of the URL.\n\t * Also try and parse it from the URL hash (for IE8)\n\t *\n\t * @return map of parameters\n\t */\n\tparseUrlQuery: function() {\n\t\tvar query = this._parseHashQuery(),\n\t\t\tparams;\n\t\t// try and parse from URL hash first\n\t\tif (query) {\n\t\t\tparams = OC.parseQueryString(this._decodeQuery(query));\n\t\t}\n\t\t// else read from query attributes\n\t\tparams = _.extend(params || {}, OC.parseQueryString(this._decodeQuery(location.search)));\n\t\treturn params || {};\n\t},\n\n\t_onPopState: function(e) {\n\t\tif (this._cancelPop) {\n\t\t\tthis._cancelPop = false;\n\t\t\treturn;\n\t\t}\n\t\tvar params;\n\t\tif (!this._handlers.length) {\n\t\t\treturn;\n\t\t}\n\t\tparams = (e && e.state);\n\t\tif (_.isString(params)) {\n\t\t\tparams = OC.parseQueryString(params);\n\t\t} else if (!params) {\n\t\t\tparams = this.parseUrlQuery() || {};\n\t\t}\n\t\tfor (var i = 0; i < this._handlers.length; i++) {\n\t\t\tthis._handlers[i](params);\n\t\t}\n\t}\n};\n\n// fallback to hashchange when no history support\nif (window.history.pushState) {\n\twindow.onpopstate = _.bind(OC.Util.History._onPopState, OC.Util.History);\n}\nelse {\n\t$(window).on('hashchange', _.bind(OC.Util.History._onPopState, OC.Util.History));\n}\n\n/**\n * Get a variable by name\n * @param {string} name\n * @return {*}\n */\nOC.get=function(name) {\n\tvar namespaces = name.split(\".\");\n\tvar tail = namespaces.pop();\n\tvar context=window;\n\n\tfor(var i = 0; i < namespaces.length; i++) {\n\t\tcontext = context[namespaces[i]];\n\t\tif(!context){\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn context[tail];\n};\n\n/**\n * Set a variable by name\n * @param {string} name\n * @param {*} value\n */\nOC.set=function(name, value) {\n\tvar namespaces = name.split(\".\");\n\tvar tail = namespaces.pop();\n\tvar context=window;\n\n\tfor(var i = 0; i < namespaces.length; i++) {\n\t\tif(!context[namespaces[i]]){\n\t\t\tcontext[namespaces[i]]={};\n\t\t}\n\t\tcontext = context[namespaces[i]];\n\t}\n\tcontext[tail]=value;\n};\n\n// fix device width on windows phone\n(function() {\n\tif (\"-ms-user-select\" in document.documentElement.style && navigator.userAgent.match(/IEMobile\\/10\\.0/)) {\n\t\tvar msViewportStyle = document.createElement(\"style\");\n\t\tmsViewportStyle.appendChild(\n\t\t\tdocument.createTextNode(\"@-ms-viewport{width:auto!important}\")\n\t\t);\n\t\tdocument.getElementsByTagName(\"head\")[0].appendChild(msViewportStyle);\n\t}\n})();\n\n/**\n * Namespace for apps\n * @namespace OCA\n */\nwindow.OCA = {};\n\n/**\n * select a range in an input field\n * @link http://stackoverflow.com/questions/499126/jquery-set-cursor-position-in-text-area\n * @param {type} start\n * @param {type} end\n */\njQuery.fn.selectRange = function(start, end) {\n\treturn this.each(function() {\n\t\tif (this.setSelectionRange) {\n\t\t\tthis.focus();\n\t\t\tthis.setSelectionRange(start, end);\n\t\t} else if (this.createTextRange) {\n\t\t\tvar range = this.createTextRange();\n\t\t\trange.collapse(true);\n\t\t\trange.moveEnd('character', end);\n\t\t\trange.moveStart('character', start);\n\t\t\trange.select();\n\t\t}\n\t});\n};\n\n/**\n * check if an element exists.\n * allows you to write if ($('#myid').exists()) to increase readability\n * @link http://stackoverflow.com/questions/31044/is-there-an-exists-function-for-jquery\n */\njQuery.fn.exists = function(){\n\treturn this.length > 0;\n};\n\n/**\n * jQuery tipsy shim for the bootstrap tooltip\n */\njQuery.fn.tipsy = function(argument) {\n\tconsole.warn('Deprecation warning: tipsy is deprecated. Use tooltip instead.');\n\tif(typeof argument === 'object' && argument !== null) {\n\n\t\t// tipsy defaults\n\t\tvar options = {\n\t\t\tplacement: 'bottom',\n\t\t\tdelay: { 'show': 0, 'hide': 0},\n\t\t\ttrigger: 'hover',\n\t\t\thtml: false,\n\t\t\tcontainer: 'body'\n\t\t};\n\t\tif(argument.gravity) {\n\t\t\tswitch(argument.gravity) {\n\t\t\t\tcase 'n':\n\t\t\t\tcase 'nw':\n\t\t\t\tcase 'ne':\n\t\t\t\t\toptions.placement='bottom';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 's':\n\t\t\t\tcase 'sw':\n\t\t\t\tcase 'se':\n\t\t\t\t\toptions.placement='top';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'w':\n\t\t\t\t\toptions.placement='right';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'e':\n\t\t\t\t\toptions.placement='left';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(argument.trigger) {\n\t\t\toptions.trigger = argument.trigger;\n\t\t}\n\t\tif(argument.delayIn) {\n\t\t\toptions.delay.show = argument.delayIn;\n\t\t}\n\t\tif(argument.delayOut) {\n\t\t\toptions.delay.hide = argument.delayOut;\n\t\t}\n\t\tif(argument.html) {\n\t\t\toptions.html = true;\n\t\t}\n\t\tif(argument.fallback) {\n\t\t\toptions.title = argument.fallback;\n\t\t}\n\t\t// destroy old tooltip in case the title has changed\n\t\tjQuery.fn.tooltip.call(this, 'destroy');\n\t\tjQuery.fn.tooltip.call(this, options);\n\t} else {\n\t\tthis.tooltip(argument);\n\t\tjQuery.fn.tooltip.call(this, argument);\n\t}\n\treturn this;\n};\n","/**\n * Copyright (c) 2014 Vincent Petry <pvince81@owncloud.com>\n *\n * This file is licensed under the Affero General Public License version 3\n * or later.\n *\n * See the COPYING-README file.\n *\n */\n\n/**\n * L10N namespace with localization functions.\n *\n * @namespace\n */\nOC.L10N = {\n\t/**\n\t * String bundles with app name as key.\n\t * @type {Object.<String,String>}\n\t */\n\t_bundles: {},\n\n\t/**\n\t * Plural functions, key is app name and value is function.\n\t * @type {Object.<String,Function>}\n\t */\n\t_pluralFunctions: {},\n\n\t/**\n\t * Load an app's translation bundle if not loaded already.\n\t *\n\t * @param {String} appName name of the app\n\t * @param {Function} callback callback to be called when\n\t * the translations are loaded\n\t * @return {Promise} promise\n\t */\n\tload: function(appName, callback) {\n\t\t// already available ?\n\t\tif (this._bundles[appName] || OC.getLocale() === 'en') {\n\t\t\tvar deferred = $.Deferred();\n\t\t\tvar promise = deferred.promise();\n\t\t\tpromise.then(callback);\n\t\t\tdeferred.resolve();\n\t\t\treturn promise;\n\t\t}\n\n\t\tvar self = this;\n\t\tvar url = OC.filePath(appName, 'l10n', OC.getLocale() + '.json');\n\n\t\t// load JSON translation bundle per AJAX\n\t\treturn $.get(url)\n\t\t\t.then(\n\t\t\t\tfunction(result) {\n\t\t\t\t\tif (result.translations) {\n\t\t\t\t\t\tself.register(appName, result.translations, result.pluralForm);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t.then(callback);\n\t},\n\n\t/**\n\t * Register an app's translation bundle.\n\t *\n\t * @param {String} appName name of the app\n\t * @param {Object<String,String>} bundle\n\t * @param {Function|String} [pluralForm] optional plural function or plural string\n\t */\n\tregister: function(appName, bundle, pluralForm) {\n\t\tvar self = this;\n\t\tif (_.isUndefined(this._bundles[appName])) {\n\t\t\tthis._bundles[appName] = bundle || {};\n\n\t\t\t// generate plural function based on form\n\t\t\tthis._pluralFunctions[appName] = this._getPlural;\n\t\t} else {\n\t\t\t// Theme overwriting the default language\n\t\t\t_.extend(self._bundles[appName], bundle);\n\t\t}\n\t},\n\n\t/**\n\t * Translate a string\n\t * @param {string} app the id of the app for which to translate the string\n\t * @param {string} text the string to translate\n\t * @param [vars] map of placeholder key to value\n\t * @param {number} [count] number to replace %n with\n\t * @param {array} [options] options array\n\t * @param {bool} [options.escape=true] enable/disable auto escape of placeholders (by default enabled)\n\t * @return {string}\n\t */\n\ttranslate: function(app, text, vars, count, options) {\n\t\tvar defaultOptions = {\n\t\t\t\tescape: true\n\t\t\t},\n\t\t\tallOptions = options || {};\n\t\t_.defaults(allOptions, defaultOptions);\n\n\t\t// TODO: cache this function to avoid inline recreation\n\t\t// of the same function over and over again in case\n\t\t// translate() is used in a loop\n\t\tvar _build = function (text, vars, count) {\n\t\t\treturn text.replace(/%n/g, count).replace(/{([^{}]*)}/g,\n\t\t\t\tfunction (a, b) {\n\t\t\t\t\tvar r = vars[b];\n\t\t\t\t\tif(typeof r === 'string' || typeof r === 'number') {\n\t\t\t\t\t\tif(allOptions.escape) {\n\t\t\t\t\t\t\treturn DOMPurify.sanitize(escapeHTML(r));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn DOMPurify.sanitize(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn DOMPurify.sanitize(a);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t};\n\t\tvar translation = text;\n\t\tvar bundle = this._bundles[app] || {};\n\t\tvar value = bundle[text];\n\t\tif( typeof(value) !== 'undefined' ){\n\t\t\ttranslation = value;\n\t\t}\n\n\t\tif(typeof vars === 'object' || count !== undefined ) {\n\t\t\treturn DOMPurify.sanitize(_build(translation, vars, count));\n\t\t} else {\n\t\t\treturn DOMPurify.sanitize(translation);\n\t\t}\n\t},\n\n\t/**\n\t * Translate a plural string\n\t * @param {string} app the id of the app for which to translate the string\n\t * @param {string} textSingular the string to translate for exactly one object\n\t * @param {string} textPlural the string to translate for n objects\n\t * @param {number} count number to determine whether to use singular or plural\n\t * @param [vars] map of placeholder key to value\n\t * @param {array} [options] options array\n\t * @param {bool} [options.escape=true] enable/disable auto escape of placeholders (by default enabled)\n\t * @return {string} Translated string\n\t */\n\ttranslatePlural: function(app, textSingular, textPlural, count, vars, options) {\n\t\tvar identifier = '_' + textSingular + '_::_' + textPlural + '_';\n\t\tvar bundle = this._bundles[app] || {};\n\t\tvar value = bundle[identifier];\n\t\tif( typeof(value) !== 'undefined' ){\n\t\t\tvar translation = value;\n\t\t\tif ($.isArray(translation)) {\n\t\t\t\tvar plural = this._pluralFunctions[app](count);\n\t\t\t\treturn this.translate(app, translation[plural], vars, count, options);\n\t\t\t}\n\t\t}\n\n\t\tif(count === 1) {\n\t\t\treturn this.translate(app, textSingular, vars, count, options);\n\t\t}\n\t\telse{\n\t\t\treturn this.translate(app, textPlural, vars, count, options);\n\t\t}\n\t},\n\n\t/**\n\t * The plural function taken from symfony\n\t *\n\t * @param {number} number\n\t * @returns {number}\n\t * @private\n\t */\n\t_getPlural: function(number) {\n\t\tvar locale = OC.getLocale();\n\t\tif ('pt_BR' === locale) {\n\t\t\t// temporary set a locale for brazilian\n\t\t\tlocale = 'xbr';\n\t\t}\n\n\t\tif (typeof locale === 'undefined') {\n\t\t\treturn (1 == number) ? 0 : 1;\n\t\t}\n\n\t\tif (locale.length > 3) {\n\t\t\tlocale = locale.substring(0, locale.lastIndexOf('_'));\n\t\t}\n\n\t\t/*\n\t\t * The plural rules are derived from code of the Zend Framework (2010-09-25),\n\t\t * which is subject to the new BSD license (http://framework.zend.com/license/new-bsd).\n\t\t * Copyright (c) 2005-2010 Zend Technologies USA Inc. (http://www.zend.com)\n\t\t */\n\t\tswitch (locale) {\n\t\t\tcase 'az':\n\t\t\tcase 'bo':\n\t\t\tcase 'dz':\n\t\t\tcase 'id':\n\t\t\tcase 'ja':\n\t\t\tcase 'jv':\n\t\t\tcase 'ka':\n\t\t\tcase 'km':\n\t\t\tcase 'kn':\n\t\t\tcase 'ko':\n\t\t\tcase 'ms':\n\t\t\tcase 'th':\n\t\t\tcase 'tr':\n\t\t\tcase 'vi':\n\t\t\tcase 'zh':\n\t\t\t\treturn 0;\n\n\t\t\tcase 'af':\n\t\t\tcase 'bn':\n\t\t\tcase 'bg':\n\t\t\tcase 'ca':\n\t\t\tcase 'da':\n\t\t\tcase 'de':\n\t\t\tcase 'el':\n\t\t\tcase 'en':\n\t\t\tcase 'eo':\n\t\t\tcase 'es':\n\t\t\tcase 'et':\n\t\t\tcase 'eu':\n\t\t\tcase 'fa':\n\t\t\tcase 'fi':\n\t\t\tcase 'fo':\n\t\t\tcase 'fur':\n\t\t\tcase 'fy':\n\t\t\tcase 'gl':\n\t\t\tcase 'gu':\n\t\t\tcase 'ha':\n\t\t\tcase 'he':\n\t\t\tcase 'hu':\n\t\t\tcase 'is':\n\t\t\tcase 'it':\n\t\t\tcase 'ku':\n\t\t\tcase 'lb':\n\t\t\tcase 'ml':\n\t\t\tcase 'mn':\n\t\t\tcase 'mr':\n\t\t\tcase 'nah':\n\t\t\tcase 'nb':\n\t\t\tcase 'ne':\n\t\t\tcase 'nl':\n\t\t\tcase 'nn':\n\t\t\tcase 'no':\n\t\t\tcase 'oc':\n\t\t\tcase 'om':\n\t\t\tcase 'or':\n\t\t\tcase 'pa':\n\t\t\tcase 'pap':\n\t\t\tcase 'ps':\n\t\t\tcase 'pt':\n\t\t\tcase 'so':\n\t\t\tcase 'sq':\n\t\t\tcase 'sv':\n\t\t\tcase 'sw':\n\t\t\tcase 'ta':\n\t\t\tcase 'te':\n\t\t\tcase 'tk':\n\t\t\tcase 'ur':\n\t\t\tcase 'zu':\n\t\t\t\treturn (1 == number) ? 0 : 1;\n\n\t\t\tcase 'am':\n\t\t\tcase 'bh':\n\t\t\tcase 'fil':\n\t\t\tcase 'fr':\n\t\t\tcase 'gun':\n\t\t\tcase 'hi':\n\t\t\tcase 'hy':\n\t\t\tcase 'ln':\n\t\t\tcase 'mg':\n\t\t\tcase 'nso':\n\t\t\tcase 'xbr':\n\t\t\tcase 'ti':\n\t\t\tcase 'wa':\n\t\t\t\treturn ((0 == number) || (1 == number)) ? 0 : 1;\n\n\t\t\tcase 'be':\n\t\t\tcase 'bs':\n\t\t\tcase 'hr':\n\t\t\tcase 'ru':\n\t\t\tcase 'sh':\n\t\t\tcase 'sr':\n\t\t\tcase 'uk':\n\t\t\t\treturn ((1 == number % 10) && (11 != number % 100)) ? 0 : (((number % 10 >= 2) && (number % 10 <= 4) && ((number % 100 < 10) || (number % 100 >= 20))) ? 1 : 2);\n\n\t\t\tcase 'cs':\n\t\t\tcase 'sk':\n\t\t\t\treturn (1 == number) ? 0 : (((number >= 2) && (number <= 4)) ? 1 : 2);\n\n\t\t\tcase 'ga':\n\t\t\t\treturn (1 == number) ? 0 : ((2 == number) ? 1 : 2);\n\n\t\t\tcase 'lt':\n\t\t\t\treturn ((1 == number % 10) && (11 != number % 100)) ? 0 : (((number % 10 >= 2) && ((number % 100 < 10) || (number % 100 >= 20))) ? 1 : 2);\n\n\t\t\tcase 'sl':\n\t\t\t\treturn (1 == number % 100) ? 0 : ((2 == number % 100) ? 1 : (((3 == number % 100) || (4 == number % 100)) ? 2 : 3));\n\n\t\t\tcase 'mk':\n\t\t\t\treturn (1 == number % 10) ? 0 : 1;\n\n\t\t\tcase 'mt':\n\t\t\t\treturn (1 == number) ? 0 : (((0 == number) || ((number % 100 > 1) && (number % 100 < 11))) ? 1 : (((number % 100 > 10) && (number % 100 < 20)) ? 2 : 3));\n\n\t\t\tcase 'lv':\n\t\t\t\treturn (0 == number) ? 0 : (((1 == number % 10) && (11 != number % 100)) ? 1 : 2);\n\n\t\t\tcase 'pl':\n\t\t\t\treturn (1 == number) ? 0 : (((number % 10 >= 2) && (number % 10 <= 4) && ((number % 100 < 12) || (number % 100 > 14))) ? 1 : 2);\n\n\t\t\tcase 'cy':\n\t\t\t\treturn (1 == number) ? 0 : ((2 == number) ? 1 : (((8 == number) || (11 == number)) ? 2 : 3));\n\n\t\t\tcase 'ro':\n\t\t\t\treturn (1 == number) ? 0 : (((0 == number) || ((number % 100 > 0) && (number % 100 < 20))) ? 1 : 2);\n\n\t\t\tcase 'ar':\n\t\t\t\treturn (0 == number) ? 0 : ((1 == number) ? 1 : ((2 == number) ? 2 : (((number % 100 >= 3) && (number % 100 <= 10)) ? 3 : (((number % 100 >= 11) && (number % 100 <= 99)) ? 4 : 5))));\n\n\t\t\tdefault:\n\t\t\t\treturn 0;\n\t\t}\n\t}\n};\n\n/**\n * translate a string\n * @param {string} app the id of the app for which to translate the string\n * @param {string} text the string to translate\n * @param [vars] map of placeholder key to value\n * @param {number} [count] number to replace %n with\n * @return {string}\n */\nwindow.t = _.bind(OC.L10N.translate, OC.L10N);\n\n/**\n * translate a string\n * @param {string} app the id of the app for which to translate the string\n * @param {string} text_singular the string to translate for exactly one object\n * @param {string} text_plural the string to translate for n objects\n * @param {number} count number to determine whether to use singular or plural\n * @param [vars] map of placeholder key to value\n * @return {string} Translated string\n */\nwindow.n = _.bind(OC.L10N.translatePlural, OC.L10N);\n\nHandlebars.registerHelper('t', function(app, text) {\n\treturn OC.L10N.translate(app, text);\n});\n\n","/**\n * jQuery plugin for micro templates\n *\n * Strings are automatically escaped, but that can be disabled by setting\n * escapeFunction to null.\n *\n * Usage examples:\n *\n *\tvar htmlStr = '<p>Bake, uncovered, until the {greasystuff} is melted and the {pasta} is heated through, about {min} minutes.</p>'\n *\t$(htmlStr).octemplate({greasystuff: 'cheese', pasta: 'macaroni', min: 10});\n *\n * \tvar htmlStr = '<p>Welcome back {user}</p>';\n *\t$(htmlStr).octemplate({user: 'John Q. Public'}, {escapeFunction: null});\n *\n * Be aware that the target string must be wrapped in an HTML element for the\n * plugin to work. The following won't work:\n * \n *      var textStr = 'Welcome back {user}';\n *      $(textStr).octemplate({user: 'John Q. Public'});\n *\n * For anything larger than one-liners, you can use a simple $.get() ajax\n * request to get the template, or you can embed them it the page using the\n * text/template type:\n *\n * <script id=\"contactListItemTemplate\" type=\"text/template\">\n *\t<tr class=\"contact\" data-id=\"{id}\">\n *\t\t<td class=\"name\">\n *\t\t\t<input type=\"checkbox\" name=\"id\" value=\"{id}\" /><span class=\"nametext\">{name}</span>\n *\t\t</td>\n *\t\t<td class=\"email\">\n *\t\t\t<a href=\"mailto:{email}\">{email}</a>\n *\t\t</td>\n *\t\t<td class=\"phone\">{phone}</td>\n *\t</tr>\n * </script>\n *\n * var $tmpl = $('#contactListItemTemplate');\n * var contacts = // fetched in some ajax call\n *\n * $.each(contacts, function(idx, contact) {\n * \t\t$contactList.append(\n * \t\t\t$tmpl.octemplate({\n * \t\t\t\tid: contact.getId(),\n * \t\t\t\tname: contact.getDisplayName(),\n * \t\t\t\temail: contact.getPreferredEmail(),\n * \t\t\t\tphone: contact.getPreferredPhone(),\n * \t\t\t});\n * \t\t);\n * });\n */\n(function( $ ) {\n\t/**\n\t* Object Template\n\t* Inspired by micro templating done by e.g. underscore.js\n\t*/\n\tvar Template = {\n\t\tinit: function(vars, options, elem) {\n\t\t\t// Mix in the passed in options with the default options\n\t\t\tthis.vars = vars;\n\t\t\tthis.options = $.extend({},this.options,options);\n\n\t\t\tthis.elem = elem;\n\t\t\tvar self = this;\n\n\t\t\tif(typeof this.options.escapeFunction === 'function') {\n\t\t\t\tvar keys = Object.keys(this.vars);\n\t\t\t\tfor (var key = 0; key < keys.length; key++) {\n\t\t\t\t\tif(typeof this.vars[keys[key]] === 'string') {\n\t\t\t\t\t\tthis.vars[keys[key]] = self.options.escapeFunction(this.vars[keys[key]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar _html = this._build(this.vars);\n\t\t\treturn $(_html);\n\t\t},\n\t\t// From stackoverflow.com/questions/1408289/best-way-to-do-variable-interpolation-in-javascript\n\t\t_build: function(o){\n\t\t\tvar data = this.elem.attr('type') === 'text/template' ? this.elem.html() : this.elem.get(0).outerHTML;\n\t\t\ttry {\n\t\t\t\treturn data.replace(/{([^{}]*)}/g,\n\t\t\t\t\tfunction (a, b) {\n\t\t\t\t\t\tvar r = o[b];\n\t\t\t\t\t\treturn typeof r === 'string' || typeof r === 'number' ? r : a;\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} catch(e) {\n\t\t\t\tconsole.error(e, 'data:', data);\n\t\t\t}\n\t\t},\n\t\toptions: {\n\t\t\tescapeFunction: escapeHTML\n\t\t}\n\t};\n\n\t$.fn.octemplate = function(vars, options) {\n\t\tvars = vars || {};\n\t\tif(this.length) {\n\t\t\tvar _template = Object.create(Template);\n\t\t\treturn _template.init(vars, options, this);\n\t\t}\n\t};\n\n})( jQuery );\n\n","/**\n * ownCloud\n *\n * @author Robin Appelman\n * @copyright 2012 Robin Appelman icewind1991@gmail.com\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * Wrapper for server side events\n * (http://en.wikipedia.org/wiki/Server-sent_events)\n * includes a fallback for older browsers and IE\n *\n * use server side events with caution, too many open requests can hang the\n * server\n */\n\n/* global EventSource */\n\n/**\n * Create a new event source\n * @param {string} src\n * @param {object} [data] to be send as GET\n *\n * @constructs OC.EventSource\n */\nOC.EventSource=function(src,data){\n\tvar dataStr='';\n\tvar name;\n\tvar joinChar;\n\tthis.typelessListeners=[];\n\tthis.closed = false;\n\tthis.listeners={};\n\tif(data){\n\t\tfor(name in data){\n\t\t\tdataStr+=name+'='+encodeURIComponent(data[name])+'&';\n\t\t}\n\t}\n\tdataStr+='requesttoken='+encodeURIComponent(oc_requesttoken);\n\tif(!this.useFallBack && typeof EventSource !== 'undefined'){\n\t\tjoinChar = '&';\n\t\tif(src.indexOf('?') === -1) {\n\t\t\tjoinChar = '?';\n\t\t}\n\t\tthis.source= new EventSource(src+joinChar+dataStr);\n\t\tthis.source.onmessage=function(e){\n\t\t\tfor(var i=0;i<this.typelessListeners.length;i++){\n\t\t\t\tthis.typelessListeners[i](JSON.parse(e.data));\n\t\t\t}\n\t\t}.bind(this);\n\t}else{\n\t\tvar iframeId='oc_eventsource_iframe_'+OC.EventSource.iframeCount;\n\t\tOC.EventSource.fallBackSources[OC.EventSource.iframeCount]=this;\n\t\tthis.iframe=$('<iframe/>');\n\t\tthis.iframe.attr('id',iframeId);\n\t\tthis.iframe.hide();\n\n\t\tjoinChar = '&';\n\t\tif(src.indexOf('?') === -1) {\n\t\t\tjoinChar = '?';\n\t\t}\n\t\tthis.iframe.attr('src',src+joinChar+'fallback=true&fallback_id='+OC.EventSource.iframeCount+'&'+dataStr);\n\t\t$('body').append(this.iframe);\n\t\tthis.useFallBack=true;\n\t\tOC.EventSource.iframeCount++;\n\t}\n\t//add close listener\n\tthis.listen('__internal__',function(data){\n\t\tif(data === 'close'){\n\t\t\tthis.close();\n\t\t}\n\t}.bind(this));\n};\nOC.EventSource.fallBackSources=[];\nOC.EventSource.iframeCount=0;//number of fallback iframes\nOC.EventSource.fallBackCallBack=function(id,type,data){\n\tOC.EventSource.fallBackSources[id].fallBackCallBack(type,data);\n};\nOC.EventSource.prototype={\n\ttypelessListeners:[],\n\tiframe:null,\n\tlisteners:{},//only for fallback\n\tuseFallBack:false,\n\t/**\n\t * Fallback callback for browsers that don't have the\n\t * native EventSource object.\n\t *\n\t * Calls the registered listeners.\n\t *\n\t * @private\n\t * @param {String} type event type\n\t * @param {Object} data received data\n\t */\n\tfallBackCallBack:function(type,data){\n\t\tvar i;\n\t\t// ignore messages that might appear after closing\n\t\tif (this.closed) {\n\t\t\treturn;\n\t\t}\n\t\tif(type){\n\t\t\tif (typeof this.listeners.done !== 'undefined') {\n\t\t\t\tfor(i=0;i<this.listeners[type].length;i++){\n\t\t\t\t\tthis.listeners[type][i](data);\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tfor(i=0;i<this.typelessListeners.length;i++){\n\t\t\t\tthis.typelessListeners[i](data);\n\t\t\t}\n\t\t}\n\t},\n\tlastLength:0,//for fallback\n\t/**\n\t * Listen to a given type of events.\n\t *\n\t * @param {String} type event type\n\t * @param {Function} callback event callback\n\t */\n\tlisten:function(type,callback){\n\t\tif(callback && callback.call){\n\n\t\t\tif(type){\n\t\t\t\tif(this.useFallBack){\n\t\t\t\t\tif(!this.listeners[type]){\n\t\t\t\t\t\tthis.listeners[type]=[];\n\t\t\t\t\t}\n\t\t\t\t\tthis.listeners[type].push(callback);\n\t\t\t\t}else{\n\t\t\t\t\tthis.source.addEventListener(type,function(e){\n\t\t\t\t\t\tif (typeof e.data !== 'undefined') {\n\t\t\t\t\t\t\tcallback(JSON.parse(e.data));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback('');\n\t\t\t\t\t\t}\n\t\t\t\t\t},false);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tthis.typelessListeners.push(callback);\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * Closes this event source.\n\t */\n\tclose:function(){\n\t\tthis.closed = true;\n\t\tif (typeof this.source !== 'undefined') {\n\t\t\tthis.source.close();\n\t\t}\n\t}\n};\n","/**\n * @copyright Copyright (c) 2016 Joas Schilling <coding@schilljs.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @namespace\n * @since 11.0.0\n */\nOCP.AppConfig = {\n\t/**\n\t * @param {string} method\n\t * @param {string} endpoint\n\t * @param {Object} [options]\n\t * @param {Object} [options.data]\n\t * @param {function} [options.success]\n\t * @param {function} [options.error]\n\t * @internal\n\t */\n\t_call: function(method, endpoint, options) {\n\t\tif ((method === 'post' || method === 'delete') && OC.PasswordConfirmation.requiresPasswordConfirmation()) {\n\t\t\tOC.PasswordConfirmation.requirePasswordConfirmation(_.bind(this._call, this, method, endpoint, options));\n\t\t\treturn;\n\t\t}\n\n\t\toptions = options || {};\n\t\t$.ajax({\n\t\t\ttype: method.toUpperCase(),\n\t\t\turl: OC.linkToOCS('apps/provisioning_api/api/v1', 2) + 'config/apps' + endpoint,\n\t\t\tdata: options.data || {},\n\t\t\tsuccess: options.success,\n\t\t\terror: options.error\n\t\t});\n\t},\n\n\t/**\n\t * @param {Object} [options]\n\t * @param {function} [options.success]\n\t * @since 11.0.0\n\t */\n\tgetApps: function(options) {\n\t\tthis._call('get', '', options);\n\t},\n\n\t/**\n\t * @param {string} app\n\t * @param {Object} [options]\n\t * @param {function} [options.success]\n\t * @param {function} [options.error]\n\t * @since 11.0.0\n\t */\n\tgetKeys: function(app, options) {\n\t\tthis._call('get', '/' + app, options);\n\t},\n\n\t/**\n\t * @param {string} app\n\t * @param {string} key\n\t * @param {string|function} defaultValue\n\t * @param {Object} [options]\n\t * @param {function} [options.success]\n\t * @param {function} [options.error]\n\t * @since 11.0.0\n\t */\n\tgetValue: function(app, key, defaultValue, options) {\n\t\toptions = options || {};\n\t\toptions.data = {\n\t\t\tdefaultValue: defaultValue\n\t\t};\n\n\t\tthis._call('get', '/' + app + '/' + key, options);\n\t},\n\n\t/**\n\t * @param {string} app\n\t * @param {string} key\n\t * @param {string} value\n\t * @param {Object} [options]\n\t * @param {function} [options.success]\n\t * @param {function} [options.error]\n\t * @since 11.0.0\n\t */\n\tsetValue: function(app, key, value, options) {\n\t\toptions = options || {};\n\t\toptions.data = {\n\t\t\tvalue: value\n\t\t};\n\n\t\tthis._call('post', '/' + app + '/' + key, options);\n\t},\n\n\t/**\n\t * @param {string} app\n\t * @param {string} key\n\t * @param {Object} [options]\n\t * @param {function} [options.success]\n\t * @param {function} [options.error]\n\t * @since 11.0.0\n\t */\n\tdeleteKey: function(app, key, options) {\n\t\tthis._call('delete', '/' + app + '/' + key, options);\n\t}\n};\n","/**\n * @copyright (c) 2017 Arthur Schiwon <blizzz@arthur-schiwon.de>\n *\n * @author Arthur Schiwon <blizzz@arthur-schiwon.de>\n *\n * This file is licensed under the Affero General Public License version 3 or\n * later. See the COPYING file.\n */\n\n(function(OCP) {\n\t\"use strict\";\n\n\tOCP.Comments = {\n\n\t\t/*\n\t\t * Detects links:\n\t\t * Either the http(s) protocol is given or two strings, basically limited to ascii with the last\n\t\t * \tword being at least one digit long,\n\t\t * followed by at least another character\n\t\t *\n\t\t * The downside: anything not ascii is excluded. Not sure how common it is in areas using different\n\t\t * alphabets the upside: fake domains with similar looking characters won't be formatted as links\n\t\t */\n\t\turlRegex: /(\\s|^)(https?:\\/\\/)?((?:[-A-Z0-9+_]+\\.)+[-A-Z]+(?:\\/[-A-Z0-9+&@#%?=~_|!:,.;()]*)*)(\\s|$)/ig,\n\n\t\tplainToRich: function(content) {\n\t\t\tcontent = this.formatLinksRich(content);\n\t\t\treturn content;\n\t\t},\n\n\t\trichToPlain: function(content) {\n\t\t\tcontent = this.formatLinksPlain(content);\n\t\t\treturn content;\n\t\t},\n\n\t\tformatLinksRich: function(content) {\n\t\t\treturn content.replace(this.urlRegex, function(_, leadingSpace, protocol, url, trailingSpace) {\n\t\t\t\tvar linkText = url;\n\t\t\t\tif(!protocol) {\n\t\t\t\t\tprotocol = 'https://';\n\t\t\t\t} else if (protocol === 'http://'){\n\t\t\t\t\tlinkText = protocol + url;\n\t\t\t\t}\n\n\t\t\t\treturn leadingSpace + '<a class=\"external\" target=\"_blank\" rel=\"noopener noreferrer\" href=\"' + protocol + url + '\">' + linkText + '</a>' + trailingSpace;\n\t\t\t});\n\t\t},\n\n\t\tformatLinksPlain: function(content) {\n\t\t\tvar $content = $('<div></div>').html(content);\n\t\t\t$content.find('a').each(function () {\n\t\t\t\tvar $this = $(this);\n\t\t\t\t$this.html($this.attr('href'));\n\t\t\t});\n\t\t\treturn $content.html();\n\t\t}\n\n\t};\n})(OCP);\n","/**\n * @copyright (c) 2017 Arthur Schiwon <blizzz@arthur-schiwon.de>\n *\n * @author Arthur Schiwon <blizzz@arthur-schiwon.de>\n *\n * This file is licensed under the Affero General Public License version 3 or\n * later. See the COPYING file.\n */\n\n(function(OCP) {\n\t\"use strict\";\n\n\tOCP.WhatsNew = {\n\n\t\tquery: function(options) {\n\t\t\toptions = options || {};\n\t\t\tvar dismissOptions = options.dismiss || {};\n\t\t\t$.ajax({\n\t\t\t\ttype: 'GET',\n\t\t\t\turl: options.url || OC.linkToOCS('core', 2) + 'whatsnew?format=json',\n\t\t\t\tsuccess: options.success || function(data, statusText, xhr) {\n\t\t\t\t\tOCP.WhatsNew._onQuerySuccess(data, statusText, xhr, dismissOptions);\n\t\t\t\t},\n\t\t\t\terror: options.error || this._onQueryError\n\t\t\t});\n\t\t},\n\n\t\tdismiss: function(version, options) {\n\t\t\toptions = options || {};\n\t\t\t$.ajax({\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: options.url || OC.linkToOCS('core', 2) + 'whatsnew',\n\t\t\t\tdata: {version: encodeURIComponent(version)},\n\t\t\t\tsuccess: options.success || this._onDismissSuccess,\n\t\t\t\terror: options.error || this._onDismissError\n\t\t\t});\n\t\t\t// remove element immediately\n\t\t\t$('.whatsNewPopover').remove();\n\t\t},\n\n\t\t_onQuerySuccess: function(data, statusText, xhr, dismissOptions) {\n\t\t\tconsole.debug('querying Whats New data was successful: ' + statusText);\n\t\t\tconsole.debug(data);\n\n\t\t\tif(xhr.status !== 200) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar item, menuItem, text, icon;\n\n\t\t\tvar div = document.createElement('div');\n\t\t\tdiv.classList.add('popovermenu', 'open', 'whatsNewPopover', 'menu-left');\n\n\t\t\tvar list = document.createElement('ul');\n\n\t\t\t// header\n\t\t\titem = document.createElement('li');\n\t\t\tmenuItem = document.createElement('span');\n\t\t\tmenuItem.className = \"menuitem\";\n\n\t\t\ttext = document.createElement('span');\n\t\t\ttext.innerText = t('core', 'New in') + ' ' + data['ocs']['data']['product'];\n\t\t\ttext.className = 'caption';\n\t\t\tmenuItem.appendChild(text);\n\n\t\t\ticon = document.createElement('span');\n\t\t\ticon.className = 'icon-close';\n\t\t\ticon.onclick = function () {\n\t\t\t\tOCP.WhatsNew.dismiss(data['ocs']['data']['version'], dismissOptions);\n\t\t\t};\n\t\t\tmenuItem.appendChild(icon);\n\n\t\t\titem.appendChild(menuItem);\n\t\t\tlist.appendChild(item);\n\n\t\t\t// Highlights\n\t\t\tfor (var i in data['ocs']['data']['whatsNew']['regular']) {\n\t\t\t\tvar whatsNewTextItem = data['ocs']['data']['whatsNew']['regular'][i];\n\t\t\t\titem = document.createElement('li');\n\n\t\t\t\tmenuItem = document.createElement('span');\n\t\t\t\tmenuItem.className = \"menuitem\";\n\n\t\t\t\ticon = document.createElement('span');\n\t\t\t\ticon.className = 'icon-checkmark';\n\t\t\t\tmenuItem.appendChild(icon);\n\n\t\t\t\ttext = document.createElement('p');\n\t\t\t\ttext.innerHTML = _.escape(whatsNewTextItem);\n\t\t\t\tmenuItem.appendChild(text);\n\n\t\t\t\titem.appendChild(menuItem);\n\t\t\t\tlist.appendChild(item);\n\t\t\t}\n\n\t\t\t// Changelog URL\n\t\t\tif(!_.isUndefined(data['ocs']['data']['changelogURL'])) {\n\t\t\t\titem = document.createElement('li');\n\n\t\t\t\tmenuItem = document.createElement('a');\n\t\t\t\tmenuItem.href = data['ocs']['data']['changelogURL'];\n\t\t\t\tmenuItem.rel = 'noreferrer noopener';\n\t\t\t\tmenuItem.target = '_blank';\n\n\t\t\t\ticon = document.createElement('span');\n\t\t\t\ticon.className = 'icon-link';\n\t\t\t\tmenuItem.appendChild(icon);\n\n\t\t\t\ttext = document.createElement('span');\n\t\t\t\ttext.innerText = t('core', 'View changelog');\n\t\t\t\tmenuItem.appendChild(text);\n\n\t\t\t\titem.appendChild(menuItem);\n\t\t\t\tlist.appendChild(item);\n\t\t\t}\n\n\t\t\tdiv.appendChild(list);\n\t\t\tdocument.body.appendChild(div);\n\t\t},\n\n\t\t_onQueryError: function (x, t, e) {\n\t\t\tconsole.debug('querying Whats New Data resulted in an error: ' + t + e);\n\t\t\tconsole.debug(x);\n\t\t},\n\n\t\t_onDismissSuccess: function(data) {\n\t\t\t//noop\n\t\t},\n\n\t\t_onDismissError: function (data) {\n\t\t\tconsole.debug('dismissing Whats New data resulted in an error: ' + data);\n\t\t}\n\t};\n})(OCP);\n","/**\n * @copyright Copyright (c) 2016 Joas Schilling <coding@schilljs.com>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/**\n * @namespace\n * @deprecated Use OCP.AppConfig instead\n */\nOC.AppConfig={\n\t/**\n\t * @deprecated Use OCP.AppConfig.getValue() instead\n\t */\n\tgetValue:function(app,key,defaultValue,callback){\n\t\tOCP.AppConfig.getValue(app, key, defaultValue, {\n\t\t\tsuccess: callback\n\t\t});\n\t},\n\n\t/**\n\t * @deprecated Use OCP.AppConfig.setValue() instead\n\t */\n\tsetValue:function(app,key,value){\n\t\tOCP.AppConfig.setValue(app, key, value);\n\t},\n\n\t/**\n\t * @deprecated Use OCP.AppConfig.getApps() instead\n\t */\n\tgetApps:function(callback){\n\t\tOCP.AppConfig.getApps({\n\t\t\tsuccess: callback\n\t\t});\n\t},\n\n\t/**\n\t * @deprecated Use OCP.AppConfig.getKeys() instead\n\t */\n\tgetKeys:function(app,callback){\n\t\tOCP.AppConfig.getKeys(app, {\n\t\t\tsuccess: callback\n\t\t});\n\t},\n\n\t/**\n\t * @deprecated Use OCP.AppConfig.deleteKey() instead\n\t */\n\tdeleteKey:function(app,key){\n\t\tOCP.AppConfig.deleteKey(app, key);\n\t}\n};\n","$(document).on('ajaxSend',function(elm, xhr, settings) {\n\tif(settings.crossDomain === false) {\n\t\txhr.setRequestHeader('requesttoken', oc_requesttoken);\n\t\txhr.setRequestHeader('OCS-APIREQUEST', 'true');\n\t}\n});\n","/**\n * ownCloud - core\n *\n * This file is licensed under the Affero General Public License version 3 or\n * later. See the COPYING file.\n *\n * @author Bernhard Posselt <dev@bernhard-posselt.com>\n * @copyright Bernhard Posselt 2014\n */\n\n(function (document, $, exports) {\n\n\t'use strict';\n\n\tvar dynamicSlideToggleEnabled = false;\n\n\texports.Apps = {\n\t\tenableDynamicSlideToggle: function () {\n\t\t\tdynamicSlideToggleEnabled = true;\n\t\t}\n\t};\n\n\t/**\n\t * Shows the #app-sidebar and add .with-app-sidebar to subsequent siblings\n\t *\n\t * @param {Object} [$el] sidebar element to show, defaults to $('#app-sidebar')\n\t */\n\texports.Apps.showAppSidebar = function($el) {\n\t\tvar $appSidebar = $el || $('#app-sidebar');\n\t\t$appSidebar.removeClass('disappear')\n\t\t\t.show('slide', { direction: 'right' }, 300);\n\t\t$('#app-content').trigger(new $.Event('appresized'));\n\t};\n\n\t/**\n\t * Shows the #app-sidebar and removes .with-app-sidebar from subsequent\n\t * siblings\n\t *\n\t * @param {Object} [$el] sidebar element to hide, defaults to $('#app-sidebar')\n\t */\n\texports.Apps.hideAppSidebar = function($el) {\n\t\tvar $appSidebar = $el || $('#app-sidebar');\n\t\t$appSidebar.hide('slide', { direction: 'right' }, 300,\n\t\t\tfunction() {\n\t\t\t\t$appSidebar.addClass('disappear');\n\t\t\t});\n\t\t$('#app-content').trigger(new $.Event('appresized'));\n\t};\n\n\t/**\n\t * Provides a way to slide down a target area through a button and slide it\n\t * up if the user clicks somewhere else. Used for the news app settings and\n\t * add new field.\n\t *\n\t * Usage:\n\t * <button data-apps-slide-toggle=\".slide-area\">slide</button>\n\t * <div class=\".slide-area\" class=\"hidden\">I'm sliding up</div>\n\t */\n\tvar registerAppsSlideToggle = function () {\n\t\tvar buttons = $('[data-apps-slide-toggle]');\n\n\t\tif (buttons.length === 0) {\n\t\t\t$('#app-navigation').addClass('without-app-settings');\n\t\t}\n\n\t\t$(document).click(function (event) {\n\n\t\t\tif (dynamicSlideToggleEnabled) {\n\t\t\t\tbuttons = $('[data-apps-slide-toggle]');\n\t\t\t}\n\n\t\t\tbuttons.each(function (index, button) {\n\n\t\t\t\tvar areaSelector = $(button).data('apps-slide-toggle');\n\t\t\t\tvar area = $(areaSelector);\n\n\t\t\t\tfunction hideArea() {\n\t\t\t\t\tarea.slideUp(OC.menuSpeed*4, function() {\n\t\t\t\t\t\tarea.trigger(new $.Event('hide'));\n\t\t\t\t\t});\n\t\t\t\t\tarea.removeClass('opened');\n\t\t\t\t\t$(button).removeClass('opened');\n\t\t\t\t}\n\t\t\t\tfunction showArea() {\n\t\t\t\t\tarea.slideDown(OC.menuSpeed*4, function() {\n\t\t\t\t\t\tarea.trigger(new $.Event('show'));\n\t\t\t\t\t});\n\t\t\t\t\tarea.addClass('opened');\n\t\t\t\t\t$(button).addClass('opened');\n\t\t\t\t\tvar input = $(areaSelector + ' [autofocus]');\n\t\t\t\t\tif (input.length === 1) {\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// do nothing if the area is animated\n\t\t\t\tif (!area.is(':animated')) {\n\n\t\t\t\t\t// button toggles the area\n\t\t\t\t\tif ($(button).is($(event.target).closest('[data-apps-slide-toggle]'))) {\n\t\t\t\t\t\tif (area.is(':visible')) {\n\t\t\t\t\t\t\thideArea();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tshowArea();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// all other areas that have not been clicked but are open\n\t\t\t\t\t// should be slid up\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar closest = $(event.target).closest(areaSelector);\n\t\t\t\t\t\tif (area.is(':visible') && closest[0] !== area[0]) {\n\t\t\t\t\t\t\thideArea();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t});\n\t};\n\n\n\t$(document).ready(function () {\n\t\tregisterAppsSlideToggle();\n\t});\n\n}(document, jQuery, OC));\n","/**\n * @author Roeland Jago Douma <roeland@famdouma.nl>\n *\n * @copyright Copyright (c) 2015, ownCloud, Inc.\n * @license AGPL-3.0\n *\n * This code is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License, version 3,\n * as published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License, version 3,\n * along with this program.  If not, see <http://www.gnu.org/licenses/>\n *\n */\n\n/**\n * Namespace to hold functions related to convert mimetype to icons\n *\n * @namespace\n */\nOC.MimeType = {\n\n\t/**\n\t * Cache that maps mimeTypes to icon urls\n\t */\n\t_mimeTypeIcons: {},\n\n\t/**\n\t * Return the file icon we want to use for the given mimeType.\n\t * The file needs to be present in the supplied file list\n\t *\n\t * @param {string} mimeType The mimeType we want an icon for\n\t * @param {array} files The available icons in this theme\n\t * @return {string} The icon to use or null if there is no match\n\t */\n\t_getFile: function(mimeType, files) {\n\t\tvar icon = mimeType.replace(new RegExp('/', 'g'), '-');\n\n\t\t// Generate path\n\t\tif (mimeType === 'dir' && $.inArray('folder', files) !== -1) {\n\t\t\treturn 'folder';\n\t\t} else if (mimeType === 'dir-encrypted' && $.inArray('folder-encrypted', files) !== -1) {\n\t\t\treturn 'folder-encrypted';\n\t\t} else if (mimeType === 'dir-shared' && $.inArray('folder-shared', files) !== -1) {\n\t\t\treturn 'folder-shared';\n\t\t} else if (mimeType === 'dir-public' && $.inArray('folder-public', files) !== -1) {\n\t\t\treturn 'folder-public';\n\t\t} else if (mimeType === 'dir-external' && $.inArray('folder-external', files) !== -1) {\n\t\t\treturn 'folder-external';\n\t\t} else if ($.inArray(icon, files) !== -1) {\n\t\t\treturn icon;\n\t\t} else if ($.inArray(icon.split('-')[0], files) !== -1) {\n\t\t\treturn icon.split('-')[0];\n\t\t} else if ($.inArray('file', files) !== -1) {\n\t\t\treturn 'file';\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Return the url to icon of the given mimeType\n\t *\n\t * @param {string} mimeType The mimeType to get the icon for\n\t * @return {string} Url to the icon for mimeType\n\t */\n\tgetIconUrl: function(mimeType) {\n\t\tif (_.isUndefined(mimeType)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\twhile (mimeType in OC.MimeTypeList.aliases) {\n\t\t\tmimeType = OC.MimeTypeList.aliases[mimeType];\n\t\t}\n\t\tif (mimeType in OC.MimeType._mimeTypeIcons) {\n\t\t\treturn OC.MimeType._mimeTypeIcons[mimeType];\n\t\t}\n\n\t\t// First try to get the correct icon from the current theme\n\t\tvar gotIcon = null;\n\t\tvar path = '';\n\t\tif (OC.theme.folder !== '' && $.isArray(OC.MimeTypeList.themes[OC.theme.folder])) {\n\t\t\tpath = OC.getRootPath() + '/themes/' + OC.theme.folder + '/core/img/filetypes/';\n\t\t\tvar icon = OC.MimeType._getFile(mimeType, OC.MimeTypeList.themes[OC.theme.folder]);\n\n\t\t\tif (icon !== null) {\n\t\t\t\tgotIcon = true;\n\t\t\t\tpath += icon;\n\t\t\t}\n\t\t}\n\t\tif(OCA.Theming && gotIcon === null) {\n\t\t\tpath = OC.generateUrl('/apps/theming/img/core/filetypes/');\n\t\t\tpath += OC.MimeType._getFile(mimeType, OC.MimeTypeList.files);\n\t\t\tgotIcon = true;\n\t\t}\n\n\t\t// If we do not yet have an icon fall back to the default\n\t\tif (gotIcon === null) {\n\t\t\tpath = OC.getRootPath() + '/core/img/filetypes/';\n\t\t\tpath += OC.MimeType._getFile(mimeType, OC.MimeTypeList.files);\n\t\t}\n\n\t\tpath += '.svg';\n\n\t\tif(OCA.Theming) {\n\t\t\tpath += \"?v=\" + OCA.Theming.cacheBuster;\n\t\t}\n\n\t\t// Cache the result\n\t\tOC.MimeType._mimeTypeIcons[mimeType] = path;\n\t\treturn path;\n\t}\n\n};\n","/**\n* This file is automatically generated\n* DO NOT EDIT MANUALLY!\n*\n* You can update the list of MimeType Aliases in config/mimetypealiases.json\n* The list of files is fetched from core/img/filetypes\n* To regenerate this file run ./occ maintenance:mimetype:update-js\n*/\nOC.MimeTypeList={\n\taliases: {\n    \"application/coreldraw\": \"image\",\n    \"application/epub+zip\": \"text\",\n    \"application/font-sfnt\": \"image\",\n    \"application/font-woff\": \"image\",\n    \"application/gpx+xml\": \"location\",\n    \"application/illustrator\": \"image\",\n    \"application/javascript\": \"text/code\",\n    \"application/json\": \"text/code\",\n    \"application/msaccess\": \"file\",\n    \"application/msexcel\": \"x-office/spreadsheet\",\n    \"application/msonenote\": \"x-office/document\",\n    \"application/mspowerpoint\": \"x-office/presentation\",\n    \"application/msword\": \"x-office/document\",\n    \"application/octet-stream\": \"file\",\n    \"application/postscript\": \"image\",\n    \"application/rss+xml\": \"application/xml\",\n    \"application/vnd.android.package-archive\": \"package/x-generic\",\n    \"application/vnd.lotus-wordpro\": \"x-office/document\",\n    \"application/vnd.garmin.tcx+xml\": \"location\",\n    \"application/vnd.google-earth.kml+xml\": \"location\",\n    \"application/vnd.google-earth.kmz\": \"location\",\n    \"application/vnd.ms-excel\": \"x-office/spreadsheet\",\n    \"application/vnd.ms-excel.addin.macroEnabled.12\": \"x-office/spreadsheet\",\n    \"application/vnd.ms-excel.sheet.binary.macroEnabled.12\": \"x-office/spreadsheet\",\n    \"application/vnd.ms-excel.sheet.macroEnabled.12\": \"x-office/spreadsheet\",\n    \"application/vnd.ms-excel.template.macroEnabled.12\": \"x-office/spreadsheet\",\n    \"application/vnd.ms-fontobject\": \"image\",\n    \"application/vnd.ms-powerpoint\": \"x-office/presentation\",\n    \"application/vnd.ms-powerpoint.addin.macroEnabled.12\": \"x-office/presentation\",\n    \"application/vnd.ms-powerpoint.presentation.macroEnabled.12\": \"x-office/presentation\",\n    \"application/vnd.ms-powerpoint.slideshow.macroEnabled.12\": \"x-office/presentation\",\n    \"application/vnd.ms-powerpoint.template.macroEnabled.12\": \"x-office/presentation\",\n    \"application/vnd.ms-visio.drawing.macroEnabled.12\": \"application/vnd.visio\",\n    \"application/vnd.ms-visio.drawing\": \"application/vnd.visio\",\n    \"application/vnd.ms-visio.stencil.macroEnabled.12\": \"application/vnd.visio\",\n    \"application/vnd.ms-visio.stencil\": \"application/vnd.visio\",\n    \"application/vnd.ms-visio.template.macroEnabled.12\": \"application/vnd.visio\",\n    \"application/vnd.ms-visio.template\": \"application/vnd.visio\",\n    \"application/vnd.ms-word.document.macroEnabled.12\": \"x-office/document\",\n    \"application/vnd.ms-word.template.macroEnabled.12\": \"x-office/document\",\n    \"application/vnd.oasis.opendocument.presentation\": \"x-office/presentation\",\n    \"application/vnd.oasis.opendocument.presentation-template\": \"x-office/presentation\",\n    \"application/vnd.oasis.opendocument.spreadsheet\": \"x-office/spreadsheet\",\n    \"application/vnd.oasis.opendocument.spreadsheet-template\": \"x-office/spreadsheet\",\n    \"application/vnd.oasis.opendocument.text\": \"x-office/document\",\n    \"application/vnd.oasis.opendocument.text-master\": \"x-office/document\",\n    \"application/vnd.oasis.opendocument.text-template\": \"x-office/document\",\n    \"application/vnd.oasis.opendocument.text-web\": \"x-office/document\",\n    \"application/vnd.openxmlformats-officedocument.presentationml.presentation\": \"x-office/presentation\",\n    \"application/vnd.openxmlformats-officedocument.presentationml.slideshow\": \"x-office/presentation\",\n    \"application/vnd.openxmlformats-officedocument.presentationml.template\": \"x-office/presentation\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\": \"x-office/spreadsheet\",\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.template\": \"x-office/spreadsheet\",\n    \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\": \"x-office/document\",\n    \"application/vnd.openxmlformats-officedocument.wordprocessingml.template\": \"x-office/document\",\n    \"application/vnd.visio\": \"x-office/document\",\n    \"application/vnd.wordperfect\": \"x-office/document\",\n    \"application/x-7z-compressed\": \"package/x-generic\",\n    \"application/x-bzip2\": \"package/x-generic\",\n    \"application/x-cbr\": \"text\",\n    \"application/x-compressed\": \"package/x-generic\",\n    \"application/x-dcraw\": \"image\",\n    \"application/x-deb\": \"package/x-generic\",\n    \"application/x-fictionbook+xml\": \"text\",\n    \"application/x-font\": \"image\",\n    \"application/x-gimp\": \"image\",\n    \"application/x-gzip\": \"package/x-generic\",\n    \"application/x-iwork-keynote-sffkey\": \"x-office/presentation\",\n    \"application/x-iwork-numbers-sffnumbers\": \"x-office/spreadsheet\",\n    \"application/x-iwork-pages-sffpages\": \"x-office/document\",\n    \"application/x-mobipocket-ebook\": \"text\",\n    \"application/x-perl\": \"text/code\",\n    \"application/x-photoshop\": \"image\",\n    \"application/x-php\": \"text/code\",\n    \"application/x-rar-compressed\": \"package/x-generic\",\n    \"application/x-tar\": \"package/x-generic\",\n    \"application/x-tex\": \"text\",\n    \"application/xml\": \"text/html\",\n    \"application/yaml\": \"text/code\",\n    \"application/zip\": \"package/x-generic\",\n    \"database\": \"file\",\n    \"httpd/unix-directory\": \"dir\",\n    \"text/css\": \"text/code\",\n    \"text/csv\": \"x-office/spreadsheet\",\n    \"text/html\": \"text/code\",\n    \"text/x-c\": \"text/code\",\n    \"text/x-c++src\": \"text/code\",\n    \"text/x-h\": \"text/code\",\n    \"text/x-java-source\": \"text/code\",\n    \"text/x-ldif\": \"text/code\",\n    \"text/x-python\": \"text/code\",\n    \"text/x-shellscript\": \"text/code\",\n    \"web\": \"text/code\",\n    \"application/internet-shortcut\": \"link\"\n},\n\tfiles: [\n    \"application\",\n    \"application-pdf\",\n    \"audio\",\n    \"file\",\n    \"folder\",\n    \"folder-drag-accept\",\n    \"folder-encrypted\",\n    \"folder-external\",\n    \"folder-public\",\n    \"folder-shared\",\n    \"folder-starred\",\n    \"image\",\n    \"link\",\n    \"location\",\n    \"package-x-generic\",\n    \"text\",\n    \"text-calendar\",\n    \"text-code\",\n    \"text-vcard\",\n    \"video\",\n    \"x-office-document\",\n    \"x-office-presentation\",\n    \"x-office-spreadsheet\"\n],\n\tthemes: []\n};\n","/*\n * Copyright (c) 2015\n *\n * This file is licensed under the Affero General Public License version 3\n * or later.\n *\n * See the COPYING-README file.\n *\n */\n\n/* global Backbone */\nif(!_.isUndefined(Backbone)) {\n\tOC.Backbone = Backbone.noConflict();\n}\n","/*\n * Copyright (c) 2015\n *\n * This file is licensed under the Affero General Public License version 3\n * or later.\n *\n * See the COPYING-README file.\n *\n */\n\n/* global Select2 */\n\n/**\n * Select2 extension for toggling values in a multi-select dropdown\n */\n(function(Select2) {\n\n\tvar Select2FindHighlightableChoices = Select2.class.multi.prototype.findHighlightableChoices;\n\tSelect2.class.multi.prototype.findHighlightableChoices = function () {\n\t\tif (this.opts.toggleSelect) {\n\t\t\treturn this.results.find('.select2-result-selectable:not(.select2-disabled)');\n\t\t}\n\t\treturn Select2FindHighlightableChoices.apply(this, arguments);\n\t};\n\n\tvar Select2TriggerSelect = Select2.class.multi.prototype.triggerSelect;\n\tSelect2.class.multi.prototype.triggerSelect = function (data) {\n\t\tif (this.opts.toggleSelect && this.val().indexOf(this.id(data)) !== -1) {\n\t\t\tvar self = this;\n\t\t\tvar val = this.id(data);\n\n\t\t\tvar selectionEls = this.container.find('.select2-search-choice').filter(function() {\n\t\t\t\treturn (self.id($(this).data('select2-data')) === val);\n\t\t\t});\n\n\t\t\tif (this.unselect(selectionEls)) {\n\t\t\t\t// also unselect in dropdown\n\t\t\t\tthis.results.find('.select2-result.select2-selected').each(function () {\n\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\tif (self.id($this.data('select2-data')) === val) {\n\t\t\t\t\t\t$this.removeClass('select2-selected');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.clearSearch();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn Select2TriggerSelect.apply(this, arguments);\n\t\t}\n\t};\n\n})(Select2);\n\n","/**\n * ownCloud\n *\n * @author John Molakvo\n * @copyright 2016-2018 John Molakvo <skjnldsv@protonmail.com>\n * @author Morris Jobke\n * @copyright 2013 Morris Jobke <morris.jobke@gmail.com>\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License along with this library.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n/*\n * Adds a background color to the element called on and adds the first character\n * of the passed in string. This string is also the seed for the generation of\n * the background color.\n *\n * You have following HTML:\n *\n * <div id=\"albumart\"></div>\n *\n * And call this from Javascript:\n *\n * $('#albumart').imageplaceholder('The Album Title');\n *\n * Which will result in:\n *\n * <div id=\"albumart\" style=\"background-color: rgb(121, 90, 171); ... \">T</div>\n *\n * You may also call it like this, to have a different background, than the seed:\n *\n * $('#albumart').imageplaceholder('The Album Title', 'Album Title');\n *\n * Resulting in:\n *\n * <div id=\"albumart\" style=\"background-color: rgb(121, 90, 171); ... \">A</div>\n *\n */\n\n /*\n * Alternatively, you can use the prototype function to convert your string to rgb colors:\n *\n * \"a6741a86aded5611a8e46ce16f2ad646\".toRgb()\n *\n * Will return the rgb parameters within the following object:\n *\n * Color{r: 208, g: 158, b: 109}\n *\n */\n\n(function ($) {\n\n\tString.prototype.toRgb = function() {\n\t\t// Normalize hash\t\t\n\t\tvar hash = this.toLowerCase();\n\n\t\t// Already a md5 hash?\n\t\tif( hash.match(/^([0-9a-f]{4}-?){8}$/) === null ) {\n\t\t\thash = md5(hash);\n\t\t}\n\n\t\thash = hash.replace(/[^0-9a-f]/g, '');\n\n\t\tfunction Color(r,g,b) {\n\t\t\tthis.r = r;\n\t\t\tthis.g = g;\n\t\t\tthis.b = b;\n\t\t}\n\n\t\tfunction stepCalc(steps, ends) {\n\t\t\tvar step = new Array(3);\n\t\t\tstep[0] = (ends[1].r - ends[0].r) / steps;\n\t\t\tstep[1] = (ends[1].g - ends[0].g) / steps;\n\t\t\tstep[2] = (ends[1].b - ends[0].b) / steps;\n\t\t\treturn step;\n\t\t}\n\n\t\tfunction mixPalette(steps, color1, color2) {\n\t\t\tvar count = steps + 1;\n\t\t\tvar palette = new Array();\n\t\t\tpalette.push(color1);\n\t\t\tvar step = stepCalc(steps, [color1, color2])\n\t\t\tfor (var i = 1; i < steps; i++) {\n\t\t\t\tvar r = parseInt(color1.r + (step[0] * i));\n\t\t\t\tvar g = parseInt(color1.g + (step[1] * i));\n\t\t\t\tvar b = parseInt(color1.b + (step[2] * i));\n\t\t\t\t\tpalette.push(new Color(r,g,b));\n\t\t\t}\n\t\t\treturn palette;\n\t\t}\n\n\t\tvar red = new Color(182, 70, 157);\n\t\tvar yellow = new Color(221, 203, 85);\n\t\tvar blue = new Color(0, 130, 201); // Nextcloud blue\n\t\t// Number of steps to go from a color to another\n\t\t// 3 colors * 6 will result in 18 generated colors\n\t\tvar steps = 6;\n\n\t\tvar palette1 = mixPalette(steps, red, yellow);\n\t\tvar palette2 = mixPalette(steps, yellow, blue);\n\t\tvar palette3 = mixPalette(steps, blue, red);\n\n\t\tvar finalPalette = palette1.concat(palette2).concat(palette3);\n\n\t\t// Convert a string to an integer evenly\n\t\tfunction hashToInt(hash, maximum) {\n\t\t\tvar finalInt = 0;\n\t\t\tvar result = Array();\n\n\t\t\t// Splitting evenly the string\n\t\t\tfor (var i=0; i<hash.length; i++) {\n\t\t\t\t// chars in md5 goes up to f, hex:16\n\t\t\t\tresult.push(parseInt(hash.charAt(i), 16) % 16);\n\t\t\t}\n\t\t\t// Adds up all results\n\t\t\tfor (var j in result) {\n\t\t\t\tfinalInt += result[j];\n\t\t\t}\n\t\t\t// chars in md5 goes up to f, hex:16\n\t\t\t// make sure we're always using int in our operation\n\t\t\treturn parseInt(parseInt(finalInt) % maximum);\n\t\t}\n\t\treturn finalPalette[hashToInt(hash, steps * 3 )];\n\t};\n\n\t$.fn.imageplaceholder = function(seed, text, size) {\n\t\ttext = text || seed;\n\n\t\t// Compute the hash\n\t\tvar rgb = seed.toRgb();\n\t\tthis.css('background-color', 'rgb('+rgb.r+', '+rgb.g+', '+rgb.b+')');\n\n\t\t// Placeholders are square\n\t\tvar height = this.height() || size || 32;\n\t\tthis.height(height);\n\t\tthis.width(height);\n\n\t\t// CSS rules\n\t\tthis.css('color', '#fff');\n\t\tthis.css('font-weight', 'normal');\n\t\tthis.css('text-align', 'center');\n\n\t\t// calculate the height\n\t\tthis.css('line-height', height + 'px');\n\t\tthis.css('font-size', (height * 0.55) + 'px');\n\n\t\tif(seed !== null && seed.length) {\n\t\t\tthis.html(text[0].toUpperCase());\n\t\t}\n\t};\n\n\t$.fn.clearimageplaceholder = function() {\n\t\tthis.css('background-color', '');\n\t\tthis.css('color', '');\n\t\tthis.css('font-weight', '');\n\t\tthis.css('text-align', '');\n\t\tthis.css('line-height', '');\n\t\tthis.css('font-size', '');\n\t\tthis.html('');\n\t\tthis.removeClass('icon-loading');\n\t\tthis.removeClass('icon-loading-small');\n\t};\n}(jQuery));\n","/**\n * Copyright (c) 2013 Christopher Schpers <christopher@schaepers.it>\n * This file is licensed under the Affero General Public License version 3 or\n * later.\n * See the COPYING-README file.\n */\n\n/**\n * This plugin inserts the right avatar for the user, depending on, whether a\n * custom avatar is uploaded - which it uses then - or not, and display a\n * placeholder with the first letter of the users name instead.\n * For this it queries the core_avatar_get route, thus this plugin is fit very\n * tightly for owncloud, and it may not work anywhere else.\n *\n * You may use this on any <div></div>\n * Here I'm using <div class=\"avatardiv\"></div> as an example.\n *\n * There are 5 ways to call this:\n *\n * 1. $('.avatardiv').avatar('jdoe', 128);\n * This will make the div to jdoe's fitting avatar, with a size of 128px.\n *\n * 2. $('.avatardiv').avatar('jdoe');\n * This will make the div to jdoe's fitting avatar. If the div already has a\n * height, it will be used for the avatars size. Otherwise this plugin will\n * search for 'size' DOM data, to use for avatar size. If neither are available\n * it will default to 64px.\n *\n * 3. $('.avatardiv').avatar();\n * This will search the DOM for 'user' data, to use as the username. If there\n * is no username available it will default to a placeholder with the value of\n * \"?\". The size will be determined the same way, as the second example.\n *\n * 4. $('.avatardiv').avatar('jdoe', 128, true);\n * This will behave like the first example, except it will also append random\n * hashes to the custom avatar images, to force image reloading in IE8.\n *\n * 5. $('.avatardiv').avatar('jdoe', 128, undefined, true);\n * This will behave like the first example, but it will hide the avatardiv, if\n * it will display the default placeholder. undefined is the ie8fix from\n * example 4 and can be either true, or false/undefined, to be ignored.\n *\n * 6. $('.avatardiv').avatar('jdoe', 128, undefined, true, callback);\n * This will behave like the above example, but it will call the function\n * defined in callback after the avatar is placed into the DOM.\n *\n */\n\n(function ($) {\n\t$.fn.avatar = function(user, size, ie8fix, hidedefault, callback, displayname) {\n\t\tvar setAvatarForUnknownUser = function(target) {\n\t\t\ttarget.imageplaceholder('?');\n\t\t\ttarget.css('background-color', '#b9b9b9');\n\t\t};\n\n\t\tif (typeof(user) !== 'undefined') {\n\t\t\tuser = String(user);\n\t\t}\n\t\tif (typeof(displayname) !== 'undefined') {\n\t\t\tdisplayname = String(displayname);\n\t\t}\n\n\t\tif (typeof(size) === 'undefined') {\n\t\t\tif (this.height() > 0) {\n\t\t\t\tsize = this.height();\n\t\t\t} else if (this.data('size') > 0) {\n\t\t\t\tsize = this.data('size');\n\t\t\t} else {\n\t\t\t\tsize = 64;\n\t\t\t}\n\t\t}\n\n\t\tthis.height(size);\n\t\tthis.width(size);\n\n\t\tif (typeof(user) === 'undefined') {\n\t\t\tif (typeof(this.data('user')) !== 'undefined') {\n\t\t\t\tuser = this.data('user');\n\t\t\t} else {\n\t\t\t\tsetAvatarForUnknownUser(this);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// sanitize\n\t\tuser = String(user).replace(/\\//g,'');\n\n\t\tvar $div = this;\n\t\tvar url;\n\n\t\t// If this is our own avatar we have to use the version attribute\n\t\tif (user === OC.getCurrentUser().uid) {\n\t\t\turl = OC.generateUrl(\n\t\t\t\t'/avatar/{user}/{size}?v={version}',\n\t\t\t\t{\n\t\t\t\t\tuser: user,\n\t\t\t\t\tsize: Math.ceil(size * window.devicePixelRatio),\n\t\t\t\t\tversion: oc_userconfig.avatar.version\n\t\t\t\t});\n\t\t} else {\n\t\t\turl = OC.generateUrl(\n\t\t\t\t'/avatar/{user}/{size}',\n\t\t\t\t{\n\t\t\t\t\tuser: user,\n\t\t\t\t\tsize: Math.ceil(size * window.devicePixelRatio)\n\t\t\t\t});\n\t\t}\n\n\t\tvar img = new Image();\n\n\t\t// If the new image loads successfully set it.\n\t\timg.onload = function() {\n\t\t\t$div.clearimageplaceholder();\n\t\t\t$div.append(img);\n\n\t\t\tif(typeof callback === 'function') {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t};\n\t\t// Fallback when avatar loading fails:\n\t\t// Use old placeholder when a displayname attribute is defined,\n\t\t// otherwise show the unknown user placeholder.\n\t\timg.onerror = function () {\n\t\t\t$div.clearimageplaceholder();\n\t\t\tif (typeof(displayname) !== 'undefined') {\n\t\t\t\t$div.imageplaceholder(user, displayname);\n\t\t\t} else {\n\t\t\t\tsetAvatarForUnknownUser($div);\n\t\t\t}\n\n\t\t\tif(typeof callback === 'function') {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t};\n\n\t\tif (size < 32) {\n\t\t\t$div.addClass('icon-loading-small');\n\t\t} else {\n\t\t\t$div.addClass('icon-loading');\n\t\t}\n\t\timg.width = size;\n\t\timg.height = size;\n\t\timg.src = url;\n\t\timg.alt = '';\n\t};\n}(jQuery));\n","/**\n * Copyright (c) 2017 Georg Ehrke <oc.list@georgehrke.com>\n * This file is licensed under the Affero General Public License version 3 or\n * later.\n * See the COPYING-README file.\n */\n\n(function ($) {\n\n\tvar LIST = ''\n\t\t+ '<div class=\"menu popovermenu menu-left hidden contactsmenu-popover\">'\n\t\t+ '    <ul>'\n\t\t+ '        <li>'\n\t\t+ '            <a>'\n\t\t+ '                <span class=\"icon-loading-small\"></span>'\n\t\t+ '            </a>'\n\t\t+ '        </li>'\n\t\t+ '    </ul>'\n\t\t+ '</div>';\n\n\t$.fn.contactsMenu = function(shareWith, shareType, appendTo) {\n\t\t// 0 - user, 4 - email, 6 - remote\n\t\tvar allowedTypes = [0, 4, 6];\n\t\tif (allowedTypes.indexOf(shareType) === -1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $div = this;\n\t\tappendTo.append(LIST);\n\t\tvar $list = appendTo.find('div.contactsmenu-popover');\n\n\t\t$div.click(function() {\n\t\t\tif (!$list.hasClass('hidden')) {\n\t\t\t\t$list.addClass('hidden');\n\t\t\t\t$list.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$list.removeClass('hidden');\n\t\t\t$list.show();\n\n\t\t\tif ($list.hasClass('loaded')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$list.addClass('loaded');\n\t\t\t$.ajax(OC.generateUrl('/contactsmenu/findOne'), {\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\tshareType: shareType,\n\t\t\t\t\tshareWith: shareWith\n\t\t\t\t}\n\t\t\t}).then(function(data) {\n\t\t\t\t$list.find('ul').find('li').addClass('hidden');\n\n\t\t\t\tvar actions;\n\t\t\t\tif (!data.topAction) {\n\t\t\t\t\tactions = [{\n\t\t\t\t\t\thyperlink: '#',\n\t\t\t\t\t\ttitle: t('core', 'No action available')\n\t\t\t\t\t}];\n\t\t\t\t} else {\n\t\t\t\t\tactions = [data.topAction].concat(data.actions);\n\t\t\t\t}\n\n\t\t\t\tactions.forEach(function(action) {\n\t\t\t\t\tvar template = OC.ContactsMenu.Templates['jquery_entry'];\n\t\t\t\t\t$list.find('ul').append(template(action));\n\t\t\t\t});\n\n\t\t\t\tif (actions.length === 0) {\n\n\t\t\t\t}\n\t\t\t}, function(jqXHR) {\n\t\t\t\t$list.find('ul').find('li').addClass('hidden');\n\n\t\t\t\tvar title;\n\t\t\t\tif (jqXHR.status === 404) {\n\t\t\t\t\ttitle = t('core', 'No action available');\n\t\t\t\t} else {\n\t\t\t\t\ttitle = t('core', 'Error fetching contact actions');\n\t\t\t\t}\n\n\t\t\t\tvar template = OC.ContactsMenu.Templates['jquery_entry'];\n\t\t\t\t$list.find('ul').append(template({\n\t\t\t\t\thyperlink: '#',\n\t\t\t\t\ttitle: title\n\t\t\t\t}));\n\t\t\t});\n\t\t});\n\n\t\t$(document).click(function(event) {\n\t\t\tvar clickedList = ($list.has(event.target).length > 0);\n\t\t\tvar clickedTarget = ($div.has(event.target).length > 0);\n\n\t\t\t$div.each(function() {\n\t\t\t\tif ($(this).is(event.target)) {\n\t\t\t\t\tclickedTarget = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (clickedList || clickedTarget) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$list.addClass('hidden');\n\t\t\t$list.hide();\n\t\t});\n\t};\n}(jQuery));\n"],"sourceRoot":""}