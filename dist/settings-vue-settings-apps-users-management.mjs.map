{"version":3,"mappings":"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","names":["sync","store","router","options","moduleName","cloneRoute","state","transition","isTimeTraveling","currentPath","storeUnwatch","route","fullPath","afterEachUnHook","to","from","clone","AppStore","__vitePreload","n","AppStoreNavigation","AppStoreSidebar","UserManagement","UserManagementNavigation","routes","Vue","Router","generateUrl","GroupSorting","sanitize","url","api","confirmPassword","axios","data","localStorage","getBuilder","defaults","mutations","usersObj","existingUsers","id","newUsers","users","_usersObj","length","groups","orderBy","userCount","group","gid","displayName","e","groupIndex","groupSearch","updatedGroup","userid","user","userIndex","response","enabled","actionType","disabledGroup","userGroup","logger","key","value","humanValue","parseFileSize","sorting","oldValue","error","showError","getters","a","b","numA","numB","CancelToken","searchRequestCancelSource","actions","context","offset","limit","search","generateOcsUrl","userId","usersCount","limitParam","groupid","getCapabilities","commit","dispatch","password","email","subadmin","quota","language","manager","userStatus","allowedEmpty","loadState","categories","updateCount","categoriesPromise","category","categoriesArray","apps","appId","_id","app","canInstall","version","selectedCategoryId","_appId","showInfo","shouldRefetchCategories","categoriesPromiseResponse","settings","oc","Vuex","debug","message","useStore","Store","VTooltip","t","PiniaVuePlugin","pinia","createPinia","mainAppsUsersManagement","h","SettingsApp"],"ignoreList":[0],"sources":["../node_modules/vuex-router-sync/index.js","../apps/settings/src/router/routes.ts","../apps/settings/src/router/index.ts","../apps/settings/src/constants/GroupManagement.ts","../apps/settings/src/store/api.js","../apps/settings/src/store/users.js","../apps/settings/src/store/apps.js","../apps/settings/src/store/users-settings.js","../apps/settings/src/store/oc.js","../apps/settings/src/store/index.js","../apps/settings/src/main-apps-users-management.ts"],"sourcesContent":["exports.sync = function (store, router, options) {\n  var moduleName = (options || {}).moduleName || 'route'\n\n  store.registerModule(moduleName, {\n    namespaced: true,\n    state: cloneRoute(router.currentRoute),\n    mutations: {\n      'ROUTE_CHANGED': function ROUTE_CHANGED (state, transition) {\n        store.state[moduleName] = cloneRoute(transition.to, transition.from)\n      }\n    }\n  })\n\n  var isTimeTraveling = false\n  var currentPath\n\n  // sync router on store change\n  var storeUnwatch = store.watch(\n    function (state) { return state[moduleName]; },\n    function (route) {\n      var fullPath = route.fullPath;\n      if (fullPath === currentPath) {\n        return\n      }\n      if (currentPath != null) {\n        isTimeTraveling = true\n        router.push(route)\n      }\n      currentPath = fullPath\n    },\n    { sync: true }\n  )\n\n  // sync store on router navigation\n  var afterEachUnHook = router.afterEach(function (to, from) {\n    if (isTimeTraveling) {\n      isTimeTraveling = false\n      return\n    }\n    currentPath = to.fullPath\n    store.commit(moduleName + '/ROUTE_CHANGED', { to: to, from: from })\n  })\n\n  return function unsync () {\n    // On unsync, remove router hook\n    if (afterEachUnHook != null) {\n      afterEachUnHook()\n    }\n\n    // On unsync, remove store watch\n    if (storeUnwatch != null) {\n      storeUnwatch()\n    }\n\n    // On unsync, unregister Module with store\n    store.unregisterModule(moduleName)\n  }\n}\n\nfunction cloneRoute (to, from) {\n  var clone = {\n    name: to.name,\n    path: to.path,\n    hash: to.hash,\n    query: to.query,\n    params: to.params,\n    fullPath: to.fullPath,\n    meta: to.meta\n  }\n  if (from) {\n    clone.from = cloneRoute(from)\n  }\n  return Object.freeze(clone)\n}\n\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport type { RouteConfig } from 'vue-router'\n\n// Dynamic loading\nconst AppStore = () => import(/* webpackChunkName: 'settings-apps-view' */'../views/AppStore.vue')\nconst AppStoreNavigation = () => import(/* webpackChunkName: 'settings-apps-view' */'../views/AppStoreNavigation.vue')\nconst AppStoreSidebar = () => import(/* webpackChunkName: 'settings-apps-view' */'../views/AppStoreSidebar.vue')\n\nconst UserManagement = () => import(/* webpackChunkName: 'settings-users' */'../views/UserManagement.vue')\nconst UserManagementNavigation = () => import(/* webpackChunkName: 'settings-users' */'../views/UserManagementNavigation.vue')\n\nconst routes: RouteConfig[] = [\n\t{\n\t\tname: 'users',\n\t\tpath: '/:index(index.php/)?settings/users',\n\t\tcomponents: {\n\t\t\tdefault: UserManagement,\n\t\t\tnavigation: UserManagementNavigation,\n\t\t},\n\t\tprops: true,\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tpath: ':selectedGroup',\n\t\t\t\tname: 'group',\n\t\t\t},\n\t\t],\n\t},\n\t{\n\t\tpath: '/:index(index.php/)?settings/apps',\n\t\tname: 'apps',\n\t\t// redirect to our default route - the app discover section\n\t\tredirect: {\n\t\t\tname: 'apps-category',\n\t\t\tparams: {\n\t\t\t\tcategory: 'discover',\n\t\t\t},\n\t\t},\n\t\tcomponents: {\n\t\t\tdefault: AppStore,\n\t\t\tnavigation: AppStoreNavigation,\n\t\t\tsidebar: AppStoreSidebar,\n\t\t},\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tpath: ':category',\n\t\t\t\tname: 'apps-category',\n\t\t\t\tchildren: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpath: ':id',\n\t\t\t\t\t\tname: 'apps-details',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t],\n\t},\n]\n\nexport default routes\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport Vue from 'vue'\nimport Router from 'vue-router'\nimport { generateUrl } from '@nextcloud/router'\nimport routes from './routes.ts'\n\nVue.use(Router)\n\nconst router = new Router({\n\tmode: 'history',\n\t// if index.php is in the url AND we got this far, then it's working:\n\t// let's keep using index.php in the url\n\tbase: generateUrl(''),\n\tlinkActiveClass: 'active',\n\troutes,\n})\n\nexport default router\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n/**\n * https://github.com/nextcloud/server/blob/208e38e84e1a07a49699aa90dc5b7272d24489f0/lib/private/Group/MetaData.php#L34\n */\nexport enum GroupSorting {\n\tUserCount = 1,\n\tGroupName = 2\n}\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport axios from '@nextcloud/axios'\nimport { confirmPassword } from '@nextcloud/password-confirmation'\nimport '@nextcloud/password-confirmation/dist/style.css'\n\nconst sanitize = function(url) {\n\treturn url.replace(/\\/$/, '') // Remove last url slash\n}\n\nexport default {\n\n\t/**\n\t * This Promise is used to chain a request that require an admin password confirmation\n\t * Since chaining Promise have a very precise behavior concerning catch and then,\n\t * you'll need to be careful when using it.\n\t * e.g\n\t * // store\n\t * action(context) {\n\t *   return api.requireAdmin().then((response) => {\n\t *     return api.get('url')\n\t *       .then((response) => {API success})\n\t *       .catch((error) => {API failure});\n\t *   }).catch((error) => {requireAdmin failure});\n\t * }\n\t * // vue\n\t * this.$store.dispatch('action').then(() => {always executed})\n\t *\n\t * Since Promise.then().catch().then() will always execute the last then\n\t * this.$store.dispatch('action').then will always be executed\n\t *\n\t * If you want requireAdmin failure to also catch the API request failure\n\t * you will need to throw a new error in the api.get.catch()\n\t *\n\t * e.g\n\t * api.requireAdmin().then((response) => {\n\t *   api.get('url')\n\t *     .then((response) => {API success})\n\t *     .catch((error) => {throw error;});\n\t * }).catch((error) => {requireAdmin OR API failure});\n\t *\n\t * @return {Promise}\n\t */\n\trequireAdmin() {\n\t\treturn confirmPassword()\n\t},\n\tget(url, options) {\n\t\treturn axios.get(sanitize(url), options)\n\t},\n\tpost(url, data) {\n\t\treturn axios.post(sanitize(url), data)\n\t},\n\tpatch(url, data) {\n\t\treturn axios.patch(sanitize(url), data)\n\t},\n\tput(url, data) {\n\t\treturn axios.put(sanitize(url), data)\n\t},\n\tdelete(url, data) {\n\t\treturn axios.delete(sanitize(url), { params: data })\n\t},\n}\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { getBuilder } from '@nextcloud/browser-storage'\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { parseFileSize } from '@nextcloud/files'\nimport { showError } from '@nextcloud/dialogs'\nimport { generateOcsUrl, generateUrl } from '@nextcloud/router'\nimport axios from '@nextcloud/axios'\n\nimport { GroupSorting } from '../constants/GroupManagement.ts'\nimport api from './api.js'\nimport logger from '../logger.ts'\n\nconst localStorage = getBuilder('settings').persist(true).build()\n\nconst defaults = {\n\tgroup: {\n\t\tid: '',\n\t\tname: '',\n\t\tusercount: 0,\n\t\tdisabled: 0,\n\t\tcanAdd: true,\n\t\tcanRemove: true,\n\t},\n}\n\nconst state = {\n\tusers: [],\n\tgroups: [],\n\torderBy: GroupSorting.UserCount,\n\tminPasswordLength: 0,\n\tusersOffset: 0,\n\tusersLimit: 25,\n\tdisabledUsersOffset: 0,\n\tdisabledUsersLimit: 25,\n\tuserCount: 0,\n\tshowConfig: {\n\t\tshowStoragePath: localStorage.getItem('account_settings__showStoragePath') === 'true',\n\t\tshowUserBackend: localStorage.getItem('account_settings__showUserBackend') === 'true',\n\t\tshowLastLogin: localStorage.getItem('account_settings__showLastLogin') === 'true',\n\t\tshowNewUserForm: localStorage.getItem('account_settings__showNewUserForm') === 'true',\n\t\tshowLanguages: localStorage.getItem('account_settings__showLanguages') === 'true',\n\t},\n}\n\nconst mutations = {\n\tappendUsers(state, usersObj) {\n\t\tconst existingUsers = state.users.map(({ id }) => id)\n\t\tconst newUsers = Object.values(usersObj)\n\t\t\t.filter(({ id }) => !existingUsers.includes(id))\n\n\t\tconst users = state.users.concat(newUsers)\n\t\tstate.usersOffset += state.usersLimit\n\t\tstate.users = users\n\t},\n\tupdateDisabledUsers(state, _usersObj) {\n\t\tstate.disabledUsersOffset += state.disabledUsersLimit\n\t},\n\tsetPasswordPolicyMinLength(state, length) {\n\t\tstate.minPasswordLength = length !== '' ? length : 0\n\t},\n\tinitGroups(state, { groups, orderBy, userCount }) {\n\t\tstate.groups = groups.map(group => Object.assign({}, defaults.group, group))\n\t\tstate.orderBy = orderBy\n\t\tstate.userCount = userCount\n\t},\n\taddGroup(state, { gid, displayName }) {\n\t\ttry {\n\t\t\tif (typeof state.groups.find((group) => group.id === gid) !== 'undefined') {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// extend group to default values\n\t\t\tconst group = Object.assign({}, defaults.group, {\n\t\t\t\tid: gid,\n\t\t\t\tname: displayName,\n\t\t\t})\n\t\t\tstate.groups.unshift(group)\n\t\t} catch (e) {\n\t\t\tconsole.error('Can\\'t create group', e)\n\t\t}\n\t},\n\trenameGroup(state, { gid, displayName }) {\n\t\tconst groupIndex = state.groups.findIndex(groupSearch => groupSearch.id === gid)\n\t\tif (groupIndex >= 0) {\n\t\t\tconst updatedGroup = state.groups[groupIndex]\n\t\t\tupdatedGroup.name = displayName\n\t\t\tstate.groups.splice(groupIndex, 1, updatedGroup)\n\t\t}\n\t},\n\tremoveGroup(state, gid) {\n\t\tconst groupIndex = state.groups.findIndex(groupSearch => groupSearch.id === gid)\n\t\tif (groupIndex >= 0) {\n\t\t\tstate.groups.splice(groupIndex, 1)\n\t\t}\n\t},\n\taddUserGroup(state, { userid, gid }) {\n\t\tconst group = state.groups.find(groupSearch => groupSearch.id === gid)\n\t\tconst user = state.users.find(user => user.id === userid)\n\t\t// increase count if user is enabled\n\t\tif (group && user.enabled && state.userCount > 0) {\n\t\t\tgroup.usercount++\n\t\t}\n\t\tconst groups = user.groups\n\t\tgroups.push(gid)\n\t},\n\tremoveUserGroup(state, { userid, gid }) {\n\t\tconst group = state.groups.find(groupSearch => groupSearch.id === gid)\n\t\tconst user = state.users.find(user => user.id === userid)\n\t\t// lower count if user is enabled\n\t\tif (group && user.enabled && state.userCount > 0) {\n\t\t\tgroup.usercount--\n\t\t}\n\t\tconst groups = user.groups\n\t\tgroups.splice(groups.indexOf(gid), 1)\n\t},\n\taddUserSubAdmin(state, { userid, gid }) {\n\t\tconst groups = state.users.find(user => user.id === userid).subadmin\n\t\tgroups.push(gid)\n\t},\n\tremoveUserSubAdmin(state, { userid, gid }) {\n\t\tconst groups = state.users.find(user => user.id === userid).subadmin\n\t\tgroups.splice(groups.indexOf(gid), 1)\n\t},\n\tdeleteUser(state, userid) {\n\t\tconst userIndex = state.users.findIndex(user => user.id === userid)\n\t\tthis.commit('updateUserCounts', { user: state.users[userIndex], actionType: 'remove' })\n\t\tstate.users.splice(userIndex, 1)\n\t},\n\taddUserData(state, response) {\n\t\tconst user = response.data.ocs.data\n\t\tstate.users.unshift(user)\n\t\tthis.commit('updateUserCounts', { user, actionType: 'create' })\n\t},\n\tenableDisableUser(state, { userid, enabled }) {\n\t\tconst user = state.users.find(user => user.id === userid)\n\t\tuser.enabled = enabled\n\t\tthis.commit('updateUserCounts', { user, actionType: enabled ? 'enable' : 'disable' })\n\t},\n\t// update active/disabled counts, groups counts\n\tupdateUserCounts(state, { user, actionType }) {\n\t\t// 0 is a special value\n\t\tif (state.userCount === 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst disabledGroup = state.groups.find(group => group.id === 'disabled')\n\t\tswitch (actionType) {\n\t\tcase 'enable':\n\t\tcase 'disable':\n\t\t\tdisabledGroup.usercount += user.enabled ? -1 : 1 // update Disabled Users count\n\t\t\tstate.userCount += user.enabled ? 1 : -1 // update Active Users count\n\t\t\tuser.groups.forEach(userGroup => {\n\t\t\t\tconst group = state.groups.find(groupSearch => groupSearch.id === userGroup)\n\t\t\t\tgroup.disabled += user.enabled ? -1 : 1 // update group disabled count\n\t\t\t})\n\t\t\tbreak\n\t\tcase 'create':\n\t\t\tstate.userCount++ // increment Active Users count\n\n\t\t\tuser.groups.forEach(userGroup => {\n\t\t\t\tstate.groups\n\t\t\t\t\t.find(groupSearch => groupSearch.id === userGroup)\n\t\t\t\t    .usercount++ // increment group total count\n\t\t\t})\n\t\t\tbreak\n\t\tcase 'remove':\n\t\t\tif (user.enabled) {\n\t\t\t\tstate.userCount-- // decrement Active Users count\n\t\t\t\tuser.groups.forEach(userGroup => {\n\t\t\t\t\tconst group = state.groups.find(groupSearch => groupSearch.id === userGroup)\n\t\t\t\t\tif (!group) {\n\t\t\t\t\t\tconsole.warn('User group ' + userGroup + ' does not exist during user removal')\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tgroup.usercount-- // decrement group total count\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tdisabledGroup.usercount-- // decrement Disabled Users count\n\t\t\t\tuser.groups.forEach(userGroup => {\n\t\t\t\t\tconst group = state.groups.find(groupSearch => groupSearch.id === userGroup)\n\t\t\t\t\tgroup.disabled-- // decrement group disabled count\n\t\t\t\t})\n\t\t\t}\n\t\t\tbreak\n\t\tdefault:\n\t\t\tlogger.error(`Unknown action type in updateUserCounts: '${actionType}'`)\n\t\t\t// not throwing error to interrupt execution as this is not fatal\n\t\t}\n\t},\n\tsetUserData(state, { userid, key, value }) {\n\t\tif (key === 'quota') {\n\t\t\tconst humanValue = parseFileSize(value, true)\n\t\t\tstate.users.find(user => user.id === userid)[key][key] = humanValue !== null ? humanValue : value\n\t\t} else {\n\t\t\tstate.users.find(user => user.id === userid)[key] = value\n\t\t}\n\t},\n\n\t/**\n\t * Reset users list\n\t *\n\t * @param {object} state the store state\n\t */\n\tresetUsers(state) {\n\t\tstate.users = []\n\t\tstate.usersOffset = 0\n\t\tstate.disabledUsersOffset = 0\n\t},\n\n\tsetShowConfig(state, { key, value }) {\n\t\tlocalStorage.setItem(`account_settings__${key}`, JSON.stringify(value))\n\t\tstate.showConfig[key] = value\n\t},\n\n\tsetGroupSorting(state, sorting) {\n\t\tconst oldValue = state.orderBy\n\t\tstate.orderBy = sorting\n\n\t\t// Persist the value on the server\n\t\taxios.post(\n\t\t\tgenerateUrl('/settings/users/preferences/group.sortBy'),\n\t\t\t{\n\t\t\t\tvalue: String(sorting),\n\t\t\t},\n\t\t).catch((error) => {\n\t\t\tstate.orderBy = oldValue\n\t\t\tshowError(t('settings', 'Could not set group sorting'))\n\t\t\tlogger.error(error)\n\t\t})\n\t},\n}\n\nconst getters = {\n\tgetUsers(state) {\n\t\treturn state.users\n\t},\n\tgetGroups(state) {\n\t\treturn state.groups\n\t},\n\tgetSubadminGroups(state) {\n\t\t// Can't be subadmin of admin or disabled\n\t\treturn state.groups.filter(group => group.id !== 'admin' && group.id !== 'disabled')\n\t},\n\tgetSortedGroups(state) {\n\t\tconst groups = [...state.groups]\n\t\tif (state.orderBy === GroupSorting.UserCount) {\n\t\t\treturn groups.sort((a, b) => {\n\t\t\t\tconst numA = a.usercount - a.disabled\n\t\t\t\tconst numB = b.usercount - b.disabled\n\t\t\t\treturn (numA < numB) ? 1 : (numB < numA ? -1 : a.name.localeCompare(b.name))\n\t\t\t})\n\t\t} else {\n\t\t\treturn groups.sort((a, b) => a.name.localeCompare(b.name))\n\t\t}\n\t},\n\tgetGroupSorting(state) {\n\t\treturn state.orderBy\n\t},\n\tgetPasswordPolicyMinLength(state) {\n\t\treturn state.minPasswordLength\n\t},\n\tgetUsersOffset(state) {\n\t\treturn state.usersOffset\n\t},\n\tgetUsersLimit(state) {\n\t\treturn state.usersLimit\n\t},\n\tgetDisabledUsersOffset(state) {\n\t\treturn state.disabledUsersOffset\n\t},\n\tgetDisabledUsersLimit(state) {\n\t\treturn state.disabledUsersLimit\n\t},\n\tgetUserCount(state) {\n\t\treturn state.userCount\n\t},\n\tgetShowConfig(state) {\n\t\treturn state.showConfig\n\t},\n}\n\nconst CancelToken = axios.CancelToken\nlet searchRequestCancelSource = null\n\nconst actions = {\n\n\t/**\n\t * search users\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {number} options.offset List offset to request\n\t * @param {number} options.limit List number to return from offset\n\t * @param {string} options.search Search amongst users\n\t * @return {Promise}\n\t */\n\tsearchUsers(context, { offset, limit, search }) {\n\t\tsearch = typeof search === 'string' ? search : ''\n\n\t\treturn api.get(generateOcsUrl('cloud/users/details?offset={offset}&limit={limit}&search={search}', { offset, limit, search })).catch((error) => {\n\t\t\tif (!axios.isCancel(error)) {\n\t\t\t\tcontext.commit('API_FAILURE', error)\n\t\t\t}\n\t\t})\n\t},\n\n\t/**\n\t * Get user details\n\t *\n\t * @param {object} context store context\n\t * @param {string} userId user id\n\t * @return {Promise}\n\t */\n\tgetUser(context, userId) {\n\t\treturn api.get(generateOcsUrl(`cloud/users/${userId}`)).catch((error) => {\n\t\t\tif (!axios.isCancel(error)) {\n\t\t\t\tcontext.commit('API_FAILURE', error)\n\t\t\t}\n\t\t})\n\t},\n\n\t/**\n\t * Get all users with full details\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {number} options.offset List offset to request\n\t * @param {number} options.limit List number to return from offset\n\t * @param {string} options.search Search amongst users\n\t * @param {string} options.group Get users from group\n\t * @return {Promise}\n\t */\n\tgetUsers(context, { offset, limit, search, group }) {\n\t\tif (searchRequestCancelSource) {\n\t\t\tsearchRequestCancelSource.cancel('Operation canceled by another search request.')\n\t\t}\n\t\tsearchRequestCancelSource = CancelToken.source()\n\t\tsearch = typeof search === 'string' ? search : ''\n\n\t\t/**\n\t\t * Adding filters in the search bar such as in:files, in:users, etc.\n\t\t * collides with this particular search, so we need to remove them\n\t\t * here and leave only the original search query\n\t\t */\n\t\tsearch = search.replace(/in:[^\\s]+/g, '').trim()\n\n\t\tgroup = typeof group === 'string' ? group : ''\n\t\tif (group !== '') {\n\t\t\treturn api.get(generateOcsUrl('cloud/groups/{group}/users/details?offset={offset}&limit={limit}&search={search}', { group: encodeURIComponent(group), offset, limit, search }), {\n\t\t\t\tcancelToken: searchRequestCancelSource.token,\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst usersCount = Object.keys(response.data.ocs.data.users).length\n\t\t\t\t\tif (usersCount > 0) {\n\t\t\t\t\t\tcontext.commit('appendUsers', response.data.ocs.data.users)\n\t\t\t\t\t}\n\t\t\t\t\treturn usersCount\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tif (!axios.isCancel(error)) {\n\t\t\t\t\t\tcontext.commit('API_FAILURE', error)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\n\t\treturn api.get(generateOcsUrl('cloud/users/details?offset={offset}&limit={limit}&search={search}', { offset, limit, search }), {\n\t\t\tcancelToken: searchRequestCancelSource.token,\n\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconst usersCount = Object.keys(response.data.ocs.data.users).length\n\t\t\t\tif (usersCount > 0) {\n\t\t\t\t\tcontext.commit('appendUsers', response.data.ocs.data.users)\n\t\t\t\t}\n\t\t\t\treturn usersCount\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tif (!axios.isCancel(error)) {\n\t\t\t\t\tcontext.commit('API_FAILURE', error)\n\t\t\t\t}\n\t\t\t})\n\t},\n\n\t/**\n\t * Get disabled users with full details\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {number} options.offset List offset to request\n\t * @param {number} options.limit List number to return from offset\n\t * @return {Promise<number>}\n\t */\n\tasync getDisabledUsers(context, { offset, limit, search }) {\n\t\tconst url = generateOcsUrl('cloud/users/disabled?offset={offset}&limit={limit}&search={search}', { offset, limit, search })\n\t\ttry {\n\t\t\tconst response = await api.get(url)\n\t\t\tconst usersCount = Object.keys(response.data.ocs.data.users).length\n\t\t\tif (usersCount > 0) {\n\t\t\t\tcontext.commit('appendUsers', response.data.ocs.data.users)\n\t\t\t\tcontext.commit('updateDisabledUsers', response.data.ocs.data.users)\n\t\t\t}\n\t\t\treturn usersCount\n\t\t} catch (error) {\n\t\t\tcontext.commit('API_FAILURE', error)\n\t\t}\n\t},\n\n\tgetGroups(context, { offset, limit, search }) {\n\t\tsearch = typeof search === 'string' ? search : ''\n\t\tconst limitParam = limit === -1 ? '' : `&limit=${limit}`\n\t\treturn api.get(generateOcsUrl('cloud/groups?offset={offset}&search={search}', { offset, search }) + limitParam)\n\t\t\t.then((response) => {\n\t\t\t\tif (Object.keys(response.data.ocs.data.groups).length > 0) {\n\t\t\t\t\tresponse.data.ocs.data.groups.forEach(function(group) {\n\t\t\t\t\t\tcontext.commit('addGroup', { gid: group, displayName: group })\n\t\t\t\t\t})\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false\n\t\t\t})\n\t\t\t.catch((error) => context.commit('API_FAILURE', error))\n\t},\n\n\t/**\n\t * Get all users with full details\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {number} options.offset List offset to request\n\t * @param {number} options.limit List number to return from offset\n\t * @param {string} options.search -\n\t * @return {Promise}\n\t */\n\tgetUsersFromList(context, { offset, limit, search }) {\n\t\tsearch = typeof search === 'string' ? search : ''\n\t\treturn api.get(generateOcsUrl('cloud/users/details?offset={offset}&limit={limit}&search={search}', { offset, limit, search }))\n\t\t\t.then((response) => {\n\t\t\t\tif (Object.keys(response.data.ocs.data.users).length > 0) {\n\t\t\t\t\tcontext.commit('appendUsers', response.data.ocs.data.users)\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false\n\t\t\t})\n\t\t\t.catch((error) => context.commit('API_FAILURE', error))\n\t},\n\n\t/**\n\t * Get all users with full details from a groupid\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {number} options.offset List offset to request\n\t * @param {number} options.limit List number to return from offset\n\t * @param {string} options.groupid -\n\t * @return {Promise}\n\t */\n\tgetUsersFromGroup(context, { groupid, offset, limit }) {\n\t\treturn api.get(generateOcsUrl('cloud/users/{groupId}/details?offset={offset}&limit={limit}', { groupId: encodeURIComponent(groupid), offset, limit }))\n\t\t\t.then((response) => context.commit('getUsersFromList', response.data.ocs.data.users))\n\t\t\t.catch((error) => context.commit('API_FAILURE', error))\n\t},\n\n\tgetPasswordPolicyMinLength(context) {\n\t\tif (getCapabilities().password_policy && getCapabilities().password_policy.minLength) {\n\t\t\tcontext.commit('setPasswordPolicyMinLength', getCapabilities().password_policy.minLength)\n\t\t\treturn getCapabilities().password_policy.minLength\n\t\t}\n\t\treturn false\n\t},\n\n\t/**\n\t * Add group\n\t *\n\t * @param {object} context store context\n\t * @param {string} gid Group id\n\t * @return {Promise}\n\t */\n\taddGroup(context, gid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/groups'), { groupid: gid })\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('addGroup', { gid, displayName: gid })\n\t\t\t\t\treturn { gid, displayName: gid }\n\t\t\t\t})\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => {\n\t\t\tcontext.commit('API_FAILURE', { gid, error })\n\t\t\t// let's throw one more time to prevent the view\n\t\t\t// from adding the user to a group that doesn't exists\n\t\t\tthrow error\n\t\t})\n\t},\n\n\t/**\n\t * Rename group\n\t *\n\t * @param {object} context store context\n\t * @param {string} groupid Group id\n\t * @param {string} displayName Group display name\n\t * @return {Promise}\n\t */\n\trenameGroup(context, { groupid, displayName }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.put(generateOcsUrl('cloud/groups/{groupId}', { groupId: encodeURIComponent(groupid) }), { key: 'displayname', value: displayName })\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('renameGroup', { gid: groupid, displayName })\n\t\t\t\t\treturn { groupid, displayName }\n\t\t\t\t})\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => {\n\t\t\tcontext.commit('API_FAILURE', { groupid, error })\n\t\t\t// let's throw one more time to prevent the view\n\t\t\t// from renaming the group\n\t\t\tthrow error\n\t\t})\n\t},\n\n\t/**\n\t * Remove group\n\t *\n\t * @param {object} context store context\n\t * @param {string} gid Group id\n\t * @return {Promise}\n\t */\n\tremoveGroup(context, gid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.delete(generateOcsUrl('cloud/groups/{groupId}', { groupId: encodeURIComponent(gid) }))\n\t\t\t\t.then((response) => context.commit('removeGroup', gid))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { gid, error }))\n\t},\n\n\t/**\n\t * Add user to group\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.gid Group id\n\t * @return {Promise}\n\t */\n\taddUserGroup(context, { userid, gid }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/users/{userid}/groups', { userid }), { groupid: gid })\n\t\t\t\t.then((response) => context.commit('addUserGroup', { userid, gid }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Remove user from group\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.gid Group id\n\t * @return {Promise}\n\t */\n\tremoveUserGroup(context, { userid, gid }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.delete(generateOcsUrl('cloud/users/{userid}/groups', { userid }), { groupid: gid })\n\t\t\t\t.then((response) => context.commit('removeUserGroup', { userid, gid }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => {\n\t\t\tcontext.commit('API_FAILURE', { userid, error })\n\t\t\t// let's throw one more time to prevent\n\t\t\t// the view from removing the user row on failure\n\t\t\tthrow error\n\t\t})\n\t},\n\n\t/**\n\t * Add user to group admin\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.gid Group id\n\t * @return {Promise}\n\t */\n\taddUserSubAdmin(context, { userid, gid }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/users/{userid}/subadmins', { userid }), { groupid: gid })\n\t\t\t\t.then((response) => context.commit('addUserSubAdmin', { userid, gid }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Remove user from group admin\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.gid Group id\n\t * @return {Promise}\n\t */\n\tremoveUserSubAdmin(context, { userid, gid }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.delete(generateOcsUrl('cloud/users/{userid}/subadmins', { userid }), { groupid: gid })\n\t\t\t\t.then((response) => context.commit('removeUserSubAdmin', { userid, gid }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Mark all user devices for remote wipe\n\t *\n\t * @param {object} context store context\n\t * @param {string} userid User id\n\t * @return {Promise}\n\t */\n\twipeUserDevices(context, userid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/users/{userid}/wipe', { userid }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Delete a user\n\t *\n\t * @param {object} context store context\n\t * @param {string} userid User id\n\t * @return {Promise}\n\t */\n\tdeleteUser(context, userid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.delete(generateOcsUrl('cloud/users/{userid}', { userid }))\n\t\t\t\t.then((response) => context.commit('deleteUser', userid))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Add a user\n\t *\n\t * @param {object} context store context\n\t * @param {Function} context.commit -\n\t * @param {Function} context.dispatch -\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.password User password\n\t * @param {string} options.displayName User display name\n\t * @param {string} options.email User email\n\t * @param {string} options.groups User groups\n\t * @param {string} options.subadmin User subadmin groups\n\t * @param {string} options.quota User email\n\t * @param {string} options.language User language\n\t * @param {string} options.manager User manager\n\t * @return {Promise}\n\t */\n\taddUser({ commit, dispatch }, { userid, password, displayName, email, groups, subadmin, quota, language, manager }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/users'), { userid, password, displayName, email, groups, subadmin, quota, language, manager })\n\t\t\t\t.then((response) => dispatch('addUserData', userid || response.data.ocs.data.id))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => {\n\t\t\tcommit('API_FAILURE', { userid, error })\n\t\t\tthrow error\n\t\t})\n\t},\n\n\t/**\n\t * Get user data and commit addition\n\t *\n\t * @param {object} context store context\n\t * @param {string} userid User id\n\t * @return {Promise}\n\t */\n\taddUserData(context, userid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.get(generateOcsUrl('cloud/users/{userid}', { userid }))\n\t\t\t\t.then((response) => context.commit('addUserData', response))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Enable or disable user\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {boolean} options.enabled User enablement status\n\t * @return {Promise}\n\t */\n\tenableDisableUser(context, { userid, enabled = true }) {\n\t\tconst userStatus = enabled ? 'enable' : 'disable'\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.put(generateOcsUrl('cloud/users/{userid}/{userStatus}', { userid, userStatus }))\n\t\t\t\t.then((response) => context.commit('enableDisableUser', { userid, enabled }))\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n\n\t/**\n\t * Edit user data\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.userid User id\n\t * @param {string} options.key User field to edit\n\t * @param {string} options.value Value of the change\n\t * @return {Promise}\n\t */\n\tsetUserData(context, { userid, key, value }) {\n\t\tconst allowedEmpty = ['email', 'displayname', 'manager']\n\t\tif (['email', 'language', 'quota', 'displayname', 'password', 'manager'].indexOf(key) !== -1) {\n\t\t\t// We allow empty email or displayname\n\t\t\tif (typeof value === 'string'\n\t\t\t\t&& (\n\t\t\t\t\t(allowedEmpty.indexOf(key) === -1 && value.length > 0)\n\t\t\t\t\t|| allowedEmpty.indexOf(key) !== -1\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn api.requireAdmin().then((response) => {\n\t\t\t\t\treturn api.put(generateOcsUrl('cloud/users/{userid}', { userid }), { key, value })\n\t\t\t\t\t\t.then((response) => context.commit('setUserData', { userid, key, value }))\n\t\t\t\t\t\t.catch((error) => { throw error })\n\t\t\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t\t\t}\n\t\t}\n\t\treturn Promise.reject(new Error('Invalid request data'))\n\t},\n\n\t/**\n\t * Send welcome mail\n\t *\n\t * @param {object} context store context\n\t * @param {string} userid User id\n\t * @return {Promise}\n\t */\n\tsendWelcomeMail(context, userid) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('cloud/users/{userid}/welcome', { userid }))\n\t\t\t\t.then(response => true)\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { userid, error }))\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport api from './api.js'\nimport Vue from 'vue'\nimport { generateUrl } from '@nextcloud/router'\nimport { showError, showInfo } from '@nextcloud/dialogs'\nimport { loadState } from '@nextcloud/initial-state'\n\nconst state = {\n\tapps: [],\n\tbundles: loadState('settings', 'appstoreBundles', []),\n\tcategories: [],\n\tupdateCount: loadState('settings', 'appstoreUpdateCount', 0),\n\tloading: {},\n\tgettingCategoriesPromise: null,\n}\n\nconst mutations = {\n\n\tAPPS_API_FAILURE(state, error) {\n\t\tshowError(t('settings', 'An error occurred during the request. Unable to proceed.') + '<br>' + error.error.response.data.data.message, { isHTML: true })\n\t\tconsole.error(state, error)\n\t},\n\n\tinitCategories(state, { categories, updateCount }) {\n\t\tstate.categories = categories\n\t\tstate.updateCount = updateCount\n\t},\n\n\tupdateCategories(state, categoriesPromise) {\n\t\tstate.gettingCategoriesPromise = categoriesPromise\n\t},\n\n\tsetUpdateCount(state, updateCount) {\n\t\tstate.updateCount = updateCount\n\t},\n\n\taddCategory(state, category) {\n\t\tstate.categories.push(category)\n\t},\n\n\tappendCategories(state, categoriesArray) {\n\t\t// convert obj to array\n\t\tstate.categories = categoriesArray\n\t},\n\n\tsetAllApps(state, apps) {\n\t\tstate.apps = apps\n\t},\n\n\tsetError(state, { appId, error }) {\n\t\tif (!Array.isArray(appId)) {\n\t\t\tappId = [appId]\n\t\t}\n\t\tappId.forEach((_id) => {\n\t\t\tconst app = state.apps.find(app => app.id === _id)\n\t\t\tapp.error = error\n\t\t})\n\t},\n\n\tclearError(state, { appId, error }) {\n\t\tconst app = state.apps.find(app => app.id === appId)\n\t\tapp.error = null\n\t},\n\n\tenableApp(state, { appId, groups }) {\n\t\tconst app = state.apps.find(app => app.id === appId)\n\t\tapp.active = true\n\t\tapp.groups = groups\n\t},\n\n\tsetInstallState(state, { appId, canInstall }) {\n\t\tconst app = state.apps.find(app => app.id === appId)\n\t\tif (app) {\n\t\t\tapp.canInstall = canInstall === true\n\t\t}\n\t},\n\n\tdisableApp(state, appId) {\n\t\tconst app = state.apps.find(app => app.id === appId)\n\t\tapp.active = false\n\t\tapp.groups = []\n\t\tif (app.removable) {\n\t\t\tapp.canUnInstall = true\n\t\t}\n\t},\n\n\tuninstallApp(state, appId) {\n\t\tstate.apps.find(app => app.id === appId).active = false\n\t\tstate.apps.find(app => app.id === appId).groups = []\n\t\tstate.apps.find(app => app.id === appId).needsDownload = true\n\t\tstate.apps.find(app => app.id === appId).installed = false\n\t\tstate.apps.find(app => app.id === appId).canUnInstall = false\n\t\tstate.apps.find(app => app.id === appId).canInstall = true\n\t},\n\n\tupdateApp(state, appId) {\n\t\tconst app = state.apps.find(app => app.id === appId)\n\t\tconst version = app.update\n\t\tapp.update = null\n\t\tapp.version = version\n\t\tstate.updateCount--\n\n\t},\n\n\tresetApps(state) {\n\t\tstate.apps = []\n\t},\n\treset(state) {\n\t\tstate.apps = []\n\t\tstate.categories = []\n\t\tstate.updateCount = 0\n\t},\n\tstartLoading(state, id) {\n\t\tif (Array.isArray(id)) {\n\t\t\tid.forEach((_id) => {\n\t\t\t\tVue.set(state.loading, _id, true)\n\t\t\t})\n\t\t} else {\n\t\t\tVue.set(state.loading, id, true)\n\t\t}\n\t},\n\tstopLoading(state, id) {\n\t\tif (Array.isArray(id)) {\n\t\t\tid.forEach((_id) => {\n\t\t\t\tVue.set(state.loading, _id, false)\n\t\t\t})\n\t\t} else {\n\t\t\tVue.set(state.loading, id, false)\n\t\t}\n\t},\n}\n\nconst getters = {\n\tloading(state) {\n\t\treturn function(id) {\n\t\t\treturn state.loading[id]\n\t\t}\n\t},\n\tgetCategories(state) {\n\t\treturn state.categories\n\t},\n\tgetAllApps(state) {\n\t\treturn state.apps\n\t},\n\tgetAppBundles(state) {\n\t\treturn state.bundles\n\t},\n\tgetUpdateCount(state) {\n\t\treturn state.updateCount\n\t},\n\tgetCategoryById: (state) => (selectedCategoryId) => {\n\t\treturn state.categories.find((category) => category.id === selectedCategoryId)\n\t},\n}\n\nconst actions = {\n\n\tenableApp(context, { appId, groups }) {\n\t\tlet apps\n\t\tif (Array.isArray(appId)) {\n\t\t\tapps = appId\n\t\t} else {\n\t\t\tapps = [appId]\n\t\t}\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\tcontext.commit('startLoading', apps)\n\t\t\tcontext.commit('startLoading', 'install')\n\t\t\treturn api.post(generateUrl('settings/apps/enable'), { appIds: apps, groups })\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t\tapps.forEach(_appId => {\n\t\t\t\t\t\tcontext.commit('enableApp', { appId: _appId, groups })\n\t\t\t\t\t})\n\n\t\t\t\t\t// check for server health\n\t\t\t\t\treturn api.get(generateUrl('apps/files/'))\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (response.data.update_required) {\n\t\t\t\t\t\t\t\tshowInfo(\n\t\t\t\t\t\t\t\t\tt(\n\t\t\t\t\t\t\t\t\t\t'settings',\n\t\t\t\t\t\t\t\t\t\t'The app has been enabled but needs to be updated. You will be redirected to the update page in 5 seconds.'\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tonClick: () => window.location.reload(),\n\t\t\t\t\t\t\t\t\t\tclose: false,\n\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tlocation.reload()\n\t\t\t\t\t\t\t\t}, 5000)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\tif (!Array.isArray(appId)) {\n\t\t\t\t\t\t\t\tshowError(t('settings', 'Error: This app cannot be enabled because it makes the server unstable'))\n\t\t\t\t\t\t\t\tcontext.commit('setError', {\n\t\t\t\t\t\t\t\t\tappId: apps,\n\t\t\t\t\t\t\t\t\terror: t('settings', 'Error: This app cannot be enabled because it makes the server unstable'),\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tcontext.dispatch('disableApp', { appId })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t\tcontext.commit('setError', {\n\t\t\t\t\t\tappId: apps,\n\t\t\t\t\t\terror: error.response.data.data.message,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('APPS_API_FAILURE', { appId, error })\n\t\t\t\t})\n\t\t}).catch((error) => context.commit('API_FAILURE', { appId, error }))\n\t},\n\tforceEnableApp(context, { appId, groups }) {\n\t\tlet apps\n\t\tif (Array.isArray(appId)) {\n\t\t\tapps = appId\n\t\t} else {\n\t\t\tapps = [appId]\n\t\t}\n\t\treturn api.requireAdmin().then(() => {\n\t\t\tcontext.commit('startLoading', apps)\n\t\t\tcontext.commit('startLoading', 'install')\n\t\t\treturn api.post(generateUrl('settings/apps/force'), { appId })\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('setInstallState', { appId, canInstall: true })\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t\tcontext.commit('setError', {\n\t\t\t\t\t\tappId: apps,\n\t\t\t\t\t\terror: error.response.data.data.message,\n\t\t\t\t\t})\n\t\t\t\t\tcontext.commit('APPS_API_FAILURE', { appId, error })\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t})\n\t\t}).catch((error) => context.commit('API_FAILURE', { appId, error }))\n\t},\n\tdisableApp(context, { appId }) {\n\t\tlet apps\n\t\tif (Array.isArray(appId)) {\n\t\t\tapps = appId\n\t\t} else {\n\t\t\tapps = [appId]\n\t\t}\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\tcontext.commit('startLoading', apps)\n\t\t\treturn api.post(generateUrl('settings/apps/disable'), { appIds: apps })\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tapps.forEach(_appId => {\n\t\t\t\t\t\tcontext.commit('disableApp', _appId)\n\t\t\t\t\t})\n\t\t\t\t\treturn true\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcontext.commit('stopLoading', apps)\n\t\t\t\t\tcontext.commit('APPS_API_FAILURE', { appId, error })\n\t\t\t\t})\n\t\t}).catch((error) => context.commit('API_FAILURE', { appId, error }))\n\t},\n\tuninstallApp(context, { appId }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\tcontext.commit('startLoading', appId)\n\t\t\treturn api.get(generateUrl(`settings/apps/uninstall/${appId}`))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('stopLoading', appId)\n\t\t\t\t\tcontext.commit('uninstallApp', appId)\n\t\t\t\t\treturn true\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcontext.commit('stopLoading', appId)\n\t\t\t\t\tcontext.commit('APPS_API_FAILURE', { appId, error })\n\t\t\t\t})\n\t\t}).catch((error) => context.commit('API_FAILURE', { appId, error }))\n\t},\n\n\tupdateApp(context, { appId }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\tcontext.commit('startLoading', appId)\n\t\t\tcontext.commit('startLoading', 'install')\n\t\t\treturn api.get(generateUrl(`settings/apps/update/${appId}`))\n\t\t\t\t.then((response) => {\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t\tcontext.commit('stopLoading', appId)\n\t\t\t\t\tcontext.commit('updateApp', appId)\n\t\t\t\t\treturn true\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tcontext.commit('stopLoading', appId)\n\t\t\t\t\tcontext.commit('stopLoading', 'install')\n\t\t\t\t\tcontext.commit('APPS_API_FAILURE', { appId, error })\n\t\t\t\t})\n\t\t}).catch((error) => context.commit('API_FAILURE', { appId, error }))\n\t},\n\n\tgetAllApps(context) {\n\t\tcontext.commit('startLoading', 'list')\n\t\treturn api.get(generateUrl('settings/apps/list'))\n\t\t\t.then((response) => {\n\t\t\t\tcontext.commit('setAllApps', response.data.apps)\n\t\t\t\tcontext.commit('stopLoading', 'list')\n\t\t\t\treturn true\n\t\t\t})\n\t\t\t.catch((error) => context.commit('API_FAILURE', error))\n\t},\n\n\tasync getCategories(context, { shouldRefetchCategories = false } = {}) {\n\t\tif (shouldRefetchCategories || !context.state.gettingCategoriesPromise) {\n\t\t\tcontext.commit('startLoading', 'categories')\n\t\t\ttry {\n\t\t\t\tconst categoriesPromise = api.get(generateUrl('settings/apps/categories'))\n\t\t\t\tcontext.commit('updateCategories', categoriesPromise)\n\t\t\t\tconst categoriesPromiseResponse = await categoriesPromise\n\t\t\t\tif (categoriesPromiseResponse.data.length > 0) {\n\t\t\t\t\tcontext.commit('appendCategories', categoriesPromiseResponse.data)\n\t\t\t\t\tcontext.commit('stopLoading', 'categories')\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\tcontext.commit('stopLoading', 'categories')\n\t\t\t\treturn false\n\t\t\t} catch (error) {\n\t\t\t\tcontext.commit('API_FAILURE', error)\n\t\t\t}\n\t\t}\n\t\treturn context.state.gettingCategoriesPromise\n\t},\n\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { loadState } from '@nextcloud/initial-state'\n\nconst state = {\n\tserverData: loadState('settings', 'usersSettings', {}),\n}\nconst mutations = {\n\tsetServerData(state, data) {\n\t\tstate.serverData = data\n\t},\n}\nconst getters = {\n\tgetServerData(state) {\n\t\treturn state.serverData\n\t},\n}\nconst actions = {}\n\nexport default { state, mutations, getters, actions }\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport api from './api.js'\nimport { generateOcsUrl } from '@nextcloud/router'\n\nconst state = {}\nconst mutations = {}\nconst getters = {}\nconst actions = {\n\t/**\n\t * Set application config in database\n\t *\n\t * @param {object} context store context\n\t * @param {object} options destructuring object\n\t * @param {string} options.app Application name\n\t * @param {boolean} options.key Config key\n\t * @param {boolean} options.value Value to set\n\t * @return {Promise}\n\t */\n\tsetAppConfig(context, { app, key, value }) {\n\t\treturn api.requireAdmin().then((response) => {\n\t\t\treturn api.post(generateOcsUrl('apps/provisioning_api/api/v1/config/apps/{app}/{key}', { app, key }), { value })\n\t\t\t\t.catch((error) => { throw error })\n\t\t}).catch((error) => context.commit('API_FAILURE', { app, key, value, error }))\n\t},\n}\n\nexport default { state, mutations, getters, actions }\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport Vue from 'vue'\nimport Vuex, { Store } from 'vuex'\nimport users from './users.js'\nimport apps from './apps.js'\nimport settings from './users-settings.js'\nimport oc from './oc.js'\nimport { showError } from '@nextcloud/dialogs'\n\nVue.use(Vuex)\n\nconst debug = process.env.NODE_ENV !== 'production'\n\nconst mutations = {\n\tAPI_FAILURE(state, error) {\n\t\ttry {\n\t\t\tconst message = error.error.response.data.ocs.meta.message\n\t\t\tshowError(t('settings', 'An error occurred during the request. Unable to proceed.') + '<br>' + message, { isHTML: true })\n\t\t} catch (e) {\n\t\t\tshowError(t('settings', 'An error occurred during the request. Unable to proceed.'))\n\t\t}\n\t\tconsole.error(state, error)\n\t},\n}\n\nlet store = null\n\nexport const useStore = () => {\n\tif (store === null) {\n\t\tstore = new Store({\n\t\t\tmodules: {\n\t\t\t\tusers,\n\t\t\t\tapps,\n\t\t\t\tsettings,\n\t\t\t\toc,\n\t\t\t},\n\t\t\tstrict: debug,\n\t\t\tmutations,\n\t\t})\n\t}\n\treturn store\n}\n","/**\n * SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport Vue from 'vue'\nimport VTooltip from 'v-tooltip'\nimport { sync } from 'vuex-router-sync'\nimport { translate as t, translatePlural as n } from '@nextcloud/l10n'\n\nimport SettingsApp from './views/SettingsApp.vue'\nimport router from './router/index.ts'\nimport { useStore } from './store/index.js'\nimport { PiniaVuePlugin, createPinia } from 'pinia'\n\nVue.use(VTooltip, { defaultHtml: false })\n\nconst store = useStore()\nsync(store, router)\n\n// bind to window\nVue.prototype.t = t\nVue.prototype.n = n\nVue.use(PiniaVuePlugin)\n\nconst pinia = createPinia()\n\nexport default new Vue({\n\trouter,\n\tstore,\n\tpinia,\n\trender: h => h(SettingsApp),\n\tel: '#content',\n})\n"],"file":"settings-vue-settings-apps-users-management.mjs"}