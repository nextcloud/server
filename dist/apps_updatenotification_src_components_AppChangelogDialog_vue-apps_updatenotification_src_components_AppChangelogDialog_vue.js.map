{"version":3,"file":"apps_updatenotification_src_components_AppChangelogDialog_vue-apps_updatenotification_src_components_AppChangelogDialog_vue.js?v=a1c7e9d71386b0c6ac74","mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA;AACA;;;;;;;;;;;;;;;;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA;AACA;;;;;;;;;;;;;;;ACvCA;;;;;;;;;;;;;;;ACAA","sources":["webpack:///nextcloud/apps/updatenotification/src/composables/useMarkdown.ts","webpack:///nextcloud/apps/updatenotification/src/components/AppChangelogDialog.vue?vue&type=script&setup=true&lang=ts","webpack:///nextcloud/apps/updatenotification/src/components/Markdown.vue?vue&type=script&setup=true&lang=ts","webpack:///nextcloud/apps/updatenotification/src/components/AppChangelogDialog.vue?vue&type=template&id=ee431ca6&scoped=true","webpack:///nextcloud/apps/updatenotification/src/components/Markdown.vue?vue&type=template&id=06e80181&scoped=true","webpack:///nextcloud/apps/updatenotification/src/components/AppChangelogDialog.vue?vue&type=style&index=0&id=ee431ca6&scoped=true&lang=scss","webpack:///nextcloud/apps/updatenotification/src/components/Markdown.vue?vue&type=style&index=0&id=06e80181&scoped=true&lang=scss","webpack://nextcloud/./apps/updatenotification/src/components/AppChangelogDialog.vue?99f4","webpack://nextcloud/./apps/updatenotification/src/components/Markdown.vue?e216","webpack:///nextcloud/apps/updatenotification/src/components/AppChangelogDialog.vue","webpack:///nextcloud/apps/updatenotification/src/components/Markdown.vue","webpack://nextcloud/./apps/updatenotification/src/components/AppChangelogDialog.vue?6c25","webpack://nextcloud/./apps/updatenotification/src/components/Markdown.vue?75dd","webpack://nextcloud/./apps/updatenotification/src/components/AppChangelogDialog.vue?aa05","webpack://nextcloud/./apps/updatenotification/src/components/AppChangelogDialog.vue?e04f"],"sourcesContent":["import { marked } from 'marked';\nimport { computed } from 'vue';\nimport dompurify from 'dompurify';\nexport const useMarkdown = (text, minHeadingLevel) => {\n  const minHeading = computed(() => Math.min(Math.max(minHeadingLevel.value ?? 1, 1), 6));\n  const renderer = new marked.Renderer();\n  renderer.link = function (href, title, text) {\n    let out = `<a href=\"${href}\" rel=\"noreferrer noopener\" target=\"_blank\"`;\n    if (title) {\n      out += ' title=\"' + title + '\"';\n    }\n    out += '>' + text + '</a>';\n    return out;\n  };\n  renderer.image = function (href, title, text) {\n    if (text) {\n      return text;\n    }\n    return title ?? '';\n  };\n  renderer.heading = (text, level) => {\n    const headingLevel = Math.max(minHeading.value, level);\n    return `<h${headingLevel}>${text}</h${headingLevel}>`;\n  };\n  const html = computed(() => dompurify.sanitize(marked((text.value ?? '').trim(), {\n    renderer,\n    gfm: false,\n    breaks: false,\n    pedantic: false\n  }), {\n    SAFE_FOR_JQUERY: true,\n    ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'strong', 'p', 'a', 'ul', 'ol', 'li', 'em', 'del', 'blockquote']\n  }));\n  return {\n    html\n  };\n};","import { defineComponent as _defineComponent } from 'vue';\nimport { translate as t } from '@nextcloud/l10n';\nimport { generateOcsUrl } from '@nextcloud/router';\nimport { ref, watchEffect } from 'vue';\nimport axios from '@nextcloud/axios';\nimport NcDialog from '@nextcloud/vue/dist/Components/NcDialog.js';\nimport Markdown from \"./Markdown.vue\";\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'AppChangelogDialog',\n  props: {\n    appId: {\n      type: String,\n      required: true\n    },\n    version: {\n      type: String,\n      required: false,\n      default: undefined\n    },\n    open: {\n      type: Boolean,\n      required: false,\n      default: true\n    }\n  },\n  emits: [\"dismiss\", \"update:open\"],\n  setup(__props, _ref) {\n    let {\n      emit\n    } = _ref;\n    const props = __props;\n    const dialogButtons = [{\n      label: t('updatenotification', 'Give feedback'),\n      callback: () => {\n        window.open(`https://apps.nextcloud.com/apps/${props.appId}#comments`, '_blank', 'noreferrer noopener');\n      }\n    }, {\n      label: t('updatenotification', 'Get started'),\n      type: 'primary',\n      callback: () => {\n        emit('dismiss');\n        emit('update:open', false);\n      }\n    }];\n    const appName = ref(props.appId);\n    const appVersion = ref(props.version ?? '');\n    const markdown = ref('');\n    watchEffect(() => {\n      const url = props.version ? generateOcsUrl('/apps/updatenotification/api/v1/changelog/{app}?version={version}', {\n        version: props.version,\n        app: props.appId\n      }) : generateOcsUrl('/apps/updatenotification/api/v1/changelog/{app}', {\n        version: props.version,\n        app: props.appId\n      });\n      axios.get(url).then(_ref2 => {\n        let {\n          data\n        } = _ref2;\n        appName.value = data.ocs.data.appName;\n        appVersion.value = data.ocs.data.version;\n        markdown.value = data.ocs.data.content;\n      }).catch(error => {\n        if (error?.response?.status === 404) {\n          appName.value = props.appId;\n          markdown.value = t('updatenotification', 'No changelog available');\n        } else {\n          console.error('Failed to load changelog entry', error);\n          emit('update:open', false);\n        }\n      });\n    });\n    return {\n      __sfc: true,\n      props,\n      emit,\n      dialogButtons,\n      appName,\n      appVersion,\n      markdown,\n      t,\n      NcDialog,\n      Markdown\n    };\n  }\n});","import { defineComponent as _defineComponent } from 'vue';\nimport { toRef } from 'vue';\nimport { useMarkdown } from \"../composables/useMarkdown\";\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Markdown',\n  props: {\n    markdown: {\n      type: String,\n      required: true\n    },\n    minHeadingLevel: {\n      type: Number,\n      required: false,\n      default: 2\n    }\n  },\n  setup(__props) {\n    const props = __props;\n    const {\n      html\n    } = useMarkdown(toRef(props, 'markdown'), toRef(props, 'minHeadingLevel'));\n    return {\n      __sfc: true,\n      props,\n      html\n    };\n  }\n});","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(_setup.NcDialog, {\n    attrs: {\n      \"content-classes\": \"app-changelog-dialog\",\n      buttons: _setup.dialogButtons,\n      name: _setup.t(\"updatenotification\", \"What's new in {app} {version}\", {\n        app: _setup.appName,\n        version: _setup.appVersion\n      }),\n      open: _vm.open && _setup.markdown !== undefined,\n      size: \"normal\"\n    },\n    on: {\n      \"update:open\": function ($event) {\n        return _vm.$emit(\"update:open\", $event);\n      }\n    }\n  }, [_c(_setup.Markdown, {\n    staticClass: \"app-changelog-dialog__text\",\n    attrs: {\n      markdown: _setup.markdown,\n      \"min-heading-level\": 3\n    }\n  })], 1);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(\"div\", {\n    staticClass: \"markdown\",\n    domProps: {\n      innerHTML: _vm._s(_setup.html)\n    }\n  });\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `[data-v-ee431ca6] .app-changelog-dialog {\n  min-height: 50vh !important;\n}\n.app-changelog-dialog__text[data-v-ee431ca6] {\n  padding-inline: 14px;\n}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.markdown[data-v-06e80181] ul {\n  list-style: disc;\n  padding-inline-start: 20px;\n}\n.markdown[data-v-06e80181] h3, .markdown[data-v-06e80181] h4, .markdown[data-v-06e80181] h5, .markdown[data-v-06e80181] h6 {\n  font-weight: 600;\n  line-height: 1.5;\n  margin-top: 24px;\n  margin-bottom: 12px;\n  color: var(--color-main-text);\n}\n.markdown[data-v-06e80181] h3 {\n  font-size: 20px;\n}\n.markdown[data-v-06e80181] h4 {\n  font-size: 18px;\n}\n.markdown[data-v-06e80181] h5 {\n  font-size: 17px;\n}\n.markdown[data-v-06e80181] h6 {\n  font-size: var(--default-font-size);\n}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=style&index=0&id=ee431ca6&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=style&index=0&id=ee431ca6&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=style&index=0&id=06e80181&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=style&index=0&id=06e80181&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./AppChangelogDialog.vue?vue&type=template&id=ee431ca6&scoped=true\"\nimport script from \"./AppChangelogDialog.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./AppChangelogDialog.vue?vue&type=script&setup=true&lang=ts\"\nimport style0 from \"./AppChangelogDialog.vue?vue&type=style&index=0&id=ee431ca6&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ee431ca6\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/var/www/nextcloud/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('ee431ca6')) {\n      api.createRecord('ee431ca6', component.options)\n    } else {\n      api.reload('ee431ca6', component.options)\n    }\n    module.hot.accept(\"./AppChangelogDialog.vue?vue&type=template&id=ee431ca6&scoped=true\", function () {\n      api.rerender('ee431ca6', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/updatenotification/src/components/AppChangelogDialog.vue\"\nexport default component.exports","import { render, staticRenderFns } from \"./Markdown.vue?vue&type=template&id=06e80181&scoped=true\"\nimport script from \"./Markdown.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./Markdown.vue?vue&type=script&setup=true&lang=ts\"\nimport style0 from \"./Markdown.vue?vue&type=style&index=0&id=06e80181&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"06e80181\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/var/www/nextcloud/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('06e80181')) {\n      api.createRecord('06e80181', component.options)\n    } else {\n      api.reload('06e80181', component.options)\n    }\n    module.hot.accept(\"./Markdown.vue?vue&type=template&id=06e80181&scoped=true\", function () {\n      api.rerender('06e80181', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/updatenotification/src/components/Markdown.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=script&setup=true&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=script&setup=true&lang=ts\"","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=script&setup=true&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Markdown.vue?vue&type=script&setup=true&lang=ts\"","export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=template&id=ee431ca6&scoped=true\"","export * from \"-!../../../../node_modules/style-loader/dist/cjs.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/sass-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppChangelogDialog.vue?vue&type=style&index=0&id=ee431ca6&scoped=true&lang=scss\""],"names":[],"sourceRoot":""}