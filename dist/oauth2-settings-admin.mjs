import{a as V,g as R,l as $}from"./index-Ma7sfat2.chunk.mjs";import{f as w,c as y,o as s,b as t,t as r,p as i,g as _,u as e,h as d,w as m,s as x,e as A,r as U,F as C,C as O,j as v,H as q,k as B}from"./runtime-dom.esm-bundler-w0tDt7Gi.chunk.mjs";import{c as k,i as T}from"./index-2HC-5o-4.chunk.mjs";import{t as a}from"./translation-DoG5ZELJ-Bni_xMHF.chunk.mjs";import{g}from"./createElementId-DhjFt1I9-B1fq6aa1.chunk.mjs";import{N}from"./autolink-U5pBzLgI-2h5mm9kB.chunk.mjs";import{N as I}from"./mdi-YPhQfxXZ.chunk.mjs";import{N as j}from"./ContentCopy-CgZpiJBj.chunk.mjs";import{D as z,_ as S}from"./TrashCanOutline-Big6DF74.chunk.mjs";import{N as F}from"./NcPasswordField-uaMO2pdt-PEl2ADM3.chunk.mjs";import"./modulepreload-polyfill-BxzAKjcf.chunk.mjs";import"./index-Bndk0DrU.chunk.mjs";import"./index-sH3U_332.chunk.mjs";import"./NcInputField-o5OFv3z6-BKcArNCr.chunk.mjs";const H={key:1},E=w({__name:"OAuthItem",props:{client:{}},emits:["delete"],setup(c){return(u,h)=>(s(),y("tr",null,[t("td",null,r(c.client.name),1),t("td",null,[t("code",{class:i(u.$style.oAuthItem__code)},r(c.client.redirectUri),3)]),t("td",null,[t("code",{class:i(u.$style.oAuthItem__code)},r(c.client.clientId),3)]),t("td",null,[c.client.clientSecret?(s(),_(e(F),{key:0,class:i(u.$style.oAuthItem__clientSecret),"aria-label":e(a)("oauth2","Secret key"),asText:"",modelValue:c.client.clientSecret,showTrailingButton:""},null,8,["class","aria-label","modelValue"])):(s(),y("span",H,"*****"))]),t("td",null,[d(e(N),{"aria-label":e(a)("oauth2","Delete"),title:e(a)("oauth2","Delete"),variant:"error",onClick:h[0]||(h[0]=b=>u.$emit("delete"))},{icon:m(()=>[d(z,{size:20})]),_:1},8,["aria-label","title"])])]))}}),G="_oAuthItem__code_3r02l_2",J="_oAuthItem__clientSecret_3r02l_11",K={oAuthItem__code:G,oAuthItem__clientSecret:J},L={$style:K},P=V(E,[["__cssModules",L]]),Q={class:"hidden-visually"},W=w({__name:"AdminSettings",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(c){const u=x(c,"modelValue"),h=R().theming.name,b=$("oauth2","oauth2-doc-link"),f=U(!1),o=U({name:"",redirectUri:"",errorMsg:"",error:!1});async function M(l){await k.delete(g("apps/oauth2/clients/{id}",{id:l})),u.value=u.value.filter(n=>n.id!==l)}async function D(){o.value.error=!1;try{const{data:l}=await k.post(g("apps/oauth2/clients"),{name:o.value.name,redirectUri:o.value.redirectUri});u.value.push(l),f.value=!0,o.value.name="",o.value.redirectUri=""}catch(l){o.value.error=!0,T(l)&&l.response?o.value.errorMsg=l.response.data.message:o.value.errorMsg=a("oauth2","An unknown error occurred.")}}return(l,n)=>(s(),_(e(j),{name:e(a)("oauth2","OAuth 2.0 clients"),description:e(a)("oauth2","OAuth 2.0 allows external services to request access to {instanceName}.",{instanceName:e(h)}),docUrl:e(b)},{default:m(()=>[u.value.length>0?(s(),y("table",{key:0,class:i([l.$style.oauthApp__table,{[l.$style.oauthApp__table_withSecret]:f.value}])},[t("thead",null,[t("tr",null,[t("th",null,r(e(a)("oauth2","Name")),1),t("th",null,r(e(a)("oauth2","Redirection URI")),1),t("th",null,r(e(a)("oauth2","Client identifier")),1),t("th",null,r(e(a)("oauth2","Secret key")),1),t("th",null,[t("span",Q,r(e(a)("oauth2","Delete client")),1)])])]),t("tbody",null,[(s(!0),y(C,null,O(u.value,p=>(s(),_(P,{key:p.id,client:p,onDelete:ue=>M(p.id)},null,8,["client","onDelete"]))),128))])],2)):A("",!0),f.value?(s(),_(e(I),{key:1,type:"warning"},{default:m(()=>[v(r(e(a)("oauth2","Make sure you store the secret key, it cannot be recovered.")),1)]),_:1})):A("",!0),n[2]||(n[2]=t("br",null,null,-1)),t("h3",null,r(e(a)("oauth2","Add client")),1),o.value.error?(s(),_(e(I),{key:2,type:"error"},{default:m(()=>[v(r(o.value.errorMsg),1)]),_:1})):A("",!0),t("form",{class:i(l.$style.oauthApp__form),onSubmit:q(D,["prevent"])},[d(e(S),{id:"name",modelValue:o.value.name,"onUpdate:modelValue":n[0]||(n[0]=p=>o.value.name=p),class:i(l.$style.oauthApp__form__input),name:"name",label:e(a)("oauth2","Name"),placeholder:e(a)("oauth2","Name")},null,8,["modelValue","class","label","placeholder"]),d(e(S),{id:"redirectUri",modelValue:o.value.redirectUri,"onUpdate:modelValue":n[1]||(n[1]=p=>o.value.redirectUri=p),type:"url",class:i(l.$style.oauthApp__form__input),name:"redirectUri",label:e(a)("oauth2","Redirection URI"),placeholder:e(a)("oauth2","Redirection URI")},null,8,["modelValue","class","label","placeholder"]),d(e(N),{type:"submit",class:i(l.$style.oauthApp__submitButton)},{default:m(()=>[v(r(e(a)("oauth2","Add")),1)]),_:1},8,["class"])],34)]),_:1},8,["name","description","docUrl"]))}}),X="_oauthApp__form_10pnp_1",Y="_oauthApp__form__input_10pnp_6",Z="_oauthApp__table_10pnp_11",ee="_oauthApp__table_withSecret_10pnp_38",te={oauthApp__form:X,oauthApp__form__input:Y,oauthApp__table:Z,oauthApp__table_withSecret:ee},ae={$style:te},le=V(W,[["__cssModules",ae]]),oe=$("oauth2","clients"),re=B(le,{modelValue:oe});re.mount("#oauth2");
//# sourceMappingURL=oauth2-settings-admin.mjs.map
