import{N as te,u as oe,d as Z,s as Y}from"./index-JpgrUA2Z-Bcb7_yWp.chunk.mjs";import{E as p,o as a,H as C,F as b,f as w,z as O,j as B,q as L,l as se,s as g,t as l,B as T,c as H,w as h,y as v,e as E,b as V,Q,p as ne,al as ee,g as re,x as M,R as ie,am as ae,ae as le,k as ce,a5 as de,M as ue,N as ve,a7 as N}from"./string_decoder-BY7m9-pN.chunk.mjs";import{N as me}from"./mdi-BK4BBTPr.chunk.mjs";import{h as pe,P as J}from"./index-Cp1VzrI8.chunk.mjs";import{m as G,N as fe}from"./index-DXRjqG_B.chunk.mjs";import{_ as A,j as he,e as X,c as ge}from"./_plugin-vue_export-helper-CXvX4IZ0.chunk.mjs";import{N as D,a as be}from"./NcActionRouter-oT-YU_jf-Bo7WEQMz.chunk.mjs";import{N as ye}from"./NcAvatar-DmUGApWA-DtpLphsv.chunk.mjs";import{_ as we}from"./index-HgP8VlAw.chunk.mjs";import{D as _e,_ as Ce}from"./TrashCanOutline-B3cqckGn.chunk.mjs";import{D as ke,s as Ve}from"./TrayArrowDown-BJd7KhmL.chunk.mjs";import{c as He}from"./index-CYNbcBtJ.chunk.mjs";import{g as Se}from"./dav-DeUNzbml.chunk.mjs";import"./NcNoteCard-CVhtNL04-B9GbPOf_.chunk.mjs";import"./index-DpibbgL8.chunk.mjs";import"./colors-Go3zmZRD-S7FgV1KG.chunk.mjs";import"./NcUserStatusIcon-CGEf7fej-liZS007Z.chunk.mjs";import"./NcInputField-Bwsh2aHY-lfIcluT2.chunk.mjs";const Le={name:"BackupRestoreIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ze=["aria-hidden","aria-label"],$e=["fill","width","height"],xe={d:"M12,3A9,9 0 0,0 3,12H0L4,16L8,12H5A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19C10.5,19 9.09,18.5 7.94,17.7L6.5,19.14C8.04,20.3 9.94,21 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M14,12A2,2 0 0,0 12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12Z"},Ae={key:0};function Ee(i,t,e,c,f,s){return a(),p("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon backup-restore-icon",role:"img",onClick:t[0]||(t[0]=d=>i.$emit("click",d))}),[(a(),p("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[C("path",xe,[e.title?(a(),p("title",Ae,w(e.title),1)):b("",!0)])],8,$e))],16,ze)}const Ie=A(Le,[["render",Ee]]),Me={name:"FileCompareIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ne=["aria-hidden","aria-label"],De=["fill","width","height"],Te={d:"M10,18H6V16H10V18M10,14H6V12H10V14M10,1V2H6C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H10V23H12V1H10M20,8V20C20,21.11 19.11,22 18,22H14V20H18V11H14V9H18.5L14,4.5V2L20,8M16,14H14V12H16V14M16,18H14V16H16V18Z"},Oe={key:0};function Be(i,t,e,c,f,s){return a(),p("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon file-compare-icon",role:"img",onClick:t[0]||(t[0]=d=>i.$emit("click",d))}),[(a(),p("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[C("path",Te,[e.title?(a(),p("title",Oe,w(e.title),1)):b("",!0)])],8,De))],16,Ne)}const Re=A(Me,[["render",Be]]),Pe={name:"ImageOffOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ue=["aria-hidden","aria-label"],qe=["fill","width","height"],Fe={d:"M22 20.7L3.3 2L2 3.3L3 4.3V19C3 20.1 3.9 21 5 21H19.7L20.7 22L22 20.7M5 19V6.3L12.6 13.9L11.1 15.8L9 13.1L6 17H15.7L17.7 19H5M8.8 5L6.8 3H19C20.1 3 21 3.9 21 5V17.2L19 15.2V5H8.8"},Ke={key:0};function We(i,t,e,c,f,s){return a(),p("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon image-off-outline-icon",role:"img",onClick:t[0]||(t[0]=d=>i.$emit("click",d))}),[(a(),p("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[C("path",Fe,[e.title?(a(),p("title",Ke,w(e.title),1)):b("",!0)])],8,qe))],16,Ue)}const je=A(Pe,[["render",We]]),Ze={name:"PencilOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ye=["aria-hidden","aria-label"],Je=["fill","width","height"],Qe={d:"M14.06,9L15,9.94L5.92,19H5V18.08L14.06,9M17.66,3C17.41,3 17.15,3.1 16.96,3.29L15.13,5.12L18.88,8.87L20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18.17,3.09 17.92,3 17.66,3M14.06,6.19L3,17.25V21H6.75L17.81,9.94L14.06,6.19Z"},Ge={key:0};function Xe(i,t,e,c,f,s){return a(),p("span",O(i.$attrs,{"aria-hidden":e.title?null:"true","aria-label":e.title,class:"material-design-icon pencil-outline-icon",role:"img",onClick:t[0]||(t[0]=d=>i.$emit("click",d))}),[(a(),p("svg",{fill:e.fillColor,class:"material-design-icon__svg",width:e.size,height:e.size,viewBox:"0 0 24 24"},[C("path",Qe,[e.title?(a(),p("title",Ge,w(e.title),1)):b("",!0)])],8,Je))],16,Ye)}const ei=A(Ze,[["render",Xe]]),ii={key:0,class:"version__image"},ti=["src"],oi={key:2,class:"version__image"},si={class:"version__info"},ni=["title"],ri={key:1,class:"version__info","data-cy-files-version-author-name":""},ai={key:0},li=["title"],ci={class:"version__info version__info__subline"},di=B({__name:"VersionEntry",props:{version:{type:Object,required:!0},node:{type:Object,required:!0},isCurrent:{type:Boolean,default:!1},isFirstVersion:{type:Boolean,default:!1},loadPreview:{type:Boolean,default:!1},canView:{type:Boolean,default:!1},canCompare:{type:Boolean,default:!1}},emits:["click","compare","restore","delete","label-update-request"],setup(i,{emit:t}){const e=i,c=t,f=L(!1),s=L(!1),d=L(se("core","capabilities",{files:{version_labeling:!1,version_deletion:!1}})),_=g(()=>pe(e.version.size)),u=g(()=>{const r=e.version.label??"";return e.isCurrent?r===""?l("files_versions","Current version"):`${r} (${l("files_versions","Current version")})`:e.isFirstVersion&&r===""?l("files_versions","Initial version"):r}),y=g(()=>!e.version.author||!e.version.authorName?"":e.version.author===T()?.uid?l("files_versions","You"):e.version.authorName??e.version.author),n=g(()=>G(e.version.mtime).format("LLLL")),k=g(()=>e.isCurrent?e.node.source:he()+e.version.url),S=g(()=>d.value.files.version_labeling===!0),z=g(()=>d.value.files.version_deletion===!0),P=g(()=>o(e.node,J.DELETE)),I=g(()=>o(e.node,J.UPDATE)),U=g(()=>!((e.node.permissions&J.READ)===0||e.node.attributes["mount-type"]==="shared"&&e.node.attributes["share-attributes"]&&(JSON.parse(e.node.attributes["share-attributes"]).find(r=>r.scope==="permissions"&&r.key==="download")||{})?.value===!1));function q(){c("label-update-request")}function F(){c("restore",e.version)}async function K(){await Q(),await Q(),c("delete",e.version)}function W(r){e.canView&&r.preventDefault(),c("click",{version:e.version})}function j(){if(!e.canView)throw new Error("Cannot compare version of this file");c("compare",{version:e.version})}function o(r,m){return(r.permissions&m)!==0}return(r,m)=>(a(),H(v(fe),{class:"version","force-display-actions":!0,"actions-aria-label":v(l)("files_versions","Actions for version from {versionHumanExplicitDate}",{versionHumanExplicitDate:n.value}),"data-files-versions-version":i.version.fileVersion,href:k.value,onClick:W},{icon:h(()=>[i.loadPreview||f.value?i.version.previewUrl&&!s.value?(a(),p("img",{key:1,src:i.version.previewUrl,alt:"",decoding:"async",fetchpriority:"low",loading:"lazy",class:"version__image",onLoad:m[0]||(m[0]=x=>f.value=!0),onError:m[1]||(m[1]=x=>s.value=!0)},null,40,ti)):(a(),p("div",oi,[V(je,{size:20})])):(a(),p("div",ii))]),name:h(()=>[C("div",si,[u.value?(a(),p("div",{key:0,class:"version__info__label","data-cy-files-version-label":"",title:u.value},w(u.value),9,ni)):b("",!0),y.value?(a(),p("div",ri,[u.value?(a(),p("span",ai,"•")):b("",!0),V(v(ye),{class:"avatar",user:i.version.author??void 0,size:20,"disable-menu":"","disable-tooltip":"","hide-status":""},null,8,["user"]),C("div",{class:"version__info__author_name",title:y.value},w(y.value),9,li)])):b("",!0)])]),subname:h(()=>[C("div",ci,[V(v(we),{class:"version__info__date","relative-time":"short",timestamp:i.version.mtime},null,8,["timestamp"]),m[2]||(m[2]=C("span",null,"•",-1)),C("span",null,w(_.value),1)])]),actions:h(()=>[S.value&&I.value?(a(),H(v(D),{key:0,"data-cy-files-versions-version-action":"label","close-after-click":!0,onClick:q},{icon:h(()=>[V(ei,{size:22})]),default:h(()=>[E(" "+w(i.version.label===""?v(l)("files_versions","Name this version"):v(l)("files_versions","Edit version name")),1)]),_:1})):b("",!0),!i.isCurrent&&i.canView&&i.canCompare?(a(),H(v(D),{key:1,"data-cy-files-versions-version-action":"compare","close-after-click":!0,onClick:j},{icon:h(()=>[V(Re,{size:22})]),default:h(()=>[E(" "+w(v(l)("files_versions","Compare to current version")),1)]),_:1})):b("",!0),!i.isCurrent&&I.value?(a(),H(v(D),{key:2,"data-cy-files-versions-version-action":"restore","close-after-click":!0,onClick:F},{icon:h(()=>[V(Ie,{size:22})]),default:h(()=>[E(" "+w(v(l)("files_versions","Restore version")),1)]),_:1})):b("",!0),U.value?(a(),H(v(be),{key:3,"data-cy-files-versions-version-action":"download",href:k.value,"close-after-click":!0,download:k.value},{icon:h(()=>[V(ke,{size:22})]),default:h(()=>[E(" "+w(v(l)("files_versions","Download version")),1)]),_:1},8,["href","download"])):b("",!0),!i.isCurrent&&z.value&&P.value?(a(),H(v(D),{key:4,"data-cy-files-versions-version-action":"delete","close-after-click":!0,onClick:K},{icon:h(()=>[V(_e,{size:22})]),default:h(()=>[E(" "+w(v(l)("files_versions","Delete version")),1)]),_:1})):b("",!0)]),_:1},8,["actions-aria-label","data-files-versions-version","href"]))}}),ui=A(di,[["__scopeId","data-v-ef281a62"]]),vi={class:"version-label-modal__info"},mi=B({__name:"VersionLabelDialog",props:{open:{type:Boolean,default:!1},label:{type:String,default:""}},emits:["update:open","update:label"],setup(i,{emit:t}){const e=i,c=t,f=ne("labelInput"),s=L(""),d=g(()=>{const u=[];return e.label.trim()===""?u.push({label:l("files_versions","Cancel")}):u.push({label:l("files_versions","Remove version name"),type:"reset",variant:"error",callback:()=>{_("")}}),[...u,{label:l("files_versions","Save version name"),icon:Ve,type:"submit",variant:"primary"}]});ee(()=>{s.value=e.label??""}),ee(()=>{e.open&&Q(()=>f.value?.focus()),s.value=e.label});function _(u){c("update:label",u)}return(u,y)=>(a(),H(v(te),{buttons:d.value,"content-classes":"version-label-modal","is-form":"",open:i.open,size:"normal",name:v(l)("files_versions","Name this version"),"onUpdate:open":y[1]||(y[1]=n=>u.$emit("update:open",n)),onSubmit:y[2]||(y[2]=n=>_(s.value))},{default:h(()=>[V(v(Ce),{ref_key:"labelInput",ref:f,modelValue:s.value,"onUpdate:modelValue":y[0]||(y[0]=n=>s.value=n),class:"version-label-modal__input",label:v(l)("files_versions","Version name"),placeholder:v(l)("files_versions","Version name")},null,8,["modelValue","label","placeholder"]),C("p",vi,w(v(l)("files_versions","Named versions are persisted, and excluded from automatic cleanups when your storage quota is full.")),1)]),_:1},8,["buttons","open","name"]))}}),pi=A(mi,[["__scopeId","data-v-6a69577b"]]),$=re().setApp("files_version").detectUser().build(),fi=B({name:"VirtualScrolling",props:{sections:{type:Array,required:!0},containerElement:{type:HTMLElement,default:null},useWindow:{type:Boolean,default:!1},headerHeight:{type:Number,default:75},renderDistance:{type:Number,default:.5},bottomBufferRatio:{type:Number,default:2},scrollToKey:{type:String,default:""}},emits:["need-content"],data(){return{scrollPosition:0,containerHeight:0,rowsContainerHeight:0,resizeObserver:null}},computed:{visibleSections(){$.debug("[VirtualScrolling] Computing visible section",{sections:this.sections});const i=this.containerHeight,t=this.scrollPosition,e=t+i;let c=0,f=0;const s=this.sections.map(n=>(f+=this.headerHeight,{...n,rows:n.rows.reduce((k,S)=>{c=f,f+=S.height;let z=0;return f<t?z=(t-f)/i:c>e&&(z=(c-e)/i),z>this.renderDistance?k:[...k,{...S,distance:z}]},[])})).filter(n=>n.rows.length>0),d=s.flatMap(({rows:n})=>n).flatMap(({items:n})=>n),_=this._rowIdToKeyMap;d.forEach(n=>n.key=_[n.id]);const u=d.map(({key:n})=>n).filter(n=>n!==void 0),y=Object.values(_).filter(n=>!u.includes(n));return d.filter(({key:n})=>n===void 0).forEach(n=>n.key=y.pop()??Math.random().toString(36).substr(2)),this._rowIdToKeyMap=d.reduce((n,{id:k,key:S})=>({...n,[`${k}`]:S}),{}),s},totalHeight(){return this.sections.map(i=>this.headerHeight+i.height).reduce((i,t)=>i+t,0)+0},paddingTop(){if(this.visibleSections.length===0)return 0;let i=0;for(const t of this.sections){if(t.key!==this.visibleSections[0].rows[0].sectionKey){i+=this.headerHeight+t.height;continue}for(const e of t.rows){if(e.key===this.visibleSections[0].rows[0].key)return i;i+=e.height}i+=this.headerHeight}return i},rowsContainerStyle(){return{height:`${this.totalHeight}px`,paddingTop:`${this.paddingTop}px`}},isNearBottom(){const i=this.containerHeight*this.bottomBufferRatio;return this.scrollPosition+this.containerHeight>=this.totalHeight-i},container(){return $.debug("[VirtualScrolling] Computing container"),this.containerElement!==null?this.containerElement:this.useWindow?window:this.$refs.container}},watch:{isNearBottom(i){$.debug("[VirtualScrolling] isNearBottom changed",{value:i}),i&&this.$emit("need-content")},visibleSections(){this.isNearBottom&&this.$emit("need-content")},scrollToKey(i){let t=0;for(const e of this.sections){if(e.key!==i){t+=this.headerHeight+e.height;continue}break}$.debug("[VirtualScrolling] Scrolling to",{currentRowTopDistanceFromTop:t}),this.container.scrollTo({top:t,behavior:"smooth"})}},beforeCreate(){this._rowIdToKeyMap={}},mounted(){this.resizeObserver=new ResizeObserver(i=>{for(const t of i){const e=t.contentRect;t.target===this.container&&(this.containerHeight=e.height),t.target.classList.contains("vs-rows-container")&&(this.rowsContainerHeight=e.height)}}),this.useWindow?(window.addEventListener("resize",this.updateContainerSize,{passive:!0}),this.containerHeight=window.innerHeight):this.resizeObserver.observe(this.container),this.resizeObserver.observe(this.$refs.rowsContainer),this.container.addEventListener("scroll",this.updateScrollPosition,{passive:!0})},beforeUnmount(){this.useWindow&&window.removeEventListener("resize",this.updateContainerSize),this.resizeObserver?.disconnect(),this.container.removeEventListener("scroll",this.updateScrollPosition)},methods:{updateScrollPosition(){this._onScrollHandle??=requestAnimationFrame(()=>{this._onScrollHandle=null,this.useWindow?this.scrollPosition=this.container.scrollY:this.scrollPosition=this.container.scrollTop})},updateContainerSize(){this.containerHeight=window.innerHeight}}}),hi={key:0,ref:"container",class:"vs-container"};function gi(i,t,e,c,f,s){return!i.useWindow&&i.containerElement===null?(a(),p("div",hi,[C("div",{ref:"rowsContainer",class:"vs-rows-container",style:ie(i.rowsContainerStyle)},[M(i.$slots,"default",{visibleSections:i.visibleSections},void 0,!0),M(i.$slots,"loader",{},void 0,!0)],4)],512)):(a(),p("div",{key:1,ref:"rowsContainer",class:"vs-rows-container",style:ie(i.rowsContainerStyle)},[M(i.$slots,"default",{visibleSections:i.visibleSections},void 0,!0),M(i.$slots,"loader",{},void 0,!0)],4))}const bi=A(fi,[["render",gi],["__scopeId","data-v-b0f92288"]]),yi=`<?xml version="1.0"?>
<d:propfind xmlns:d="DAV:"
	xmlns:oc="http://owncloud.org/ns"
	xmlns:nc="http://nextcloud.org/ns"
	xmlns:ocs="http://open-collaboration-services.org/ns">
	<d:prop>
		<d:getcontentlength />
		<d:getcontenttype />
		<d:getlastmodified />
		<d:getetag />
		<nc:version-label />
		<nc:version-author />
		<nc:has-preview />
	</d:prop>
</d:propfind>`,R=Se();async function wi(i){const t=`/versions/${T()?.uid}/versions/${i.fileid}`;try{const e=(await R.getDirectoryContents(t,{data:yi,details:!0})).data.filter(({mime:s})=>s!=="").map(s=>Ci(s,i)),c=new Set(e.map(s=>String(s.author))),f=await He.post(X("/displaynames"),{users:[...c]});for(const s of e){const d=f.data.users[s.author??""];d&&(s.authorName=d)}return e}catch(e){throw $.error("Could not fetch version",{exception:e}),e}}async function _i(i){try{$.debug("Restoring version",{url:i.url}),await R.moveFile(`/versions/${T()?.uid}/versions/${i.fileId}/${i.fileVersion}`,`/versions/${T()?.uid}/restore/target`)}catch(t){throw $.error("Could not restore version",{exception:t}),t}}function Ci(i,t){const e=G(i.lastmod).unix()*1e3;let c="";return e===t.mtime?.getTime()?c=X("/core/preview?fileId={fileId}&c={fileEtag}&x=250&y=250&forceIcon=0&a=0&forceIcon=1&mimeFallback=1",{fileId:t.fileid,fileEtag:t.attributes.etag}):c=X("/apps/files_versions/preview?file={file}&version={fileVersion}&mimeFallback=1",{file:t.path,fileVersion:i.basename}),{fileId:t.fileid.toString(),label:i.props["version-label"]?String(i.props["version-label"]):"",author:i.props["version-author"]?String(i.props["version-author"]):null,authorName:null,filename:i.filename,basename:G(e).format("LLL"),mime:i.mime,etag:`${i.props.getetag}`,size:i.size,type:i.type,mtime:e,permissions:"R",previewUrl:c,url:ae("/remote.php/dav",i.filename),source:ge("dav")+le(i.filename),fileVersion:i.basename}}async function ki(i,t){return await R.customRequest(i.filename,{method:"PROPPATCH",data:`<?xml version="1.0"?>
					<d:propertyupdate xmlns:d="DAV:"
						xmlns:oc="http://owncloud.org/ns"
						xmlns:nc="http://nextcloud.org/ns"
						xmlns:ocs="http://open-collaboration-services.org/ns">
					<d:set>
						<d:prop>
							<nc:version-label>${t}</nc:version-label>
						</d:prop>
					</d:set>
					</d:propertyupdate>`})}async function Vi(i){await R.deleteFile(i.filename)}const Hi={key:0,class:"versions-tab__container"},Si=["aria-label"],Wi=B({__name:"FilesVersionsSidebarTab",props:{node:{},folder:{},view:{}},setup(i,{expose:t}){const e=i;t({setActive:I});const c=oe(),f=L(!1),s=L([]),d=L(!1),_=L(!1),u=L(null);ce(de(()=>e.node),async()=>{if(e.node)try{d.value=!0,s.value=await wi(e.node)}finally{d.value=!1}},{immediate:!0});const y=g(()=>e.node?.mtime?.getTime()??0),n=g(()=>[...s.value].sort((o,r)=>e.node?o.mtime===e.node.mtime?.getTime()?-1:r.mtime===e.node.mtime?.getTime()?1:r.mtime-o.mtime:0)),k=g(()=>[{key:"versions",rows:n.value.map(o=>({key:o.mtime.toString(),height:68,sectionKey:"versions",items:[{id:o.mtime.toString(),version:o}]})),height:68*n.value.length}]),S=g(()=>s.value.map(o=>o.mtime).reduce((o,r)=>Math.min(o,r))),z=g(()=>e.node?window.OCA.Viewer?.mimetypes?.includes(e.node?.mime):!1),P=g(()=>!c.value&&window.OCA.Viewer?.mimetypesCompare?.includes(e.node?.mime));function I(o){f.value=o}async function U(o){if(!e.node)return;const r=e.node.clone();r.attributes.etag=o.etag,r.size=o.size,r.mtime=new Date(o.mtime);const m={preventDefault:!1,node:r,version:o};if(N("files_versions:restore:requested",m),!m.preventDefault)try{await _i(o),o.label?Z(l("files_versions",`${o.label} restored`)):o.mtime===S.value?Z(l("files_versions","Initial version restored")):Z(l("files_versions","Version restored")),N("files:node:updated",r),N("files_versions:restore:restored",{node:r,version:o})}catch{Y(l("files_versions","Could not restore version")),N("files_versions:restore:failed",o)}}function q(o){_.value=!0,u.value=o}async function F(o){if(u.value===null)throw new Error("editedVersion should be set at that point");const r=u.value.label;u.value.label=o,_.value=!1;try{await ki(u.value,o),u.value=null}catch(m){u.value.label=r,Y(l("files_versions","Could not set version label")),$.error("Could not set version label",{exception:m})}}async function K(o){const r=s.value.indexOf(o);s.value.splice(r,1);try{await Vi(o)}catch{s.value.push(o),Y(l("files_versions","Could not delete version"))}}function W({version:o}){if(e.node!==null){if(o.mtime===e.node?.mtime?.getTime()){window.OCA.Viewer.open({path:e.node.path});return}window.OCA.Viewer.open({fileInfo:{...o,filename:o.filename,previewUrl:void 0},enableSidebar:!1})}}function j({version:o}){const r=s.value.map(m=>({...m,previewUrl:void 0}));window.OCA.Viewer.compare({path:e.node.path},r.find(m=>m.source===o.source))}return(o,r)=>i.node?(a(),p("div",Hi,[V(bi,{sections:k.value,"header-height":0},{default:h(({visibleSections:m})=>[C("ul",{"aria-label":v(l)("files_versions","File versions"),"data-files-versions-versions-list":""},[m.length===1?(a(!0),p(ue,{key:0},ve(m[0].rows,x=>(a(),H(ui,{key:x.items[0].version.mtime,"can-view":z.value,"can-compare":P.value,"load-preview":f.value,version:x.items[0].version,node:i.node,"is-current":x.items[0].version.mtime===y.value,"is-first-version":x.items[0].version.mtime===S.value,onClick:W,onCompare:j,onRestore:U,onLabelUpdateRequest:Li=>q(x.items[0].version),onDelete:K},null,8,["can-view","can-compare","load-preview","version","node","is-current","is-first-version","onLabelUpdateRequest"]))),128)):b("",!0)],8,Si)]),loader:h(()=>[d.value?(a(),H(v(me),{key:0,class:"files-list-viewer__loader"})):b("",!0)]),_:1},8,["sections"]),u.value?(a(),H(pi,{key:0,open:_.value,"onUpdate:open":r[0]||(r[0]=m=>_.value=m),label:u.value.label,"onUpdate:label":F},null,8,["open","label"])):b("",!0)])):b("",!0)}});export{Wi as default};
//# sourceMappingURL=FilesVersionsSidebarTab-CNKpFJer.chunk.mjs.map
