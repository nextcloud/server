{"version":3,"file":"NcPasswordField-djttkA5Q-BJMJ835s.chunk.mjs","sources":["../node_modules/@nextcloud/vue/dist/chunks/NcPasswordField-djttkA5Q.mjs"],"sourcesContent":["import '../assets/NcPasswordField-BCJ0LHSS.css';\nimport { defineComponent, mergeModels, useModel, watch, useTemplateRef, ref, computed, createBlock, openBlock, mergeProps, unref, createSlots, withCtx, createVNode, renderSlot } from \"vue\";\nimport { o as mdiEyeOff, p as mdiEye } from \"./mdi-XFJRiRqJ.mjs\";\nimport axios from \"@nextcloud/axios\";\nimport { getCapabilities } from \"@nextcloud/capabilities\";\nimport { generateOcsUrl } from \"@nextcloud/router\";\nimport debounce from \"debounce\";\nimport { N as NcIconSvgWrapper } from \"./NcIconSvgWrapper-BvLanNaW.mjs\";\nimport { N as NcInputField } from \"./NcInputField-Bwsh2aHY.mjs\";\nimport { r as register, a as t } from \"./_l10n-DrTiip5c.mjs\";\nimport { l as logger } from \"./logger-D3RVzcfQ.mjs\";\nimport { _ as _export_sfc } from \"./_plugin-vue_export-helper-1tPrXgE0.mjs\";\nregister();\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"NcPasswordField\",\n  props: /* @__PURE__ */ mergeModels({\n    class: {},\n    inputClass: { default: \"\" },\n    id: {},\n    label: {},\n    labelOutside: { type: Boolean },\n    placeholder: {},\n    showTrailingButton: { type: Boolean, default: true },\n    success: { type: Boolean },\n    error: { type: Boolean },\n    helperText: {},\n    disabled: { type: Boolean },\n    pill: { type: Boolean },\n    checkPasswordStrength: { type: Boolean },\n    minlength: { default: void 0 },\n    asText: { type: Boolean }\n  }, {\n    \"modelValue\": { default: \"\" },\n    \"modelModifiers\": {},\n    \"visible\": { type: Boolean, ...{ default: false } },\n    \"visibleModifiers\": {}\n  }),\n  emits: /* @__PURE__ */ mergeModels([\"valid\", \"invalid\"], [\"update:modelValue\", \"update:visible\"]),\n  setup(__props, { expose: __expose, emit: __emit }) {\n    const modelValue = useModel(__props, \"modelValue\");\n    const visible = useModel(__props, \"visible\");\n    const props = __props;\n    const emit = __emit;\n    watch(modelValue, debounce(checkPassword, 500));\n    __expose({\n      focus,\n      select\n    });\n    const { password_policy: passwordPolicy } = getCapabilities();\n    const inputFieldInstance = useTemplateRef(\"inputField\");\n    const internalHelpMessage = ref(\"\");\n    const isValid = ref();\n    const propsToForward = computed(() => {\n      const all = { ...props };\n      delete all.checkPasswordStrength;\n      delete all.minlength;\n      delete all.asText;\n      delete all.error;\n      delete all.helperText;\n      delete all.inputClass;\n      delete all.success;\n      return all;\n    });\n    const minLengthWithPolicy = computed(() => {\n      return props.minlength ?? (props.checkPasswordStrength ? passwordPolicy?.minLength : void 0) ?? void 0;\n    });\n    async function checkPassword() {\n      if (!props.checkPasswordStrength) {\n        return;\n      }\n      try {\n        const { data } = await axios.post(generateOcsUrl(\"apps/password_policy/api/v1/validate\"), { password: modelValue.value });\n        isValid.value = data.ocs.data.passed;\n        if (data.ocs.data.passed) {\n          internalHelpMessage.value = t(\"Password is secure\");\n          emit(\"valid\");\n          return;\n        }\n        internalHelpMessage.value = data.ocs.data.reason;\n        emit(\"invalid\");\n      } catch (error) {\n        logger.error(\"Password policy returned an error\", { error });\n      }\n    }\n    function toggleVisibility() {\n      visible.value = !visible.value;\n    }\n    function focus(options) {\n      inputFieldInstance.value.focus(options);\n    }\n    function select() {\n      inputFieldInstance.value.select();\n    }\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(NcInputField, mergeProps(propsToForward.value, {\n        ref: \"inputField\",\n        modelValue: modelValue.value,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => modelValue.value = $event),\n        error: _ctx.error || isValid.value === false,\n        \"helper-text\": _ctx.helperText || internalHelpMessage.value,\n        \"input-class\": [_ctx.inputClass, { \"password-field__input--secure-text\": !visible.value && _ctx.asText }],\n        minlength: minLengthWithPolicy.value,\n        success: _ctx.success || isValid.value === true,\n        \"trailing-button-label\": visible.value ? unref(t)(\"Hide password\") : unref(t)(\"Show password\"),\n        type: visible.value || _ctx.asText ? \"text\" : \"password\",\n        onTrailingButtonClick: toggleVisibility\n      }), createSlots({\n        \"trailing-button-icon\": withCtx(() => [\n          createVNode(NcIconSvgWrapper, {\n            path: visible.value ? unref(mdiEyeOff) : unref(mdiEye)\n          }, null, 8, [\"path\"])\n        ]),\n        _: 2\n      }, [\n        !!_ctx.$slots.icon ? {\n          name: \"icon\",\n          fn: withCtx(() => [\n            renderSlot(_ctx.$slots, \"icon\", {}, void 0, true)\n          ]),\n          key: \"0\"\n        } : void 0\n      ]), 1040, [\"modelValue\", \"error\", \"helper-text\", \"input-class\", \"minlength\", \"success\", \"trailing-button-label\", \"type\"]);\n    };\n  }\n});\nconst NcPasswordField = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__scopeId\", \"data-v-b2684de6\"]]);\nexport {\n  NcPasswordField as N\n};\n//# sourceMappingURL=NcPasswordField-djttkA5Q.mjs.map\n"],"names":["register","_sfc_main","defineComponent","mergeModels","__props","__expose","__emit","modelValue","useModel","visible","props","emit","watch","debounce","checkPassword","focus","select","passwordPolicy","getCapabilities","inputFieldInstance","useTemplateRef","internalHelpMessage","ref","isValid","propsToForward","computed","all","minLengthWithPolicy","data","axios","generateOcsUrl","t","error","logger","toggleVisibility","options","_ctx","_cache","openBlock","createBlock","NcInputField","mergeProps","$event","unref","createSlots","withCtx","createVNode","NcIconSvgWrapper","mdiEyeOff","mdiEye","renderSlot","NcPasswordField","_export_sfc"],"mappings":"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","x_google_ignoreList":[0]}