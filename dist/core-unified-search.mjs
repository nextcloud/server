/*! third party licenses: dist/vendor.LICENSE.txt */
import{g as w}from"./chunks/index-CiG5J8j_.mjs";import{F as h,a6 as _,R as S,a9 as A,al as I,D as F,X as b,a2 as N,bR as p,b$ as C,bZ as P,bW as M,v as R,b as D,cb as U,cq as L,bS as o,bQ as m,c0 as T,aV as y,c5 as B}from"./core-common.mjs";import{d as O,P as Q,c as E}from"./chunks/pinia-CcZmjq9w.mjs";import{n as c,aK as x,ak as V,af as u,a7 as $,aj as q,al as z,aL as H,aM as Y,aN as j}from"./chunks/icons-TElqpmA8.mjs";import{d as g}from"./chunks/index-DCgLaXhm.mjs";const G={name:"CustomDateRangeModal",components:{NcButton:h,NcModal:_,CalendarRangeIcon:x,NcDateTimePicker:S},props:{isOpen:{type:Boolean,required:!0}},data(){return{dateFilter:{startFrom:null,endAt:null}}},computed:{isModalOpen:{get(){return this.isOpen},set(e){this.$emit("update:is-open",e)}}},methods:{closeModal(){this.isModalOpen=!1},applyCustomRange(){this.$emit("set:custom-date-range",this.dateFilter),this.closeModal()}}};var W=function(){var e=this,t=e._self._c;return e.isModalOpen?t("NcModal",{attrs:{id:"unified-search",name:e.t("core","Custom date range"),show:e.isModalOpen,size:"small","clear-view-delay":0,title:e.t("core","Custom date range")},on:{"update:show":function(i){e.isModalOpen=i},close:e.closeModal}},[t("div",{staticClass:"unified-search-custom-date-modal"},[t("h1",[e._v(e._s(e.t("core","Custom date range")))]),t("div",{staticClass:"unified-search-custom-date-modal__pickers"},[t("NcDateTimePicker",{attrs:{id:"unifiedsearch-custom-date-range-start",label:e.t("core","Pick start date"),type:"date"},model:{value:e.dateFilter.startFrom,callback:function(i){e.$set(e.dateFilter,"startFrom",i)},expression:"dateFilter.startFrom"}}),t("NcDateTimePicker",{attrs:{id:"unifiedsearch-custom-date-range-end",label:e.t("core","Pick end date"),type:"date"},model:{value:e.dateFilter.endAt,callback:function(i){e.$set(e.dateFilter,"endAt",i)},expression:"dateFilter.endAt"}})],1),t("div",{staticClass:"unified-search-custom-date-modal__footer"},[t("NcButton",{on:{click:e.applyCustomRange},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CalendarRangeIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,3084610734)},[e._v(" "+e._s(e.t("core","Search in date range"))+" ")])],1)])]):e._e()},K=[],X=c(G,W,K,!1,null,"268fedef");const Z=X.exports,J={name:"SearchFilterChip",components:{CloseIcon:V},props:{text:{type:String,required:!0},pretext:{type:String,required:!0}},methods:{deleteChip(){this.$emit("delete",this.filter)}}};var ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"chip"},[t("span",{staticClass:"icon"},[e._t("icon"),e.pretext.length?t("span",[e._v(" "+e._s(e.pretext)+" : ")]):e._e()],2),t("span",{staticClass:"text"},[e._v(e._s(e.text))]),t("span",{staticClass:"close-icon",on:{click:e.deleteChip}},[t("CloseIcon",{attrs:{size:18}})],1)])},te=[],ie=c(J,ee,te,!1,null,"2f1043ca");const se=ie.exports,re={name:"SearchableList",components:{NcPopover:A,NcTextField:I,Magnify:u,AlertCircleOutline:$,NcAvatar:F,NcEmptyContent:b,NcButton:h},props:{labelText:{type:String,default:"this is a label"},searchList:{type:Array,required:!0},emptyContentText:{type:String,required:!0}},data(){return{opened:!1,error:!1,searchTerm:""}},computed:{filteredList(){return this.searchList.filter(e=>this.searchTerm.toLowerCase().length?["displayName"].some(t=>e[t].toLowerCase().includes(this.searchTerm.toLowerCase())):!0)}},methods:{clearSearch(){this.searchTerm=""},itemSelected(e){this.$emit("item-selected",e),this.clearSearch(),this.opened=!1},searchTermChanged(e){this.$emit("search-term-change",e)}}};var ae=function(){var e=this,t=e._self._c;return t("NcPopover",{attrs:{shown:e.opened},on:{show:function(i){e.opened=!0},hide:function(i){e.opened=!1}},scopedSlots:e._u([{key:"trigger",fn:function(){return[e._t("trigger")]},proxy:!0}],null,!0)},[t("div",{staticClass:"searchable-list__wrapper"},[t("NcTextField",{attrs:{value:e.searchTerm,label:e.labelText,"trailing-button-icon":"close","show-trailing-button":e.searchTerm!==""},on:{"update:value":[function(i){e.searchTerm=i},e.searchTermChanged],"trailing-button-click":e.clearSearch}},[t("Magnify",{attrs:{size:20}})],1),e.filteredList.length>0?t("ul",{staticClass:"searchable-list__list"},e._l(e.filteredList,function(i){return t("li",{key:i.id,attrs:{title:i.displayName,role:"button"}},[t("NcButton",{attrs:{alignment:"start",type:"tertiary",wide:!0},on:{click:function(s){return e.itemSelected(i)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.isUser?t("NcAvatar",{attrs:{user:i.user,"show-user-status":!1}}):t("NcAvatar",{attrs:{"is-no-user":!0,"display-name":i.displayName,"show-user-status":!1}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(i.displayName)+" ")])],1)}),0):t("div",{staticClass:"searchable-list__empty-content"},[t("NcEmptyContent",{attrs:{name:e.emptyContentText},scopedSlots:e._u([{key:"icon",fn:function(){return[t("AlertCircleOutline")]},proxy:!0}])})],1)],1)])},ne=[],oe=c(re,ae,ne,!1,null,"379f1814");const le=oe.exports,ce={name:"SearchResult",components:{NcListItem:N},props:{thumbnailUrl:{type:String,default:null},title:{type:String,required:!0},subline:{type:String,default:null},resourceUrl:{type:String,default:null},icon:{type:String,default:""},rounded:{type:Boolean,default:!1},query:{type:String,default:""},focused:{type:Boolean,default:!1}},data(){return{thumbnailHasError:!1}},watch:{thumbnailUrl(){this.thumbnailHasError=!1}},methods:{isValidIconOrPreviewUrl(e){return/^https?:\/\//.test(e)||e.startsWith("/")},thumbnailErrorHandler(){this.thumbnailHasError=!0}}};var de=function(){var e=this,t=e._self._c;return t("NcListItem",{staticClass:"result-items__item",attrs:{name:e.title,bold:!1,href:e.resourceUrl,target:"_self"},scopedSlots:e._u([{key:"icon",fn:function(){return[t("div",{staticClass:"result-items__item-icon",class:{"result-items__item-icon--rounded":e.rounded,"result-items__item-icon--no-preview":!e.isValidIconOrPreviewUrl(e.thumbnailUrl),"result-items__item-icon--with-thumbnail":e.isValidIconOrPreviewUrl(e.thumbnailUrl),[e.icon]:!e.isValidIconOrPreviewUrl(e.icon)},style:{backgroundImage:e.isValidIconOrPreviewUrl(e.icon)?"url(".concat(e.icon,")"):""},attrs:{"aria-hidden":"true"}},[e.isValidIconOrPreviewUrl(e.thumbnailUrl)&&!e.thumbnailHasError?t("img",{attrs:{src:e.thumbnailUrl},on:{error:e.thumbnailErrorHandler}}):e._e()])]},proxy:!0},{key:"subname",fn:function(){return[e._v(" "+e._s(e.subline)+" ")]},proxy:!0}])})},ue=[],he=c(ce,de,ue,!1,null,"794d598f");const pe=he.exports,fe=()=>p.CancelToken.source();async function me(){try{const{data:e}=await p.get(C("search/providers"),{params:{from:window.location.pathname.replace("/index.php","")+window.location.search}});if("ocs"in e&&"data"in e.ocs&&Array.isArray(e.ocs.data)&&e.ocs.data.length>0)return e.ocs.data}catch(e){console.error(e)}return[]}function ye({type:e,query:t,cursor:i,since:s,until:r,limit:a,person:n,extraQueries:d={}}){const l=fe();return{request:async()=>p.get(C("search/providers/{type}/search",{type:e}),{cancelToken:l.token,params:{term:t,cursor:i,since:s,until:r,limit:a,person:n,from:window.location.pathname.replace("/index.php","")+window.location.search,...d}}),cancel:l.cancel}}async function v({searchTerm:e}){const{data:{contacts:t}}=await p.post(P("/contactsmenu/contacts"),{filter:e});if(!e){let i=M();return i={id:i.uid,fullName:i.displayName,emailAddresses:[]},t.unshift(i),t}return t}const k=O({id:"search",state:()=>({externalFilters:[]}),actions:{registerExternalFilter({id:e,appId:t,label:i,callback:s,icon:r}){this.externalFilters.push({id:e,appId:t,name:i,callback:s,icon:r,isPluginFilter:!0})}}}),ge={name:"UnifiedSearchModal",components:{ArrowRight:q,AccountGroup:z,CalendarRangeIcon:x,CustomDateRangeModal:Z,DotsHorizontalIcon:H,FilterIcon:Y,FilterChip:se,ListBox:j,NcActions:R,NcActionButton:D,NcAvatar:F,NcButton:h,NcEmptyContent:b,NcModal:_,NcInputField:U,MagnifyIcon:u,SearchableList:le,SearchResult:pe},props:{isVisible:{type:Boolean,required:!0}},setup(){const e=L(),t=k();return{currentLocation:e,externalFilters:t.externalFilters}},data(){return{providers:[],providerActionMenuIsOpen:!1,dateActionMenuIsOpen:!1,providerResultLimit:5,dateFilter:{id:"date",type:"date",text:"",startFrom:null,endAt:null},personFilter:{id:"person",type:"person",name:""},dateFilterIsApplied:!1,personFilterIsApplied:!1,filteredProviders:[],searching:!1,searchQuery:"",placessearchTerm:"",dateTimeFilter:null,filters:[],results:[],contacts:[],debouncedFind:g(this.find,300),debouncedFilterContacts:g(this.filterContacts,300),showDateRangeModal:!1,internalIsVisible:!1}},computed:{userContacts(){return this.contacts},noContentInfo(){const e=this.searchQuery.length===0,t=this.searchQuery.length>0&&this.results.length===0;return{show:e||t,text:this.searching&&t?o("core","Searching â€¦"):e?o("core","Start typing to search"):o("core","No matching results"),icon:u}},supportFiltering(){return["/settings/users","/apps/files","/apps/deck"].some(e=>{var t,i;return(i=(t=this.currentLocation.pathname)==null?void 0:t.includes)==null?void 0:i.call(t,e)})}},watch:{isVisible(e){e&&m("nextcloud:unified-search.reset",{query:""}),this.internalIsVisible=e},internalIsVisible(e){this.$emit("update:isVisible",e),this.$nextTick(()=>{e&&this.focusInput()})}},mounted(){T("nextcloud:unified-search:add-filter",this.handlePluginFilter),me().then(e=>{this.providers=e,this.externalFilters.forEach(t=>{this.providers.push(t)}),this.providers=this.groupProvidersByApp(this.providers),console.debug("Search providers",this.providers)}),v({searchTerm:""}).then(e=>{this.contacts=this.mapContacts(e),console.debug("Contacts",this.contacts)})},methods:{find(e){if(this.searching=!0,e.length===0){this.results=[],this.searching=!1,m("nextcloud:unified-search.reset",{query:e});return}m("nextcloud:unified-search.search",{query:e});const t=[],i=this.filteredProviders.length>0?this.filteredProviders:this.providers,s=(r,a)=>{const n={type:r.id,query:e,cursor:null,extraQueries:r.extraParams};if(a.dateFilterIsApplied)if(r.filters.since&&r.filters.until)n.since=this.dateFilter.startFrom,n.until=this.dateFilter.endAt;else return;if(a.personFilterIsApplied)if(r.filters.person)n.person=this.personFilter.user;else return;this.providerResultLimit>5&&(n.limit=this.providerResultLimit);const d=ye(n).request;d().then(l=>{t.push({id:r.id,provider:r.name,inAppSearch:r.inAppSearch,results:l.data.ocs.data.entries}),console.debug("New results",t),console.debug("Unified search results:",this.results),this.updateResults(t),this.searching=!1})};i.forEach(r=>{const a=this.dateFilterIsApplied,n=this.personFilterIsApplied;s(r,{dateFilterIsApplied:a,personFilterIsApplied:n})})},updateResults(e){let t=[...this.results];this.filters.length>0&&(t=t.filter(s=>this.filters.some(r=>r.id===s.id))),e.forEach(s=>{const r=t.findIndex(a=>a.id===s.id);r!==-1?s.results.length===0?t.splice(r,1):t.splice(r,1,s):s.results.length>0&&t.push(s)});const i=t.slice(0);i.sort((s,r)=>{const a=this.providers.find(f=>f.id===s.id),n=this.providers.find(f=>f.id===r.id),d=a?a.order:0,l=n?n.order:0;return d-l}),this.results=i},mapContacts(e){return e.map(t=>({displayName:t.fullName,isNoUser:!1,subname:t.emailAddresses[0]?t.emailAddresses[0]:"",icon:"",user:t.id,isUser:t.isUser}))},filterContacts(e){v({searchTerm:e}).then(t=>{this.contacts=this.mapContacts(t),console.debug("Contacts filtered by ".concat(e),this.contacts)})},applyPersonFilter(e){this.personFilterIsApplied=!0;const t=this.filters.findIndex(i=>i.id===e.id);t===-1?(this.personFilter.id=e.id,this.personFilter.user=e.user,this.personFilter.name=e.displayName,this.filters.push(this.personFilter)):(this.filters[t].id=e.id,this.filters[t].user=e.user,this.filters[t].name=e.displayName),this.debouncedFind(this.searchQuery),console.debug("Person filter applied",e)},loadMoreResultsForProvider(e){this.providerResultLimit+=5,this.filters=this.filters.filter(i=>i.type!=="provider");const t=this.providers.find(i=>i.id===e);this.addProviderFilter(t,!0)},addProviderFilter(e,t=!1){if(!e.id)return;e.isPluginFilter&&e.callback(),this.providerResultLimit=t?this.providerResultLimit:5,this.providerActionMenuIsOpen=!1;const i=this.filteredProviders.findIndex(s=>s.id===e.id);i>-1&&(this.filteredProviders.splice(i,1),this.filters=this.syncProviderFilters(this.filters,this.filteredProviders)),this.filteredProviders.push({id:e.id,name:e.name,icon:e.icon,type:e.type||"provider",filters:e.filters,isPluginFilter:e.isPluginFilter||!1}),this.filters=this.syncProviderFilters(this.filters,this.filteredProviders),console.debug("Search filters (newly added)",this.filters),this.debouncedFind(this.searchQuery)},removeFilter(e){if(e.type==="provider"){for(let t=0;t<this.filteredProviders.length;t++)if(this.filteredProviders[t].id===e.id){this.filteredProviders.splice(t,1);break}this.filters=this.syncProviderFilters(this.filters,this.filteredProviders),console.debug("Search filters (recently removed)",this.filters)}else for(let t=0;t<this.filters.length;t++)if(this.filters[t].id==="date"||this.filters[t].id===e.id){this.dateFilterIsApplied=!1,this.filters.splice(t,1),e.type==="person"&&(this.personFilterIsApplied=!1);break}this.debouncedFind(this.searchQuery)},syncProviderFilters(e,t){const i=e.slice();return i.forEach((s,r)=>{const a=s.id;s.type==="provider"&&(t.some(n=>n.id===a)||i.splice(r,1))}),t.forEach(s=>{const r=s.id;s.type==="provider"&&(i.some(a=>a.id===r)||i.push(s))}),i},updateDateFilter(){const e=this.filters.findIndex(t=>t.id==="date");e!==-1?this.filters[e]=this.dateFilter:this.filters.push(this.dateFilter),this.dateFilterIsApplied=!0,this.debouncedFind(this.searchQuery)},applyQuickDateRange(e){this.dateActionMenuIsOpen=!1;const t=new Date;let i,s;switch(e){case"today":i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0),s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999),this.dateFilter.text=o("core","Today");break;case"7days":i=new Date(t.getFullYear(),t.getMonth(),t.getDate()-6,0,0,0,0),this.dateFilter.text=o("core","Last 7 days");break;case"30days":i=new Date(t.getFullYear(),t.getMonth(),t.getDate()-29,0,0,0,0),this.dateFilter.text=o("core","Last 30 days");break;case"thisyear":i=new Date(t.getFullYear(),0,1,0,0,0,0),s=new Date(t.getFullYear(),11,31,23,59,59,999),this.dateFilter.text=o("core","This year");break;case"lastyear":i=new Date(t.getFullYear()-1,0,1,0,0,0,0),s=new Date(t.getFullYear()-1,11,31,23,59,59,999),this.dateFilter.text=o("core","Last year");break;case"custom":this.showDateRangeModal=!0;return;default:return}this.dateFilter.startFrom=i,this.dateFilter.endAt=s,this.updateDateFilter()},setCustomDateRange(e){console.debug("Custom date range",e),this.dateFilter.startFrom=e.startFrom,this.dateFilter.endAt=e.endAt,this.dateFilter.text=o("core","Between ".concat(this.dateFilter.startFrom.toLocaleDateString()," and ").concat(this.dateFilter.endAt.toLocaleDateString())),this.updateDateFilter()},handlePluginFilter(e){for(let t=0;t<this.filteredProviders.length;t++){const i=this.filteredProviders[t];if(i.id===e.id){i.name=e.filterUpdateText,this.providers.findIndex(s=>s.id===e.id)>-1&&(i.extraParams=e.filterParams,this.filteredProviders[t]=i);break}}this.debouncedFind(this.searchQuery)},groupProvidersByApp(e){const t={};e.forEach(s=>{const r=s.appId?s.appId:"general";t[r]||(t[r]=[]),t[r].push(s)});const i=[];return Object.values(t).forEach(s=>{i.push(...s)}),i},focusInput(){this.$refs.searchInput.$el.children[0].children[0].focus()},closeModal(){this.internalIsVisible=!1,this.searchQuery=""}}};var ve=function(){var e=this,t=e._self._c;return t("NcModal",{ref:"unifiedSearchModal",attrs:{id:"unified-search",show:e.internalIsVisible,"clear-view-delay":0},on:{"update:show":function(i){e.internalIsVisible=i},close:e.closeModal}},[t("CustomDateRangeModal",{staticClass:"unified-search__date-range",attrs:{"is-open":e.showDateRangeModal},on:{"set:custom-date-range":e.setCustomDateRange,"update:is-open":function(i){e.showDateRangeModal=i}}}),t("div",{ref:"unifiedSearch",staticClass:"unified-search-modal"},[t("div",{staticClass:"unified-search-modal__header"},[t("h2",[e._v(e._s(e.t("core","Unified search")))]),t("NcInputField",{ref:"searchInput",attrs:{"data-cy-unified-search-input":"",value:e.searchQuery,type:"text",label:e.t("core","Search apps, files, tags, messages")+"..."},on:{"update:value":[function(i){e.searchQuery=i},e.debouncedFind]}}),t("div",{staticClass:"unified-search-modal__filters",attrs:{"data-cy-unified-search-filters":""}},[t("NcActions",{attrs:{"menu-name":e.t("core","Places"),open:e.providerActionMenuIsOpen,"data-cy-unified-search-filter":"places"},on:{"update:open":function(i){e.providerActionMenuIsOpen=i}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ListBox",{attrs:{size:20}})]},proxy:!0}])},e._l(e.providers,function(i){return t("NcActionButton",{key:"".concat(i.id,"-").concat(i.name.replace(/\s/g,"")),on:{click:function(s){return e.addProviderFilter(i)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("img",{staticClass:"filter-button__icon",attrs:{src:i.icon,alt:""}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(i.name)+" ")])}),1),t("NcActions",{attrs:{"menu-name":e.t("core","Date"),open:e.dateActionMenuIsOpen,"data-cy-unified-search-filter":"date"},on:{"update:open":function(i){e.dateActionMenuIsOpen=i}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("CalendarRangeIcon",{attrs:{size:20}})]},proxy:!0}])},[t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("today")}}},[e._v(" "+e._s(e.t("core","Today"))+" ")]),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("7days")}}},[e._v(" "+e._s(e.t("core","Last 7 days"))+" ")]),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("30days")}}},[e._v(" "+e._s(e.t("core","Last 30 days"))+" ")]),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("thisyear")}}},[e._v(" "+e._s(e.t("core","This year"))+" ")]),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("lastyear")}}},[e._v(" "+e._s(e.t("core","Last year"))+" ")]),t("NcActionButton",{attrs:{"close-after-click":!0},on:{click:function(i){return e.applyQuickDateRange("custom")}}},[e._v(" "+e._s(e.t("core","Custom date range"))+" ")])],1),t("SearchableList",{attrs:{"label-text":e.t("core","Search people"),"search-list":e.userContacts,"empty-content-text":e.t("core","Not found"),"data-cy-unified-search-filter":"people"},on:{"search-term-change":e.debouncedFilterContacts,"item-selected":e.applyPersonFilter},scopedSlots:e._u([{key:"trigger",fn:function(){return[t("NcButton",{scopedSlots:e._u([{key:"icon",fn:function(){return[t("AccountGroup",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("core","People"))+" ")])]},proxy:!0}])}),e.supportFiltering?t("NcButton",{attrs:{"data-cy-unified-search-filter":"current-view"},on:{click:e.closeModal},scopedSlots:e._u([{key:"icon",fn:function(){return[t("FilterIcon",{attrs:{size:20}})]},proxy:!0}],null,!1,2021673347)},[e._v(" "+e._s(e.t("core","Filter in current view"))+" ")]):e._e()],1),t("div",{staticClass:"unified-search-modal__filters-applied"},e._l(e.filters,function(i){var s;return t("FilterChip",{key:i.id,attrs:{text:(s=i.name)!=null?s:i.text,pretext:""},on:{delete:function(r){return e.removeFilter(i)}},scopedSlots:e._u([{key:"icon",fn:function(){return[i.type==="person"?t("NcAvatar",{attrs:{user:i.user,size:24,"disable-menu":!0,"show-user-status":!1,"hide-favorite":!1}}):i.type==="date"?t("CalendarRangeIcon"):t("img",{attrs:{src:i.icon,alt:""}})]},proxy:!0}],null,!0)})}),1)],1),e.noContentInfo.show?t("div",{staticClass:"unified-search-modal__no-content"},[t("NcEmptyContent",{attrs:{name:e.noContentInfo.text},scopedSlots:e._u([{key:"icon",fn:function(){return[t(e.noContentInfo.icon,{tag:"component"})]},proxy:!0}],null,!1,604901229)})],1):t("div",{staticClass:"unified-search-modal__results"},e._l(e.results,function(i){return t("div",{key:i.id,staticClass:"result"},[t("div",{staticClass:"result-title"},[t("span",[e._v(e._s(i.provider))])]),t("ul",{staticClass:"result-items"},e._l(i.results,function(s,r){return t("SearchResult",e._b({key:r},"SearchResult",s,!1))}),1),t("div",{staticClass:"result-footer"},[t("NcButton",{attrs:{type:"tertiary-no-background"},on:{click:function(s){return e.loadMoreResultsForProvider(i.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("DotsHorizontalIcon",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("core","Load more results"))+" ")]),i.inAppSearch?t("NcButton",{attrs:{alignment:"end-reverse",type:"tertiary-no-background"},scopedSlots:e._u([{key:"icon",fn:function(){return[t("ArrowRight",{attrs:{size:20}})]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("core","Search in"))+" "+e._s(i.provider)+" ")]):e._e()],1)])}),0)])],1)},_e=[],Fe=c(ge,ve,_e,!1,null,"0c9ec68d");const be=Fe.exports,Ce={name:"UnifiedSearch",components:{NcButton:h,Magnify:u,UnifiedSearchModal:be},data(){return{showUnifiedSearch:!1}},mounted(){console.debug("Unified search initialized!")},methods:{toggleUnifiedSearch(){this.showUnifiedSearch=!this.showUnifiedSearch},handleModalVisibilityChange(e){this.showUnifiedSearch=e}}};var xe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header-menu unified-search-menu"},[t("NcButton",{staticClass:"header-menu__trigger",attrs:{"aria-label":e.t("core","Unified search"),type:"tertiary-no-background"},on:{click:e.toggleUnifiedSearch},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Magnify",{staticClass:"header-menu__trigger-icon",attrs:{size:20}})]},proxy:!0}])}),t("UnifiedSearchModal",{attrs:{"is-visible":e.showUnifiedSearch},on:{"update:isVisible":e.handleModalVisibilityChange}})],1)},ke=[],we=c(Ce,xe,ke,!1,null,"2e041c36");const Se=we.exports,Ae=w().setApp("unified-search").detectUser().build();y.mixin({data(){return{logger:Ae}},methods:{t:o,n:B}}),window.OCA=window.OCA||{},window.OCA.UnifiedSearch={registerFilterAction:({id:e,appId:t,label:i,callback:s,icon:r})=>{k().registerExternalFilter({id:e,appId:t,label:i,callback:s,icon:r})}},y.use(Q);const Ie=E(),Ue=new y({el:"#unified-search",pinia:Ie,name:"UnifiedSearchRoot",render:e=>e(Se)});export{Ue as default};
