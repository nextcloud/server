{"version":3,"file":"files-init.js?v=5c50880652f4d555270b","mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AC3HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACvVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AClGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAkBA;AACA;;;;;;;;;;;;;;;ACvCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAkBA;AACA;;;;;;;;;;;;;;;ACvCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAkBA;AACA;;;;;;;;;;;;;;;ACtCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAkBA;AACA;;;;;;;;;;;;;;;ACvCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAkBA;AACA;;;;;;;;;;;;;;;ACvCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AGAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC3EA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AClFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACnLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACtJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACjEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACRA;AACA;AACA;AACA;AACA;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACNA;AACA;AACA;AACA;AACA;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvFA;;;;;AEAA;AACA;AACA;AACA;AACA","sources":["webpack:///nextcloud/apps/files/src/actions/convertAction.ts","webpack:///nextcloud/apps/files/src/actions/convertUtils.ts","webpack:///nextcloud/apps/files/src/actions/deleteAction.ts","webpack:///nextcloud/apps/files/src/actions/deleteUtils.ts","webpack:///nextcloud/apps/files/src/actions/downloadAction.ts","webpack:///nextcloud/apps/files/src/actions/favoriteAction.ts","webpack:///nextcloud/apps/files/src/actions/moveOrCopyAction.ts","webpack:///nextcloud/apps/files/src/actions/moveOrCopyActionUtils.ts","webpack:///nextcloud/apps/files/src/actions/openFolderAction.ts","webpack:///nextcloud/apps/files/src/actions/openInFilesAction.ts","webpack:///nextcloud/apps/files/src/actions/openLocallyAction.ts","webpack:///nextcloud/apps/files/src/actions/renameAction.ts","webpack:///nextcloud/apps/files/src/actions/sidebarAction.ts","webpack:///nextcloud/apps/files/src/actions/viewInFolderAction.ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilter.vue","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilter.vue?7bd9","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilter.vue?7f85","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilter.vue?4064","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterModified.vue","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterModified.vue?54c4","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterModified.vue?8053","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterModified.vue?b166","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterToSearch.vue","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterToSearch.vue?2974","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterToSearch.vue?d1bc","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterType.vue","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterType.vue?870d","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterType.vue?4d8b","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterType.vue?4ef5","webpack:///nextcloud/apps/files/src/components/NewNodeDialog.vue","webpack://nextcloud/./apps/files/src/components/NewNodeDialog.vue?12eb","webpack://nextcloud/./apps/files/src/components/NewNodeDialog.vue?a2dd","webpack://nextcloud/./apps/files/src/components/NewNodeDialog.vue?35e0","webpack:///nextcloud/apps/files/src/filters/FilenameFilter.ts","webpack:///nextcloud/apps/files/src/filters/HiddenFilesFilter.ts","webpack:///nextcloud/apps/files/src/filters/ModifiedFilter.ts","webpack:///nextcloud/apps/files/src/filters/SearchFilter.ts","webpack:///nextcloud/apps/files/src/filters/TypeFilter.ts","webpack:///nextcloud/apps/files/src/init.ts","webpack:///nextcloud/apps/files/src/logger.ts","webpack:///nextcloud/apps/files/src/newMenu/newFolder.ts","webpack:///nextcloud/apps/files/src/newMenu/newFromTemplate.ts","webpack:///nextcloud/apps/files/src/newMenu/newTemplatesFolder.ts","webpack:///nextcloud/apps/files/src/services/Favorites.ts","webpack:///nextcloud/apps/files/src/services/Files.ts","webpack:///nextcloud/apps/files/src/services/FolderTree.ts","webpack:///nextcloud/apps/files/src/services/LivePhotos.ts","webpack:///nextcloud/apps/files/src/services/PersonalFiles.ts","webpack:///nextcloud/apps/files/src/services/Recent.ts","webpack:///nextcloud/apps/files/src/services/Search.ts","webpack:///nextcloud/apps/files/src/services/ServiceWorker.js","webpack:///nextcloud/apps/files/src/services/WebDavSearch.ts","webpack:///nextcloud/apps/files/src/services/WebdavClient.ts","webpack:///nextcloud/apps/files/src/store/active.ts","webpack:///nextcloud/apps/files/src/store/files.ts","webpack:///nextcloud/apps/files/src/store/index.ts","webpack:///nextcloud/apps/files/src/store/paths.ts","webpack:///nextcloud/apps/files/src/store/search.ts","webpack:///nextcloud/apps/files/src/store/userconfig.ts","webpack:///nextcloud/apps/files/src/utils/filenameValidity.ts","webpack:///nextcloud/apps/files/src/utils/filesViews.ts","webpack:///nextcloud/apps/files/src/utils/hashUtils.ts","webpack:///nextcloud/apps/files/src/utils/newNodeDialog.ts","webpack:///nextcloud/apps/files/src/utils/permissions.ts","webpack:///nextcloud/apps/files/src/views/favorites.ts","webpack:///nextcloud/apps/files/src/views/files.ts","webpack:///nextcloud/apps/files/src/views/folderTree.ts","webpack:///nextcloud/apps/files/src/views/personal-files.ts","webpack:///nextcloud/apps/files/src/views/recent.ts","webpack:///nextcloud/apps/files/src/views/search.ts","webpack:///nextcloud/apps/files_trashbin/src/files_views/columns.ts","webpack:///nextcloud/apps/files_trashbin/src/files_views/trashbinView.ts","webpack:///nextcloud/apps/files_trashbin/src/services/client.ts","webpack:///nextcloud/apps/files_trashbin/src/services/trashbin.ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilter.vue?vue&type=script&setup=true&lang=ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterModified.vue?vue&type=script&lang=ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterToSearch.vue?vue&type=script&setup=true&lang=ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterType.vue?vue&type=script&lang=ts","webpack:///nextcloud/apps/files/src/components/NewNodeDialog.vue?vue&type=script&setup=true&lang=ts","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilter.vue?vue&type=template&id=5c291778&scoped=true","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterModified.vue?vue&type=template&id=f47dfc3e&scoped=true","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterToSearch.vue?vue&type=template&id=032b2a1b","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterType.vue?vue&type=template&id=6c0e6dd2","webpack:///nextcloud/apps/files/src/components/NewNodeDialog.vue?vue&type=template&id=e6b9c05a&scoped=true","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterModified.vue?vue&type=style&index=0&id=f47dfc3e&scoped=true&lang=scss","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilter.vue?vue&type=style&index=0&id=5c291778&scoped=true&lang=css","webpack:///nextcloud/apps/files/src/components/FileListFilter/FileListFilterType.vue?vue&type=style&index=0&id=6c0e6dd2&lang=css","webpack:///nextcloud/apps/files/src/components/NewNodeDialog.vue?vue&type=style&index=0&id=e6b9c05a&scoped=true&lang=css","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterModified.vue?1422","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilter.vue?fbd5","webpack://nextcloud/./apps/files/src/components/FileListFilter/FileListFilterType.vue?918c","webpack://nextcloud/./apps/files/src/components/NewNodeDialog.vue?2381","webpack:///nextcloud/webpack/bootstrap","webpack:///nextcloud/webpack/runtime/chunk loaded","webpack:///nextcloud/webpack/runtime/compat get default export","webpack:///nextcloud/webpack/runtime/define property getters","webpack:///nextcloud/webpack/runtime/ensure chunk","webpack:///nextcloud/webpack/runtime/get javascript chunk filename","webpack:///nextcloud/webpack/runtime/global","webpack:///nextcloud/webpack/runtime/hasOwnProperty shorthand","webpack:///nextcloud/webpack/runtime/load script","webpack:///nextcloud/webpack/runtime/make namespace object","webpack:///nextcloud/webpack/runtime/node module decorator","webpack:///nextcloud/webpack/runtime/publicPath","webpack:///nextcloud/webpack/runtime/jsonp chunk loading","webpack:///nextcloud/webpack/runtime/nonce","webpack:///nextcloud/webpack/before-startup","webpack:///nextcloud/webpack/startup","webpack:///nextcloud/webpack/after-startup"],"sourcesContent":["import { FileAction, registerFileAction } from '@nextcloud/files';\nimport { generateUrl } from '@nextcloud/router';\nimport { getCapabilities } from '@nextcloud/capabilities';\nimport { t } from '@nextcloud/l10n';\nimport AutoRenewSvg from '@mdi/svg/svg/autorenew.svg?raw';\nimport { convertFile, convertFiles } from \"./convertUtils\";\nexport const ACTION_CONVERT = 'convert';\nexport const registerConvertActions = () => {\n  // Generate sub actions\n  const convertProviders = getCapabilities()?.files?.file_conversions ?? [];\n  const actions = convertProviders.map(_ref => {\n    let {\n      to,\n      from,\n      displayName\n    } = _ref;\n    return new FileAction({\n      id: `convert-${from}-${to}`,\n      displayName: () => t('files', 'Save as {displayName}', {\n        displayName\n      }),\n      iconSvgInline: () => generateIconSvg(to),\n      enabled: nodes => {\n        // Check that all nodes have the same mime type\n        return nodes.every(node => from === node.mime);\n      },\n      async exec(node) {\n        // If we're here, we know that the node has a fileid\n        convertFile(node.fileid, to);\n        // Silently terminate, we'll handle the UI in the background\n        return null;\n      },\n      async execBatch(nodes) {\n        const fileIds = nodes.map(node => node.fileid).filter(Boolean);\n        convertFiles(fileIds, to);\n        // Silently terminate, we'll handle the UI in the background\n        return Array(nodes.length).fill(null);\n      },\n      parent: ACTION_CONVERT\n    });\n  });\n  // Register main action\n  registerFileAction(new FileAction({\n    id: ACTION_CONVERT,\n    displayName: () => t('files', 'Save as …'),\n    iconSvgInline: () => AutoRenewSvg,\n    enabled: (nodes, view) => {\n      return actions.some(action => action.enabled(nodes, view));\n    },\n    async exec() {\n      return null;\n    },\n    order: 25\n  }));\n  // Register sub actions\n  actions.forEach(registerFileAction);\n};\nexport const generateIconSvg = mime => {\n  // Generate icon based on mime type\n  const url = generateUrl('/core/mimeicon?mime=' + encodeURIComponent(mime));\n  return `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\"\n\t\txmlns=\"http://www.w3.org/2000/svg\">\n\t\t<image href=\"${url}\" height=\"32\" width=\"32\" />\n\t</svg>`;\n};","import { emit } from '@nextcloud/event-bus';\nimport { generateOcsUrl } from '@nextcloud/router';\nimport { showError, showLoading, showSuccess } from '@nextcloud/dialogs';\nimport { n, t } from '@nextcloud/l10n';\nimport axios, { isAxiosError } from '@nextcloud/axios';\nimport PQueue from 'p-queue';\nimport { fetchNode } from \"../services/WebdavClient.ts\";\nimport logger from \"../logger\";\nconst queue = new PQueue({\n  concurrency: 5\n});\nconst requestConversion = function (fileId, targetMimeType) {\n  return axios.post(generateOcsUrl('/apps/files/api/v1/convert'), {\n    fileId,\n    targetMimeType\n  });\n};\nexport const convertFiles = async function (fileIds, targetMimeType) {\n  const conversions = fileIds.map(fileId => queue.add(() => requestConversion(fileId, targetMimeType)));\n  // Start conversion\n  const toast = showLoading(t('files', 'Converting files …'));\n  // Handle results\n  try {\n    const results = await Promise.allSettled(conversions);\n    const failed = results.filter(result => result.status === 'rejected');\n    if (failed.length > 0) {\n      const messages = failed.map(result => result.reason?.response?.data?.ocs?.meta?.message);\n      logger.error('Failed to convert files', {\n        fileIds,\n        targetMimeType,\n        messages\n      });\n      // If all failed files have the same error message, show it\n      if (new Set(messages).size === 1 && typeof messages[0] === 'string') {\n        showError(t('files', 'Failed to convert files: {message}', {\n          message: messages[0]\n        }));\n        return;\n      }\n      if (failed.length === fileIds.length) {\n        showError(t('files', 'All files failed to be converted'));\n        return;\n      }\n      // A single file failed and if we have a message for the failed file, show it\n      if (failed.length === 1 && messages[0]) {\n        showError(t('files', 'One file could not be converted: {message}', {\n          message: messages[0]\n        }));\n        return;\n      }\n      // We already check above when all files failed\n      // if we're here, we have a mix of failed and successful files\n      showError(n('files', 'One file could not be converted', '%n files could not be converted', failed.length));\n      showSuccess(n('files', 'One file successfully converted', '%n files successfully converted', fileIds.length - failed.length));\n      return;\n    }\n    // All files converted\n    showSuccess(t('files', 'Files successfully converted'));\n    // Extract files that are within the current directory\n    // in batch mode, you might have files from different directories\n    // ⚠️, let's get the actual current dir, as the one from the action\n    // might have changed as the user navigated away\n    const currentDir = window.OCP.Files.Router.query.dir;\n    const newPaths = results.filter(result => result.status === 'fulfilled').map(result => result.value.data.ocs.data.path).filter(path => path.startsWith(currentDir));\n    // Fetch the new files\n    logger.debug('Files to fetch', {\n      newPaths\n    });\n    const newFiles = await Promise.all(newPaths.map(path => fetchNode(path)));\n    // Inform the file list about the new files\n    newFiles.forEach(file => emit('files:node:created', file));\n    // Switch to the new files\n    const firstSuccess = results[0];\n    const newFileId = firstSuccess.value.data.ocs.data.fileId;\n    window.OCP.Files.Router.goToRoute(null, {\n      ...window.OCP.Files.Router.params,\n      fileid: newFileId.toString()\n    }, window.OCP.Files.Router.query);\n  } catch (error) {\n    // Should not happen as we use allSettled and handle errors above\n    showError(t('files', 'Failed to convert files'));\n    logger.error('Failed to convert files', {\n      fileIds,\n      targetMimeType,\n      error\n    });\n  } finally {\n    // Hide loading toast\n    toast.hideToast();\n  }\n};\nexport const convertFile = async function (fileId, targetMimeType) {\n  const toast = showLoading(t('files', 'Converting file …'));\n  try {\n    const result = await queue.add(() => requestConversion(fileId, targetMimeType));\n    showSuccess(t('files', 'File successfully converted'));\n    // Inform the file list about the new file\n    const newFile = await fetchNode(result.data.ocs.data.path);\n    emit('files:node:created', newFile);\n    // Switch to the new file\n    const newFileId = result.data.ocs.data.fileId;\n    window.OCP.Files.Router.goToRoute(null, {\n      ...window.OCP.Files.Router.params,\n      fileid: newFileId.toString()\n    }, window.OCP.Files.Router.query);\n  } catch (error) {\n    // If the server returned an error message, show it\n    if (isAxiosError(error) && error.response?.data?.ocs?.meta?.message) {\n      showError(t('files', 'Failed to convert file: {message}', {\n        message: error.response.data.ocs.meta.message\n      }));\n      return;\n    }\n    logger.error('Failed to convert file', {\n      fileId,\n      targetMimeType,\n      error\n    });\n    showError(t('files', 'Failed to convert file'));\n  } finally {\n    // Hide loading toast\n    toast.hideToast();\n  }\n};","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { Permission, FileAction } from '@nextcloud/files';\nimport { loadState } from '@nextcloud/initial-state';\nimport PQueue from 'p-queue';\nimport CloseSvg from '@mdi/svg/svg/close.svg?raw';\nimport NetworkOffSvg from '@mdi/svg/svg/network-off.svg?raw';\nimport TrashCanSvg from '@mdi/svg/svg/trash-can-outline.svg?raw';\nimport { TRASHBIN_VIEW_ID } from \"../../../files_trashbin/src/files_views/trashbinView.ts\";\nimport { askConfirmation, canDisconnectOnly, canUnshareOnly, deleteNode, displayName, shouldAskForConfirmation } from \"./deleteUtils.ts\";\nimport logger from \"../logger.ts\";\nconst queue = new PQueue({\n  concurrency: 5\n});\nexport const ACTION_DELETE = 'delete';\nexport const action = new FileAction({\n  id: ACTION_DELETE,\n  displayName,\n  iconSvgInline: nodes => {\n    if (canUnshareOnly(nodes)) {\n      return CloseSvg;\n    }\n    if (canDisconnectOnly(nodes)) {\n      return NetworkOffSvg;\n    }\n    return TrashCanSvg;\n  },\n  enabled(nodes, view) {\n    if (view.id === TRASHBIN_VIEW_ID) {\n      const config = loadState('files_trashbin', 'config', {\n        allow_delete: true\n      });\n      if (config.allow_delete === false) {\n        return false;\n      }\n    }\n    return nodes.length > 0 && nodes.map(node => node.permissions).every(permission => (permission & Permission.DELETE) !== 0);\n  },\n  async exec(node, view) {\n    try {\n      let confirm = true;\n      // Trick to detect if the action was called from a keyboard event\n      // we need to make sure the method calling have its named containing 'keydown'\n      // here we use `onKeydown` method from the FileEntryActions component\n      const callStack = new Error().stack || '';\n      const isCalledFromEventListener = callStack.toLocaleLowerCase().includes('keydown');\n      if (shouldAskForConfirmation() || isCalledFromEventListener) {\n        confirm = await askConfirmation([node], view);\n      }\n      // If the user cancels the deletion, we don't want to do anything\n      if (confirm === false) {\n        return null;\n      }\n      await deleteNode(node);\n      return true;\n    } catch (error) {\n      logger.error('Error while deleting a file', {\n        error,\n        source: node.source,\n        node\n      });\n      return false;\n    }\n  },\n  async execBatch(nodes, view) {\n    let confirm = true;\n    if (shouldAskForConfirmation()) {\n      confirm = await askConfirmation(nodes, view);\n    } else if (nodes.length >= 5 && !canUnshareOnly(nodes) && !canDisconnectOnly(nodes)) {\n      confirm = await askConfirmation(nodes, view);\n    }\n    // If the user cancels the deletion, we don't want to do anything\n    if (confirm === false) {\n      return Promise.all(nodes.map(() => null));\n    }\n    // Map each node to a promise that resolves with the result of exec(node)\n    const promises = nodes.map(node => {\n      // Create a promise that resolves with the result of exec(node)\n      const promise = new Promise(resolve => {\n        queue.add(async () => {\n          try {\n            await deleteNode(node);\n            resolve(true);\n          } catch (error) {\n            logger.error('Error while deleting a file', {\n              error,\n              source: node.source,\n              node\n            });\n            resolve(false);\n          }\n        });\n      });\n      return promise;\n    });\n    return Promise.all(promises);\n  },\n  destructive: true,\n  order: 100\n});","import { emit } from '@nextcloud/event-bus';\nimport { FileType } from '@nextcloud/files';\nimport { getCapabilities } from '@nextcloud/capabilities';\nimport { n, t } from '@nextcloud/l10n';\nimport axios from '@nextcloud/axios';\nimport { useUserConfigStore } from \"../store/userconfig\";\nimport { getPinia } from \"../store\";\nexport const isTrashbinEnabled = () => getCapabilities()?.files?.undelete === true;\nexport const canUnshareOnly = nodes => {\n  return nodes.every(node => node.attributes['is-mount-root'] === true && node.attributes['mount-type'] === 'shared');\n};\nexport const canDisconnectOnly = nodes => {\n  return nodes.every(node => node.attributes['is-mount-root'] === true && node.attributes['mount-type'] === 'external');\n};\nexport const isMixedUnshareAndDelete = nodes => {\n  if (nodes.length === 1) {\n    return false;\n  }\n  const hasSharedItems = nodes.some(node => canUnshareOnly([node]));\n  const hasDeleteItems = nodes.some(node => !canUnshareOnly([node]));\n  return hasSharedItems && hasDeleteItems;\n};\nexport const isAllFiles = nodes => {\n  return !nodes.some(node => node.type !== FileType.File);\n};\nexport const isAllFolders = nodes => {\n  return !nodes.some(node => node.type !== FileType.Folder);\n};\nexport const displayName = (nodes, view) => {\n  /**\n   * If those nodes are all the root node of a\n   * share, we can only unshare them.\n   */\n  if (canUnshareOnly(nodes)) {\n    if (nodes.length === 1) {\n      return t('files', 'Leave this share');\n    }\n    return t('files', 'Leave these shares');\n  }\n  /**\n   * If those nodes are all the root node of an\n   * external storage, we can only disconnect it.\n   */\n  if (canDisconnectOnly(nodes)) {\n    if (nodes.length === 1) {\n      return t('files', 'Disconnect storage');\n    }\n    return t('files', 'Disconnect storages');\n  }\n  /**\n   * If we're in the trashbin, we can only delete permanently\n   */\n  if (view.id === 'trashbin' || !isTrashbinEnabled()) {\n    return t('files', 'Delete permanently');\n  }\n  /**\n   * If we're in the sharing view, we can only unshare\n   */\n  if (isMixedUnshareAndDelete(nodes)) {\n    return t('files', 'Delete and unshare');\n  }\n  /**\n   * If we're only selecting files, use proper wording\n   */\n  if (isAllFiles(nodes)) {\n    if (nodes.length === 1) {\n      return t('files', 'Delete file');\n    }\n    return t('files', 'Delete files');\n  }\n  /**\n   * If we're only selecting folders, use proper wording\n   */\n  if (isAllFolders(nodes)) {\n    if (nodes.length === 1) {\n      return t('files', 'Delete folder');\n    }\n    return t('files', 'Delete folders');\n  }\n  return t('files', 'Delete');\n};\nexport const shouldAskForConfirmation = () => {\n  const userConfig = useUserConfigStore(getPinia());\n  return userConfig.userConfig.show_dialog_deletion !== false;\n};\nexport const askConfirmation = async (nodes, view) => {\n  const message = view.id === 'trashbin' || !isTrashbinEnabled() ? n('files', 'You are about to permanently delete {count} item', 'You are about to permanently delete {count} items', nodes.length, {\n    count: nodes.length\n  }) : n('files', 'You are about to delete {count} item', 'You are about to delete {count} items', nodes.length, {\n    count: nodes.length\n  });\n  return new Promise(resolve => {\n    // TODO: Use the new dialog API\n    window.OC.dialogs.confirmDestructive(message, t('files', 'Confirm deletion'), {\n      type: window.OC.dialogs.YES_NO_BUTTONS,\n      confirm: displayName(nodes, view),\n      confirmClasses: 'error',\n      cancel: t('files', 'Cancel')\n    }, decision => {\n      resolve(decision);\n    });\n  });\n};\nexport const deleteNode = async node => {\n  await axios.delete(node.encodedSource);\n  // Let's delete even if it's moved to the trashbin\n  // since it has been removed from the current view\n  // and changing the view will trigger a reload anyway.\n  emit('files:node:deleted', node);\n};","import { FileAction, FileType, DefaultType } from '@nextcloud/files';\nimport { showError } from '@nextcloud/dialogs';\nimport { t } from '@nextcloud/l10n';\nimport axios from '@nextcloud/axios';\nimport ArrowDownSvg from '@mdi/svg/svg/arrow-down.svg?raw';\nimport { isDownloadable } from \"../utils/permissions\";\nimport { usePathsStore } from \"../store/paths\";\nimport { getPinia } from \"../store\";\nimport { useFilesStore } from \"../store/files\";\nimport { emit } from '@nextcloud/event-bus';\n/**\n * Trigger downloading a file.\n *\n * @param url The url of the asset to download\n * @param name Optionally the recommended name of the download (browsers might ignore it)\n */\nasync function triggerDownload(url, name) {\n  // try to see if the resource is still available\n  await axios.head(url);\n  const hiddenElement = document.createElement('a');\n  hiddenElement.download = name ?? '';\n  hiddenElement.href = url;\n  hiddenElement.click();\n}\n/**\n * Find the longest common path prefix of both input paths\n * @param first The first path\n * @param second The second path\n */\nfunction longestCommonPath(first, second) {\n  const firstSegments = first.split('/').filter(Boolean);\n  const secondSegments = second.split('/').filter(Boolean);\n  let base = '';\n  for (const [index, segment] of firstSegments.entries()) {\n    if (index >= second.length) {\n      break;\n    }\n    if (segment !== secondSegments[index]) {\n      break;\n    }\n    const sep = base === '' ? '' : '/';\n    base = `${base}${sep}${segment}`;\n  }\n  return base;\n}\n/**\n * Download the given nodes.\n *\n * If only one node is given, it will be downloaded directly.\n * If multiple nodes are given, they will be zipped and downloaded.\n *\n * @param nodes The node(s) to download\n */\nasync function downloadNodes(nodes) {\n  let url;\n  if (nodes.length === 1) {\n    if (nodes[0].type === FileType.File) {\n      await triggerDownload(nodes[0].encodedSource, nodes[0].displayname);\n      return;\n    } else {\n      url = new URL(nodes[0].encodedSource);\n      url.searchParams.append('accept', 'zip');\n    }\n  } else {\n    url = new URL(nodes[0].encodedSource);\n    let base = url.pathname;\n    for (const node of nodes.slice(1)) {\n      base = longestCommonPath(base, new URL(node.encodedSource).pathname);\n    }\n    url.pathname = base;\n    // The URL contains the path encoded so we need to decode as the query.append will re-encode it\n    const filenames = nodes.map(node => decodeURIComponent(node.encodedSource.slice(url.href.length + 1)));\n    url.searchParams.append('accept', 'zip');\n    url.searchParams.append('files', JSON.stringify(filenames));\n  }\n  if (url.pathname.at(-1) !== '/') {\n    url.pathname = `${url.pathname}/`;\n  }\n  await triggerDownload(url.href);\n}\n/**\n * Get the current directory node for the given view and path.\n * TODO: ideally the folder would directly be passed as exec params\n *\n * @param view The current view\n * @param directory The directory path\n * @return The current directory node or null if not found\n */\nfunction getCurrentDirectory(view, directory) {\n  const filesStore = useFilesStore(getPinia());\n  const pathsStore = usePathsStore(getPinia());\n  if (!view?.id) {\n    return null;\n  }\n  if (directory === '/') {\n    return filesStore.getRoot(view.id) || null;\n  }\n  const fileId = pathsStore.getPath(view.id, directory);\n  return filesStore.getNode(fileId) || null;\n}\nexport const action = new FileAction({\n  id: 'download',\n  default: DefaultType.DEFAULT,\n  displayName: () => t('files', 'Download'),\n  iconSvgInline: () => ArrowDownSvg,\n  enabled(nodes, view) {\n    if (nodes.length === 0) {\n      return false;\n    }\n    // We can only download dav files and folders.\n    if (nodes.some(node => !node.isDavResource)) {\n      return false;\n    }\n    // Trashbin does not allow batch download\n    if (nodes.length > 1 && view.id === 'trashbin') {\n      return false;\n    }\n    return nodes.every(isDownloadable);\n  },\n  async exec(node) {\n    try {\n      await downloadNodes([node]);\n    } catch (e) {\n      showError(t('files', 'The requested file is not available.'));\n      emit('files:node:deleted', node);\n    }\n    return null;\n  },\n  async execBatch(nodes, view, dir) {\n    try {\n      await downloadNodes(nodes);\n    } catch (e) {\n      showError(t('files', 'The requested files are not available.'));\n      // Try to reload the current directory to update the view\n      const directory = getCurrentDirectory(view, dir);\n      emit('files:node:updated', directory);\n    }\n    return new Array(nodes.length).fill(null);\n  },\n  order: 30\n});","import { emit } from '@nextcloud/event-bus';\nimport { Permission, FileAction } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport { encodePath } from '@nextcloud/paths';\nimport { generateUrl } from '@nextcloud/router';\nimport { isPublicShare } from '@nextcloud/sharing/public';\nimport axios from '@nextcloud/axios';\nimport PQueue from 'p-queue';\nimport Vue from 'vue';\nimport StarOutlineSvg from '@mdi/svg/svg/star-outline.svg?raw';\nimport StarSvg from '@mdi/svg/svg/star.svg?raw';\nimport logger from \"../logger.ts\";\nexport const ACTION_FAVORITE = 'favorite';\nconst queue = new PQueue({\n  concurrency: 5\n});\n// If any of the nodes is not favorited, we display the favorite action.\nconst shouldFavorite = nodes => {\n  return nodes.some(node => node.attributes.favorite !== 1);\n};\nexport const favoriteNode = async (node, view, willFavorite) => {\n  try {\n    // TODO: migrate to webdav tags plugin\n    const url = generateUrl('/apps/files/api/v1/files') + encodePath(node.path);\n    await axios.post(url, {\n      tags: willFavorite ? [window.OC.TAG_FAVORITE] : []\n    });\n    // Let's delete if we are in the favourites view\n    // AND if it is removed from the user favorites\n    // AND it's in the root of the favorites view\n    if (view.id === 'favorites' && !willFavorite && node.dirname === '/') {\n      emit('files:node:deleted', node);\n    }\n    // Update the node webdav attribute\n    Vue.set(node.attributes, 'favorite', willFavorite ? 1 : 0);\n    // Dispatch event to whoever is interested\n    if (willFavorite) {\n      emit('files:favorites:added', node);\n    } else {\n      emit('files:favorites:removed', node);\n    }\n    return true;\n  } catch (error) {\n    const action = willFavorite ? 'adding a file to favourites' : 'removing a file from favourites';\n    logger.error('Error while ' + action, {\n      error,\n      source: node.source,\n      node\n    });\n    return false;\n  }\n};\nexport const action = new FileAction({\n  id: ACTION_FAVORITE,\n  displayName(nodes) {\n    return shouldFavorite(nodes) ? t('files', 'Add to favorites') : t('files', 'Remove from favorites');\n  },\n  iconSvgInline: nodes => {\n    return shouldFavorite(nodes) ? StarOutlineSvg : StarSvg;\n  },\n  enabled(nodes) {\n    // Not enabled for public shares\n    if (isPublicShare()) {\n      return false;\n    }\n    // We can only favorite nodes if they are located in files\n    return nodes.every(node => node.root?.startsWith?.('/files'))\n    // and we have permissions\n    && nodes.every(node => node.permissions !== Permission.NONE);\n  },\n  async exec(node, view) {\n    const willFavorite = shouldFavorite([node]);\n    return await favoriteNode(node, view, willFavorite);\n  },\n  async execBatch(nodes, view) {\n    const willFavorite = shouldFavorite(nodes);\n    // Map each node to a promise that resolves with the result of exec(node)\n    const promises = nodes.map(node => {\n      // Create a promise that resolves with the result of exec(node)\n      const promise = new Promise(resolve => {\n        queue.add(async () => {\n          try {\n            await favoriteNode(node, view, willFavorite);\n            resolve(true);\n          } catch (error) {\n            logger.error('Error while adding file to favorite', {\n              error,\n              source: node.source,\n              node\n            });\n            resolve(false);\n          }\n        });\n      });\n      return promise;\n    });\n    return Promise.all(promises);\n  },\n  order: -50\n});","import { isAxiosError } from '@nextcloud/axios';\nimport { FilePickerClosed, getFilePickerBuilder, showError, showInfo, TOAST_PERMANENT_TIMEOUT } from '@nextcloud/dialogs';\nimport { emit } from '@nextcloud/event-bus';\nimport { FileAction, FileType, NodeStatus, davGetClient, davRootPath, davResultToNode, davGetDefaultPropfind, getUniqueName, Permission } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport { openConflictPicker, hasConflict } from '@nextcloud/upload';\nimport { basename, join } from 'path';\nimport Vue from 'vue';\nimport CopyIconSvg from '@mdi/svg/svg/folder-multiple-outline.svg?raw';\nimport FolderMoveSvg from '@mdi/svg/svg/folder-move-outline.svg?raw';\nimport { MoveCopyAction, canCopy, canMove, getQueue } from \"./moveOrCopyActionUtils\";\nimport { getContents } from \"../services/Files\";\nimport logger from \"../logger\";\n/**\n * Return the action that is possible for the given nodes\n * @param {Node[]} nodes The nodes to check against\n * @return {MoveCopyAction} The action that is possible for the given nodes\n */\nconst getActionForNodes = nodes => {\n  if (canMove(nodes)) {\n    if (canCopy(nodes)) {\n      return MoveCopyAction.MOVE_OR_COPY;\n    }\n    return MoveCopyAction.MOVE;\n  }\n  // Assuming we can copy as the enabled checks for copy permissions\n  return MoveCopyAction.COPY;\n};\n/**\n * Create a loading notification toast\n * @param mode The move or copy mode\n * @param source Name of the node that is copied / moved\n * @param destination Destination path\n * @return {() => void} Function to hide the notification\n */\nfunction createLoadingNotification(mode, source, destination) {\n  const text = mode === MoveCopyAction.MOVE ? t('files', 'Moving \"{source}\" to \"{destination}\" …', {\n    source,\n    destination\n  }) : t('files', 'Copying \"{source}\" to \"{destination}\" …', {\n    source,\n    destination\n  });\n  let toast;\n  toast = showInfo(`<span class=\"icon icon-loading-small toast-loading-icon\"></span> ${text}`, {\n    isHTML: true,\n    timeout: TOAST_PERMANENT_TIMEOUT,\n    onRemove: () => {\n      toast?.hideToast();\n      toast = undefined;\n    }\n  });\n  return () => toast && toast.hideToast();\n}\n/**\n * Handle the copy/move of a node to a destination\n * This can be imported and used by other scripts/components on server\n * @param {Node} node The node to copy/move\n * @param {Folder} destination The destination to copy/move the node to\n * @param {MoveCopyAction} method The method to use for the copy/move\n * @param {boolean} overwrite Whether to overwrite the destination if it exists\n * @return {Promise<void>} A promise that resolves when the copy/move is done\n */\nexport const handleCopyMoveNodeTo = async function (node, destination, method) {\n  let overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  if (!destination) {\n    return;\n  }\n  if (destination.type !== FileType.Folder) {\n    throw new Error(t('files', 'Destination is not a folder'));\n  }\n  // Do not allow to MOVE a node to the same folder it is already located\n  if (method === MoveCopyAction.MOVE && node.dirname === destination.path) {\n    throw new Error(t('files', 'This file/folder is already in that directory'));\n  }\n  /**\n   * Example:\n   * - node: /foo/bar/file.txt -> path = /foo/bar/file.txt, destination: /foo\n   *   Allow move of /foo does not start with /foo/bar/file.txt so allow\n   * - node: /foo , destination: /foo/bar\n   *   Do not allow as it would copy foo within itself\n   * - node: /foo/bar.txt, destination: /foo\n   *   Allow copy a file to the same directory\n   * - node: \"/foo/bar\", destination: \"/foo/bar 1\"\n   *   Allow to move or copy but we need to check with trailing / otherwise it would report false positive\n   */\n  if (`${destination.path}/`.startsWith(`${node.path}/`)) {\n    throw new Error(t('files', 'You cannot move a file/folder onto itself or into a subfolder of itself'));\n  }\n  // Set loading state\n  Vue.set(node, 'status', NodeStatus.LOADING);\n  const actionFinished = createLoadingNotification(method, node.basename, destination.path);\n  const queue = getQueue();\n  return await queue.add(async () => {\n    const copySuffix = index => {\n      if (index === 1) {\n        return t('files', '(copy)'); // TRANSLATORS: Mark a file as a copy of another file\n      }\n      return t('files', '(copy %n)', undefined, index); // TRANSLATORS: Meaning it is the n'th copy of a file\n    };\n    try {\n      const client = davGetClient();\n      const currentPath = join(davRootPath, node.path);\n      const destinationPath = join(davRootPath, destination.path);\n      if (method === MoveCopyAction.COPY) {\n        let target = node.basename;\n        // If we do not allow overwriting then find an unique name\n        if (!overwrite) {\n          const otherNodes = await client.getDirectoryContents(destinationPath);\n          target = getUniqueName(node.basename, otherNodes.map(n => n.basename), {\n            suffix: copySuffix,\n            ignoreFileExtension: node.type === FileType.Folder\n          });\n        }\n        await client.copyFile(currentPath, join(destinationPath, target));\n        // If the node is copied into current directory the view needs to be updated\n        if (node.dirname === destination.path) {\n          const {\n            data\n          } = await client.stat(join(destinationPath, target), {\n            details: true,\n            data: davGetDefaultPropfind()\n          });\n          emit('files:node:created', davResultToNode(data));\n        }\n      } else {\n        // show conflict file popup if we do not allow overwriting\n        if (!overwrite) {\n          const otherNodes = await getContents(destination.path);\n          if (hasConflict([node], otherNodes.contents)) {\n            try {\n              // Let the user choose what to do with the conflicting files\n              const {\n                selected,\n                renamed\n              } = await openConflictPicker(destination.path, [node], otherNodes.contents);\n              // two empty arrays: either only old files or conflict skipped -> no action required\n              if (!selected.length && !renamed.length) {\n                return;\n              }\n            } catch (error) {\n              // User cancelled\n              return;\n            }\n          }\n        }\n        // getting here means either no conflict, file was renamed to keep both files\n        // in a conflict, or the selected file was chosen to be kept during the conflict\n        try {\n          await client.moveFile(currentPath, join(destinationPath, node.basename));\n        } catch (error) {\n          const parser = new DOMParser();\n          const text = await error.response?.text();\n          const message = parser.parseFromString(text ?? '', 'text/xml').querySelector('message')?.textContent;\n          if (message) {\n            showError(message);\n          }\n          throw error;\n        }\n        // Delete the node as it will be fetched again\n        // when navigating to the destination folder\n        emit('files:node:deleted', node);\n      }\n    } catch (error) {\n      if (isAxiosError(error)) {\n        if (error.response?.status === 412) {\n          throw new Error(t('files', 'A file or folder with that name already exists in this folder'));\n        } else if (error.response?.status === 423) {\n          throw new Error(t('files', 'The files are locked'));\n        } else if (error.response?.status === 404) {\n          throw new Error(t('files', 'The file does not exist anymore'));\n        } else if (error.message) {\n          throw new Error(error.message);\n        }\n      }\n      logger.debug(error);\n      throw new Error();\n    } finally {\n      Vue.set(node, 'status', '');\n      actionFinished();\n    }\n  });\n};\n/**\n * Open a file picker for the given action\n * @param action The action to open the file picker for\n * @param dir The directory to start the file picker in\n * @param nodes The nodes to move/copy\n * @return The picked destination or false if cancelled by user\n */\nasync function openFilePickerForAction(action) {\n  let dir = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n  let nodes = arguments.length > 2 ? arguments[2] : undefined;\n  const {\n    resolve,\n    reject,\n    promise\n  } = Promise.withResolvers();\n  const fileIDs = nodes.map(node => node.fileid).filter(Boolean);\n  const filePicker = getFilePickerBuilder(t('files', 'Choose destination')).allowDirectories(true).setFilter(n => {\n    // We don't want to show the current nodes in the file picker\n    return !fileIDs.includes(n.fileid);\n  }).setMimeTypeFilter([]).setMultiSelect(false).startAt(dir).setButtonFactory((selection, path) => {\n    const buttons = [];\n    const target = basename(path);\n    const dirnames = nodes.map(node => node.dirname);\n    const paths = nodes.map(node => node.path);\n    if (action === MoveCopyAction.COPY || action === MoveCopyAction.MOVE_OR_COPY) {\n      buttons.push({\n        label: target ? t('files', 'Copy to {target}', {\n          target\n        }, undefined, {\n          escape: false,\n          sanitize: false\n        }) : t('files', 'Copy'),\n        type: 'primary',\n        icon: CopyIconSvg,\n        disabled: selection.some(node => (node.permissions & Permission.CREATE) === 0),\n        async callback(destination) {\n          resolve({\n            destination: destination[0],\n            action: MoveCopyAction.COPY\n          });\n        }\n      });\n    }\n    // Invalid MOVE targets (but valid copy targets)\n    if (dirnames.includes(path)) {\n      // This file/folder is already in that directory\n      return buttons;\n    }\n    if (paths.includes(path)) {\n      // You cannot move a file/folder onto itself\n      return buttons;\n    }\n    if (selection.some(node => (node.permissions & Permission.CREATE) === 0)) {\n      // Missing 'CREATE' permissions for selected destination\n      return buttons;\n    }\n    if (action === MoveCopyAction.MOVE || action === MoveCopyAction.MOVE_OR_COPY) {\n      buttons.push({\n        label: target ? t('files', 'Move to {target}', {\n          target\n        }, undefined, {\n          escape: false,\n          sanitize: false\n        }) : t('files', 'Move'),\n        type: action === MoveCopyAction.MOVE ? 'primary' : 'secondary',\n        icon: FolderMoveSvg,\n        async callback(destination) {\n          resolve({\n            destination: destination[0],\n            action: MoveCopyAction.MOVE\n          });\n        }\n      });\n    }\n    return buttons;\n  }).build();\n  filePicker.pick().catch(error => {\n    logger.debug(error);\n    if (error instanceof FilePickerClosed) {\n      resolve(false);\n    } else {\n      reject(new Error(t('files', 'Move or copy operation failed')));\n    }\n  });\n  return promise;\n}\nexport const ACTION_COPY_MOVE = 'move-copy';\nexport const action = new FileAction({\n  id: ACTION_COPY_MOVE,\n  displayName(nodes) {\n    switch (getActionForNodes(nodes)) {\n      case MoveCopyAction.MOVE:\n        return t('files', 'Move');\n      case MoveCopyAction.COPY:\n        return t('files', 'Copy');\n      case MoveCopyAction.MOVE_OR_COPY:\n        return t('files', 'Move or copy');\n    }\n  },\n  iconSvgInline: () => FolderMoveSvg,\n  enabled(nodes, view) {\n    // We can not copy or move in single file shares\n    if (view.id === 'public-file-share') {\n      return false;\n    }\n    // We only support moving/copying files within the user folder\n    if (!nodes.every(node => node.root?.startsWith('/files/'))) {\n      return false;\n    }\n    return nodes.length > 0 && (canMove(nodes) || canCopy(nodes));\n  },\n  async exec(node, view, dir) {\n    const action = getActionForNodes([node]);\n    let result;\n    try {\n      result = await openFilePickerForAction(action, dir, [node]);\n    } catch (e) {\n      logger.error(e);\n      return false;\n    }\n    if (result === false) {\n      return null;\n    }\n    try {\n      await handleCopyMoveNodeTo(node, result.destination, result.action);\n      return true;\n    } catch (error) {\n      if (error instanceof Error && !!error.message) {\n        showError(error.message);\n        // Silent action as we handle the toast\n        return null;\n      }\n      return false;\n    }\n  },\n  async execBatch(nodes, view, dir) {\n    const action = getActionForNodes(nodes);\n    const result = await openFilePickerForAction(action, dir, nodes);\n    // Handle cancellation silently\n    if (result === false) {\n      return nodes.map(() => null);\n    }\n    const promises = nodes.map(async node => {\n      try {\n        await handleCopyMoveNodeTo(node, result.destination, result.action);\n        return true;\n      } catch (error) {\n        logger.error(`Failed to ${result.action} node`, {\n          node,\n          error\n        });\n        return false;\n      }\n    });\n    // We need to keep the selection on error!\n    // So we do not return null, and for batch action\n    // we let the front handle the error.\n    return await Promise.all(promises);\n  },\n  order: 15\n});","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { Permission } from '@nextcloud/files';\nimport { isPublicShare } from '@nextcloud/sharing/public';\nimport PQueue from 'p-queue';\nimport { loadState } from '@nextcloud/initial-state';\nconst sharePermissions = loadState('files_sharing', 'sharePermissions', Permission.NONE);\n// This is the processing queue. We only want to allow 3 concurrent requests\nlet queue;\n// Maximum number of concurrent operations\nconst MAX_CONCURRENCY = 5;\n/**\n * Get the processing queue\n */\nexport const getQueue = () => {\n  if (!queue) {\n    queue = new PQueue({\n      concurrency: MAX_CONCURRENCY\n    });\n  }\n  return queue;\n};\nexport var MoveCopyAction;\n(function (MoveCopyAction) {\n  MoveCopyAction[\"MOVE\"] = \"Move\";\n  MoveCopyAction[\"COPY\"] = \"Copy\";\n  MoveCopyAction[\"MOVE_OR_COPY\"] = \"move-or-copy\";\n})(MoveCopyAction || (MoveCopyAction = {}));\nexport const canMove = nodes => {\n  const minPermission = nodes.reduce((min, node) => Math.min(min, node.permissions), Permission.ALL);\n  return Boolean(minPermission & Permission.DELETE);\n};\nexport const canDownload = nodes => {\n  return nodes.every(node => {\n    const shareAttributes = JSON.parse(node.attributes?.['share-attributes'] ?? '[]');\n    return !shareAttributes.some(attribute => attribute.scope === 'permissions' && attribute.value === false && attribute.key === 'download');\n  });\n};\nexport const canCopy = nodes => {\n  // a shared file cannot be copied if the download is disabled\n  if (!canDownload(nodes)) {\n    return false;\n  }\n  // it cannot be copied if the user has only view permissions\n  if (nodes.some(node => node.permissions === Permission.NONE)) {\n    return false;\n  }\n  // on public shares all files have the same permission so copy is only possible if write permission is granted\n  if (isPublicShare()) {\n    return Boolean(sharePermissions & Permission.CREATE);\n  }\n  // otherwise permission is granted\n  return true;\n};","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { Permission, FileType, FileAction, DefaultType } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport FolderSvg from '@mdi/svg/svg/folder.svg?raw';\nexport const action = new FileAction({\n  id: 'open-folder',\n  displayName(files) {\n    // Only works on single node\n    const displayName = files[0].displayname;\n    return t('files', 'Open folder {displayName}', {\n      displayName\n    });\n  },\n  iconSvgInline: () => FolderSvg,\n  enabled(nodes) {\n    // Only works on single node\n    if (nodes.length !== 1) {\n      return false;\n    }\n    const node = nodes[0];\n    if (!node.isDavRessource) {\n      return false;\n    }\n    return node.type === FileType.Folder && (node.permissions & Permission.READ) !== 0;\n  },\n  async exec(node, view) {\n    if (!node || node.type !== FileType.Folder) {\n      return false;\n    }\n    window.OCP.Files.Router.goToRoute(null, {\n      view: view.id,\n      fileid: String(node.fileid)\n    }, {\n      dir: node.path\n    });\n    return null;\n  },\n  // Main action if enabled, meaning folders only\n  default: DefaultType.HIDDEN,\n  order: -100\n});","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { t } from '@nextcloud/l10n';\nimport { FileType, FileAction, DefaultType } from '@nextcloud/files';\nimport { VIEW_ID as SEARCH_VIEW_ID } from \"../views/search\";\nexport const action = new FileAction({\n  id: 'open-in-files',\n  displayName: () => t('files', 'Open in Files'),\n  iconSvgInline: () => '',\n  enabled(nodes, view) {\n    return view.id === 'recent' || view.id === SEARCH_VIEW_ID;\n  },\n  async exec(node) {\n    let dir = node.dirname;\n    if (node.type === FileType.Folder) {\n      dir = dir + '/' + node.basename;\n    }\n    window.OCP.Files.Router.goToRoute(null,\n    // use default route\n    {\n      view: 'files',\n      fileid: String(node.fileid)\n    }, {\n      dir,\n      openfile: 'true'\n    });\n    return null;\n  },\n  // Before openFolderAction\n  order: -1000,\n  default: DefaultType.HIDDEN\n});","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { encodePath } from '@nextcloud/paths';\nimport { generateOcsUrl } from '@nextcloud/router';\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { FileAction, Permission } from '@nextcloud/files';\nimport { showError, DialogBuilder } from '@nextcloud/dialogs';\nimport { translate as t } from '@nextcloud/l10n';\nimport axios from '@nextcloud/axios';\nimport LaptopSvg from '@mdi/svg/svg/laptop.svg?raw';\nimport IconWeb from '@mdi/svg/svg/web.svg?raw';\nimport { isPublicShare } from '@nextcloud/sharing/public';\nexport const action = new FileAction({\n  id: 'edit-locally',\n  displayName: () => t('files', 'Open locally'),\n  iconSvgInline: () => LaptopSvg,\n  // Only works on single files\n  enabled(nodes) {\n    // Only works on single node\n    if (nodes.length !== 1) {\n      return false;\n    }\n    // does not work with shares\n    if (isPublicShare()) {\n      return false;\n    }\n    return (nodes[0].permissions & Permission.UPDATE) !== 0;\n  },\n  async exec(node) {\n    await attemptOpenLocalClient(node.path);\n    return null;\n  },\n  order: 25\n});\n/**\n * Try to open the path in the Nextcloud client.\n *\n * If this fails a dialog is shown with 3 options:\n * 1. Retry: If it fails no further dialog is shown.\n * 2. Open online: The viewer is used to open the file.\n * 3. Close the dialog and nothing happens (abort).\n *\n * @param path - The path to open\n */\nasync function attemptOpenLocalClient(path) {\n  await openLocalClient(path);\n  const result = await confirmLocalEditDialog();\n  if (result === 'local') {\n    await openLocalClient(path);\n  } else if (result === 'online') {\n    window.OCA.Viewer.open({\n      path\n    });\n  }\n}\n/**\n * Try to open a file in the Nextcloud client.\n * There is no way to get notified if this action was successfull.\n *\n * @param path - Path to open\n */\nasync function openLocalClient(path) {\n  const link = generateOcsUrl('apps/files/api/v1') + '/openlocaleditor?format=json';\n  try {\n    const result = await axios.post(link, {\n      path\n    });\n    const uid = getCurrentUser()?.uid;\n    let url = `nc://open/${uid}@` + window.location.host + encodePath(path);\n    url += '?token=' + result.data.ocs.data.token;\n    window.open(url, '_self');\n  } catch (error) {\n    showError(t('files', 'Failed to redirect to client'));\n  }\n}\n/**\n * Open the confirmation dialog.\n */\nasync function confirmLocalEditDialog() {\n  let result = false;\n  const dialog = new DialogBuilder().setName(t('files', 'Open file locally')).setText(t('files', 'The file should now open on your device. If it doesn\\'t, please check that you have the desktop app installed.')).setButtons([{\n    label: t('files', 'Retry and close'),\n    type: 'secondary',\n    callback: () => {\n      result = 'local';\n    }\n  }, {\n    label: t('files', 'Open online'),\n    icon: IconWeb,\n    type: 'primary',\n    callback: () => {\n      result = 'online';\n    }\n  }]).build();\n  await dialog.show();\n  return result;\n}","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { emit } from '@nextcloud/event-bus';\nimport { Permission, FileAction } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport PencilSvg from '@mdi/svg/svg/pencil-outline.svg?raw';\nimport { getPinia } from \"../store\";\nimport { useFilesStore } from \"../store/files\";\nimport { dirname } from 'path';\nexport const ACTION_RENAME = 'rename';\nexport const action = new FileAction({\n  id: ACTION_RENAME,\n  displayName: () => t('files', 'Rename'),\n  iconSvgInline: () => PencilSvg,\n  enabled: (nodes, view) => {\n    if (nodes.length === 0) {\n      return false;\n    }\n    // Disable for single file shares\n    if (view.id === 'public-file-share') {\n      return false;\n    }\n    const node = nodes[0];\n    const filesStore = useFilesStore(getPinia());\n    const parentNode = node.dirname === '/' ? filesStore.getRoot(view.id) : filesStore.getNode(dirname(node.source));\n    const parentPermissions = parentNode?.permissions || Permission.NONE;\n    // Only enable if the node have the delete permission\n    // and if the parent folder allows creating files\n    return Boolean(node.permissions & Permission.DELETE) && Boolean(parentPermissions & Permission.CREATE);\n  },\n  async exec(node) {\n    // Renaming is a built-in feature of the files app\n    emit('files:node:rename', node);\n    return null;\n  },\n  order: 10\n});","import { Permission, FileAction } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport { isPublicShare } from '@nextcloud/sharing/public';\nimport InformationSvg from '@mdi/svg/svg/information-outline.svg?raw';\nimport logger from \"../logger.ts\";\nexport const ACTION_DETAILS = 'details';\nexport const action = new FileAction({\n  id: ACTION_DETAILS,\n  displayName: () => t('files', 'Details'),\n  iconSvgInline: () => InformationSvg,\n  // Sidebar currently supports user folder only, /files/USER\n  enabled: nodes => {\n    if (isPublicShare()) {\n      return false;\n    }\n    // Only works on single node\n    if (nodes.length !== 1) {\n      return false;\n    }\n    if (!nodes[0]) {\n      return false;\n    }\n    // Only work if the sidebar is available\n    if (!window?.OCA?.Files?.Sidebar) {\n      return false;\n    }\n    return (nodes[0].root?.startsWith('/files/') && nodes[0].permissions !== Permission.NONE) ?? false;\n  },\n  async exec(node, view, dir) {\n    try {\n      // If the sidebar is already open for the current file, do nothing\n      if (window.OCA.Files.Sidebar.file === node.path) {\n        logger.debug('Sidebar already open for this file', {\n          node\n        });\n        return null;\n      }\n      // Open sidebar and set active tab to sharing by default\n      window.OCA.Files.Sidebar.setActiveTab('sharing');\n      // TODO: migrate Sidebar to use a Node instead\n      await window.OCA.Files.Sidebar.open(node.path);\n      // Silently update current fileid\n      window.OCP?.Files?.Router?.goToRoute(null, {\n        view: view.id,\n        fileid: String(node.fileid)\n      }, {\n        ...window.OCP.Files.Router.query,\n        dir,\n        opendetails: 'true'\n      }, true);\n      return null;\n    } catch (error) {\n      logger.error('Error while opening sidebar', {\n        error\n      });\n      return false;\n    }\n  },\n  order: -50\n});","import { isPublicShare } from '@nextcloud/sharing/public';\nimport { FileAction, FileType, Permission } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport FolderMoveSvg from '@mdi/svg/svg/folder-move-outline.svg?raw';\nexport const action = new FileAction({\n  id: 'view-in-folder',\n  displayName() {\n    return t('files', 'View in folder');\n  },\n  iconSvgInline: () => FolderMoveSvg,\n  enabled(nodes, view) {\n    // Not enabled for public shares\n    if (isPublicShare()) {\n      return false;\n    }\n    // Only works outside of the main files view\n    if (view.id === 'files') {\n      return false;\n    }\n    // Only works on single node\n    if (nodes.length !== 1) {\n      return false;\n    }\n    const node = nodes[0];\n    if (!node.isDavRessource) {\n      return false;\n    }\n    // Can only view files that are in the user root folder\n    if (!node.root?.startsWith('/files')) {\n      return false;\n    }\n    if (node.permissions === Permission.NONE) {\n      return false;\n    }\n    return node.type === FileType.File;\n  },\n  async exec(node) {\n    if (!node || node.type !== FileType.File) {\n      return false;\n    }\n    window.OCP.Files.Router.goToRoute(null, {\n      view: 'files',\n      fileid: String(node.fileid)\n    }, {\n      dir: node.dirname\n    });\n    return null;\n  },\n  order: 80\n});","import { render, staticRenderFns } from \"./FileListFilter.vue?vue&type=template&id=5c291778&scoped=true\"\nimport script from \"./FileListFilter.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FileListFilter.vue?vue&type=script&setup=true&lang=ts\"\nimport style0 from \"./FileListFilter.vue?vue&type=style&index=0&id=5c291778&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5c291778\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/louis/workspace/nextcloud/instances/master/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('5c291778')) {\n      api.createRecord('5c291778', component.options)\n    } else {\n      api.reload('5c291778', component.options)\n    }\n    module.hot.accept(\"./FileListFilter.vue?vue&type=template&id=5c291778&scoped=true\", function () {\n      api.rerender('5c291778', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/files/src/components/FileListFilter/FileListFilter.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=script&setup=true&lang=ts\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=script&setup=true&lang=ts\"","export * from \"-!../../../../../node_modules/style-loader/dist/cjs.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=style&index=0&id=5c291778&scoped=true&lang=css\"","export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=template&id=5c291778&scoped=true\"","import { render, staticRenderFns } from \"./FileListFilterModified.vue?vue&type=template&id=f47dfc3e&scoped=true\"\nimport script from \"./FileListFilterModified.vue?vue&type=script&lang=ts\"\nexport * from \"./FileListFilterModified.vue?vue&type=script&lang=ts\"\nimport style0 from \"./FileListFilterModified.vue?vue&type=style&index=0&id=f47dfc3e&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f47dfc3e\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/louis/workspace/nextcloud/instances/master/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('f47dfc3e')) {\n      api.createRecord('f47dfc3e', component.options)\n    } else {\n      api.reload('f47dfc3e', component.options)\n    }\n    module.hot.accept(\"./FileListFilterModified.vue?vue&type=template&id=f47dfc3e&scoped=true\", function () {\n      api.rerender('f47dfc3e', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/files/src/components/FileListFilter/FileListFilterModified.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=script&lang=ts\"","export * from \"-!../../../../../node_modules/style-loader/dist/cjs.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=style&index=0&id=f47dfc3e&scoped=true&lang=scss\"","export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=template&id=f47dfc3e&scoped=true\"","import { render, staticRenderFns } from \"./FileListFilterToSearch.vue?vue&type=template&id=032b2a1b\"\nimport script from \"./FileListFilterToSearch.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./FileListFilterToSearch.vue?vue&type=script&setup=true&lang=ts\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/louis/workspace/nextcloud/instances/master/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('032b2a1b')) {\n      api.createRecord('032b2a1b', component.options)\n    } else {\n      api.reload('032b2a1b', component.options)\n    }\n    module.hot.accept(\"./FileListFilterToSearch.vue?vue&type=template&id=032b2a1b\", function () {\n      api.rerender('032b2a1b', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/files/src/components/FileListFilter/FileListFilterToSearch.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterToSearch.vue?vue&type=script&setup=true&lang=ts\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterToSearch.vue?vue&type=script&setup=true&lang=ts\"","export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterToSearch.vue?vue&type=template&id=032b2a1b\"","import { render, staticRenderFns } from \"./FileListFilterType.vue?vue&type=template&id=6c0e6dd2\"\nimport script from \"./FileListFilterType.vue?vue&type=script&lang=ts\"\nexport * from \"./FileListFilterType.vue?vue&type=script&lang=ts\"\nimport style0 from \"./FileListFilterType.vue?vue&type=style&index=0&id=6c0e6dd2&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/louis/workspace/nextcloud/instances/master/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('6c0e6dd2')) {\n      api.createRecord('6c0e6dd2', component.options)\n    } else {\n      api.reload('6c0e6dd2', component.options)\n    }\n    module.hot.accept(\"./FileListFilterType.vue?vue&type=template&id=6c0e6dd2\", function () {\n      api.rerender('6c0e6dd2', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/files/src/components/FileListFilter/FileListFilterType.vue\"\nexport default component.exports","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=script&lang=ts\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=script&lang=ts\"","export * from \"-!../../../../../node_modules/style-loader/dist/cjs.js!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=style&index=0&id=6c0e6dd2&lang=css\"","export * from \"-!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=template&id=6c0e6dd2\"","import { render, staticRenderFns } from \"./NewNodeDialog.vue?vue&type=template&id=e6b9c05a&scoped=true\"\nimport script from \"./NewNodeDialog.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./NewNodeDialog.vue?vue&type=script&setup=true&lang=ts\"\nimport style0 from \"./NewNodeDialog.vue?vue&type=style&index=0&id=e6b9c05a&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e6b9c05a\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/louis/workspace/nextcloud/instances/master/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('e6b9c05a')) {\n      api.createRecord('e6b9c05a', component.options)\n    } else {\n      api.reload('e6b9c05a', component.options)\n    }\n    module.hot.accept(\"./NewNodeDialog.vue?vue&type=template&id=e6b9c05a&scoped=true\", function () {\n      api.rerender('e6b9c05a', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"apps/files/src/components/NewNodeDialog.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=script&setup=true&lang=ts\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??clonedRuleSet-4.use[1]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=script&setup=true&lang=ts\"","export * from \"-!../../../../node_modules/style-loader/dist/cjs.js!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=style&index=0&id=e6b9c05a&scoped=true&lang=css\"","export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=template&id=e6b9c05a&scoped=true\"","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { subscribe } from '@nextcloud/event-bus';\nimport { FileListFilter, registerFileListFilter } from '@nextcloud/files';\nimport { getPinia } from \"../store/index.ts\";\nimport { useSearchStore } from \"../store/search.ts\";\n/**\n * Register the filename filter\n */\nexport function registerFilenameFilter() {\n  registerFileListFilter(new FilenameFilter());\n}\n/**\n * Simple file list filter controlled by the Navigation search box\n */\nclass FilenameFilter extends FileListFilter {\n  constructor() {\n    super('files:filename', 5);\n    _defineProperty(this, \"searchQuery\", '');\n    subscribe('files:search:updated', _ref => {\n      let {\n        query,\n        scope\n      } = _ref;\n      if (scope === 'filter') {\n        this.updateQuery(query);\n      }\n    });\n  }\n  filter(nodes) {\n    const queryParts = this.searchQuery.toLocaleLowerCase().split(' ').filter(Boolean);\n    return nodes.filter(node => {\n      const displayname = node.displayname.toLocaleLowerCase();\n      return queryParts.every(part => displayname.includes(part));\n    });\n  }\n  reset() {\n    this.updateQuery('');\n  }\n  updateQuery(query) {\n    query = (query || '').trim();\n    // Only if the query is different we update the filter to prevent re-computing all nodes\n    if (query !== this.searchQuery) {\n      this.searchQuery = query;\n      this.filterUpdated();\n      const chips = [];\n      if (query !== '') {\n        chips.push({\n          text: query,\n          onclick: () => {\n            this.updateQuery('');\n          }\n        });\n      } else {\n        // make sure to also reset the search store when pressing the \"X\" on the filter chip\n        const store = useSearchStore(getPinia());\n        if (store.scope === 'filter') {\n          store.query = '';\n        }\n      }\n      this.updateChips(chips);\n    }\n  }\n}","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { FileListFilter, registerFileListFilter } from '@nextcloud/files';\nimport { subscribe } from '@nextcloud/event-bus';\nimport { loadState } from '@nextcloud/initial-state';\nclass HiddenFilesFilter extends FileListFilter {\n  constructor() {\n    super('files:hidden', 0);\n    _defineProperty(this, \"showHidden\", void 0);\n    this.showHidden = loadState('files', 'config', {\n      show_hidden: false\n    }).show_hidden;\n    subscribe('files:config:updated', _ref => {\n      let {\n        key,\n        value\n      } = _ref;\n      if (key === 'show_hidden') {\n        this.showHidden = Boolean(value);\n        this.filterUpdated();\n      }\n    });\n  }\n  filter(nodes) {\n    if (this.showHidden) {\n      return nodes;\n    }\n    return nodes.filter(node => node.attributes.hidden !== true && !node.basename.startsWith('.'));\n  }\n}\n/**\n * Register a file list filter to only show hidden files if enabled by user config\n */\nexport function registerHiddenFilesFilter() {\n  registerFileListFilter(new HiddenFilesFilter());\n}","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { FileListFilter, registerFileListFilter } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport Vue from 'vue';\nimport FileListFilterModified from \"../components/FileListFilter/FileListFilterModified.vue\";\nimport calendarSvg from '@mdi/svg/svg/calendar.svg?raw';\nconst startOfToday = () => new Date().setHours(0, 0, 0, 0);\n/**\n * Available presets\n */\nconst timePresets = [{\n  id: 'today',\n  label: t('files', 'Today'),\n  filter: time => time > startOfToday()\n}, {\n  id: 'last-7',\n  label: t('files', 'Last 7 days'),\n  filter: time => time > startOfToday() - 7 * 24 * 60 * 60 * 1000\n}, {\n  id: 'last-30',\n  label: t('files', 'Last 30 days'),\n  filter: time => time > startOfToday() - 30 * 24 * 60 * 60 * 1000\n}, {\n  id: 'this-year',\n  label: t('files', 'This year ({year})', {\n    year: new Date().getFullYear()\n  }),\n  filter: time => time > new Date(startOfToday()).setMonth(0, 1)\n}, {\n  id: 'last-year',\n  label: t('files', 'Last year ({year})', {\n    year: new Date().getFullYear() - 1\n  }),\n  filter: time => time > new Date(startOfToday()).setFullYear(new Date().getFullYear() - 1, 0, 1) && time < new Date(startOfToday()).setMonth(0, 1)\n}];\nclass ModifiedFilter extends FileListFilter {\n  constructor() {\n    super('files:modified', 50);\n    _defineProperty(this, \"currentInstance\", void 0);\n    _defineProperty(this, \"currentPreset\", void 0);\n  }\n  mount(el) {\n    if (this.currentInstance) {\n      this.currentInstance.$destroy();\n    }\n    const View = Vue.extend(FileListFilterModified);\n    this.currentInstance = new View({\n      propsData: {\n        timePresets\n      },\n      el\n    }).$on('update:preset', this.setPreset.bind(this)).$mount();\n  }\n  filter(nodes) {\n    if (!this.currentPreset) {\n      return nodes;\n    }\n    return nodes.filter(node => node.mtime === undefined || this.currentPreset.filter(node.mtime.getTime()));\n  }\n  reset() {\n    this.setPreset();\n  }\n  setPreset(preset) {\n    this.currentPreset = preset;\n    this.filterUpdated();\n    const chips = [];\n    if (preset) {\n      chips.push({\n        icon: calendarSvg,\n        text: preset.label,\n        onclick: () => this.setPreset()\n      });\n    } else {\n      this.currentInstance?.resetFilter();\n    }\n    this.updateChips(chips);\n  }\n}\n/**\n * Register the file list filter by modification date\n */\nexport function registerModifiedFilter() {\n  registerFileListFilter(new ModifiedFilter());\n}","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { subscribe } from '@nextcloud/event-bus';\nimport { FileListFilter, registerFileListFilter } from '@nextcloud/files';\nimport Vue from 'vue';\nimport FileListFilterToSearch from \"../components/FileListFilter/FileListFilterToSearch.vue\";\nclass SearchFilter extends FileListFilter {\n  constructor() {\n    super('files:filter-to-search', 999);\n    _defineProperty(this, \"currentInstance\", void 0);\n    subscribe('files:search:updated', _ref => {\n      let {\n        query,\n        scope\n      } = _ref;\n      if (query && scope === 'filter') {\n        this.currentInstance?.showButton();\n      } else {\n        this.currentInstance?.hideButton();\n      }\n    });\n  }\n  mount(el) {\n    if (this.currentInstance) {\n      this.currentInstance.$destroy();\n    }\n    const View = Vue.extend(FileListFilterToSearch);\n    this.currentInstance = new View().$mount(el);\n  }\n  filter(nodes) {\n    return nodes;\n  }\n}\n/**\n * Register a file list filter to only show hidden files if enabled by user config\n */\nexport function registerFilterToSearchToggle() {\n  registerFileListFilter(new SearchFilter());\n}","function _defineProperty(e, r, t) { return (r = _toPropertyKey(r)) in e ? Object.defineProperty(e, r, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[r] = t, e; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == typeof i ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != typeof i) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\nimport { FileListFilter, registerFileListFilter } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport Vue from 'vue';\nimport FileListFilterType from \"../components/FileListFilter/FileListFilterType.vue\";\n// TODO: Create a modern replacement for OC.MimeType...\nimport svgDocument from '@mdi/svg/svg/file-document.svg?raw';\nimport svgSpreadsheet from '@mdi/svg/svg/file-table-box.svg?raw';\nimport svgPresentation from '@mdi/svg/svg/file-presentation-box.svg?raw';\nimport svgPDF from '@mdi/svg/svg/file-pdf-box.svg?raw';\nimport svgFolder from '@mdi/svg/svg/folder.svg?raw';\nimport svgAudio from '@mdi/svg/svg/music.svg?raw';\nimport svgImage from '@mdi/svg/svg/image.svg?raw';\nimport svgMovie from '@mdi/svg/svg/movie.svg?raw';\nconst colorize = (svg, color) => {\n  return svg.replace('<path ', `<path fill=\"${color}\" `);\n};\n/**\n * Available presets\n */\nconst getTypePresets = async () => [{\n  id: 'document',\n  label: t('files', 'Documents'),\n  icon: colorize(svgDocument, '#49abea'),\n  mime: ['x-office/document']\n}, {\n  id: 'spreadsheet',\n  label: t('files', 'Spreadsheets'),\n  icon: colorize(svgSpreadsheet, '#9abd4e'),\n  mime: ['x-office/spreadsheet']\n}, {\n  id: 'presentation',\n  label: t('files', 'Presentations'),\n  icon: colorize(svgPresentation, '#f0965f'),\n  mime: ['x-office/presentation']\n}, {\n  id: 'pdf',\n  label: t('files', 'PDFs'),\n  icon: colorize(svgPDF, '#dc5047'),\n  mime: ['application/pdf']\n}, {\n  id: 'folder',\n  label: t('files', 'Folders'),\n  icon: colorize(svgFolder, window.getComputedStyle(document.body).getPropertyValue('--color-primary-element')),\n  mime: ['httpd/unix-directory']\n}, {\n  id: 'audio',\n  label: t('files', 'Audio'),\n  icon: svgAudio,\n  mime: ['audio']\n}, {\n  id: 'image',\n  // TRANSLATORS: This is for filtering files, e.g. PNG or JPEG, so photos, drawings, or images in general\n  label: t('files', 'Images'),\n  icon: svgImage,\n  mime: ['image']\n}, {\n  id: 'video',\n  label: t('files', 'Videos'),\n  icon: svgMovie,\n  mime: ['video']\n}];\nclass TypeFilter extends FileListFilter {\n  constructor() {\n    super('files:type', 10);\n    _defineProperty(this, \"currentInstance\", void 0);\n    _defineProperty(this, \"currentPresets\", void 0);\n    _defineProperty(this, \"allPresets\", void 0);\n    this.currentPresets = [];\n  }\n  async mount(el) {\n    // We need to defer this as on init script this is not available:\n    if (this.allPresets === undefined) {\n      this.allPresets = await getTypePresets();\n    }\n    // Already mounted\n    if (this.currentInstance) {\n      this.currentInstance.$destroy();\n      delete this.currentInstance;\n    }\n    const View = Vue.extend(FileListFilterType);\n    this.currentInstance = new View({\n      propsData: {\n        presets: this.currentPresets,\n        typePresets: this.allPresets\n      },\n      el\n    }).$on('update:presets', this.setPresets.bind(this)).$mount();\n  }\n  filter(nodes) {\n    if (!this.currentPresets || this.currentPresets.length === 0) {\n      return nodes;\n    }\n    const mimeList = this.currentPresets.reduce((previous, current) => [...previous, ...current.mime], []);\n    return nodes.filter(node => {\n      if (!node.mime) {\n        return false;\n      }\n      const mime = node.mime.toLowerCase();\n      if (mimeList.includes(mime)) {\n        return true;\n      } else if (mimeList.includes(window.OC.MimeTypeList.aliases[mime])) {\n        return true;\n      } else if (mimeList.includes(mime.split('/')[0])) {\n        return true;\n      }\n      return false;\n    });\n  }\n  reset() {\n    this.setPresets();\n  }\n  setPresets(presets) {\n    this.currentPresets = presets ?? [];\n    if (this.currentInstance !== undefined) {\n      // could be called before the instance was created\n      // (meaning the files list is not mounted yet)\n      this.currentInstance.$props.presets = presets;\n    }\n    this.filterUpdated();\n    const chips = [];\n    if (presets && presets.length > 0) {\n      for (const preset of presets) {\n        chips.push({\n          icon: preset.icon,\n          text: preset.label,\n          onclick: () => this.removeFilterPreset(preset.id)\n        });\n      }\n    } else {\n      this.currentInstance?.resetFilter();\n    }\n    this.updateChips(chips);\n  }\n  /**\n   * Helper callback that removed a preset from selected.\n   * This is used when clicking on \"remove\" on a filter-chip.\n   * @param presetId Id of preset to remove\n   */\n  removeFilterPreset(presetId) {\n    const filtered = this.currentPresets.filter(_ref => {\n      let {\n        id\n      } = _ref;\n      return id !== presetId;\n    });\n    this.setPresets(filtered);\n  }\n}\n/**\n * Register the file list filter by file type\n */\nexport function registerTypeFilter() {\n  registerFileListFilter(new TypeFilter());\n}","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { addNewFileMenuEntry, registerDavProperty, registerFileAction } from '@nextcloud/files';\nimport { action as deleteAction } from \"./actions/deleteAction\";\nimport { action as downloadAction } from \"./actions/downloadAction\";\nimport { action as editLocallyAction } from \"./actions/openLocallyAction.ts\";\nimport { action as favoriteAction } from \"./actions/favoriteAction\";\nimport { action as moveOrCopyAction } from \"./actions/moveOrCopyAction\";\nimport { action as openFolderAction } from \"./actions/openFolderAction\";\nimport { action as openInFilesAction } from \"./actions/openInFilesAction\";\nimport { action as renameAction } from \"./actions/renameAction\";\nimport { action as sidebarAction } from \"./actions/sidebarAction\";\nimport { action as viewInFolderAction } from \"./actions/viewInFolderAction\";\nimport { registerHiddenFilesFilter } from \"./filters/HiddenFilesFilter.ts\";\nimport { registerTypeFilter } from \"./filters/TypeFilter.ts\";\nimport { registerModifiedFilter } from \"./filters/ModifiedFilter.ts\";\nimport { entry as newFolderEntry } from \"./newMenu/newFolder.ts\";\nimport { entry as newTemplatesFolder } from \"./newMenu/newTemplatesFolder.ts\";\nimport { registerTemplateEntries } from \"./newMenu/newFromTemplate.ts\";\nimport { registerFavoritesView } from \"./views/favorites.ts\";\nimport registerRecentView from \"./views/recent\";\nimport { registerPersonalFilesView } from \"./views/personal-files\";\nimport { registerFilesView } from \"./views/files\";\nimport { registerFolderTreeView } from \"./views/folderTree.ts\";\nimport { registerSearchView } from \"./views/search.ts\";\nimport registerPreviewServiceWorker from \"./services/ServiceWorker.js\";\nimport { initLivePhotos } from \"./services/LivePhotos\";\nimport { isPublicShare } from '@nextcloud/sharing/public';\nimport { registerConvertActions } from \"./actions/convertAction.ts\";\nimport { registerFilenameFilter } from \"./filters/FilenameFilter.ts\";\nimport { registerFilterToSearchToggle } from \"./filters/SearchFilter.ts\";\n// Register file actions\nregisterConvertActions();\nregisterFileAction(deleteAction);\nregisterFileAction(downloadAction);\nregisterFileAction(editLocallyAction);\nregisterFileAction(favoriteAction);\nregisterFileAction(moveOrCopyAction);\nregisterFileAction(openFolderAction);\nregisterFileAction(openInFilesAction);\nregisterFileAction(renameAction);\nregisterFileAction(sidebarAction);\nregisterFileAction(viewInFolderAction);\n// Register new menu entry\naddNewFileMenuEntry(newFolderEntry);\naddNewFileMenuEntry(newTemplatesFolder);\nregisterTemplateEntries();\n// Register files views when not on public share\nif (isPublicShare() === false) {\n  registerFavoritesView();\n  registerFilesView();\n  registerPersonalFilesView();\n  registerRecentView();\n  registerSearchView();\n  registerFolderTreeView();\n}\n// Register file list filters\nregisterHiddenFilesFilter();\nregisterTypeFilter();\nregisterModifiedFilter();\nregisterFilenameFilter();\nregisterFilterToSearchToggle();\n// Register preview service worker\nregisterPreviewServiceWorker();\nregisterDavProperty('nc:hidden', {\n  nc: 'http://nextcloud.org/ns'\n});\nregisterDavProperty('nc:is-mount-root', {\n  nc: 'http://nextcloud.org/ns'\n});\nregisterDavProperty('nc:metadata-blurhash', {\n  nc: 'http://nextcloud.org/ns'\n});\ninitLivePhotos();","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getLoggerBuilder } from '@nextcloud/logger';\nexport default getLoggerBuilder().setApp('files').detectUser().build();","import { basename } from 'path';\nimport { emit } from '@nextcloud/event-bus';\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { Permission, Folder } from '@nextcloud/files';\nimport { showError, showSuccess } from '@nextcloud/dialogs';\nimport { translate as t } from '@nextcloud/l10n';\nimport axios from '@nextcloud/axios';\nimport FolderPlusSvg from '@mdi/svg/svg/folder-plus-outline.svg?raw';\nimport { newNodeName } from \"../utils/newNodeDialog\";\nimport logger from \"../logger\";\nconst createNewFolder = async (root, name) => {\n  const source = root.source + '/' + name;\n  const encodedSource = root.encodedSource + '/' + encodeURIComponent(name);\n  const response = await axios({\n    method: 'MKCOL',\n    url: encodedSource,\n    headers: {\n      Overwrite: 'F'\n    }\n  });\n  return {\n    fileid: parseInt(response.headers['oc-fileid']),\n    source\n  };\n};\nexport const entry = {\n  id: 'newFolder',\n  displayName: t('files', 'New folder'),\n  enabled: context => Boolean(context.permissions & Permission.CREATE) && Boolean(context.permissions & Permission.READ),\n  // Make the svg icon color match the primary element color\n  iconSvgInline: FolderPlusSvg.replace(/viewBox/gi, 'style=\"color: var(--color-primary-element)\" viewBox'),\n  order: 0,\n  async handler(context, content) {\n    const name = await newNodeName(t('files', 'New folder'), content);\n    if (name === null) {\n      return;\n    }\n    try {\n      const {\n        fileid,\n        source\n      } = await createNewFolder(context, name.trim());\n      // Create the folder in the store\n      const folder = new Folder({\n        source,\n        id: fileid,\n        mtime: new Date(),\n        owner: context.owner,\n        permissions: Permission.ALL,\n        root: context?.root || '/files/' + getCurrentUser()?.uid,\n        // Include mount-type from parent folder as this is inherited\n        attributes: {\n          'mount-type': context.attributes?.['mount-type'],\n          'owner-id': context.attributes?.['owner-id'],\n          'owner-display-name': context.attributes?.['owner-display-name']\n        }\n      });\n      // Show success\n      emit('files:node:created', folder);\n      showSuccess(t('files', 'Created new folder \"{name}\"', {\n        name: basename(source)\n      }));\n      logger.debug('Created new folder', {\n        folder,\n        source\n      });\n      // Navigate to the new folder\n      window.OCP.Files.Router.goToRoute(null,\n      // use default route\n      {\n        view: 'files',\n        fileid: String(fileid)\n      }, {\n        dir: context.path\n      });\n    } catch (error) {\n      logger.error('Creating new folder failed', {\n        error\n      });\n      showError('Creating new folder failed');\n    }\n  }\n};","/**\n * SPDX-FileCopyrightText: 2020 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { Permission, addNewFileMenuEntry } from '@nextcloud/files';\nimport { loadState } from '@nextcloud/initial-state';\nimport { newNodeName } from \"../utils/newNodeDialog\";\nimport { translate as t } from '@nextcloud/l10n';\nimport Vue, { defineAsyncComponent } from 'vue';\n// async to reduce bundle size\nconst TemplatePickerVue = defineAsyncComponent(() => import(\"../views/TemplatePicker.vue\"));\nlet TemplatePicker = null;\nconst getTemplatePicker = async context => {\n  if (TemplatePicker === null) {\n    // Create document root\n    const mountingPoint = document.createElement('div');\n    mountingPoint.id = 'template-picker';\n    document.body.appendChild(mountingPoint);\n    // Init vue app\n    TemplatePicker = new Vue({\n      render: h => h(TemplatePickerVue, {\n        ref: 'picker',\n        props: {\n          parent: context\n        }\n      }),\n      methods: {\n        open() {\n          this.$refs.picker.open(...arguments);\n        }\n      },\n      el: mountingPoint\n    });\n  }\n  return TemplatePicker;\n};\n/**\n * Register all new-file-menu entries for all template providers\n */\nexport function registerTemplateEntries() {\n  const templates = loadState('files', 'templates', []);\n  // Init template files menu\n  templates.forEach((provider, index) => {\n    addNewFileMenuEntry({\n      id: `template-new-${provider.app}-${index}`,\n      displayName: provider.label,\n      iconClass: provider.iconClass || 'icon-file',\n      iconSvgInline: provider.iconSvgInline,\n      enabled(context) {\n        return (context.permissions & Permission.CREATE) !== 0;\n      },\n      order: 11,\n      async handler(context, content) {\n        const templatePicker = getTemplatePicker(context);\n        const name = await newNodeName(`${provider.label}${provider.extension}`, content, {\n          label: t('files', 'Filename'),\n          name: provider.label\n        });\n        if (name !== null) {\n          // Create the file\n          const picker = await templatePicker;\n          picker.open(name.trim(), provider);\n        }\n      }\n    });\n  });\n}","import { getCurrentUser } from '@nextcloud/auth';\nimport { showError } from '@nextcloud/dialogs';\nimport { Permission, removeNewFileMenuEntry } from '@nextcloud/files';\nimport { loadState } from '@nextcloud/initial-state';\nimport { translate as t } from '@nextcloud/l10n';\nimport { generateOcsUrl } from '@nextcloud/router';\nimport { join } from 'path';\nimport { newNodeName } from \"../utils/newNodeDialog\";\nimport PlusSvg from '@mdi/svg/svg/plus.svg?raw';\nimport axios from '@nextcloud/axios';\nimport logger from \"../logger.ts\";\nconst templatesEnabled = loadState('files', 'templates_enabled', true);\nlet templatesPath = loadState('files', 'templates_path', false);\nlogger.debug('Templates folder enabled', {\n  templatesEnabled\n});\nlogger.debug('Initial templates folder', {\n  templatesPath\n});\n/**\n * Init template folder\n * @param directory Folder where to create the templates folder\n * @param name Name to use or the templates folder\n */\nconst initTemplatesFolder = async function (directory, name) {\n  const templatePath = join(directory.path, name);\n  try {\n    logger.debug('Initializing the templates directory', {\n      templatePath\n    });\n    const {\n      data\n    } = await axios.post(generateOcsUrl('apps/files/api/v1/templates/path'), {\n      templatePath,\n      copySystemTemplates: true\n    });\n    // Go to template directory\n    window.OCP.Files.Router.goToRoute(null,\n    // use default route\n    {\n      view: 'files',\n      fileid: undefined\n    }, {\n      dir: templatePath\n    });\n    logger.info('Created new templates folder', {\n      ...data.ocs.data\n    });\n    templatesPath = data.ocs.data.templates_path;\n  } catch (error) {\n    logger.error('Unable to initialize the templates directory');\n    showError(t('files', 'Unable to initialize the templates directory'));\n  }\n};\nexport const entry = {\n  id: 'template-picker',\n  displayName: t('files', 'Create templates folder'),\n  iconSvgInline: PlusSvg,\n  order: 30,\n  enabled(context) {\n    // Templates disabled or templates folder already initialized\n    if (!templatesEnabled || templatesPath) {\n      return false;\n    }\n    // Allow creation on your own folders only\n    if (context.owner !== getCurrentUser()?.uid) {\n      return false;\n    }\n    return (context.permissions & Permission.CREATE) !== 0;\n  },\n  async handler(context, content) {\n    const name = await newNodeName(t('files', 'Templates'), content, {\n      name: t('files', 'New template folder')\n    });\n    if (name !== null) {\n      // Create the template folder\n      initTemplatesFolder(context, name);\n      // Remove the menu entry\n      removeNewFileMenuEntry('template-picker');\n    }\n  }\n};","import { getCurrentUser } from '@nextcloud/auth';\nimport { Folder, Permission, davRemoteURL, davRootPath, getFavoriteNodes } from '@nextcloud/files';\nimport { CancelablePromise } from 'cancelable-promise';\nimport { getContents as filesContents } from \"./Files.ts\";\nimport { client } from \"./WebdavClient.ts\";\nexport const getContents = function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  // We only filter root files for favorites, for subfolders we can simply reuse the files contents\n  if (path !== '/') {\n    return filesContents(path);\n  }\n  return new CancelablePromise((resolve, reject, cancel) => {\n    const promise = getFavoriteNodes(client).catch(reject).then(contents => {\n      if (!contents) {\n        reject();\n        return;\n      }\n      resolve({\n        contents,\n        folder: new Folder({\n          id: 0,\n          source: `${davRemoteURL}${davRootPath}`,\n          root: davRootPath,\n          owner: getCurrentUser()?.uid || null,\n          permissions: Permission.READ\n        })\n      });\n    });\n    cancel(() => promise.cancel());\n  });\n};","import { defaultRootPath, getDefaultPropfind, resultToNode as davResultToNode } from '@nextcloud/files/dav';\nimport { CancelablePromise } from 'cancelable-promise';\nimport { join } from 'path';\nimport { client } from \"./WebdavClient.ts\";\nimport { searchNodes } from \"./WebDavSearch.ts\";\nimport { getPinia } from \"../store/index.ts\";\nimport { useFilesStore } from \"../store/files.ts\";\nimport { useSearchStore } from \"../store/search.ts\";\nimport logger from \"../logger.ts\";\n/**\n * Slim wrapper over `@nextcloud/files` `davResultToNode` to allow using the function with `Array.map`\n * @param stat The result returned by the webdav library\n */\nexport const resultToNode = stat => davResultToNode(stat);\n/**\n * Get contents implementation for the files view.\n * This also allows to fetch local search results when the user is currently filtering.\n *\n * @param path - The path to query\n */\nexport function getContents() {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  const controller = new AbortController();\n  const searchStore = useSearchStore(getPinia());\n  if (searchStore.query.length >= 3) {\n    return new CancelablePromise((resolve, reject, cancel) => {\n      cancel(() => controller.abort());\n      getLocalSearch(path, searchStore.query, controller.signal).then(resolve).catch(reject);\n    });\n  } else {\n    return defaultGetContents(path);\n  }\n}\n/**\n * Generic `getContents` implementation for the users files.\n *\n * @param path - The path to get the contents\n */\nexport function defaultGetContents(path) {\n  path = join(defaultRootPath, path);\n  const controller = new AbortController();\n  const propfindPayload = getDefaultPropfind();\n  return new CancelablePromise(async (resolve, reject, onCancel) => {\n    onCancel(() => controller.abort());\n    try {\n      const contentsResponse = await client.getDirectoryContents(path, {\n        details: true,\n        data: propfindPayload,\n        includeSelf: true,\n        signal: controller.signal\n      });\n      const root = contentsResponse.data[0];\n      const contents = contentsResponse.data.slice(1);\n      if (root.filename !== path && `${root.filename}/` !== path) {\n        logger.debug(`Exepected \"${path}\" but got filename \"${root.filename}\" instead.`);\n        throw new Error('Root node does not match requested path');\n      }\n      resolve({\n        folder: resultToNode(root),\n        contents: contents.map(result => {\n          try {\n            return resultToNode(result);\n          } catch (error) {\n            logger.error(`Invalid node detected '${result.basename}'`, {\n              error\n            });\n            return null;\n          }\n        }).filter(Boolean)\n      });\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n/**\n * Get the local search results for the current folder.\n *\n * @param path - The path\n * @param query - The current search query\n * @param signal - The aboort signal\n */\nasync function getLocalSearch(path, query, signal) {\n  const filesStore = useFilesStore(getPinia());\n  let folder = filesStore.getDirectoryByPath('files', path);\n  if (!folder) {\n    const rootPath = join(defaultRootPath, path);\n    const stat = await client.stat(rootPath, {\n      details: true\n    });\n    folder = resultToNode(stat.data);\n  }\n  const contents = await searchNodes(query, {\n    dir: path,\n    signal\n  });\n  return {\n    folder,\n    contents\n  };\n}","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { davRemoteURL } from '@nextcloud/files';\nimport axios from '@nextcloud/axios';\nimport { generateOcsUrl } from '@nextcloud/router';\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { dirname, encodePath, joinPaths } from '@nextcloud/paths';\nimport { getCanonicalLocale, getLanguage } from '@nextcloud/l10n';\nimport { getContents as getFiles } from \"./Files.ts\";\nexport const folderTreeId = 'folders';\nexport const sourceRoot = `${davRemoteURL}/files/${getCurrentUser()?.uid}`;\nconst collator = Intl.Collator([getLanguage(), getCanonicalLocale()], {\n  numeric: true,\n  usage: 'sort'\n});\nconst compareNodes = (a, b) => collator.compare(a.displayName ?? a.basename, b.displayName ?? b.basename);\nconst getTreeNodes = function (tree) {\n  let currentPath = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '/';\n  let nodes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  const sortedTree = tree.toSorted(compareNodes);\n  for (const {\n    id,\n    basename,\n    displayName,\n    children\n  } of sortedTree) {\n    const path = joinPaths(currentPath, basename);\n    const source = `${sourceRoot}${path}`;\n    const node = {\n      source,\n      encodedSource: encodeSource(source),\n      path,\n      fileid: id,\n      basename\n    };\n    if (displayName) {\n      node.displayName = displayName;\n    }\n    nodes.push(node);\n    if (children.length > 0) {\n      getTreeNodes(children, path, nodes);\n    }\n  }\n  return nodes;\n};\nexport const getFolderTreeNodes = async function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  let depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  const {\n    data: tree\n  } = await axios.get(generateOcsUrl('/apps/files/api/v1/folder-tree'), {\n    params: new URLSearchParams({\n      path,\n      depth: String(depth)\n    })\n  });\n  const nodes = getTreeNodes(tree, path);\n  return nodes;\n};\nexport const getContents = path => getFiles(path);\nexport const encodeSource = source => {\n  const {\n    origin\n  } = new URL(source);\n  return origin + encodePath(source.slice(origin.length));\n};\nexport const getSourceParent = source => {\n  const parent = dirname(source);\n  if (parent === sourceRoot) {\n    return folderTreeId;\n  }\n  return encodeSource(parent);\n};","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { registerDavProperty } from '@nextcloud/files';\n/**\n *\n */\nexport function initLivePhotos() {\n  registerDavProperty('nc:metadata-files-live-photo', {\n    nc: 'http://nextcloud.org/ns'\n  });\n}\n/**\n * @param {Node} node - The node\n */\nexport function isLivePhoto(node) {\n  return node.attributes['metadata-files-live-photo'] !== undefined;\n}","import { getCurrentUser } from '@nextcloud/auth';\nimport { getContents as getFiles } from \"./Files\";\nconst currentUserId = getCurrentUser()?.uid;\n/**\n * Filters each file/folder on its shared status\n *\n * A personal file is considered a file that has all of the following properties:\n * 1. the current user owns\n * 2. the file is not shared with anyone\n * 3. the file is not a group folder\n * @todo Move to `@nextcloud/files`\n * @param node The node to check\n */\nexport const isPersonalFile = function (node) {\n  // the type of mounts that determine whether the file is shared\n  const sharedMountTypes = ['group', 'shared'];\n  const mountType = node.attributes['mount-type'];\n  return currentUserId === node.owner && !sharedMountTypes.includes(mountType);\n};\nexport const getContents = function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  // get all the files from the current path as a cancellable promise\n  // then filter the files that the user does not own, or has shared / is a group folder\n  return getFiles(path).then(content => {\n    content.contents = content.contents.filter(isPersonalFile);\n    return content;\n  });\n};","import { getCurrentUser } from '@nextcloud/auth';\nimport { Folder, Permission, davGetRecentSearch, davRootPath, davRemoteURL, davResultToNode } from '@nextcloud/files';\nimport { CancelablePromise } from 'cancelable-promise';\nimport { useUserConfigStore } from \"../store/userconfig.ts\";\nimport { getPinia } from \"../store/index.ts\";\nimport { client } from \"./WebdavClient.ts\";\nimport { getBaseUrl } from '@nextcloud/router';\nconst lastTwoWeeksTimestamp = Math.round(Date.now() / 1000 - 60 * 60 * 24 * 14);\n/**\n * Helper to map a WebDAV result to a Nextcloud node\n * The search endpoint already includes the dav remote URL so we must not include it in the source\n *\n * @param stat the WebDAV result\n */\nconst resultToNode = stat => davResultToNode(stat, davRootPath, getBaseUrl());\n/**\n * Get recently changed nodes\n *\n * This takes the users preference about hidden files into account.\n * If hidden files are not shown, then also recently changed files *in* hidden directories are filtered.\n *\n * @param path Path to search for recent changes\n */\nexport const getContents = function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  const store = useUserConfigStore(getPinia());\n  /**\n   * Filter function that returns only the visible nodes - or hidden if explicitly configured\n   * @param node The node to check\n   */\n  const filterHidden = node => path !== '/' // We need to hide files from hidden directories in the root if not configured to show\n  || store.userConfig.show_hidden // If configured to show hidden files we can early return\n  || !node.dirname.split('/').some(dir => dir.startsWith('.')); // otherwise only include the file if non of the parent directories is hidden\n  const controller = new AbortController();\n  const handler = async () => {\n    const contentsResponse = await client.search('/', {\n      signal: controller.signal,\n      details: true,\n      data: davGetRecentSearch(lastTwoWeeksTimestamp)\n    });\n    const contents = contentsResponse.data.results.map(resultToNode).filter(filterHidden);\n    return {\n      folder: new Folder({\n        id: 0,\n        source: `${davRemoteURL}${davRootPath}`,\n        root: davRootPath,\n        owner: getCurrentUser()?.uid || null,\n        permissions: Permission.READ\n      }),\n      contents\n    };\n  };\n  return new CancelablePromise(async (resolve, reject, cancel) => {\n    cancel(() => controller.abort());\n    resolve(handler());\n  });\n};","/*!\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { Folder, Permission } from '@nextcloud/files';\nimport { defaultRemoteURL } from '@nextcloud/files/dav';\nimport { CancelablePromise } from 'cancelable-promise';\nimport { searchNodes } from \"./WebDavSearch.ts\";\nimport logger from \"../logger.ts\";\nimport { useSearchStore } from \"../store/search.ts\";\nimport { getPinia } from \"../store/index.ts\";\n/**\n * Get the contents for a search view\n */\nexport function getContents() {\n  const controller = new AbortController();\n  const searchStore = useSearchStore(getPinia());\n  return new CancelablePromise(async (resolve, reject, cancel) => {\n    cancel(() => controller.abort());\n    try {\n      const contents = await searchNodes(searchStore.query, {\n        signal: controller.signal\n      });\n      resolve({\n        contents,\n        folder: new Folder({\n          id: 0,\n          source: `${defaultRemoteURL}#search`,\n          owner: getCurrentUser().uid,\n          permissions: Permission.READ\n        })\n      });\n    } catch (error) {\n      logger.error('Failed to fetch search results', {\n        error\n      });\n      reject(error);\n    }\n  });\n}","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { generateUrl, getRootUrl } from '@nextcloud/router';\nimport logger from \"../logger.ts\";\nexport default () => {\n  if ('serviceWorker' in navigator) {\n    // Use the window load event to keep the page load performant\n    window.addEventListener('load', async () => {\n      try {\n        const url = generateUrl('/apps/files/preview-service-worker.js', {}, {\n          noRewrite: true\n        });\n        let scope = getRootUrl();\n        // If the instance is not in a subfolder an empty string will be returned.\n        // The service worker registration will use the current path if it receives an empty string,\n        // which will result in a service worker registration for every single path the user visits.\n        if (scope === '') {\n          scope = '/';\n        }\n        const registration = await navigator.serviceWorker.register(url, {\n          scope\n        });\n        logger.debug('SW registered: ', {\n          registration\n        });\n      } catch (error) {\n        logger.error('SW registration failed: ', {\n          error\n        });\n      }\n    });\n  } else {\n    logger.debug('Service Worker is not enabled on this browser.');\n  }\n};","/*!\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { defaultRootPath, getDavNameSpaces, getDavProperties, resultToNode } from '@nextcloud/files/dav';\nimport { getBaseUrl } from '@nextcloud/router';\nimport { client } from \"./WebdavClient.ts\";\nimport logger from \"../logger.ts\";\n/**\n * Search for nodes matching the given query.\n *\n * @param query - Search query\n * @param options - Options\n * @param options.dir - The base directory to scope the search to\n * @param options.signal - Abort signal for the request\n */\nexport async function searchNodes(query, _ref) {\n  let {\n    dir,\n    signal\n  } = _ref;\n  const user = getCurrentUser();\n  if (!user) {\n    // the search plugin only works for user roots\n    return [];\n  }\n  query = query.trim();\n  if (query.length < 3) {\n    // the search plugin only works with queries of at least 3 characters\n    return [];\n  }\n  if (dir && !dir.startsWith('/')) {\n    dir = `/${dir}`;\n  }\n  logger.debug('Searching for nodes', {\n    query,\n    dir\n  });\n  const {\n    data\n  } = await client.search('/', {\n    details: true,\n    signal,\n    data: `\n<d:searchrequest ${getDavNameSpaces()}>\n\t <d:basicsearch>\n\t\t <d:select>\n\t\t\t <d:prop>\n\t\t\t ${getDavProperties()}\n\t\t\t </d:prop>\n\t\t </d:select>\n\t\t <d:from>\n\t\t\t <d:scope>\n\t\t\t\t <d:href>/files/${user.uid}${dir || ''}</d:href>\n\t\t\t\t <d:depth>infinity</d:depth>\n\t\t\t </d:scope>\n\t\t </d:from>\n\t\t <d:where>\n\t\t\t <d:like>\n\t\t\t\t <d:prop>\n\t\t\t\t\t <d:displayname/>\n\t\t\t\t </d:prop>\n\t\t\t\t <d:literal>%${query.replace('%', '')}%</d:literal>\n\t\t\t </d:like>\n\t\t </d:where>\n\t\t <d:orderby/>\n\t</d:basicsearch>\n</d:searchrequest>`\n  });\n  // check if the request was aborted\n  if (signal?.aborted) {\n    return [];\n  }\n  // otherwise return the result mapped to Nextcloud nodes\n  return data.results.map(result => resultToNode(result, defaultRootPath, getBaseUrl()));\n}","import { getClient, getDefaultPropfind, getRootPath, resultToNode } from '@nextcloud/files/dav';\nexport const client = getClient();\nexport const fetchNode = async path => {\n  const propfindPayload = getDefaultPropfind();\n  const result = await client.stat(`${getRootPath()}${path}`, {\n    details: true,\n    data: propfindPayload\n  });\n  return resultToNode(result.data);\n};","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { subscribe } from '@nextcloud/event-bus';\nimport { getNavigation } from '@nextcloud/files';\nimport { defineStore } from 'pinia';\nimport { ref } from 'vue';\nimport logger from \"../logger.ts\";\nexport const useActiveStore = defineStore('active', () => {\n  /**\n   * The currently active action\n   */\n  const activeAction = ref();\n  /**\n   * The currently active folder\n   */\n  const activeFolder = ref();\n  /**\n   * The current active node within the folder\n   */\n  const activeNode = ref();\n  /**\n   * The current active view\n   */\n  const activeView = ref();\n  initialize();\n  /**\n   * Unset the active node if deleted\n   *\n   * @param node - The node thats deleted\n   * @private\n   */\n  function onDeletedNode(node) {\n    if (activeNode.value && activeNode.value.source === node.source) {\n      activeNode.value = undefined;\n    }\n  }\n  /**\n   * Callback to update the current active view\n   *\n   * @param view - The new active view\n   * @private\n   */\n  function onChangedView() {\n    let view = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    logger.debug('Setting active view', {\n      view\n    });\n    activeView.value = view ?? undefined;\n    activeNode.value = undefined;\n  }\n  /**\n   * Initalize the store - connect all event listeners.\n   * @private\n   */\n  function initialize() {\n    const navigation = getNavigation();\n    // Make sure we only register the listeners once\n    subscribe('files:node:deleted', onDeletedNode);\n    onChangedView(navigation.active);\n    // Or you can react to changes of the current active view\n    navigation.addEventListener('updateActive', event => {\n      onChangedView(event.detail);\n    });\n  }\n  return {\n    activeAction,\n    activeFolder,\n    activeNode,\n    activeView\n  };\n});","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { defineStore } from 'pinia';\nimport { subscribe } from '@nextcloud/event-bus';\nimport logger from \"../logger\";\nimport Vue from 'vue';\nimport { fetchNode } from \"../services/WebdavClient.ts\";\nimport { usePathsStore } from \"./paths.ts\";\nexport const useFilesStore = function () {\n  const store = defineStore('files', {\n    state: () => ({\n      files: {},\n      roots: {}\n    }),\n    getters: {\n      /**\n       * Get a file or folder by its source\n       * @param state\n       */\n      getNode: state => source => state.files[source],\n      /**\n       * Get a list of files or folders by their IDs\n       * Note: does not return undefined values\n       * @param state\n       */\n      getNodes: state => sources => sources.map(source => state.files[source]).filter(Boolean),\n      /**\n       * Get files or folders by their file ID\n       * Multiple nodes can have the same file ID but different sources\n       * (e.g. in a shared context)\n       * @param state\n       */\n      getNodesById: state => fileId => Object.values(state.files).filter(node => node.fileid === fileId),\n      /**\n       * Get the root folder of a service\n       * @param state\n       */\n      getRoot: state => service => state.roots[service]\n    },\n    actions: {\n      /**\n       * Get cached directory matching a given path\n       *\n       * @param service - The service (files view)\n       * @param path - The path relative within the service\n       * @return The folder if found\n       */\n      getDirectoryByPath(service, path) {\n        const pathsStore = usePathsStore();\n        let folder;\n        // Get the containing folder from path store\n        if (!path || path === '/') {\n          folder = this.getRoot(service);\n        } else {\n          const source = pathsStore.getPath(service, path);\n          if (source) {\n            folder = this.getNode(source);\n          }\n        }\n        return folder;\n      },\n      /**\n       * Get cached child nodes within a given path\n       *\n       * @param service - The service (files view)\n       * @param path - The path relative within the service\n       * @return Array of cached nodes within the path\n       */\n      getNodesByPath(service, path) {\n        const folder = this.getDirectoryByPath(service, path);\n        // If we found a cache entry and the cache entry was already loaded (has children) then use it\n        return (folder?._children ?? []).map(source => this.getNode(source)).filter(Boolean);\n      },\n      updateNodes(nodes) {\n        // Update the store all at once\n        const files = nodes.reduce((acc, node) => {\n          if (!node.fileid) {\n            logger.error('Trying to update/set a node without fileid', {\n              node\n            });\n            return acc;\n          }\n          acc[node.source] = node;\n          return acc;\n        }, {});\n        Vue.set(this, 'files', {\n          ...this.files,\n          ...files\n        });\n      },\n      deleteNodes(nodes) {\n        nodes.forEach(node => {\n          if (node.source) {\n            Vue.delete(this.files, node.source);\n          }\n        });\n      },\n      setRoot(_ref) {\n        let {\n          service,\n          root\n        } = _ref;\n        Vue.set(this.roots, service, root);\n      },\n      onDeletedNode(node) {\n        this.deleteNodes([node]);\n      },\n      onCreatedNode(node) {\n        this.updateNodes([node]);\n      },\n      onMovedNode(_ref2) {\n        let {\n          node,\n          oldSource\n        } = _ref2;\n        if (!node.fileid) {\n          logger.error('Trying to update/set a node without fileid', {\n            node\n          });\n          return;\n        }\n        // Update the path of the node\n        Vue.delete(this.files, oldSource);\n        this.updateNodes([node]);\n      },\n      async onUpdatedNode(node) {\n        if (!node.fileid) {\n          logger.error('Trying to update/set a node without fileid', {\n            node\n          });\n          return;\n        }\n        // If we have multiple nodes with the same file ID, we need to update all of them\n        const nodes = this.getNodesById(node.fileid);\n        if (nodes.length > 1) {\n          await Promise.all(nodes.map(node => fetchNode(node.path))).then(this.updateNodes);\n          logger.debug(nodes.length + ' nodes updated in store', {\n            fileid: node.fileid\n          });\n          return;\n        }\n        // If we have only one node with the file ID, we can update it directly\n        if (nodes.length === 1 && node.source === nodes[0].source) {\n          this.updateNodes([node]);\n          return;\n        }\n        // Otherwise, it means we receive an event for a node that is not in the store\n        fetchNode(node.path).then(n => this.updateNodes([n]));\n      },\n      // Handlers for legacy sidebar (no real nodes support)\n      onAddFavorite(node) {\n        const ourNode = this.getNode(node.source);\n        if (ourNode) {\n          Vue.set(ourNode.attributes, 'favorite', 1);\n        }\n      },\n      onRemoveFavorite(node) {\n        const ourNode = this.getNode(node.source);\n        if (ourNode) {\n          Vue.set(ourNode.attributes, 'favorite', 0);\n        }\n      }\n    }\n  });\n  const fileStore = store(...arguments);\n  // Make sure we only register the listeners once\n  if (!fileStore._initialized) {\n    subscribe('files:node:created', fileStore.onCreatedNode);\n    subscribe('files:node:deleted', fileStore.onDeletedNode);\n    subscribe('files:node:updated', fileStore.onUpdatedNode);\n    subscribe('files:node:moved', fileStore.onMovedNode);\n    // legacy sidebar\n    subscribe('files:favorites:added', fileStore.onAddFavorite);\n    subscribe('files:favorites:removed', fileStore.onRemoveFavorite);\n    fileStore._initialized = true;\n  }\n  return fileStore;\n};","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { createPinia } from 'pinia';\nexport const getPinia = () => {\n  if (window._nc_files_pinia) {\n    return window._nc_files_pinia;\n  }\n  window._nc_files_pinia = createPinia();\n  return window._nc_files_pinia;\n};","import { defineStore } from 'pinia';\nimport { dirname } from '@nextcloud/paths';\nimport { File, FileType, getNavigation } from '@nextcloud/files';\nimport { subscribe } from '@nextcloud/event-bus';\nimport Vue from 'vue';\nimport logger from \"../logger\";\nimport { useFilesStore } from \"./files\";\nexport const usePathsStore = function () {\n  const files = useFilesStore(...arguments);\n  const store = defineStore('paths', {\n    state: () => ({\n      paths: {}\n    }),\n    getters: {\n      getPath: state => {\n        return (service, path) => {\n          if (!state.paths[service]) {\n            return undefined;\n          }\n          return state.paths[service][path];\n        };\n      }\n    },\n    actions: {\n      addPath(payload) {\n        // If it doesn't exists, init the service state\n        if (!this.paths[payload.service]) {\n          Vue.set(this.paths, payload.service, {});\n        }\n        // Now we can set the provided path\n        Vue.set(this.paths[payload.service], payload.path, payload.source);\n      },\n      deletePath(service, path) {\n        // skip if service does not exist\n        if (!this.paths[service]) {\n          return;\n        }\n        Vue.delete(this.paths[service], path);\n      },\n      onCreatedNode(node) {\n        const service = getNavigation()?.active?.id || 'files';\n        if (!node.fileid) {\n          logger.error('Node has no fileid', {\n            node\n          });\n          return;\n        }\n        // Only add path if it's a folder\n        if (node.type === FileType.Folder) {\n          this.addPath({\n            service,\n            path: node.path,\n            source: node.source\n          });\n        }\n        // Update parent folder children if exists\n        // If the folder is the root, get it and update it\n        this.addNodeToParentChildren(node);\n      },\n      onDeletedNode(node) {\n        const service = getNavigation()?.active?.id || 'files';\n        if (node.type === FileType.Folder) {\n          // Delete the path\n          this.deletePath(service, node.path);\n        }\n        this.deleteNodeFromParentChildren(node);\n      },\n      onMovedNode(_ref) {\n        let {\n          node,\n          oldSource\n        } = _ref;\n        const service = getNavigation()?.active?.id || 'files';\n        // Update the path of the node\n        if (node.type === FileType.Folder) {\n          // Delete the old path if it exists\n          const oldPath = Object.entries(this.paths[service]).find(_ref2 => {\n            let [, source] = _ref2;\n            return source === oldSource;\n          });\n          if (oldPath?.[0]) {\n            this.deletePath(service, oldPath[0]);\n          }\n          // Add the new path\n          this.addPath({\n            service,\n            path: node.path,\n            source: node.source\n          });\n        }\n        // Dummy simple clone of the renamed node from a previous state\n        const oldNode = new File({\n          source: oldSource,\n          owner: node.owner,\n          mime: node.mime\n        });\n        this.deleteNodeFromParentChildren(oldNode);\n        this.addNodeToParentChildren(node);\n      },\n      deleteNodeFromParentChildren(node) {\n        const service = getNavigation()?.active?.id || 'files';\n        // Update children of a root folder\n        const parentSource = dirname(node.source);\n        const folder = node.dirname === '/' ? files.getRoot(service) : files.getNode(parentSource);\n        if (folder) {\n          // ensure sources are unique\n          const children = new Set(folder._children ?? []);\n          children.delete(node.source);\n          Vue.set(folder, '_children', [...children.values()]);\n          logger.debug('Children updated', {\n            parent: folder,\n            node,\n            children: folder._children\n          });\n          return;\n        }\n        logger.debug('Parent path does not exists, skipping children update', {\n          node\n        });\n      },\n      addNodeToParentChildren(node) {\n        const service = getNavigation()?.active?.id || 'files';\n        // Update children of a root folder\n        const parentSource = dirname(node.source);\n        const folder = node.dirname === '/' ? files.getRoot(service) : files.getNode(parentSource);\n        if (folder) {\n          // ensure sources are unique\n          const children = new Set(folder._children ?? []);\n          children.add(node.source);\n          Vue.set(folder, '_children', [...children.values()]);\n          logger.debug('Children updated', {\n            parent: folder,\n            node,\n            children: folder._children\n          });\n          return;\n        }\n        logger.debug('Parent path does not exists, skipping children update', {\n          node\n        });\n      }\n    }\n  });\n  const pathsStore = store(...arguments);\n  // Make sure we only register the listeners once\n  if (!pathsStore._initialized) {\n    subscribe('files:node:created', pathsStore.onCreatedNode);\n    subscribe('files:node:deleted', pathsStore.onDeletedNode);\n    subscribe('files:node:moved', pathsStore.onMovedNode);\n    pathsStore._initialized = true;\n  }\n  return pathsStore;\n};","/*!\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { emit, subscribe } from '@nextcloud/event-bus';\nimport debounce from 'debounce';\nimport { defineStore } from 'pinia';\nimport { ref, watch } from 'vue';\nimport { VIEW_ID } from \"../views/search.ts\";\nimport logger from \"../logger.ts\";\nexport const useSearchStore = defineStore('search', () => {\n  /**\n   * The current search query\n   */\n  const query = ref('');\n  /**\n   * Scope of the search.\n   * Scopes:\n   * - filter: only filter current file list\n   * - globally: search everywhere\n   */\n  const scope = ref('filter');\n  // reset the base if query is cleared\n  watch(scope, updateSearch);\n  watch(query, (old, current) => {\n    // skip if only whitespaces changed\n    if (old.trim() === current.trim()) {\n      return;\n    }\n    updateSearch();\n  });\n  // initialize the search store\n  initialize();\n  /**\n   * Debounced update of the current route\n   * @private\n   */\n  const updateRouter = debounce(isSearch => {\n    const router = window.OCP.Files.Router;\n    router.goToRoute(undefined, {\n      view: VIEW_ID\n    }, {\n      query: query.value\n    }, isSearch);\n  });\n  /**\n   * Handle updating the filter if needed.\n   * Also update the search view by updating the current route if needed.\n   *\n   * @private\n   */\n  function updateSearch() {\n    // emit the search event to update the filter\n    emit('files:search:updated', {\n      query: query.value,\n      scope: scope.value\n    });\n    const router = window.OCP.Files.Router;\n    // if we are on the search view and the query was unset or scope was set to 'filter' we need to move back to the files view\n    if (router.params.view === VIEW_ID && (query.value === '' || scope.value === 'filter')) {\n      scope.value = 'filter';\n      return router.goToRoute(undefined, {\n        view: 'files'\n      }, {\n        ...router.query,\n        query: undefined\n      });\n    }\n    // for the filter scope we do not need to adjust the current route anymore\n    // also if the query is empty we do not need to do anything\n    if (scope.value === 'filter' || !query.value) {\n      return;\n    }\n    const isSearch = router.params.view === VIEW_ID;\n    logger.debug('Update route for updated search query', {\n      query: query.value,\n      isSearch\n    });\n    updateRouter(isSearch);\n  }\n  /**\n   * Event handler that resets the store if the file list view was changed.\n   *\n   * @param view - The new view that is active\n   * @private\n   */\n  function onViewChanged(view) {\n    if (view.id !== VIEW_ID) {\n      query.value = '';\n      scope.value = 'filter';\n    }\n  }\n  /**\n   * Initialize the store from the router if needed\n   */\n  function initialize() {\n    subscribe('files:navigation:changed', onViewChanged);\n    const router = window.OCP.Files.Router;\n    // if we initially load the search view (e.g. hard page refresh)\n    // then we need to initialize the store from the router\n    if (router.params.view === VIEW_ID) {\n      query.value = [router.query.query].flat()[0] ?? '';\n      if (query.value) {\n        scope.value = 'globally';\n        logger.debug('Directly navigated to search view', {\n          query: query.value\n        });\n      } else {\n        // we do not have any query so we need to move to the files list\n        logger.info('Directly navigated to search view without any query, redirect to files view.');\n        router.goToRoute(undefined, {\n          ...router.params,\n          view: 'files'\n        }, {\n          ...router.query,\n          query: undefined\n        }, true);\n      }\n    }\n  }\n  return {\n    query,\n    scope\n  };\n});","import { getCurrentUser } from '@nextcloud/auth';\nimport { emit, subscribe } from '@nextcloud/event-bus';\nimport { loadState } from '@nextcloud/initial-state';\nimport { generateUrl } from '@nextcloud/router';\nimport { defineStore } from 'pinia';\nimport { ref, set } from 'vue';\nimport axios from '@nextcloud/axios';\nconst initialUserConfig = loadState('files', 'config', {\n  crop_image_previews: true,\n  default_view: 'files',\n  grid_view: false,\n  show_files_extensions: true,\n  show_hidden: false,\n  show_mime_column: true,\n  sort_favorites_first: true,\n  sort_folders_first: true,\n  show_dialog_deletion: false,\n  show_dialog_file_extension: true\n});\nexport const useUserConfigStore = defineStore('userconfig', () => {\n  const userConfig = ref({\n    ...initialUserConfig\n  });\n  /**\n   * Update the user config local store\n   * @param key The config key\n   * @param value The new value\n   */\n  function onUpdate(key, value) {\n    set(userConfig.value, key, value);\n  }\n  /**\n   * Update the user config local store AND on server side\n   * @param key The config key\n   * @param value The new value\n   */\n  async function update(key, value) {\n    // only update if a user is logged in (not the case for public shares)\n    if (getCurrentUser() !== null) {\n      await axios.put(generateUrl('/apps/files/api/v1/config/{key}', {\n        key\n      }), {\n        value\n      });\n    }\n    emit('files:config:updated', {\n      key,\n      value\n    });\n  }\n  // Register the event listener\n  subscribe('files:config:updated', _ref => {\n    let {\n      key,\n      value\n    } = _ref;\n    return onUpdate(key, value);\n  });\n  return {\n    userConfig,\n    update\n  };\n});","/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { InvalidFilenameError, InvalidFilenameErrorReason, validateFilename } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\n/**\n * Get the validity of a filename (empty if valid).\n * This can be used for `setCustomValidity` on input elements\n * @param name The filename\n * @param escape Escape the matched string in the error (only set when used in HTML)\n */\nexport function getFilenameValidity(name) {\n  let escape = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (name.trim() === '') {\n    return t('files', 'Filename must not be empty.');\n  }\n  try {\n    validateFilename(name);\n    return '';\n  } catch (error) {\n    if (!(error instanceof InvalidFilenameError)) {\n      throw error;\n    }\n    switch (error.reason) {\n      case InvalidFilenameErrorReason.Character:\n        return t('files', '\"{char}\" is not allowed inside a filename.', {\n          char: error.segment\n        }, undefined, {\n          escape\n        });\n      case InvalidFilenameErrorReason.ReservedName:\n        return t('files', '\"{segment}\" is a reserved name and not allowed for filenames.', {\n          segment: error.segment\n        }, undefined, {\n          escape: false\n        });\n      case InvalidFilenameErrorReason.Extension:\n        if (error.segment.match(/\\.[a-z]/i)) {\n          return t('files', '\"{extension}\" is not an allowed filetype.', {\n            extension: error.segment\n          }, undefined, {\n            escape: false\n          });\n        }\n        return t('files', 'Filenames must not end with \"{extension}\".', {\n          extension: error.segment\n        }, undefined, {\n          escape: false\n        });\n      default:\n        return t('files', 'Invalid filename.');\n    }\n  }\n}","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { loadState } from '@nextcloud/initial-state';\n/**\n * Check whether the personal files view can be shown\n */\nexport function hasPersonalFilesView() {\n  const storageStats = loadState('files', 'storageStats', {\n    quota: -1\n  });\n  // Don't show this view if the user has no storage quota\n  return storageStats.quota !== 0;\n}\n/**\n * Get the default files view\n */\nexport function defaultView() {\n  const {\n    default_view: defaultView\n  } = loadState('files', 'config', {\n    default_view: 'files'\n  });\n  // the default view - only use the personal one if it is enabled\n  if (defaultView !== 'personal' || hasPersonalFilesView()) {\n    return defaultView;\n  }\n  return 'files';\n}","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n/**\n * Simple non-secure hashing function similar to Java's `hashCode`\n * @param str The string to hash\n * @return {number} a non secure hash of the string\n */\nexport const hashCode = function (str) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = (hash << 5) - hash + str.charCodeAt(i) | 0;\n  }\n  return hash >>> 0;\n};","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { spawnDialog } from '@nextcloud/dialogs';\nimport NewNodeDialog from \"../components/NewNodeDialog.vue\";\n/**\n * Ask user for file or folder name\n * @param defaultName Default name to use\n * @param folderContent Nodes with in the current folder to check for unique name\n * @param labels Labels to set on the dialog\n * @return string if successful otherwise null if aborted\n */\nexport function newNodeName(defaultName, folderContent) {\n  let labels = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const contentNames = folderContent.map(node => node.basename);\n  return new Promise(resolve => {\n    spawnDialog(NewNodeDialog, {\n      ...labels,\n      defaultName,\n      otherNames: contentNames\n    }, folderName => {\n      resolve(folderName);\n    });\n  });\n}","import { Permission } from '@nextcloud/files';\n/**\n * Check permissions on the node if it can be downloaded\n * @param node The node to check\n * @return True if downloadable, false otherwise\n */\nexport function isDownloadable(node) {\n  if ((node.permissions & Permission.READ) === 0) {\n    return false;\n  }\n  // check hide-download property of shares\n  if (node.attributes['hide-download'] === true || node.attributes['hide-download'] === 'true') {\n    return false;\n  }\n  // If the mount type is a share, ensure it got download permissions.\n  if (node.attributes['share-attributes']) {\n    const shareAttributes = JSON.parse(node.attributes['share-attributes'] || '[]');\n    const downloadAttribute = shareAttributes.find(_ref => {\n      let {\n        scope,\n        key\n      } = _ref;\n      return scope === 'permissions' && key === 'download';\n    });\n    if (downloadAttribute !== undefined) {\n      return downloadAttribute.value === true;\n    }\n  }\n  return true;\n}","import { FileType, View, getNavigation } from '@nextcloud/files';\nimport { getCanonicalLocale, getLanguage, t } from '@nextcloud/l10n';\nimport { getFavoriteNodes } from '@nextcloud/files/dav';\nimport { subscribe } from '@nextcloud/event-bus';\nimport FolderSvg from '@mdi/svg/svg/folder-outline.svg?raw';\nimport StarSvg from '@mdi/svg/svg/star-outline.svg?raw';\nimport { client } from \"../services/WebdavClient.ts\";\nimport { getContents } from \"../services/Favorites\";\nimport { hashCode } from \"../utils/hashUtils\";\nimport logger from \"../logger\";\nconst generateFavoriteFolderView = function (folder) {\n  let index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return new View({\n    id: generateIdFromPath(folder.path),\n    name: folder.displayname,\n    icon: FolderSvg,\n    order: index,\n    params: {\n      dir: folder.path,\n      fileid: String(folder.fileid),\n      view: 'favorites'\n    },\n    parent: 'favorites',\n    columns: [],\n    getContents\n  });\n};\nconst generateIdFromPath = function (path) {\n  return `favorite-${hashCode(path)}`;\n};\nexport const registerFavoritesView = async () => {\n  const Navigation = getNavigation();\n  Navigation.register(new View({\n    id: 'favorites',\n    name: t('files', 'Favorites'),\n    caption: t('files', 'List of favorite files and folders.'),\n    emptyTitle: t('files', 'No favorites yet'),\n    emptyCaption: t('files', 'Files and folders you mark as favorite will show up here'),\n    icon: StarSvg,\n    order: 15,\n    columns: [],\n    getContents\n  }));\n  const favoriteFolders = (await getFavoriteNodes(client)).filter(node => node.type === FileType.Folder);\n  const favoriteFoldersViews = favoriteFolders.map((folder, index) => generateFavoriteFolderView(folder, index));\n  logger.debug('Generating favorites view', {\n    favoriteFolders\n  });\n  favoriteFoldersViews.forEach(view => Navigation.register(view));\n  /**\n   * Update favorites navigation when a new folder is added\n   */\n  subscribe('files:favorites:added', node => {\n    if (node.type !== FileType.Folder) {\n      return;\n    }\n    // Sanity check\n    if (node.path === null || !node.root?.startsWith('/files')) {\n      logger.error('Favorite folder is not within user files root', {\n        node\n      });\n      return;\n    }\n    addToFavorites(node);\n  });\n  /**\n   * Remove favorites navigation when a folder is removed\n   */\n  subscribe('files:favorites:removed', node => {\n    if (node.type !== FileType.Folder) {\n      return;\n    }\n    // Sanity check\n    if (node.path === null || !node.root?.startsWith('/files')) {\n      logger.error('Favorite folder is not within user files root', {\n        node\n      });\n      return;\n    }\n    removePathFromFavorites(node.path);\n  });\n  /**\n   * Update favorites navigation when a folder is renamed\n   */\n  subscribe('files:node:renamed', node => {\n    if (node.type !== FileType.Folder) {\n      return;\n    }\n    if (node.attributes.favorite !== 1) {\n      return;\n    }\n    updateNodeFromFavorites(node);\n  });\n  /**\n   * Sort the favorites paths array and\n   * update the order property of the existing views\n   */\n  const updateAndSortViews = function () {\n    favoriteFolders.sort((a, b) => a.basename.localeCompare(b.basename, [getLanguage(), getCanonicalLocale()], {\n      ignorePunctuation: true,\n      numeric: true,\n      usage: 'sort'\n    }));\n    favoriteFolders.forEach((folder, index) => {\n      const view = favoriteFoldersViews.find(view => view.id === generateIdFromPath(folder.path));\n      if (view) {\n        view.order = index;\n      }\n    });\n  };\n  // Add a folder to the favorites paths array and update the views\n  const addToFavorites = function (node) {\n    const view = generateFavoriteFolderView(node);\n    // Skip if already exists\n    if (favoriteFolders.find(folder => folder.path === node.path)) {\n      return;\n    }\n    // Update arrays\n    favoriteFolders.push(node);\n    favoriteFoldersViews.push(view);\n    // Update and sort views\n    updateAndSortViews();\n    Navigation.register(view);\n  };\n  // Remove a folder from the favorites paths array and update the views\n  const removePathFromFavorites = function (path) {\n    const id = generateIdFromPath(path);\n    const index = favoriteFolders.findIndex(folder => folder.path === path);\n    // Skip if not exists\n    if (index === -1) {\n      return;\n    }\n    // Update arrays\n    favoriteFolders.splice(index, 1);\n    favoriteFoldersViews.splice(index, 1);\n    // Update and sort views\n    Navigation.remove(id);\n    updateAndSortViews();\n  };\n  // Update a folder from the favorites paths array and update the views\n  const updateNodeFromFavorites = function (node) {\n    const favoriteFolder = favoriteFolders.find(folder => folder.fileid === node.fileid);\n    // Skip if it does not exists\n    if (favoriteFolder === undefined) {\n      return;\n    }\n    removePathFromFavorites(favoriteFolder.path);\n    addToFavorites(node);\n  };\n  updateAndSortViews();\n};","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { emit, subscribe } from '@nextcloud/event-bus';\nimport { View, getNavigation } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport { getContents } from \"../services/Files.ts\";\nimport { useActiveStore } from \"../store/active.ts\";\nimport { defaultView } from \"../utils/filesViews.ts\";\nimport FolderSvg from '@mdi/svg/svg/folder-outline.svg?raw';\nexport const VIEW_ID = 'files';\n/**\n * Register the files view to the navigation\n */\nexport function registerFilesView() {\n  // we cache the query to allow more performant search (see below in event listener)\n  let oldQuery = '';\n  const Navigation = getNavigation();\n  Navigation.register(new View({\n    id: VIEW_ID,\n    name: t('files', 'All files'),\n    caption: t('files', 'List of your files and folders.'),\n    icon: FolderSvg,\n    // if this is the default view we set it at the top of the list - otherwise below it\n    order: defaultView() === VIEW_ID ? 0 : 5,\n    getContents\n  }));\n  // when the search is updated\n  // and we are in the files view\n  // and there is already a folder fetched\n  // then we \"update\" it to trigger a new `getContents` call to search for the query while the filelist is filtered\n  subscribe('files:search:updated', _ref => {\n    let {\n      scope,\n      query\n    } = _ref;\n    if (scope === 'globally') {\n      return;\n    }\n    if (Navigation.active?.id !== VIEW_ID) {\n      return;\n    }\n    // If neither the old query nor the new query is longer than the search minimum\n    // then we do not need to trigger a new PROPFIND / SEARCH\n    // so we skip unneccessary requests here\n    if (oldQuery.length < 3 && query.length < 3) {\n      return;\n    }\n    const store = useActiveStore();\n    if (!store.activeFolder) {\n      return;\n    }\n    oldQuery = query;\n    emit('files:node:updated', store.activeFolder);\n  });\n}","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport PQueue from 'p-queue';\nimport { FileType, View, getNavigation } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport { emit, subscribe } from '@nextcloud/event-bus';\nimport { isSamePath } from '@nextcloud/paths';\nimport { loadState } from '@nextcloud/initial-state';\nimport FolderSvg from '@mdi/svg/svg/folder-outline.svg?raw';\nimport FolderMultipleSvg from '@mdi/svg/svg/folder-multiple-outline.svg?raw';\nimport { folderTreeId, getContents, getFolderTreeNodes, getSourceParent, sourceRoot } from \"../services/FolderTree.ts\";\nconst isFolderTreeEnabled = loadState('files', 'config', {\n  folder_tree: true\n}).folder_tree;\nlet showHiddenFiles = loadState('files', 'config', {\n  show_hidden: false\n}).show_hidden;\nconst Navigation = getNavigation();\nconst queue = new PQueue({\n  concurrency: 5,\n  intervalCap: 5,\n  interval: 200\n});\nconst registerQueue = new PQueue({\n  concurrency: 5,\n  intervalCap: 5,\n  interval: 200\n});\nconst registerTreeChildren = async function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  await queue.add(async () => {\n    const nodes = await getFolderTreeNodes(path);\n    const promises = nodes.map(node => registerQueue.add(() => registerNodeView(node)));\n    await Promise.allSettled(promises);\n  });\n};\nconst getLoadChildViews = node => {\n  return async view => {\n    // @ts-expect-error Custom property on View instance\n    if (view.loading || view.loaded) {\n      return;\n    }\n    // @ts-expect-error Custom property\n    view.loading = true;\n    await registerTreeChildren(node.path);\n    // @ts-expect-error Custom property\n    view.loading = false;\n    // @ts-expect-error Custom property\n    view.loaded = true;\n    // @ts-expect-error No payload\n    emit('files:navigation:updated');\n    // @ts-expect-error No payload\n    emit('files:folder-tree:expanded');\n  };\n};\nconst registerNodeView = node => {\n  const registeredView = Navigation.views.find(view => view.id === node.encodedSource);\n  if (registeredView) {\n    Navigation.remove(registeredView.id);\n  }\n  if (!showHiddenFiles && node.basename.startsWith('.')) {\n    return;\n  }\n  Navigation.register(new View({\n    id: node.encodedSource,\n    parent: getSourceParent(node.source),\n    // @ts-expect-error Casing differences\n    name: node.displayName ?? node.displayname ?? node.basename,\n    icon: FolderSvg,\n    getContents,\n    loadChildViews: getLoadChildViews(node),\n    params: {\n      view: folderTreeId,\n      fileid: String(node.fileid),\n      // Needed for matching exact routes\n      dir: node.path\n    }\n  }));\n};\nconst removeFolderView = folder => {\n  const viewId = folder.encodedSource;\n  Navigation.remove(viewId);\n};\nconst removeFolderViewSource = source => {\n  Navigation.remove(source);\n};\nconst onCreateNode = node => {\n  if (node.type !== FileType.Folder) {\n    return;\n  }\n  registerNodeView(node);\n};\nconst onDeleteNode = node => {\n  if (node.type !== FileType.Folder) {\n    return;\n  }\n  removeFolderView(node);\n};\nconst onMoveNode = _ref => {\n  let {\n    node,\n    oldSource\n  } = _ref;\n  if (node.type !== FileType.Folder) {\n    return;\n  }\n  removeFolderViewSource(oldSource);\n  registerNodeView(node);\n  const newPath = node.source.replace(sourceRoot, '');\n  const oldPath = oldSource.replace(sourceRoot, '');\n  const childViews = Navigation.views.filter(view => {\n    if (!view.params?.dir) {\n      return false;\n    }\n    if (isSamePath(view.params.dir, oldPath)) {\n      return false;\n    }\n    return view.params.dir.startsWith(oldPath);\n  });\n  for (const view of childViews) {\n    // @ts-expect-error FIXME Allow setting parent\n    view.parent = getSourceParent(node.source);\n    // @ts-expect-error dir param is defined\n    view.params.dir = view.params.dir.replace(oldPath, newPath);\n  }\n};\nconst onUserConfigUpdated = async _ref2 => {\n  let {\n    key,\n    value\n  } = _ref2;\n  if (key === 'show_hidden') {\n    showHiddenFiles = value;\n    await registerTreeChildren();\n    // @ts-expect-error No payload\n    emit('files:folder-tree:initialized');\n  }\n};\nconst registerTreeRoot = () => {\n  Navigation.register(new View({\n    id: folderTreeId,\n    name: t('files', 'Folder tree'),\n    caption: t('files', 'List of your files and folders.'),\n    icon: FolderMultipleSvg,\n    order: 50,\n    // Below all other views\n    getContents\n  }));\n};\nexport const registerFolderTreeView = async () => {\n  if (!isFolderTreeEnabled) {\n    return;\n  }\n  registerTreeRoot();\n  await registerTreeChildren();\n  subscribe('files:node:created', onCreateNode);\n  subscribe('files:node:deleted', onDeleteNode);\n  subscribe('files:node:moved', onMoveNode);\n  subscribe('files:config:updated', onUserConfigUpdated);\n  // @ts-expect-error No payload\n  emit('files:folder-tree:initialized');\n};","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { t } from '@nextcloud/l10n';\nimport { View, getNavigation } from '@nextcloud/files';\nimport { getContents } from \"../services/PersonalFiles.ts\";\nimport { defaultView, hasPersonalFilesView } from \"../utils/filesViews.ts\";\nimport AccountIcon from '@mdi/svg/svg/account-outline.svg?raw';\nexport const VIEW_ID = 'personal';\n/**\n * Register the personal files view if allowed\n */\nexport function registerPersonalFilesView() {\n  if (!hasPersonalFilesView()) {\n    return;\n  }\n  const Navigation = getNavigation();\n  Navigation.register(new View({\n    id: VIEW_ID,\n    name: t('files', 'Personal files'),\n    caption: t('files', 'List of your files and folders that are not shared.'),\n    emptyTitle: t('files', 'No personal files found'),\n    emptyCaption: t('files', 'Files that are not shared will show up here.'),\n    icon: AccountIcon,\n    // if this is the default view we set it at the top of the list - otherwise default position of fifth\n    order: defaultView() === VIEW_ID ? 0 : 5,\n    getContents\n  }));\n}","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { View, getNavigation } from '@nextcloud/files';\nimport { translate as t } from '@nextcloud/l10n';\nimport HistorySvg from '@mdi/svg/svg/history.svg?raw';\nimport { getContents } from \"../services/Recent\";\nexport default () => {\n  const Navigation = getNavigation();\n  Navigation.register(new View({\n    id: 'recent',\n    name: t('files', 'Recent'),\n    caption: t('files', 'List of recently modified files and folders.'),\n    emptyTitle: t('files', 'No recently modified files'),\n    emptyCaption: t('files', 'Files and folders you recently modified will show up here.'),\n    icon: HistorySvg,\n    order: 10,\n    defaultSortKey: 'mtime',\n    getContents\n  }));\n};","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { View, getNavigation } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport { getContents } from \"../services/Search.ts\";\nimport { VIEW_ID as FILES_VIEW_ID } from \"./files.ts\";\nimport MagnifySvg from '@mdi/svg/svg/magnify.svg?raw';\nimport Vue from 'vue';\nexport const VIEW_ID = 'search';\n/**\n * Register the search-in-files view\n */\nexport function registerSearchView() {\n  let instance;\n  let view;\n  const Navigation = getNavigation();\n  Navigation.register(new View({\n    id: VIEW_ID,\n    name: t('files', 'Search'),\n    caption: t('files', 'Search results within your files.'),\n    async emptyView(el) {\n      if (!view) {\n        view = (await import(\"./SearchEmptyView.vue\")).default;\n      } else {\n        instance.$destroy();\n      }\n      instance = new Vue(view);\n      instance.$mount(el);\n    },\n    icon: MagnifySvg,\n    order: 10,\n    parent: FILES_VIEW_ID,\n    // it should be shown expanded\n    expanded: true,\n    // this view is hidden by default and only shown when active\n    hidden: true,\n    getContents\n  }));\n}","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { Column } from '@nextcloud/files';\nimport { formatRelativeTime, getCanonicalLocale, getLanguage, t } from '@nextcloud/l10n';\nimport { dirname } from '@nextcloud/paths';\nimport Vue from 'vue';\nimport NcUserBubble from '@nextcloud/vue/components/NcUserBubble';\nexport const originalLocation = new Column({\n  id: 'files_trashbin--original-location',\n  title: t('files_trashbin', 'Original location'),\n  render(node) {\n    const originalLocation = parseOriginalLocation(node);\n    const span = document.createElement('span');\n    span.title = originalLocation;\n    span.textContent = originalLocation;\n    return span;\n  },\n  sort(nodeA, nodeB) {\n    const locationA = parseOriginalLocation(nodeA);\n    const locationB = parseOriginalLocation(nodeB);\n    return locationA.localeCompare(locationB, [getLanguage(), getCanonicalLocale()], {\n      numeric: true,\n      usage: 'sort'\n    });\n  }\n});\nexport const deletedBy = new Column({\n  id: 'files_trashbin--deleted-by',\n  title: t('files_trashbin', 'Deleted by'),\n  render(node) {\n    const {\n      userId,\n      displayName,\n      label\n    } = parseDeletedBy(node);\n    if (label) {\n      const span = document.createElement('span');\n      span.textContent = label;\n      return span;\n    }\n    const UserBubble = Vue.extend(NcUserBubble);\n    const propsData = {\n      size: 32,\n      user: userId ?? undefined,\n      displayName: displayName ?? userId\n    };\n    const userBubble = new UserBubble({\n      propsData\n    }).$mount().$el;\n    return userBubble;\n  },\n  sort(nodeA, nodeB) {\n    const deletedByA = parseDeletedBy(nodeA);\n    const deletedbyALabel = deletedByA.label ?? deletedByA.displayName ?? deletedByA.userId;\n    const deletedByB = parseDeletedBy(nodeB);\n    const deletedByBLabel = deletedByB.label ?? deletedByB.displayName ?? deletedByB.userId;\n    // label is set if uid and display name are unset - if label is unset at least uid or display name is set.\n    return deletedbyALabel.localeCompare(deletedByBLabel, [getLanguage(), getCanonicalLocale()], {\n      numeric: true,\n      usage: 'sort'\n    });\n  }\n});\nexport const deleted = new Column({\n  id: 'files_trashbin--deleted',\n  title: t('files_trashbin', 'Deleted'),\n  render(node) {\n    const deletionTime = node.attributes?.['trashbin-deletion-time'] || (node?.mtime?.getTime() ?? 0) / 1000;\n    const span = document.createElement('span');\n    if (deletionTime) {\n      const formatter = Intl.DateTimeFormat([getCanonicalLocale()], {\n        dateStyle: 'long',\n        timeStyle: 'short'\n      });\n      const timestamp = new Date(deletionTime * 1000);\n      span.title = formatter.format(timestamp);\n      span.textContent = formatRelativeTime(timestamp, {\n        ignoreSeconds: t('files', 'few seconds ago')\n      });\n      return span;\n    }\n    // Unknown deletion time\n    span.textContent = t('files_trashbin', 'A long time ago');\n    return span;\n  },\n  sort(nodeA, nodeB) {\n    // deletion time is a unix timestamp while mtime is a JS Date -> we need to align the numbers (seconds vs milliseconds)\n    const deletionTimeA = nodeA.attributes?.['trashbin-deletion-time'] || (nodeA?.mtime?.getTime() ?? 0) / 1000;\n    const deletionTimeB = nodeB.attributes?.['trashbin-deletion-time'] || (nodeB?.mtime?.getTime() ?? 0) / 1000;\n    return deletionTimeB - deletionTimeA;\n  }\n});\n/**\n * Get the original file location of a trashbin file.\n *\n * @param node The node to parse\n */\nfunction parseOriginalLocation(node) {\n  const path = stringOrNull(node.attributes?.['trashbin-original-location']);\n  if (!path) {\n    return t('files_trashbin', 'Unknown');\n  }\n  const dir = dirname(path);\n  if (dir === path) {\n    // Node is in root folder\n    return t('files_trashbin', 'All files');\n  }\n  return dir.replace(/^\\//, '');\n}\n/**\n * Parse a trashbin file to get information about the user that deleted the file.\n *\n * @param node The node to parse\n */\nfunction parseDeletedBy(node) {\n  const userId = stringOrNull(node.attributes?.['trashbin-deleted-by-id']);\n  const displayName = stringOrNull(node.attributes?.['trashbin-deleted-by-display-name']);\n  let label;\n  const currentUserId = getCurrentUser()?.uid;\n  if (userId === currentUserId) {\n    label = t('files_trashbin', 'You');\n  }\n  if (!userId && !displayName) {\n    label = t('files_trashbin', 'Unknown');\n  }\n  return {\n    userId,\n    displayName,\n    label\n  };\n}\n/**\n * If the attribute is given it will be stringified and returned - otherwise null is returned.\n *\n * @param attribute The attribute to check\n */\nfunction stringOrNull(attribute) {\n  if (attribute) {\n    return String(attribute);\n  }\n  return null;\n}","/**\n * SPDX-FileCopyrightText: 2025 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { View } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport { deleted, deletedBy, originalLocation } from \"./columns.ts\";\nimport { getContents } from \"../services/trashbin.ts\";\nimport svgDelete from '@mdi/svg/svg/trash-can-outline.svg?raw';\nexport const TRASHBIN_VIEW_ID = 'trashbin';\nexport const trashbinView = new View({\n  id: TRASHBIN_VIEW_ID,\n  name: t('files_trashbin', 'Deleted files'),\n  caption: t('files_trashbin', 'List of files that have been deleted.'),\n  emptyTitle: t('files_trashbin', 'No deleted files'),\n  emptyCaption: t('files_trashbin', 'Files and folders you have deleted will show up here'),\n  icon: svgDelete,\n  order: 50,\n  sticky: true,\n  defaultSortKey: 'deleted',\n  columns: [originalLocation, deletedBy, deleted],\n  getContents\n});","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getCurrentUser } from '@nextcloud/auth';\nimport { davGetClient } from '@nextcloud/files';\n// init webdav client\nexport const rootPath = `/trashbin/${getCurrentUser()?.uid}/trash`;\nexport const client = davGetClient();","import { davResultToNode, getDavNameSpaces, getDavProperties } from '@nextcloud/files';\nimport { client, rootPath } from \"./client\";\nimport { generateUrl } from '@nextcloud/router';\nconst data = `<?xml version=\"1.0\"?>\n<d:propfind ${getDavNameSpaces()}>\n\t<d:prop>\n\t\t<nc:trashbin-deletion-time />\n\t\t<nc:trashbin-original-location />\n\t\t<nc:trashbin-title />\n\t\t<nc:trashbin-deleted-by-id />\n\t\t<nc:trashbin-deleted-by-display-name />\n\t\t${getDavProperties()}\n\t</d:prop>\n</d:propfind>`;\nconst resultToNode = stat => {\n  const node = davResultToNode(stat, rootPath);\n  node.attributes.previewUrl = generateUrl('/apps/files_trashbin/preview?fileId={fileid}&x=32&y=32', {\n    fileid: node.fileid\n  });\n  return node;\n};\nexport const getContents = async function () {\n  let path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '/';\n  const contentsResponse = await client.getDirectoryContents(`${rootPath}${path}`, {\n    details: true,\n    data,\n    includeSelf: true\n  });\n  const contents = contentsResponse.data.map(resultToNode);\n  const [folder] = contents.splice(contents.findIndex(node => node.path === path), 1);\n  return {\n    folder: folder,\n    contents\n  };\n};","import { defineComponent as _defineComponent } from 'vue';\nimport { t } from '@nextcloud/l10n';\nimport NcActions from '@nextcloud/vue/components/NcActions';\nimport NcActionButton from '@nextcloud/vue/components/NcActionButton';\nimport NcActionSeparator from '@nextcloud/vue/components/NcActionSeparator';\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'FileListFilter',\n  props: {\n    isActive: {\n      type: Boolean,\n      required: true\n    },\n    filterName: {\n      type: String,\n      required: true\n    }\n  },\n  emits: [\"reset-filter\"],\n  setup(__props) {\n    return {\n      __sfc: true,\n      t,\n      NcActions,\n      NcActionButton,\n      NcActionSeparator\n    };\n  }\n});","import { mdiCalendarRangeOutline } from '@mdi/js';\nimport { translate as t } from '@nextcloud/l10n';\nimport { defineComponent } from 'vue';\nimport NcActionButton from '@nextcloud/vue/components/NcActionButton';\nimport NcIconSvgWrapper from '@nextcloud/vue/components/NcIconSvgWrapper';\nimport FileListFilter from \"./FileListFilter.vue\";\nexport default defineComponent({\n  components: {\n    FileListFilter,\n    NcActionButton,\n    NcIconSvgWrapper\n  },\n  props: {\n    timePresets: {\n      type: Array,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      // icons used in template\n      mdiCalendarRangeOutline\n    };\n  },\n  data() {\n    return {\n      selectedOption: null,\n      timeRangeEnd: null,\n      timeRangeStart: null\n    };\n  },\n  computed: {\n    /**\n     * Is the filter currently active\n     */\n    isActive() {\n      return this.selectedOption !== null;\n    },\n    currentPreset() {\n      return this.timePresets.find(_ref => {\n        let {\n          id\n        } = _ref;\n        return id === this.selectedOption;\n      }) ?? null;\n    }\n  },\n  watch: {\n    selectedOption() {\n      if (this.selectedOption === null) {\n        this.$emit('update:preset');\n      } else {\n        const preset = this.currentPreset;\n        this.$emit('update:preset', preset);\n      }\n    }\n  },\n  methods: {\n    t,\n    resetFilter() {\n      this.selectedOption = null;\n      this.timeRangeEnd = null;\n      this.timeRangeStart = null;\n    }\n  }\n});","import { defineComponent as _defineComponent } from 'vue';\nimport { t } from '@nextcloud/l10n';\nimport { ref } from 'vue';\nimport NcButton from '@nextcloud/vue/components/NcButton';\nimport { getPinia } from \"../../store/index.ts\";\nimport { useSearchStore } from \"../../store/search.ts\";\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'FileListFilterToSearch',\n  setup(__props, _ref) {\n    let {\n      expose\n    } = _ref;\n    const isVisible = ref(false);\n    expose({\n      hideButton,\n      showButton\n    });\n    /**\n     * Hide the button - called by the filter class\n     */\n    function hideButton() {\n      isVisible.value = false;\n    }\n    /**\n     * Show the button - called by the filter class\n     */\n    function showButton() {\n      isVisible.value = true;\n    }\n    /**\n     * Button click handler to make the filtering a global search.\n     */\n    function onClick() {\n      const searchStore = useSearchStore(getPinia());\n      searchStore.scope = 'globally';\n    }\n    return {\n      __sfc: true,\n      isVisible,\n      hideButton,\n      showButton,\n      onClick,\n      t,\n      NcButton\n    };\n  }\n});","import { mdiFileOutline } from '@mdi/js';\nimport { translate as t } from '@nextcloud/l10n';\nimport { defineComponent } from 'vue';\nimport NcActionButton from '@nextcloud/vue/components/NcActionButton';\nimport NcIconSvgWrapper from '@nextcloud/vue/components/NcIconSvgWrapper';\nimport FileListFilter from \"./FileListFilter.vue\";\nexport default defineComponent({\n  name: 'FileListFilterType',\n  components: {\n    FileListFilter,\n    NcActionButton,\n    NcIconSvgWrapper\n  },\n  props: {\n    presets: {\n      type: Array,\n      default: () => []\n    },\n    typePresets: {\n      type: Array,\n      required: true\n    }\n  },\n  setup() {\n    return {\n      mdiFileOutline,\n      t\n    };\n  },\n  data() {\n    return {\n      selectedOptions: []\n    };\n  },\n  computed: {\n    isActive() {\n      return this.selectedOptions.length > 0;\n    }\n  },\n  watch: {\n    /** Reset selected options if property is changed */\n    presets() {\n      this.selectedOptions = this.presets ?? [];\n    },\n    selectedOptions(newValue, oldValue) {\n      if (this.selectedOptions.length === 0) {\n        if (oldValue.length !== 0) {\n          this.$emit('update:presets');\n        }\n      } else {\n        this.$emit('update:presets', this.selectedOptions);\n      }\n    }\n  },\n  mounted() {\n    this.selectedOptions = this.presets ?? [];\n  },\n  methods: {\n    resetFilter() {\n      this.selectedOptions = [];\n    },\n    /**\n     * Toggle option from selected option\n     * @param option The option to toggle\n     */\n    toggleOption(option) {\n      const idx = this.selectedOptions.indexOf(option);\n      if (idx !== -1) {\n        this.selectedOptions.splice(idx, 1);\n      } else {\n        this.selectedOptions.push(option);\n      }\n    }\n  }\n});","import { defineComponent as _defineComponent } from 'vue';\nimport { getUniqueName } from '@nextcloud/files';\nimport { t } from '@nextcloud/l10n';\nimport { extname } from 'path';\nimport { computed, nextTick, onMounted, ref, watch, watchEffect } from 'vue';\nimport { getFilenameValidity } from \"../utils/filenameValidity.ts\";\nimport NcButton from '@nextcloud/vue/components/NcButton';\nimport NcDialog from '@nextcloud/vue/components/NcDialog';\nimport NcTextField from '@nextcloud/vue/components/NcTextField';\nimport NcNoteCard from '@nextcloud/vue/components/NcNoteCard';\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'NewNodeDialog',\n  props: {\n    /**\n     * The name to be used by default\n     */\n    defaultName: {\n      type: String,\n      default: t('files', 'New folder')\n    },\n    /**\n     * Other files that are in the current directory\n     */\n    otherNames: {\n      type: Array,\n      default: () => []\n    },\n    /**\n     * Open state of the dialog\n     */\n    open: {\n      type: Boolean,\n      default: true\n    },\n    /**\n     * Dialog name\n     */\n    name: {\n      type: String,\n      default: t('files', 'Create new folder')\n    },\n    /**\n     * Input label\n     */\n    label: {\n      type: String,\n      default: t('files', 'Folder name')\n    }\n  },\n  emits: [\"close\"],\n  setup(__props, _ref) {\n    let {\n      emit\n    } = _ref;\n    const props = __props;\n    const localDefaultName = ref(props.defaultName);\n    const nameInput = ref();\n    const formElement = ref();\n    const validity = ref('');\n    const isHiddenFileName = computed(() => {\n      // Check if the name starts with a dot, which indicates a hidden file\n      return localDefaultName.value.trim().startsWith('.');\n    });\n    /**\n     * Focus the filename input field\n     */\n    function focusInput() {\n      nextTick(() => {\n        // get the input element\n        const input = nameInput.value?.$el.querySelector('input');\n        if (!props.open || !input) {\n          return;\n        }\n        // length of the basename\n        const length = localDefaultName.value.length - extname(localDefaultName.value).length;\n        // focus the input\n        input.focus();\n        // and set the selection to the basename (name without extension)\n        input.setSelectionRange(0, length);\n      });\n    }\n    /**\n     * Trigger submit on the form\n     */\n    function submit() {\n      formElement.value?.requestSubmit();\n    }\n    // Reset local name on props change\n    watch(() => [props.defaultName, props.otherNames], () => {\n      localDefaultName.value = getUniqueName(props.defaultName, props.otherNames).trim();\n    });\n    // Validate the local name\n    watchEffect(() => {\n      if (props.otherNames.includes(localDefaultName.value.trim())) {\n        validity.value = t('files', 'This name is already in use.');\n      } else {\n        validity.value = getFilenameValidity(localDefaultName.value.trim());\n      }\n      const input = nameInput.value?.$el.querySelector('input');\n      if (input) {\n        input.setCustomValidity(validity.value);\n        input.reportValidity();\n      }\n    });\n    // Ensure the input is focussed even if the dialog is already mounted but not open\n    watch(() => props.open, () => {\n      nextTick(() => {\n        focusInput();\n      });\n    });\n    onMounted(() => {\n      // on mounted lets use the unique name\n      localDefaultName.value = getUniqueName(localDefaultName.value, props.otherNames).trim();\n      nextTick(() => focusInput());\n    });\n    return {\n      __sfc: true,\n      props,\n      emit,\n      localDefaultName,\n      nameInput,\n      formElement,\n      validity,\n      isHiddenFileName,\n      focusInput,\n      submit,\n      t,\n      NcButton,\n      NcDialog,\n      NcTextField,\n      NcNoteCard\n    };\n  }\n});","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(_setup.NcActions, {\n    attrs: {\n      \"force-menu\": \"\",\n      type: _vm.isActive ? \"secondary\" : \"tertiary\",\n      \"menu-name\": _vm.filterName\n    },\n    scopedSlots: _vm._u([{\n      key: \"icon\",\n      fn: function () {\n        return [_vm._t(\"icon\")];\n      },\n      proxy: true\n    }], null, true)\n  }, [_vm._v(\" \"), _vm._t(\"default\"), _vm._v(\" \"), _vm.isActive ? [_c(_setup.NcActionSeparator), _vm._v(\" \"), _c(_setup.NcActionButton, {\n    staticClass: \"files-list-filter__clear-button\",\n    attrs: {\n      \"close-after-click\": \"\"\n    },\n    on: {\n      click: function ($event) {\n        return _vm.$emit(\"reset-filter\");\n      }\n    }\n  }, [_vm._v(\"\\n\\t\\t\\t\" + _vm._s(_setup.t(\"files\", \"Clear filter\")) + \"\\n\\t\\t\")])] : _vm._e()], 2);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(\"FileListFilter\", {\n    attrs: {\n      \"is-active\": _vm.isActive,\n      \"filter-name\": _vm.t(\"files\", \"Modified\")\n    },\n    on: {\n      \"reset-filter\": _vm.resetFilter\n    },\n    scopedSlots: _vm._u([{\n      key: \"icon\",\n      fn: function () {\n        return [_c(\"NcIconSvgWrapper\", {\n          attrs: {\n            path: _vm.mdiCalendarRangeOutline\n          }\n        })];\n      },\n      proxy: true\n    }])\n  }, [_vm._v(\" \"), _vm._l(_vm.timePresets, function (preset) {\n    return _c(\"NcActionButton\", {\n      key: preset.id,\n      attrs: {\n        type: \"radio\",\n        \"close-after-click\": \"\",\n        \"model-value\": _vm.selectedOption,\n        value: preset.id\n      },\n      on: {\n        \"update:modelValue\": function ($event) {\n          _vm.selectedOption = $event;\n        },\n        \"update:model-value\": function ($event) {\n          _vm.selectedOption = $event;\n        }\n      }\n    }, [_vm._v(\"\\n\\t\\t\" + _vm._s(preset.label) + \"\\n\\t\")]);\n  })], 2);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(_setup.NcButton, {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: _setup.isVisible,\n      expression: \"isVisible\"\n    }],\n    on: {\n      click: _setup.onClick\n    }\n  }, [_vm._v(\"\\n\\t\" + _vm._s(_setup.t(\"files\", \"Search everywhere\")) + \"\\n\")]);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(\"FileListFilter\", {\n    staticClass: \"file-list-filter-type\",\n    attrs: {\n      \"is-active\": _vm.isActive,\n      \"filter-name\": _vm.t(\"files\", \"Type\")\n    },\n    on: {\n      \"reset-filter\": _vm.resetFilter\n    },\n    scopedSlots: _vm._u([{\n      key: \"icon\",\n      fn: function () {\n        return [_c(\"NcIconSvgWrapper\", {\n          attrs: {\n            path: _vm.mdiFileOutline\n          }\n        })];\n      },\n      proxy: true\n    }])\n  }, [_vm._v(\" \"), _vm._l(_vm.typePresets, function (fileType) {\n    return _c(\"NcActionButton\", {\n      key: fileType.id,\n      attrs: {\n        type: \"checkbox\",\n        \"model-value\": _vm.selectedOptions.includes(fileType)\n      },\n      on: {\n        click: function ($event) {\n          return _vm.toggleOption(fileType);\n        }\n      },\n      scopedSlots: _vm._u([{\n        key: \"icon\",\n        fn: function () {\n          return [_c(\"NcIconSvgWrapper\", {\n            attrs: {\n              svg: fileType.icon\n            }\n          })];\n        },\n        proxy: true\n      }], null, true)\n    }, [_vm._v(\"\\n\\t\\t\" + _vm._s(fileType.label) + \"\\n\\t\")]);\n  })], 2);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","var render = function render() {\n  var _vm = this,\n    _c = _vm._self._c,\n    _setup = _vm._self._setupProxy;\n  return _c(_setup.NcDialog, {\n    attrs: {\n      \"data-cy-files-new-node-dialog\": \"\",\n      name: _vm.name,\n      open: _vm.open,\n      \"close-on-click-outside\": \"\",\n      \"out-transition\": \"\"\n    },\n    on: {\n      \"update:open\": function ($event) {\n        return _setup.emit(\"close\", null);\n      }\n    },\n    scopedSlots: _vm._u([{\n      key: \"actions\",\n      fn: function () {\n        return [_c(_setup.NcButton, {\n          attrs: {\n            \"data-cy-files-new-node-dialog-submit\": \"\",\n            type: \"primary\",\n            disabled: _setup.validity !== \"\"\n          },\n          on: {\n            click: _setup.submit\n          }\n        }, [_vm._v(\"\\n\\t\\t\\t\" + _vm._s(_setup.t(\"files\", \"Create\")) + \"\\n\\t\\t\")])];\n      },\n      proxy: true\n    }])\n  }, [_vm._v(\" \"), _c(\"form\", {\n    ref: \"formElement\",\n    staticClass: \"new-node-dialog__form\",\n    on: {\n      submit: function ($event) {\n        $event.preventDefault();\n        return _setup.emit(\"close\", _setup.localDefaultName);\n      }\n    }\n  }, [_c(_setup.NcTextField, {\n    ref: \"nameInput\",\n    attrs: {\n      \"data-cy-files-new-node-dialog-input\": \"\",\n      error: _setup.validity !== \"\",\n      \"helper-text\": _setup.validity,\n      label: _vm.label,\n      value: _setup.localDefaultName\n    },\n    on: {\n      \"update:value\": function ($event) {\n        _setup.localDefaultName = $event;\n      }\n    }\n  }), _vm._v(\" \"), _setup.isHiddenFileName ? _c(_setup.NcNoteCard, {\n    attrs: {\n      type: \"warning\",\n      text: _setup.t(\"files\", \"Files starting with a dot are hidden by default\")\n    }\n  }) : _vm._e()], 1)]);\n};\nvar staticRenderFns = [];\nrender._withStripped = true;\nexport { render, staticRenderFns };","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.files-list-filter-time__clear-button[data-v-f47dfc3e] .action-button__text {\n  color: var(--color-error-text);\n}`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.files-list-filter__clear-button[data-v-5c291778] .action-button__text {\n\tcolor: var(--color-error-text);\n}\n[data-v-5c291778] .button-vue {\n\tfont-weight: normal !important;\n*[data-v-5c291778] {\n\t\tfont-weight: normal !important;\n}\n}\n`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.file-list-filter-type {\n\tmax-width: 220px;\n}\n`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\n.new-node-dialog__form[data-v-e6b9c05a] {\n\t/* Ensure the dialog does not jump when there is a validity error */\n\tmin-height: calc(2 * var(--default-clickable-area));\n}\n`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=style&index=0&id=f47dfc3e&scoped=true&lang=scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/sass-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterModified.vue?vue&type=style&index=0&id=f47dfc3e&scoped=true&lang=scss\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=style&index=0&id=5c291778&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilter.vue?vue&type=style&index=0&id=5c291778&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=style&index=0&id=6c0e6dd2&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileListFilterType.vue?vue&type=style&index=0&id=6c0e6dd2&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=style&index=0&id=e6b9c05a&scoped=true&lang=css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NewNodeDialog.vue?vue&type=style&index=0&id=e6b9c05a&scoped=true&lang=css\";\n       export default content && content.locals ? content.locals : undefined;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \"-\" + chunkId + \".js?v=\" + {\"node_modules_nextcloud_dialogs_dist_chunks_index-BC-7VPxC_mjs\":\"2fcef36253529e5f48bc\",\"node_modules_nextcloud_dialogs_dist_chunks_PublicAuthPrompt-BSFsDqYB_mjs\":\"f3a3966faa81f9b81fa8\",\"apps_files_src_views_SearchEmptyView_vue\":\"f4a1d1b5018f4999b20a\",\"node_modules_nextcloud_upload_dist_chunks_InvalidFilenameDialog-BYpqWa7P_mjs\":\"b5048b7dd1c81ffc8fe6\",\"node_modules_nextcloud_upload_dist_chunks_ConflictPicker-BvM7ZujP_mjs\":\"f457ef4faf127a8a345a\",\"apps_files_src_views_TemplatePicker_vue\":\"8034a0e7f970992f72fb\",\"node_modules_nextcloud_dialogs_dist_chunks_FilePicker-CsU6FfAP_mjs\":\"8bce3ebf3ef868f175e5\",\"data_image_svg_xml_3c_21--_20-_20SPDX-FileCopyrightText_202020_20Google_20Inc_20-_20SPDX-Lice-cc29b1\":\"9fa10a9863e5b78deec8\"}[chunkId] + \"\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"nextcloud:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"files-init\": 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunknextcloud\"] = self[\"webpackChunknextcloud\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"core-common\"], () => (__webpack_require__(\"./apps/files/src/init.ts\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"sourceRoot":""}