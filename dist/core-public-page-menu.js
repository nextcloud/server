(()=>{var e,t,n,r={15340(){},40306(e,t,n){"use strict";n.d(t,{A:()=>a});var r=n(71354),l=n.n(r),o=n(76314),i=n.n(o)()(l());i.push([e.id,"\n.public-page-menu-entry__icon[data-v-7256a1f8] {\n\tpadding-inline-start: var(--default-grid-baseline);\n}\n","",{version:3,sources:["webpack://./core/src/components/PublicPageMenu/PublicPageMenuEntry.vue"],names:[],mappings:";AAmDA;CACA,kDAAA;AACA",sourcesContent:['\x3c!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n --\x3e\n<template>\n\t<NcListItem\n\t\t:anchor-id="`${id}--link`"\n\t\tcompact\n\t\t:details="details"\n\t\t:href="href"\n\t\t:name="label"\n\t\trole="presentation"\n\t\t@click="$emit(\'click\')">\n\t\t<template #icon>\n\t\t\t<slot v-if="$scopedSlots.icon" name="icon" />\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\trole="presentation"\n\t\t\t\tclass="icon public-page-menu-entry__icon"\n\t\t\t\t:class="[icon]" />\n\t\t</template>\n\t</NcListItem>\n</template>\n\n<script setup lang="ts">\nimport { onMounted } from \'vue\'\nimport NcListItem from \'@nextcloud/vue/components/NcListItem\'\n\nconst props = defineProps<{\n\t/** Only emit click event but do not open href */\n\tclickOnly?: boolean\n\t// menu entry props\n\tid: string\n\tlabel: string\n\ticon?: string\n\thref: string\n\tdetails?: string\n}>()\n\nonMounted(() => {\n\tconst anchor = document.getElementById(`${props.id}--link`) as HTMLAnchorElement\n\t// Make the `<a>` a menuitem\n\tanchor.role = \'menuitem\'\n\t// Prevent native click handling if required\n\tif (props.clickOnly) {\n\t\tanchor.onclick = (event) => event.preventDefault()\n\t}\n})\n<\/script>\n\n<style scoped>\n.public-page-menu-entry__icon {\n\tpadding-inline-start: var(--default-grid-baseline);\n}\n</style>\n'],sourceRoot:""}]);const a=i},47790(){},51069(){},51684(e,t,n){"use strict";n.d(t,{A:()=>a});var r=n(71354),l=n.n(r),o=n(76314),i=n.n(o)()(l());i.push([e.id,".public-page-menu[data-v-4b8ac038]{box-sizing:border-box}.public-page-menu[data-v-4b8ac038]> *{box-sizing:border-box}.public-page-menu__wrapper[data-v-4b8ac038]{display:flex;flex-direction:row;gap:var(--default-grid-baseline)}.public-page-menu__primary[data-v-4b8ac038]{height:var(--default-clickable-area);margin-block:calc((var(--header-height) - var(--default-clickable-area))/2)}.public-page-menu__primary[data-v-4b8ac038]:focus-visible{border-color:var(--color-background-plain-text) !important}.public-page-menu__primary-icon[data-v-4b8ac038]{filter:var(--primary-invert-if-bright)}","",{version:3,sources:["webpack://./core/src/views/PublicPageMenu.vue"],names:[],mappings:"AACA,mCACC,qBAAA,CAEA,sCACC,qBAAA,CAGD,4CACC,YAAA,CACA,kBAAA,CACA,gCAAA,CAGD,4CACC,oCAAA,CACA,2EAAA,CAGA,0DACC,0DAAA,CAIF,iDACC,sCAAA",sourcesContent:["\n.public-page-menu {\n\tbox-sizing: border-box;\n\n\t> :deep(*) {\n\t\tbox-sizing: border-box;\n\t}\n\n\t&__wrapper {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tgap: var(--default-grid-baseline);\n\t}\n\n\t&__primary {\n\t\theight: var(--default-clickable-area);\n\t\tmargin-block: calc((var(--header-height) - var(--default-clickable-area)) / 2);\n\n\t\t// Ensure the correct focus-visible color is used (as this is rendered directly on the background(-image))\n\t\t&:focus-visible {\n\t\t\tborder-color: var(--color-background-plain-text) !important;\n\t\t}\n\t}\n\n\t&__primary-icon {\n\t\tfilter: var(--primary-invert-if-bright);\n\t}\n}\n"],sourceRoot:""}]);const a=i},63779(){},64688(){},66089(){},73776(){},77199(){},77965(){},78982(){},79368(){},79838(){},86685(e,t,n){"use strict";var r=n(21777),l=n(85471),o=n(81222),i=n(53334),a=n(53429),c=n(98469),s=n(74095),u=n(2769),p=n(26690);const d=(0,l.pM)({__name:"PublicPageMenuCustomEntry",props:{id:null,html:null},setup(e){const t=(0,l.KR)(),n=(0,l.KR)("presentation");return(0,l.sV)(()=>{const e=t.value?.querySelector('[role="menuitem"]');if(e)return;const r=t.value?.querySelector("button")??t.value?.querySelector("a");r?r.role="menuitem":n.value="menuitem"}),{__sfc:!0,listItem:t,itemRole:n}}});var m=n(14486);const b=(0,m.A)(d,function(){var e=this;return(0,e._self._c)("li",{ref:"listItem",attrs:{role:e._self._setupProxy.itemRole},domProps:{innerHTML:e._s(e.html)}})},[],!1,null,null,null).exports;var f=n(1522);const g=(0,l.pM)({__name:"PublicPageMenuEntry",props:{clickOnly:{type:Boolean},id:null,label:null,icon:null,href:null,details:null},setup(e){const t=e;return(0,l.sV)(()=>{const e=document.getElementById(`${t.id}--link`);e.role="menuitem",t.clickOnly&&(e.onclick=e=>e.preventDefault())}),{__sfc:!0,props:t,NcListItem:f.A}}});var v=n(85072),h=n.n(v),y=n(97825),A=n.n(y),_=n(77659),k=n.n(_),C=n(55056),x=n.n(C),P=n(10540),w=n.n(P),M=n(41113),E=n.n(M),S=n(40306),N={};N.styleTagTransform=E(),N.setAttributes=x(),N.insert=k().bind(null,"head"),N.domAPI=A(),N.insertStyleElement=w(),h()(S.A,N),S.A&&S.A.locals&&S.A.locals;const T=(0,m.A)(g,function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.NcListItem,{attrs:{"anchor-id":`${e.id}--link`,compact:"",details:e.details,href:e.href,name:e.label,role:"presentation"},on:{click:function(t){return e.$emit("click")}},scopedSlots:e._u([{key:"icon",fn:function(){return[e.$scopedSlots.icon?e._t("icon"):t("div",{staticClass:"icon public-page-menu-entry__icon",class:[e.icon],attrs:{role:"presentation"}})]},proxy:!0}],null,!0)})},[],!1,null,"7256a1f8",null).exports;var D=n(19051),I=n(85168),L=n(63814),O=n(32505),$=n(94219),R=n(88289),F=n(82182),B=n(35947);const U=null===(K=(0,r.HW)())?(0,B.YK)().setApp("core").build():(0,B.YK)().setApp("core").setUid(K.uid).build();var K;(0,B.YK)().setApp("unified-search").detectUser().build();const j=(0,l.pM)({__name:"PublicPageMenuExternalDialog",props:{label:null},setup(e){const t=(0,l.KR)(!1),n=(0,l.KR)(""),r=(0,l.KR)(),o=(0,l.KR)(!0);return(0,l.sV)(()=>(0,l.dY)(()=>r.value.focus())),(0,l.wB)(n,()=>{let e="";n.value.includes("@")?n.value.match(/@(.+\..{2,}|localhost)(:\d\d+)?$/)||(e=(0,i.t)("core","Invalid remote URL.")):e=(0,i.t)("core","The remote URL must include the user."),r.value.$el.querySelector("input").setCustomValidity(e),r.value.$el.querySelector("input").reportValidity()}),{__sfc:!0,loading:t,remoteUrl:n,input:r,open:o,createFederatedShare:async function(){t.value=!0;try{const e=(0,L.Jv)("/apps/federatedfilesharing/createFederatedShare"),{data:t}=await D.Ay.post(e,{shareWith:n.value,token:(0,O.G)()});t.remoteUrl.includes("://")?window.location.href=t.remoteUrl:window.location.href=`${window.location.protocol}//${t.remoteUrl}`}catch(e){U.error("Failed to create federated share",{error:e}),(0,I.Qg)((0,i.t)("files_sharing","Failed to add the public link to your Nextcloud"))}finally{t.value=!1}},t:i.t,NcButton:s.A,NcDialog:$.A,NcLoadingIcon:R.A,NcTextField:F.A}}}),q=(0,m.A)(j,function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.NcDialog,{attrs:{"is-form":"",name:e.label,open:n.open},on:{"update:open":function(e){n.open=e},submit:n.createFederatedShare},scopedSlots:e._u([{key:"actions",fn:function(){return[t(n.NcButton,{attrs:{disabled:n.loading,variant:"primary",type:"submit"},scopedSlots:e._u([n.loading?{key:"icon",fn:function(){return[t(n.NcLoadingIcon)]},proxy:!0}:null],null,!0)},[e._v("\n\t\t\t"+e._s(n.t("core","Create share"))+"\n\t\t")])]},proxy:!0}])},[t(n.NcTextField,{ref:"input",attrs:{label:n.t("core","Federated user"),placeholder:n.t("core","user@your-nextcloud.org"),required:""},model:{value:n.remoteUrl,callback:function(e){n.remoteUrl=e},expression:"remoteUrl"}})],1)},[],!1,null,null,null).exports;var G=n(54914);const H=(0,l.pM)({__name:"PublicPageMenuExternalEntry",props:{id:null,label:null,icon:null,href:null},emits:["click"],setup(e,{emit:t}){const n=(0,l.KR)(!1);return{__sfc:!0,emit:t,showDialog:n,openDialog:function(){n.value=!0,t("click")},Fragment:G.F,PublicPageMenuEntry:T,PublicPageMenuExternalDialog:q}}}),V=(0,m.A)(H,function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.Fragment,[t(n.PublicPageMenuEntry,{attrs:{id:e.id,icon:e.icon,href:"#",label:e.label},on:{click:n.openDialog}}),e._v(" "),n.showDialog?t(n.PublicPageMenuExternalDialog,{attrs:{label:e.label}}):e._e()],1)},[],!1,null,null,null).exports,z=(0,l.pM)({__name:"PublicPageMenuLinkEntry",props:{id:null,label:null,icon:null,href:null},emits:["click"],setup(e,{emit:t}){const n=e;async function r(){try{await window.navigator.clipboard.writeText(n.href),(0,I.Te)((0,i.t)("core","Direct link copied"))}catch{window.prompt((0,i.t)("core","Please copy the link manually:"),n.href)}}return{__sfc:!0,props:n,emit:t,copyLink:r,onClick:function(){r(),t("click")},PublicPageMenuEntry:T}}}),Y=(0,m.A)(z,function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t(n.PublicPageMenuEntry,{attrs:{id:e.id,"click-only":"",icon:e.icon,href:e.href,label:e.label},on:{click:n.onClick}})},[],!1,null,null,null).exports,W=(0,l.pM)({__name:"PublicPageMenu",setup(e){const t=(0,o.C)("core","public-page-menu"),n=(0,l.KR)(!1),r=(0,a.F)(),d=(0,l.EW)(()=>r.value?void 0:t[0]),m=(0,l.EW)(()=>r.value?t:t.slice(1));return{__sfc:!0,menuEntries:t,showMenu:n,isMobile:r,primaryAction:d,secondaryActions:m,getComponent:function(e){if("html"in e)return b;switch(e.id){case"save":return V;case"directLink":return Y;default:return T}},openDialogIfNeeded:function(){"save"===d.value?.id&&(0,c.S)(q,{label:d.value.label})},t:i.t,NcButton:s.A,NcHeaderMenu:u.A,IconMore:p.A}}});var X=n(51684),J={};J.styleTagTransform=E(),J.setAttributes=x(),J.insert=k().bind(null,"head"),J.domAPI=A(),J.insertStyleElement=w(),h()(X.A,J),X.A&&X.A.locals&&X.A.locals;const Q=(0,m.A)(W,function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("div",{staticClass:"public-page-menu__wrapper"},[n.primaryAction?t(n.NcButton,{staticClass:"public-page-menu__primary",attrs:{id:"public-page-menu--primary",href:n.primaryAction.href,variant:"primary"},on:{click:n.openDialogIfNeeded},scopedSlots:e._u([n.primaryAction.icon?{key:"icon",fn:function(){return[t("div",{staticClass:"icon public-page-menu__primary-icon",class:[n.primaryAction.icon]})]},proxy:!0}:null],null,!0)},[e._v("\n\t\t"+e._s(n.primaryAction.label)+"\n\t")]):e._e(),e._v(" "),n.secondaryActions.length>0?t(n.NcHeaderMenu,{attrs:{id:"public-page-menu","aria-label":n.t("core","More actions"),open:n.showMenu},on:{"update:open":function(e){n.showMenu=e}},scopedSlots:e._u([{key:"trigger",fn:function(){return[t(n.IconMore,{attrs:{size:20}})]},proxy:!0}],null,!1,262033445)},[e._v(" "),t("ul",{staticClass:"public-page-menu",attrs:{"aria-label":n.t("core","More actions"),role:"menu"}},e._l(n.secondaryActions,function(r,l){return t(n.getComponent(r),e._b({key:l,tag:"component",on:{click:function(e){n.showMenu=!1}}},"component",r,!1))}),1)]):e._e()],1)},[],!1,null,"4b8ac038",null).exports;n.nc=(0,r.aV)(),(new(l.Ay.extend(Q))).$mount("#public-page-menu")}},l={};function o(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=r,e=[],o.O=(t,n,r,l)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,r,l]=e[u],a=!0,c=0;c<n.length;c++)(!1&l||i>=l)&&Object.keys(o.O).every(e=>o.O[e](n[c]))?n.splice(c--,1):(a=!1,l<i&&(i=l));if(a){e.splice(u--,1);var s=r();void 0!==s&&(t=s)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,r,l]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce((t,n)=>(o.f[n](e,t),t),[])),o.u=e=>e+"-"+e+".js?v="+{594:"f5af3d132040859cb666",620:"e5d77a046303aedd05c5",2391:"6d29c12fea2fbb265756",2880:"803b63f847e6d68bcf0d",4325:"2c2e8efde4f3230744bd",5862:"580b9c2e231a9169a12f",7145:"1f907ab7a1c83e8a6617",8339:"b2246be0f4c885a9d524"}[e],o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},n="nextcloud-ui-legacy:",o.l=(e,r,l,i)=>{if(t[e])t[e].push(r);else{var a,c;if(void 0!==l)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var p=s[u];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==n+l){a=p;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",n+l),a.src=e),t[e]=[r];var d=(n,r)=>{a.onerror=a.onload=null,clearTimeout(m);var l=t[e];if(delete t[e],a.parentNode&&a.parentNode.removeChild(a),l&&l.forEach(e=>e(r)),n)return n(r)},m=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=1688,(()=>{var e;globalThis.importScripts&&(e=globalThis.location+"");var t=globalThis.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={1688:0};o.f.j=(t,n)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var l=new Promise((n,l)=>r=e[t]=[n,l]);n.push(r[2]=l);var i=o.p+o.u(t),a=new Error;o.l(i,n=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var l=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+l+": "+i+")",a.name="ChunkLoadError",a.type=l,a.request=i,r[1](a)}},"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,n)=>{var r,l,[i,a,c]=n,s=0;if(i.some(t=>0!==e[t])){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(c)var u=c(o)}for(t&&t(n);s<i.length;s++)l=i[s],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(u)},n=globalThis.webpackChunknextcloud_ui_legacy=globalThis.webpackChunknextcloud_ui_legacy||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.nc=void 0;var i=o.O(void 0,[4208],()=>o(86685));i=o.O(i)})();
//# sourceMappingURL=core-public-page-menu.js.map?v=f152d0dc72d9a73a5298