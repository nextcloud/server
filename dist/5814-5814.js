"use strict";(globalThis.webpackChunknextcloud=globalThis.webpackChunknextcloud||[]).push([[594,5814],{17859:(e,l,t)=>{t.d(l,{A:()=>i._});var i=t(42005)},30594:(e,l,t)=>{t.r(l),t.d(l,{default:()=>i.N});var i=t(56799)},45814:(e,l,t)=>{t.d(l,{default:()=>fl});var i=t(20641),a=t(90033),n=t(50953),o=t(53751),r=t(61338),s=t(91126),c=t(15785),u=t(50240),d=t(35810),v=t(79458),p=t(63668),f=t(12054),m=t(9165),k=t(40715),h=t(22722),g=t(43016),y=t(74506),w=t(19051),_=t(81222),b=t(63814),C=t(32505);function E(e){const l=Object.create(null);return t=>l[t]||(l[t]=e(t))}"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString;const L=/\B([A-Z])/g,F=(E(e=>e.replace(L,"-$1").toLowerCase()),/-(\w)/g);E(e=>e.replace(F,(e,l)=>l?l.toUpperCase():""));const R=n.BA;var X=t(40980),W=t(34376),z=t(3621),B=t(75749),x=t(21777),V=t(30594),S=t(17859),I=t(71225),N=t(36117);const P={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},H=["aria-hidden","aria-label"],A=["fill","width","height"],M={d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"},K={key:0},$=(0,u._)(P,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon file-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",M,[t.title?((0,i.uX)(),(0,i.CE)("title",K,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,A))],16,H)}]]),D={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},U=["aria-hidden","aria-label"],Q=["fill","width","height"],Z={d:"M7,10L12,15L17,10H7Z"},J={key:0},T=(0,u._)(D,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon menu-down-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",Z,[t.title?((0,i.uX)(),(0,i.CE)("title",J,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,Q))],16,U)}]]),O={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},j=["aria-hidden","aria-label"],q=["fill","width","height"],G={d:"M7,15L12,10L17,15H7Z"},Y={key:0},ee=(0,u._)(O,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon menu-up-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",G,[t.title?((0,i.uX)(),(0,i.CE)("title",Y,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,q))],16,j)}]]),le={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},te=["aria-hidden","aria-label"],ie=["fill","width","height"],ae={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},ne={key:0},oe=(0,u._)(le,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon folder-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",ae,[t.title?((0,i.uX)(),(0,i.CE)("title",ne,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,ie))],16,te)}]]),re={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},se=(0,i.pM)({__name:"FilePreview",props:{node:{},cropImagePreviews:{type:Boolean}},setup(e){const l=e,t=(0,n.KR)(re),{previewURL:o,previewLoaded:r}=(0,g.u)((0,n.lW)(l,"node"),(0,i.EW)(()=>({cropPreview:l.cropImagePreviews}))),s=(0,i.EW)(()=>l.node.type===d.pt.File),c=(0,i.EW)(()=>{if(l.node.type!==d.pt.Folder)return null;if(1===l.node.attributes?.["is-encrypted"])return m.kHm;if(l.node.attributes?.["is-tag"])return m.HzW;const e=Object.values(l.node.attributes?.["share-types"]||{}).flat();if(e.some(e=>e===k.I.Link||e===k.I.Email))return m.Brj;if(e.length>0)return m.IyB;switch(l.node.attributes?.["mount-type"]){case"external":case"external-session":return m.jUz;case"group":return m.kOJ;case"shared":return m.IyB}return null});return(e,l)=>((0,i.uX)(),(0,i.CE)("div",{style:(0,a.Tr)((0,n.R1)(r)?{backgroundImage:`url(${(0,n.R1)(o)})`}:void 0),class:(0,a.C4)(t.value["file-picker__file-icon"])},[(0,n.R1)(r)?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[s.value?((0,i.uX)(),(0,i.Wv)($,{key:0,size:32})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[c.value?((0,i.uX)(),(0,i.Wv)((0,n.R1)(h.A),{key:0,class:(0,a.C4)(t.value["file-picker__file-icon-overlay"]),inline:"",path:c.value,size:16},null,8,["class","path"])):(0,i.Q3)("",!0),(0,i.bF)(oe,{class:(0,a.C4)(t.value["file-picker__file-icon--primary"]),size:32},null,8,["class"])],64))],64))],6))}}),ce=["tabindex","aria-selected","data-filename"],ue={class:"row-name"},de={class:"file-picker__name-container","data-testid":"row-name"},ve=["title","textContent"],pe=["textContent"],fe={class:"row-size"},me={class:"row-modified"},ke=(0,i.pM)({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:{},cropImagePreviews:{type:Boolean}},emits:["update:selected","enterDirectory"],setup(e,{emit:l}){const t=e,r=l,s=(0,i.EW)(()=>t.node.mtime??0),c=(0,i.EW)(()=>t.node.attributes?.displayName||t.node.basename.slice(0,t.node.extension?-t.node.extension.length:void 0)),u=(0,i.EW)(()=>t.node.extension),v=(0,i.EW)(()=>t.node.type===d.pt.Folder),m=(0,i.EW)(()=>t.canPick&&(t.allowPickDirectory||!v.value)),k=(0,i.EW)(()=>(t.node.permissions&d.aX.READ)===d.aX.READ);function h(){m.value&&r("update:selected",!t.selected)}function g(){v.value?k.value&&r("enterDirectory",t.node):h()}function w(e){"Enter"===e.key&&g()}return(l,t)=>((0,i.uX)(),(0,i.CE)("tr",(0,i.v6)({tabindex:e.showCheckbox&&!v.value?void 0:0,"aria-selected":m.value?e.selected:void 0,class:["file-picker__row",[{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":v.value&&!k.value,"file-picker__row--not-pickable":!m.value}]],"data-filename":e.node.basename,"data-testid":"file-list-row"},(0,i.Tb)({click:g,...!e.showCheckbox||v.value?{keydown:w}:{}},!0)),[e.showCheckbox?((0,i.uX)(),(0,i.CE)("td",{key:0,class:"row-checkbox",onClick:(0,o.D$)(()=>{},["stop"])},[(0,i.bF)((0,n.R1)(p.A),{"aria-label":(0,n.R1)(y.t)("Select the row for {nodename}",{nodename:c.value}),disabled:!m.value,"data-testid":"row-checkbox","model-value":e.selected,"onUpdate:modelValue":h},null,8,["aria-label","disabled","model-value"])])):(0,i.Q3)("",!0),(0,i.Lk)("td",ue,[(0,i.Lk)("div",de,[(0,i.bF)(se,{node:e.node,"crop-image-previews":e.cropImagePreviews},null,8,["node","crop-image-previews"]),(0,i.Lk)("div",{class:"file-picker__file-name",title:c.value,textContent:(0,a.v_)(c.value)},null,8,ve),(0,i.Lk)("div",{class:"file-picker__file-extension",textContent:(0,a.v_)(u.value)},null,8,pe)])]),(0,i.Lk)("td",fe,(0,a.v_)((0,n.R1)(d.v7)(e.node.size||0)),1),(0,i.Lk)("td",me,[(0,i.bF)((0,n.R1)(f.A),{timestamp:s.value,"ignore-seconds":""},null,8,["timestamp"])])],16,ce))}}),he=(0,u._)(ke,[["__scopeId","data-v-a5daea8d"]]),ge={"aria-hidden":"true",class:"file-picker__row loading-row"},ye={key:0,class:"row-checkbox"},we={class:"row-name"},_e={class:"row-wrapper"},be=(0,i.pM)({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup:e=>(l,t)=>((0,i.uX)(),(0,i.CE)("tr",ge,[e.showCheckbox?((0,i.uX)(),(0,i.CE)("td",ye,[...t[0]||(t[0]=[(0,i.Lk)("span",null,null,-1)])])):(0,i.Q3)("",!0),(0,i.Lk)("td",we,[(0,i.Lk)("div",_e,[(0,i.Lk)("span",{class:(0,a.C4)((0,n.R1)(re)["file-picker__file-icon"])},null,2),t[1]||(t[1]=(0,i.Lk)("span",null,null,-1))])]),t[2]||(t[2]=(0,i.Lk)("td",{class:"row-size"},[(0,i.Lk)("span")],-1)),t[3]||(t[3]=(0,i.Lk)("td",{class:"row-modified"},[(0,i.Lk)("span")],-1))]))}),Ce=(0,u._)(be,[["__scopeId","data-v-1f96131b"]]);function Ee(){const e=(0,_.C)("files","config",null),l=(0,n.KR)(e?.show_hidden??!0),t=(0,n.KR)(e?.sort_favorites_first??!0),a=(0,n.KR)(e?.crop_image_previews??!0);return(0,i.sV)(async()=>{if((0,C.f)())y.l.debug("Skip loading files settings - currently on public share");else try{const{data:e}=await w.Ay.get((0,b.Jv)("/apps/files/api/v1/configs"));l.value=e?.data?.show_hidden??!1,t.value=e?.data?.sort_favorites_first??!0,a.value=e?.data?.crop_image_previews??!0}catch(e){y.l.error("Could not load files settings",e),(0,y.s)((0,y.t)("Could not load files settings"))}}),{showHiddenFiles:l,sortFavoritesFirst:t,cropImagePreviews:a}}const Le={key:0,class:"row-checkbox"},Fe={class:"hidden-visually"},Re=["aria-sort"],Xe={class:"header-wrapper"},We={key:2,style:{width:"44px"}},ze=["aria-sort"],Be={key:2,style:{width:"44px"}},xe=["aria-sort"],Ve={key:2,style:{width:"44px"}},Se=(0,i.pM)({__name:"FileList",props:(0,i.zz)({currentView:{},multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:{},canPick:{type:Function}},{path:{required:!0},pathModifiers:{},selectedFiles:{required:!0},selectedFilesModifiers:{}}),emits:["update:path","update:selectedFiles"],setup(e){const l=(0,i.fn)(e,"path"),t=(0,i.fn)(e,"selectedFiles"),o=e,r=(0,n.KR)(),{currentConfig:s}=function(e){const l=e=>"asc"===e?"ascending":"desc"===e?"descending":"none",t=(0,_.C)("files","viewConfigs",null),a=(0,n.KR)({sortBy:t?.files?.sorting_mode??"basename",order:l(t?.files?.sorting_direction??"asc")}),o=(0,n.KR)({sortBy:t?.recent?.sorting_mode??"basename",order:l(t?.recent?.sorting_direction??"asc")}),r=(0,n.KR)({sortBy:t?.favorites?.sorting_mode??"basename",order:l(t?.favorites?.sorting_direction??"asc")});(0,i.sV)(async()=>{if((0,C.f)())y.l.debug("Skip loading files views - currently on public share");else try{const{data:e}=await w.Ay.get((0,b.Jv)("/apps/files/api/v1/views"));a.value={sortBy:e?.data?.files?.sorting_mode??"basename",order:l(e?.data?.files?.sorting_direction)},r.value={sortBy:e?.data?.favorites?.sorting_mode??"basename",order:l(e?.data?.favorites?.sorting_direction)},o.value={sortBy:e?.data?.recent?.sorting_mode??"basename",order:l(e?.data?.recent?.sorting_direction)}}catch(e){y.l.error("Could not load files views",e),(0,y.s)((0,y.t)("Could not load files views"))}});const s=(0,i.EW)(()=>"files"===R(e||"files")?a.value:"recent"===R(e)?o.value:r.value),c=(0,i.EW)(()=>s.value.sortBy),u=(0,i.EW)(()=>s.value.order);return{filesViewConfig:a,favoritesViewConfig:r,recentViewConfig:o,currentConfig:s,sortBy:c,order:u}}(o.currentView),c=(0,i.EW)(()=>r.value??s.value),u=(0,i.EW)(()=>"basename"===c.value.sortBy?"none"===c.value.order?void 0:c.value.order:void 0),f=(0,i.EW)(()=>"size"===c.value.sortBy?"none"===c.value.order?void 0:c.value.order:void 0),m=(0,i.EW)(()=>"mtime"===c.value.sortBy?"none"===c.value.order?void 0:c.value.order:void 0);function k(e){c.value.sortBy===e?"ascending"===c.value.order?r.value={sortBy:c.value.sortBy,order:"descending"}:r.value={sortBy:c.value.sortBy,order:"ascending"}:r.value={sortBy:e,order:"ascending"}}const{sortFavoritesFirst:h,cropImagePreviews:g}=Ee(),E=(0,i.EW)(()=>(0,d.ur)(o.files,{sortFoldersFirst:!0,sortFavoritesFirst:h.value,sortingOrder:"descending"===c.value.order?"desc":"asc",sortingMode:c.value.sortBy})),L=(0,i.EW)(()=>o.files.filter(e=>o.allowPickDirectory||e.type!==d.pt.Folder)),F=(0,i.EW)(()=>!o.loading&&t.value.length>0&&t.value.length>=L.value.length);function X(){t.value.length<L.value.length?t.value=[...L.value]:t.value=[]}function W(e){l.value=e.path}const z=(0,n.KR)(4),B=(0,n.KR)();{const e=()=>(0,i.dY)(()=>{const e=B.value?.parentElement?.children||[];let l=B.value?.parentElement?.clientHeight||450;for(let t=0;t<e.length;t++)B.value?.isSameNode(e[t])||(l-=e[t].clientHeight);z.value=Math.max(1,Math.floor((l-50)/50))});(0,i.sV)(()=>{window.addEventListener("resize",e),e()}),(0,i.hi)(()=>{window.removeEventListener("resize",e)})}return(l,r)=>((0,i.uX)(),(0,i.CE)("div",{ref_key:"fileContainer",ref:B,class:"file-picker__files"},[(0,i.Lk)("table",null,[(0,i.Lk)("thead",null,[(0,i.Lk)("tr",null,[e.multiselect?((0,i.uX)(),(0,i.CE)("th",Le,[(0,i.Lk)("span",Fe,(0,a.v_)((0,n.R1)(y.t)("Select entry")),1),e.multiselect?((0,i.uX)(),(0,i.Wv)((0,n.R1)(p.A),{key:0,"aria-label":(0,n.R1)(y.t)("Select all entries"),"data-testid":"select-all-checkbox","model-value":F.value,"onUpdate:modelValue":X},null,8,["aria-label","model-value"])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),(0,i.Lk)("th",{"aria-sort":u.value,class:"row-name"},[(0,i.Lk)("div",Xe,[r[3]||(r[3]=(0,i.Lk)("span",{class:"file-picker__header-preview"},null,-1)),(0,i.bF)((0,n.R1)(v.A),{"data-test":"file-picker_sort-name",variant:"tertiary",wide:"",onClick:r[0]||(r[0]=e=>k("basename"))},{icon:(0,i.k6)(()=>["ascending"===u.value?((0,i.uX)(),(0,i.Wv)(ee,{key:0,size:20})):"descending"===u.value?((0,i.uX)(),(0,i.Wv)(T,{key:1,size:20})):((0,i.uX)(),(0,i.CE)("span",We))]),default:(0,i.k6)(()=>[(0,i.eW)(" "+(0,a.v_)((0,n.R1)(y.t)("Name")),1)]),_:1})])],8,Re),(0,i.Lk)("th",{"aria-sort":f.value,class:"row-size"},[(0,i.bF)((0,n.R1)(v.A),{variant:"tertiary",wide:"",onClick:r[1]||(r[1]=e=>k("size"))},{icon:(0,i.k6)(()=>["ascending"===f.value?((0,i.uX)(),(0,i.Wv)(ee,{key:0,size:20})):"descending"===f.value?((0,i.uX)(),(0,i.Wv)(T,{key:1,size:20})):((0,i.uX)(),(0,i.CE)("span",Be))]),default:(0,i.k6)(()=>[(0,i.eW)(" "+(0,a.v_)((0,n.R1)(y.t)("Size")),1)]),_:1})],8,ze),(0,i.Lk)("th",{"aria-sort":m.value,class:"row-modified"},[(0,i.bF)((0,n.R1)(v.A),{variant:"tertiary",wide:"",onClick:r[2]||(r[2]=e=>k("mtime"))},{icon:(0,i.k6)(()=>["ascending"===m.value?((0,i.uX)(),(0,i.Wv)(ee,{key:0,size:20})):"descending"===m.value?((0,i.uX)(),(0,i.Wv)(T,{key:1,size:20})):((0,i.uX)(),(0,i.CE)("span",Ve))]),default:(0,i.k6)(()=>[(0,i.eW)(" "+(0,a.v_)((0,n.R1)(y.t)("Modified")),1)]),_:1})],8,xe)])]),(0,i.Lk)("tbody",null,[e.loading?((0,i.uX)(!0),(0,i.CE)(i.FK,{key:0},(0,i.pI)(z.value,l=>((0,i.uX)(),(0,i.Wv)(Ce,{key:l,"show-checkbox":e.multiselect},null,8,["show-checkbox"]))),128)):((0,i.uX)(!0),(0,i.CE)(i.FK,{key:1},(0,i.pI)(E.value,l=>((0,i.uX)(),(0,i.Wv)(he,{key:l.fileid||l.path,"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||0===t.value.length||t.value.includes(l))&&(void 0===e.canPick||e.canPick(l)),selected:t.value.includes(l),node:l,"crop-image-previews":(0,n.R1)(g),"onUpdate:selected":e=>function(e){t.value.includes(e)?t.value=t.value.filter(l=>l.path!==e.path):o.multiselect?t.value=[...t.value,e]:t.value=[e]}(l),onEnterDirectory:W},null,8,["allow-pick-directory","show-checkbox","can-pick","selected","node","crop-image-previews","onUpdate:selected"]))),128))])])],512))}}),Ie=(0,u._)(Se,[["__scopeId","data-v-38620705"]]),Ne={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Pe=["aria-hidden","aria-label"],He=["fill","width","height"],Ae={d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},Me={key:0},Ke=(0,u._)(Ne,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon home-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",Ae,[t.title?((0,i.uX)(),(0,i.CE)("title",Me,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,He))],16,Pe)}]]),$e={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},De=["aria-hidden","aria-label"],Ue=["fill","width","height"],Qe={d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},Ze={key:0},Je=(0,u._)($e,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon plus-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",Qe,[t.title?((0,i.uX)(),(0,i.CE)("title",Ze,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,Ue))],16,De)}]]),Te=(0,i.pM)({__name:"FilePickerBreadcrumbs",props:{path:{},showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:l}){const t=e,a=l,o=(0,n.KR)(!1),r=(0,n.KR)(""),s=(0,i.rk)("nameInput");function c(){const e=r.value.trim(),l=s.value?.$el?.querySelector("input");let t="";return 0===e.length?t=(0,y.t)("Folder name cannot be empty."):e.includes("/")?t=(0,y.t)('"/" is not allowed inside a folder name.'):["..","."].includes(e)?t=(0,y.t)('"{name}" is an invalid folder name.',{name:e}):window.OC.config?.blacklist_files_regex&&e.match(window.OC.config?.blacklist_files_regex)&&(t=(0,y.t)('"{name}" is not an allowed folder name',{name:e})),l&&l.setCustomValidity(t),""===t}function u(){const e=r.value.trim();c()&&(o.value=!1,a("create-node",e),r.value="")}const d=(0,i.EW)(()=>t.path.split("/").filter(e=>""!==e).map((e,l,t)=>({name:e,path:"/"+t.slice(0,l+1).join("/")})));return(l,t)=>((0,i.uX)(),(0,i.Wv)((0,n.R1)(B.N),{class:"file-picker__breadcrumbs"},(0,i.eX)({default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(z.N),{name:(0,n.R1)(y.t)("All files"),title:(0,n.R1)(y.t)("Home"),onClick:t[0]||(t[0]=e=>a("update:path","/"))},{icon:(0,i.k6)(()=>[(0,i.bF)(Ke,{size:20})]),_:1},8,["name","title"]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(d.value,e=>((0,i.uX)(),(0,i.Wv)((0,n.R1)(z.N),{key:e.path,name:e.name,title:e.path,onClick:l=>a("update:path",e.path)},null,8,["name","title","onClick"]))),128))]),_:2},[e.showMenu?{name:"actions",fn:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(W.N),{open:o.value,"onUpdate:open":t[2]||(t[2]=e=>o.value=e),"aria-label":(0,n.R1)(y.t)("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":(0,n.R1)(y.t)("New"),variant:"secondary",onClose:t[3]||(t[3]=e=>r.value="")},{icon:(0,i.k6)(()=>[(0,i.bF)(Je,{size:20})]),default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(X.N),{ref_key:"nameInput",ref:s,modelValue:r.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>r.value=e),c],label:(0,n.R1)(y.t)("New folder"),placeholder:(0,n.R1)(y.t)("New folder name"),onSubmit:u},{icon:(0,i.k6)(()=>[(0,i.bF)(oe,{size:20})]),_:1},8,["modelValue","label","placeholder"])]),_:1},8,["open","aria-label","menu-name"])]),key:"0"}:void 0]),1024))}}),Oe=(0,u._)(Te,[["__scopeId","data-v-4e6fd4e4"]]),je={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},qe=["aria-hidden","aria-label"],Ge=["fill","width","height"],Ye={d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},el={key:0},ll=(0,u._)(je,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon close-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",Ye,[t.title?((0,i.uX)(),(0,i.CE)("title",el,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,Ge))],16,qe)}]]),tl={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},il=["aria-hidden","aria-label"],al=["fill","width","height"],nl={d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},ol={key:0},rl=(0,u._)(tl,[["render",function(e,l,t,n,o,r){return(0,i.uX)(),(0,i.CE)("span",(0,i.v6)(e.$attrs,{"aria-hidden":t.title?null:"true","aria-label":t.title,class:"material-design-icon magnify-icon",role:"img",onClick:l[0]||(l[0]=l=>e.$emit("click",l))}),[((0,i.uX)(),(0,i.CE)("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[(0,i.Lk)("path",nl,[t.title?((0,i.uX)(),(0,i.CE)("title",ol,(0,a.v_)(t.title),1)):(0,i.Q3)("",!0)])],8,al))],16,il)}]]),sl={key:0,class:"file-picker__side"},cl=(0,i.pM)({__name:"FilePickerNavigation",props:{currentView:{},filterString:{},isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:l}){const t=e,o=l,{availableViews:r}=function(e){const l=[{id:"files",label:(0,y.t)("All files"),icon:m.fEr},{id:"recent",label:(0,y.t)("Recent"),icon:m.NZC},{id:"favorites",label:(0,y.t)("Favorites"),icon:m.ZL5}],t=e.value?l.filter(({id:e})=>"files"===e):l;return{allViews:l,availableViews:t}}((0,n.KR)(null===(0,x.HW)())),s=(0,i.EW)(()=>r.filter(e=>e.id===t.currentView)[0]??r[0]),c=e=>o("update:filterString",e);return(l,t)=>((0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)((0,n.R1)(S.A),{class:"file-picker__filter-input",label:(0,n.R1)(y.t)("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString,"onUpdate:modelValue":c,onTrailingButtonClick:t[0]||(t[0]=e=>c(""))},{"trailing-button-icon":(0,i.k6)(()=>[(0,i.bF)(ll,{size:16})]),default:(0,i.k6)(()=>[(0,i.bF)(rl,{size:16})]),_:1},8,["label","show-trailing-button","model-value"]),(0,n.R1)(r).length>1&&!e.disabledNavigation?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[e.isCollapsed?((0,i.uX)(),(0,i.Wv)((0,n.R1)(V.default),{key:1,"aria-label":(0,n.R1)(y.t)("Current view selector"),clearable:!1,searchable:!1,options:(0,n.R1)(r),"model-value":s.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o("update:currentView",e.id))},null,8,["aria-label","options","model-value"])):((0,i.uX)(),(0,i.CE)("ul",sl,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)((0,n.R1)(r),t=>((0,i.uX)(),(0,i.CE)("li",{key:t.id},[(0,i.bF)((0,n.R1)(v.A),{variant:e.currentView===t.id?"primary":"tertiary",wide:!0,onClick:e=>l.$emit("update:currentView",t.id)},{icon:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(h.A),{path:t.icon,size:20},null,8,["path"])]),default:(0,i.k6)(()=>[(0,i.eW)(" "+(0,a.v_)(t.label),1)]),_:2},1032,["variant","onClick"])]))),128))]))],64)):(0,i.Q3)("",!0)],64))}}),ul=(0,u._)(cl,[["__scopeId","data-v-86223490"]]);const dl={class:"file-picker__main"},vl={key:1,class:"file-picker__view"},pl=(0,i.pM)({__name:"FilePicker",props:{buttons:{},name:{},allowPickDirectory:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},filterFn:{type:Function,default:void 0},canPickFn:{type:Function,default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!1},path:{default:void 0}},emits:["close"],setup(e,{emit:l}){const t=e,o=l,u=(0,n.KR)(!0),v=(0,n.KR)("files"),p=(0,n.KR)(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=(0,n.KR)(""),m=(0,i.EW)({get:()=>"files"===v.value?f.value||t.path||p.value:"/",set:e=>{f.value=e}}),k=(0,n.IJ)([]),{files:h,folder:g,isLoading:w,loadFiles:_,createDirectory:b}=function(e,l){const t=(0,d.H4)(),a=(0,n.IJ)([]),o=(0,n.IJ)(null),r=(0,n.KR)(!0),s=(0,n.KR)(null);async function c(){s.value&&s.value.cancel(),r.value=!0,"favorites"===e.value?s.value=(0,d.Q$)(t,l.value):"recent"===e.value?s.value=function(e){const l=new AbortController,t=Math.round(Date.now()/1e3)-1209600;return new N.CancelablePromise(async(i,a,n)=>{n(()=>l.abort());try{const{data:a}=await e.search("/",{signal:l.signal,details:!0,data:(0,d.R3)(t)});i(a.results.map(e=>(0,d.Al)(e)))}catch(e){a(e)}})}(t):s.value=function(e,l){const t=new AbortController;return new N.CancelablePromise(async(i,a,n)=>{n(()=>t.abort());try{const a=(await e.getDirectoryContents((0,I.HS)(d.lJ,l),{signal:t.signal,details:!0,includeSelf:!0,data:(0,d.VL)()})).data.map(e=>(0,d.Al)(e));i({contents:a.filter(({path:e})=>e!==l),folder:a.find(({path:e})=>e===l)})}catch(e){a(e)}})}(t,l.value);const i=await s.value;i&&("folder"in i?(o.value=i.folder,a.value=i.contents):(o.value=null,a.value=i),s.value=null,r.value=!1)}return(0,i.wB)([e,l],()=>c()),(0,i.sV)(()=>c()),{isLoading:r,files:a,folder:o,loadFiles:c,createDirectory:async function(e){const i=(0,I.HS)(l.value,e);await t.createDirectory((0,I.HS)(d.lJ,i));const n=await async function(e,l){const{data:t}=await e.stat((0,I.HS)(d.lJ,l),{details:!0,data:(0,d.VL)()});return(0,d.Al)(t)}(t,i);return a.value=[...a.value,n],n}}}(v,m);(0,i.wB)([f],()=>{void 0===t.path&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),k.value=[]});let C=!1;const E=(0,i.EW)(()=>{const e=0===k.value.length&&t.allowPickDirectory&&g.value?[g.value]:k.value;return("function"==typeof t.buttons?t.buttons(e,m.value,v.value):t.buttons).map(l=>({...l,disabled:l.disabled||w.value,callback:()=>{C=!0,async function(e,l){await e(l),o("close",l),C=!1}(l.callback,e)}}))}),L=(0,i.EW)(()=>"favorites"===v.value?(0,y.t)("Favorites"):"recent"===v.value?(0,y.t)("Recent"):""),F=(0,n.KR)(""),{isSupportedMimeType:R}=function(e){const l=(0,i.EW)(()=>e.value.map(e=>e.split("/")));return{isSupportedMimeType:e=>{const t=e.split("/");return l.value.some(([e,l])=>!(t[0]!==e&&"*"!==e||t[1]!==l&&"*"!==l))}}}((0,n.lW)(t,"mimetypeFilter"));(0,i.sV)(()=>_());const{showHiddenFiles:X}=Ee(),W=(0,i.EW)(()=>{let e=h.value;return X.value||(e=e.filter(e=>!e.basename.startsWith("."))),t.mimetypeFilter.length>0&&(e=e.filter(e=>"folder"===e.type||e.mime&&R(e.mime))),F.value&&(e=e.filter(e=>e.basename.toLowerCase().includes(F.value.toLowerCase()))),t.filterFn&&(e=e.filter(e=>t.filterFn(e))),e}),z=(0,i.EW)(()=>"files"===v.value?(0,y.t)("Upload some content or sync with your devices!"):"recent"===v.value?(0,y.t)("Files and folders you recently modified will show up here."):(0,y.t)("Files and folders you mark as favorite will show up here."));async function B(e){try{const l=await b(e);f.value=l.path,(0,r.Ic)("files:node:created",h.value.filter(l=>l.basename===e)[0])}catch(l){y.l.warn("Could not create new folder",{name:e,error:l}),(0,y.s)((0,y.t)("Could not create the new folder"))}}function x(e){e||C||o("close")}return(l,t)=>((0,i.uX)(),(0,i.Wv)((0,n.R1)(s.A),{open:u.value,"onUpdate:open":[t[6]||(t[6]=e=>u.value=e),x],buttons:E.value,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},{navigation:(0,i.k6)(({isCollapsed:l})=>[(0,i.bF)(ul,{"current-view":v.value,"onUpdate:currentView":t[0]||(t[0]=e=>v.value=e),"filter-string":F.value,"onUpdate:filterString":t[1]||(t[1]=e=>F.value=e),"is-collapsed":l,"disabled-navigation":e.disabledNavigation},null,8,["current-view","filter-string","is-collapsed","disabled-navigation"])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",dl,["files"===v.value?((0,i.uX)(),(0,i.Wv)(Oe,{key:0,path:m.value,"onUpdate:path":t[2]||(t[2]=e=>m.value=e),"show-menu":e.allowPickDirectory,onCreateNode:B},null,8,["path","show-menu"])):((0,i.uX)(),(0,i.CE)("div",vl,[(0,i.Lk)("h3",null,(0,a.v_)(L.value),1)])),(0,n.R1)(w)||W.value.length>0?((0,i.uX)(),(0,i.Wv)(Ie,{key:2,path:m.value,"onUpdate:path":[t[3]||(t[3]=e=>m.value=e),t[5]||(t[5]=e=>v.value="files")],"selected-files":k.value,"onUpdate:selectedFiles":t[4]||(t[4]=e=>k.value=e),"allow-pick-directory":e.allowPickDirectory,"current-view":v.value,files:W.value,multiselect:e.multiselect,loading:(0,n.R1)(w),name:L.value,"can-pick":e.canPickFn},null,8,["path","selected-files","allow-pick-directory","current-view","files","multiselect","loading","name","can-pick"])):F.value?((0,i.uX)(),(0,i.Wv)((0,n.R1)(c.N),{key:3,name:(0,n.R1)(y.t)("No matching files"),description:(0,n.R1)(y.t)("No files matching your filter were found.")},{icon:(0,i.k6)(()=>[(0,i.bF)($)]),_:1},8,["name","description"])):((0,i.uX)(),(0,i.Wv)((0,n.R1)(c.N),{key:4,name:(0,n.R1)(y.t)("No files in here"),description:z.value},{icon:(0,i.k6)(()=>[(0,i.bF)($)]),_:1},8,["name","description"]))])]),_:1},8,["open","buttons","name"]))}}),fl=(0,u._)(pl,[["__scopeId","data-v-5287035b"]])}}]);
//# sourceMappingURL=5814-5814.js.map?v=d08951c5f2f4d8ce73bb