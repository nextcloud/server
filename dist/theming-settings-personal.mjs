import{k as K,m as Ue,u as Pe,s as B,an as Ce,F as S,o as c,H as x,I as m,U as O,G as j,M as Ve,t as v,y as n,d,N as xe,a as I,w,b as L,_ as D,z as oe,l as M,q as H,c as _,g as E,aj as He,P as F,Q as ne,K as G,n as we,p as Se,a3 as qe,e as Le}from"./_plugin-vue_export-helper-sUpjG1-Y.chunk.mjs";import{c as N,d as Te,i as ze}from"./index-Cvjfo1ma.chunk.mjs";import{s as X,k as Be}from"./index-JpgrUA2Z-hoZOv0I-.chunk.mjs";import{N as le}from"./NcCheckboxRadioSwitch-BCSKF7Tk-46uSoFP3.chunk.mjs";import{j as ie,e as Ie,N as Z}from"./string_decoder-CKkZVVJW.chunk.mjs";import{N as W}from"./ContentCopy-IyegwgLs.chunk.mjs";import{A as De,l as ee,g as se,r as ue}from"./refreshStyles-BcCP9kVf.chunk.mjs";import{N as Y,c as J,d as Ee,m as je,a as Ke}from"./mdi-BrEv6Slh.chunk.mjs";import{N as $e}from"./NcColorPicker-Kc0JqRtp-44mUS6uA.chunk.mjs";import"./modulepreload-polyfill-BxzAKjcf.chunk.mjs";import"./colors-Go3zmZRD-B3dC1KT2.chunk.mjs";const Fe={class:"theming__preview-description"},Oe={class:"theming__preview-explanation"},Re={key:0,class:"theming__preview-warning",role:"note"},We=K({__name:"ThemePreviewItem",props:Ue({enforced:{type:Boolean},theme:{},type:{},unique:{type:Boolean}},{selected:{type:Boolean,required:!0},selectedModifiers:{}}),emits:["update:selected"],setup(t){const e=Pe(t,"selected"),a=t,r=B(()=>a.unique?"switch":"radio"),i=B(()=>a.unique?null:a.type),s=B(()=>Ce("theming","img",a.theme.id+".jpg")),o=B({get(){return e.value},set(g){a.enforced||(e.value=a.unique?g:!0)}});function h(){if(!a.enforced){if(r.value==="radio"){o.value=!0;return}o.value=!o.value}}return(g,$)=>(c(),S("div",{class:x(["theming__preview--"+t.theme.id,"theming__preview"])},[m("div",{class:"theming__preview-image",style:O({backgroundImage:"url("+s.value+")"}),onClick:h},null,4),m("div",Fe,[m("h3",null,v(t.theme.title),1),m("p",Oe,v(t.theme.description),1),t.enforced?(c(),S("span",Re,v(n(d)("theming","Theme selection is enforced")),1)):j("",!0),Ve(I(n(le),{modelValue:o.value,"onUpdate:modelValue":$[0]||($[0]=P=>o.value=P),class:"theming__preview-toggle",disabled:t.enforced,name:i.value,type:r.value},{default:w(()=>[L(v(t.theme.enableLabel),1)]),_:1},8,["modelValue","disabled","name","type"]),[[xe,!t.enforced]])])],2))}}),de=D(We,[["__scopeId","data-v-13bf6aae"]]),Ge={name:"UndoIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ze=["aria-hidden","aria-label"],Je=["fill","width","height"],Qe={d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"},Ye={key:0};function Xe(t,e,a,r,i,s){return c(),S("span",oe(t.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon undo-icon",role:"img",onClick:e[0]||(e[0]=o=>t.$emit("click",o))}),[(c(),S("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[m("path",Qe,[a.title?(c(),S("title",Ye,v(a.title),1)):j("",!0)])],8,Je))],16,Ze)}const et=D(Ge,[["render",Xe]]),ce="theming-apporder-changed-infocard",ge="theming-apporder-changed-infocard",tt=K({__name:"UserSectionAppMenu",setup(t){const{userAppOrder:e,enforcedDefaultApp:a}=M("theming","navigationBar"),r=M("core","apps").filter(({type:p})=>p==="link").map(p=>({...p,label:p.name,default:p.default&&p.id===a})),i=H([...r]),s=H(!Array.isArray(e)||Object.values(e).length>0),o=B(()=>r.some(({id:p},y)=>p!==i.value[y]?.id)),h=B(()=>(o.value?`${ce} `:"")+(a?ge:""));async function g(p){const y={};p.forEach(({app:A,id:b},C)=>{y[b]={order:C,app:A}});try{await P("apporder",y),i.value=p,s.value=!0}catch(A){ee.error("Could not set the app order",{error:A}),X(d("theming","Could not set the app order"))}}async function $(){try{await P("apporder",[]),s.value=!1;const{data:p}=await N.get(E("/core/navigation/apps"),{headers:{"OCS-APIRequest":"true"}});i.value=p.ocs.data.map(y=>({...y,label:y.name,default:y.default&&y.app===a}))}catch(p){ee.error("Could not reset the app order",{error:p}),X(d("theming","Could not reset the app order"))}}async function P(p,y){const A=E("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"core",configKey:p});return await N.post(A,{configValue:JSON.stringify(y)})}return(p,y)=>(c(),_(n(W),{name:n(d)("theming","Navigation bar settings")},{default:w(()=>[m("p",null,v(n(d)("theming","You can configure the app order used for the navigation bar. The first entry will be the default app, opened after login or when clicking on the logo.")),1),n(a)?(c(),_(n(ie),{key:0,id:ge,type:"info"},{default:w(()=>[L(v(n(d)("theming","The default app can not be changed because it was configured by the administrator.")),1)]),_:1})):j("",!0),o.value?(c(),_(n(ie),{key:1,id:ce,type:"info"},{default:w(()=>[L(v(n(d)("theming","The app order was changed, to see it in action you have to reload the page.")),1)]),_:1})):j("",!0),I(De,{class:x(p.$style.userSectionAppMenu__selector),"aria-details":h.value,"model-value":i.value,"onUpdate:modelValue":g},null,8,["class","aria-details","model-value"]),I(n(Ie),{"data-test-id":"btn-apporder-reset",disabled:!s.value,variant:"tertiary",onClick:$},{icon:w(()=>[I(et,{size:20})]),default:w(()=>[L(" "+v(n(d)("theming","Reset default app order")),1)]),_:1},8,["disabled"])]),_:1},8,["name"]))}}),at="_userSectionAppMenu__selector_1hkl7_2",rt={userSectionAppMenu__selector:at},nt={$style:rt},it=D(tt,[["__cssModules",nt]]),ot={class:"hidden-visually"},lt=["aria-disabled","aria-pressed","aria-label","title"],st=["aria-disabled","aria-pressed","aria-label","title"],ut=["aria-disabled","aria-pressed","aria-label","title"],dt={class:"hidden-visually"},ct=["title","aria-label","aria-pressed","onClick"],gt=K({__name:"UserSectionBackground",emits:["refreshStyles"],setup(t,{emit:e}){He(l=>({v84c919a6:s}));const a=e,r=M("theming","shippedBackgrounds"),i=M("theming","themingDefaults"),s=`url('${i.backgroundImage}')`,o=H(!1),h=H(structuredClone(M("theming","data"))),g=H(M("theming","userBackgroundImage")),$=Object.keys(r).filter(l=>l!==i.defaultShippedBackground||i.backgroundMime!=="").map(l=>({name:l,url:P(l),preview:P("preview/"+l),details:r[l]}));function P(l){return Ce("theming","","img/background/")+l}async function p(l){g.value=l.backgroundImage,h.value.backgroundColor=l.backgroundColor,a("refreshStyles"),o.value=!1}async function y(){o.value="default";const l=await N.post(G("/apps/theming/background/default"));p(l.data)}async function A(l){o.value=l;const f=await N.post(G("/apps/theming/background/shipped"),{value:l});p(f.data)}async function b(l){o.value="custom";const f=await N.post(G("/apps/theming/background/custom"),{value:l});p(f.data)}async function C(l){if(!l)return;o.value="color";const{data:f}=await N.post(G("/apps/theming/background/color"),{color:l||"#0082c9"});p(f)}async function T(){await Be(d("theming","Select a background from your files")).allowDirectories(!1).setFilter(l=>l.mime.startsWith("image/")).setMultiSelect(!1).addButton({label:d("theming","Select background"),callback:([l])=>{b(l.path)},variant:"primary"}).build().pick()}return(l,f)=>(c(),_(n(W),{class:"background",name:n(d)("theming","Background and color"),description:n(d)("theming","The background can be set to an image from the default set, a custom uploaded image, or a plain color.")},{default:w(()=>[m("fieldset",null,[m("legend",ot,v(n(d)("theming","Background and color")),1),m("div",{class:x(l.$style.backgroundSelect)},[m("button",{"aria-disabled":o.value==="custom","aria-pressed":g.value==="custom","aria-label":n(d)("theming","Custom background"),title:n(d)("theming","Custom background"),class:x(["button-vue",[l.$style.backgroundSelect__entry,l.$style.backgroundSelect__entryFilePicker]]),onClick:T},[o.value==="custom"?(c(),_(n(Y),{key:0})):(c(),_(n(Z),{key:1,path:g.value==="custom"?n(J):n(Ee)},null,8,["path"]))],10,lt),I(n($e),{modelValue:h.value.backgroundColor,"onUpdate:modelValue":f[0]||(f[0]=u=>h.value.backgroundColor=u),onSubmit:C},{default:w(()=>[m("button",{class:x(["button-vue",[l.$style.backgroundSelect__entry,l.$style.backgroundSelect__entryColor]]),"aria-disabled":o.value==="color","aria-pressed":g.value==="color","aria-label":n(d)("theming","Plain background"),title:n(d)("theming","Plain background"),style:O({backgroundColor:h.value.backgroundColor,"--color-content":n(se)(h.value.backgroundColor)})},[o.value==="color"?(c(),_(n(Y),{key:0})):(c(),_(n(Z),{key:1,path:g.value==="color"?n(J):n(je)},null,8,["path"]))],14,st)]),_:1},8,["modelValue"]),m("button",{class:x(["button-vue",[l.$style.backgroundSelect__entry,l.$style.backgroundSelect__entryDefault]]),"aria-disabled":o.value==="default","aria-pressed":g.value==="default","aria-label":n(d)("theming","Default background"),title:n(d)("theming","Default background"),style:O({"--color-content":n(se)(n(i).backgroundColor)}),onClick:y},[o.value==="default"?(c(),_(n(Y),{key:0})):(c(),_(n(Z),{key:1,path:g.value==="default"?n(J):n(Ke)},null,8,["path"]))],14,ut)],2),m("fieldset",{class:x(l.$style.backgroundSelect)},[m("label",dt,v(n(d)("theming","Default shipped background images")),1),(c(!0),S(F,null,ne(n($),u=>(c(),S("button",{key:u.name,title:u.details.attribution,"aria-label":u.details.description,"aria-pressed":g.value===u.name,class:x(["button-vue",l.$style.backgroundSelect__entry]),style:O({backgroundImage:"url("+u.preview+")"}),tabindex:"0",onClick:z=>A(u.name)},[g.value===u.name?(c(),_(n(Z),{key:0,class:x(l.$style.backgroundSelect__entryIcon),path:n(J)},null,8,["class","path"])):j("",!0)],14,ct))),128))],2)])]),_:1},8,["name","description"]))}}),pt="_backgroundSelect_qby7r_2",ht="_backgroundSelect__entry_qby7r_7",mt="_backgroundSelect__entryColor_qby7r_38",bt="_backgroundSelect__entryFilePicker_qby7r_42",ft="_backgroundSelect__entryDefault_qby7r_52",yt={backgroundSelect:pt,backgroundSelect__entry:ht,backgroundSelect__entryColor:mt,backgroundSelect__entryFilePicker:bt,backgroundSelect__entryDefault:ft},vt={$style:yt},_t=D(gt,[["__cssModules",vt]]),kt=K({__name:"UserSectionHotkeys",setup(t){const e=H(M("theming","shortcutsDisabled",!1));we(e,a);async function a(){const r=E("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"shortcuts_disabled"});e.value?await N.post(r,{configValue:"yes"}):await N.delete(r)}return(r,i)=>(c(),_(n(W),{name:n(d)("theming","Keyboard shortcuts"),description:n(d)("theming","In some cases keyboard shortcuts can interfere with accessibility tools. In order to allow focusing on your tool correctly you can disable all keyboard shortcuts here. This will also disable all available shortcuts in apps.")},{default:w(()=>[I(n(le),{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=s=>e.value=s),class:"theming__preview-toggle",type:"switch"},{default:w(()=>[L(v(n(d)("theming","Disable all keyboard shortcuts")),1)]),_:1},8,["modelValue"])]),_:1},8,["name","description"]))}});var Ct={grad:.9,turn:360,rad:360/(2*Math.PI)},q=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},k=function(t,e,a){return e===void 0&&(e=0),a===void 0&&(a=Math.pow(10,e)),Math.round(a*t)/a+0},U=function(t,e,a){return e===void 0&&(e=0),a===void 0&&(a=1),t>a?a:t>e?t:e},Ae=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},pe=function(t){return{r:U(t.r,0,255),g:U(t.g,0,255),b:U(t.b,0,255),a:U(t.a)}},te=function(t){return{r:k(t.r),g:k(t.g),b:k(t.b),a:k(t.a,3)}},wt=/^#([0-9a-f]{3,8})$/i,Q=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},Ne=function(t){var e=t.r,a=t.g,r=t.b,i=t.a,s=Math.max(e,a,r),o=s-Math.min(e,a,r),h=o?s===e?(a-r)/o:s===a?2+(r-e)/o:4+(e-a)/o:0;return{h:60*(h<0?h+6:h),s:s?o/s*100:0,v:s/255*100,a:i}},Me=function(t){var e=t.h,a=t.s,r=t.v,i=t.a;e=e/360*6,a/=100,r/=100;var s=Math.floor(e),o=r*(1-a),h=r*(1-(e-s)*a),g=r*(1-(1-e+s)*a),$=s%6;return{r:255*[r,h,o,o,g,r][$],g:255*[g,r,r,h,o,o][$],b:255*[o,o,g,r,r,h][$],a:i}},he=function(t){return{h:Ae(t.h),s:U(t.s,0,100),l:U(t.l,0,100),a:U(t.a)}},me=function(t){return{h:k(t.h),s:k(t.s),l:k(t.l),a:k(t.a,3)}},be=function(t){return Me((a=(e=t).s,{h:e.h,s:(a*=((r=e.l)<50?r:100-r)/100)>0?2*a/(r+a)*100:0,v:r+a,a:e.a}));var e,a,r},R=function(t){return{h:(e=Ne(t)).h,s:(i=(200-(a=e.s))*(r=e.v)/100)>0&&i<200?a*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,a,r,i},St=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,It=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,$t=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,At=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,fe={string:[[function(t){var e=wt.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?k(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?k(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=$t.exec(t)||At.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:pe({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=St.exec(t)||It.exec(t);if(!e)return null;var a,r,i=he({h:(a=e[1],r=e[2],r===void 0&&(r="deg"),Number(a)*(Ct[r]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return be(i)},"hsl"]],object:[[function(t){var e=t.r,a=t.g,r=t.b,i=t.a,s=i===void 0?1:i;return q(e)&&q(a)&&q(r)?pe({r:Number(e),g:Number(a),b:Number(r),a:Number(s)}):null},"rgb"],[function(t){var e=t.h,a=t.s,r=t.l,i=t.a,s=i===void 0?1:i;if(!q(e)||!q(a)||!q(r))return null;var o=he({h:Number(e),s:Number(a),l:Number(r),a:Number(s)});return be(o)},"hsl"],[function(t){var e=t.h,a=t.s,r=t.v,i=t.a,s=i===void 0?1:i;if(!q(e)||!q(a)||!q(r))return null;var o=(function(h){return{h:Ae(h.h),s:U(h.s,0,100),v:U(h.v,0,100),a:U(h.a)}})({h:Number(e),s:Number(a),v:Number(r),a:Number(s)});return Me(o)},"hsv"]]},ye=function(t,e){for(var a=0;a<e.length;a++){var r=e[a][0](t);if(r)return[r,e[a][1]]}return[null,void 0]},Nt=function(t){return typeof t=="string"?ye(t.trim(),fe.string):typeof t=="object"&&t!==null?ye(t,fe.object):[null,void 0]},ae=function(t,e){var a=R(t);return{h:a.h,s:U(a.s+100*e,0,100),l:a.l,a:a.a}},re=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},ve=function(t,e){var a=R(t);return{h:a.h,s:a.s,l:U(a.l+100*e,0,100),a:a.a}},_e=(function(){function t(e){this.parsed=Nt(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return k(re(this.rgba),2)},t.prototype.isDark=function(){return re(this.rgba)<.5},t.prototype.isLight=function(){return re(this.rgba)>=.5},t.prototype.toHex=function(){return e=te(this.rgba),a=e.r,r=e.g,i=e.b,o=(s=e.a)<1?Q(k(255*s)):"","#"+Q(a)+Q(r)+Q(i)+o;var e,a,r,i,s,o},t.prototype.toRgb=function(){return te(this.rgba)},t.prototype.toRgbString=function(){return e=te(this.rgba),a=e.r,r=e.g,i=e.b,(s=e.a)<1?"rgba("+a+", "+r+", "+i+", "+s+")":"rgb("+a+", "+r+", "+i+")";var e,a,r,i,s},t.prototype.toHsl=function(){return me(R(this.rgba))},t.prototype.toHslString=function(){return e=me(R(this.rgba)),a=e.h,r=e.s,i=e.l,(s=e.a)<1?"hsla("+a+", "+r+"%, "+i+"%, "+s+")":"hsl("+a+", "+r+"%, "+i+"%)";var e,a,r,i,s},t.prototype.toHsv=function(){return e=Ne(this.rgba),{h:k(e.h),s:k(e.s),v:k(e.v),a:k(e.a,3)};var e},t.prototype.invert=function(){return V({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),V(ae(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),V(ae(this.rgba,-e))},t.prototype.grayscale=function(){return V(ae(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),V(ve(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),V(ve(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?V({r:(a=this.rgba).r,g:a.g,b:a.b,a:e}):k(this.rgba.a,3);var a},t.prototype.hue=function(e){var a=R(this.rgba);return typeof e=="number"?V({h:e,s:a.s,l:a.l,a:a.a}):k(a.h)},t.prototype.isEqual=function(e){return this.toHex()===V(e).toHex()},t})(),V=function(t){return t instanceof _e?t:new _e(t)};const Mt={name:"PaletteOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ut=["aria-hidden","aria-label"],Pt=["fill","width","height"],Vt={d:"M12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2C17.5,2 22,6 22,11A6,6 0 0,1 16,17H14.2C13.9,17 13.7,17.2 13.7,17.5C13.7,17.6 13.8,17.7 13.8,17.8C14.2,18.3 14.4,18.9 14.4,19.5C14.5,20.9 13.4,22 12,22M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C12.3,20 12.5,19.8 12.5,19.5C12.5,19.3 12.4,19.2 12.4,19.1C12,18.6 11.8,18.1 11.8,17.5C11.8,16.1 12.9,15 14.3,15H16A4,4 0 0,0 20,11C20,7.1 16.4,4 12,4M6.5,10C7.3,10 8,10.7 8,11.5C8,12.3 7.3,13 6.5,13C5.7,13 5,12.3 5,11.5C5,10.7 5.7,10 6.5,10M9.5,6C10.3,6 11,6.7 11,7.5C11,8.3 10.3,9 9.5,9C8.7,9 8,8.3 8,7.5C8,6.7 8.7,6 9.5,6M14.5,6C15.3,6 16,6.7 16,7.5C16,8.3 15.3,9 14.5,9C13.7,9 13,8.3 13,7.5C13,6.7 13.7,6 14.5,6M17.5,10C18.3,10 19,10.7 19,11.5C19,12.3 18.3,13 17.5,13C16.7,13 16,12.3 16,11.5C16,10.7 16.7,10 17.5,10Z"},xt={key:0};function Ht(t,e,a,r,i,s){return c(),S("span",oe(t.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon palette-outline-icon",role:"img",onClick:e[0]||(e[0]=o=>t.$emit("click",o))}),[(c(),S("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[m("path",Vt,[a.title?(c(),S("title",xt,v(a.title),1)):j("",!0)])],8,Pt))],16,Ut)}const qt=D(Mt,[["render",Ht]]),Lt={name:"UndoVariantIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Tt=["aria-hidden","aria-label"],zt=["fill","width","height"],Bt={d:"M13.5,7A6.5,6.5 0 0,1 20,13.5A6.5,6.5 0 0,1 13.5,20H10V18H13.5C16,18 18,16 18,13.5C18,11 16,9 13.5,9H7.83L10.91,12.09L9.5,13.5L4,8L9.5,2.5L10.92,3.91L7.83,7H13.5M6,18H8V20H6V18Z"},Dt={key:0};function Et(t,e,a,r,i,s){return c(),S("span",oe(t.$attrs,{"aria-hidden":a.title?null:"true","aria-label":a.title,class:"material-design-icon undo-variant-icon",role:"img",onClick:e[0]||(e[0]=o=>t.$emit("click",o))}),[(c(),S("svg",{fill:a.fillColor,class:"material-design-icon__svg",width:a.size,height:a.size,viewBox:"0 0 24 24"},[m("path",Bt,[a.title?(c(),S("title",Dt,v(a.title),1)):j("",!0)])],8,zt))],16,Tt)}const jt=D(Lt,[["render",Et]]),Kt=K({__name:"UserSectionPrimaryColor",emits:["refreshStyles"],setup(t,{expose:e,emit:a}){const r=a;e({reload:P});const{primaryColor:i,defaultPrimaryColor:s}=M("theming","data",{primaryColor:"#0082c9",defaultPrimaryColor:"#0082c9"}),o=Se("trigger"),h=H(!1),g=H(i);we(g,Te(b=>{y(b)},1e3));const $=B(()=>V(g.value).isEqual(V(s)));function P(){let b=window.getComputedStyle(o.value).backgroundColor;const C=b.replaceAll(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/);C&&(b=`#${A(C[1])}${A(C[2])}${A(C[3])}`),b.toLowerCase()!==g.value.toLowerCase()&&(g.value=b)}function p(){g.value=s,y(null)}async function y(b){h.value=!0;const C=E("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"primary_color"});try{b?await N.post(C,{configValue:b}):await N.delete(C),r("refreshStyles")}catch(T){ee.error("Could not update primary color",{error:T}),X(d("theming","Could not set primary color"))}h.value=!1}function A(b){return Number.parseInt(b).toString(16).padStart(2,"0")}return(b,C)=>(c(),_(n(W),{name:n(d)("theming","Primary color"),description:n(d)("theming","Set a primary color to highlight important elements. The color used for elements such as primary buttons might differ a bit as it gets adjusted to fulfill accessibility requirements.")},{default:w(()=>[m("div",{class:x(b.$style.userPrimaryColor)},[I(n($e),{modelValue:g.value,"onUpdate:modelValue":C[0]||(C[0]=T=>g.value=T),"data-user-theming-primary-color":""},{default:w(()=>[m("button",{ref:"trigger",class:x(b.$style.userPrimaryColor__trigger),style:O({"background-color":g.value}),"data-user-theming-primary-color-trigger":""},[L(v(n(d)("theming","Primary color"))+" ",1),h.value?(c(),_(n(Y),{key:0})):(c(),_(qt,{key:1,size:20}))],6)]),_:1},8,["modelValue"]),I(n(Ie),{variant:"tertiary",disabled:$.value,onClick:p},{icon:w(()=>[I(jt,{size:20})]),default:w(()=>[L(" "+v(n(d)("theming","Reset primary color")),1)]),_:1},8,["disabled"])],2)]),_:1},8,["name","description"]))}}),Ft="_userPrimaryColor_pzh62_1",Ot="_userPrimaryColor__trigger_pzh62_8",Rt={userPrimaryColor:Ft,userPrimaryColor__trigger:Ot},Wt={$style:Rt},Gt=D(Kt,[["__cssModules",Wt]]),Zt=["innerHTML"],Jt=["innerHTML"],Qt={class:"theming__preview-list"},Yt={class:"theming__preview-list"},Xt=K({__name:"UserTheming",setup(t){const e=M("theming","enforceTheme",""),a=M("theming","isUserThemingDisabled"),r=H(M("theming","enableBlurFilter","")),i=M("theming","themes",[]),s=H(i.filter(l=>l.type===1)),o=H(i.filter(l=>l.type===2)),h=B(()=>s.value.find(l=>l.enabled)||s.value[0]),g=Se("primaryColor"),$=d("theming","Universal access is very important to us. We follow web standards and check to make everything usable also without mouse, and assistive software such as screenreaders. We aim to be compliant with the {linkstart}Web Content Accessibility Guidelines{linkend} 2.1 on AA level, with the high contrast theme even on AAA level.",{linkstart:'<a target="_blank" href="https://www.w3.org/WAI/standards-guidelines/wcag/" rel="noreferrer nofollow">',linkend:"</a>"},{escape:!1}),P=d("theming","If you find any issues, do not hesitate to report them on {issuetracker}our issue tracker{linkend}. And if you want to get involved, come join {designteam}our design team{linkend}!",{issuetracker:'<a target="_blank" href="https://github.com/nextcloud/server/issues/" rel="noreferrer nofollow">',designteam:'<a target="_blank" href="https://nextcloud.com/design" rel="noreferrer nofollow">',linkend:"</a>"},{escape:!1});async function p(){await ue(),qe(()=>g.value?.reload())}function y(l,f){s.value.forEach(u=>{if(u.id===l&&f){u.enabled=!0;return}u.enabled=!1}),C(),T(f,l)}function A(l,f){o.value.forEach(u=>{if(u.id===l&&f){u.enabled=!0;return}u.enabled=!1}),C(),T(f,l)}async function b(){r.value=r.value==="no"?"yes":"no",await N({url:E("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"force_enable_blur_filter"}),data:{configValue:r.value},method:"POST"}),ue()}function C(){const l=s.value.filter(u=>u.enabled===!0).map(u=>u.id),f=o.value.filter(u=>u.enabled===!0).map(u=>u.id);s.value.forEach(u=>{document.body.toggleAttribute(`data-theme-${u.id}`,u.enabled)}),o.value.forEach(u=>{document.body.toggleAttribute(`data-theme-${u.id}`,u.enabled)}),document.body.setAttribute("data-themes",[...l,...f].join(","))}async function T(l,f){try{l?await N({url:E("apps/theming/api/v1/theme/{themeId}/enable",{themeId:f}),method:"PUT"}):await N({url:E("apps/theming/api/v1/theme/{themeId}",{themeId:f}),method:"DELETE"})}catch(u){ee.error("theming: Unable to apply setting.",{error:u});let z=d("theming","Unable to apply the setting.");ze(u)&&u.response?.data.ocs?.meta?.message&&(z=`${u.response.data.ocs.meta.message}. ${z}`),X(z)}}return(l,f)=>(c(),S(F,null,[I(n(W),{name:n(d)("theming","Appearance and accessibility settings"),class:"theming"},{default:w(()=>[m("p",{innerHTML:n($)},null,8,Zt),m("p",{innerHTML:n(P)},null,8,Jt),m("div",Qt,[(c(!0),S(F,null,ne(s.value,u=>(c(),_(de,{key:u.id,enforced:u.id===n(e),selected:h.value.id===u.id,theme:u,unique:s.value.length===1,type:"theme","onUpdate:selected":z=>y(u.id,z)},null,8,["enforced","selected","theme","unique","onUpdate:selected"]))),128))]),m("div",Yt,[(c(!0),S(F,null,ne(o.value,u=>(c(),_(de,{key:u.id,selected:u.enabled,theme:u,unique:o.value.length===1,type:"font","onUpdate:selected":z=>A(u.id,z)},null,8,["selected","theme","unique","onUpdate:selected"]))),128))]),m("h3",null,v(n(d)("theming","Misc accessibility options")),1),I(n(le),{type:"checkbox","model-value":r.value==="yes",indeterminate:r.value==="","onUpdate:modelValue":b},{default:w(()=>[L(v(n(d)("theming","Enable blur background filter (may increase GPU load)")),1)]),_:1},8,["model-value","indeterminate"])]),_:1},8,["name"]),n(a)?(c(),_(n(ie),{key:0,type:"info"},{default:w(()=>[L(v(n(d)("theming","Customization has been disabled by your administrator")),1)]),_:1})):(c(),S(F,{key:1},[I(Gt,{ref:"primaryColor",onRefreshStyles:p},null,512),I(_t,{onRefreshStyles:p})],64)),I(kt),I(it)],64))}}),ea=D(Xt,[["__scopeId","data-v-c8069614"]]),ke=Le(ea);ke.config.idPrefix="settings",ke.mount("#settings-personal-theming");
//# sourceMappingURL=theming-settings-personal.mjs.map
