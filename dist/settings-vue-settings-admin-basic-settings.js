(()=>{"use strict";var e,o,n,a={41399(e,o,n){var a=n(21777),r=n(81222),s=n(53334),i=n(85471),l=n(19051),c=n(85168),d=n(51651),A=n(47176),u=n(63814),E=n(32073),g=n(371),p=n(88837);const b=(0,n(35947).YK)().setApp("settings").detectUser().build(),T=(0,r.C)("settings","lastCron"),m=(0,r.C)("settings","cronMaxAge",""),I=(0,r.C)("settings","backgroundJobsMode","cron"),v=(0,r.C)("settings","cliBasedCronPossible",!0),h=(0,r.C)("settings","cliBasedCronUser","www-data"),f=(0,r.C)("settings","backgroundJobsDocUrl"),O={name:"BackgroundJob",components:{NcCheckboxRadioSwitch:E.A,NcSettingsSection:p.A,NcNoteCard:g.A},data:()=>({lastCron:T,cronMaxAge:m,backgroundJobsMode:I,cliBasedCronPossible:v,cliBasedCronUser:h,backgroundJobsDocUrl:f,relativeTime:(0,d.A)(1e3*T).fromNow(),maxAgeRelativeTime:(0,d.A)(1e3*m).fromNow()}),computed:{cronLabel(){let e=t("settings","Use system cron service to call the cron.php file every 5 minutes.");return this.cliBasedCronPossible?e+="<br>"+t("settings",'The cron.php needs to be executed by the system account "{user}".',{user:this.cliBasedCronUser}):e+="<br>"+t("settings","The PHP POSIX extension is required. See {linkstart}PHP documentation{linkend} for more details.",{linkstart:'<a target="_blank" rel="noreferrer nofollow" class="external" href="https://www.php.net/manual/en/book.posix.php">',linkend:"</a>"},void 0,{escape:!1}),e},oldExecution(){return Date.now()/1e3-this.lastCron>600},longExecutionNotCron(){return Date.now()/1e3-this.cronMaxAge>43200&&"cron"!==this.backgroundJobsMode},longExecutionCron(){return Date.now()/1e3-this.cronMaxAge>86400&&"cron"===this.backgroundJobsMode}},methods:{async onBackgroundJobModeChanged(e){const o=(0,u.KT)("/apps/provisioning_api/api/v1/config/apps/{appId}/{key}",{appId:"core",key:"backgroundjobs_mode"});await(0,A.C5)();try{const{data:t}=await l.Ay.post(o,{value:e});this.handleResponse({status:t.ocs?.meta?.status})}catch(e){this.handleResponse({errorMessage:t("settings","Unable to update background job mode"),error:e})}},async handleResponse({status:e,errorMessage:t,error:o}){"ok"===e?await this.deleteError():((0,c.Qg)(t),b.error(t,o))},async deleteError(){const e=(0,u.KT)("/apps/provisioning_api/api/v1/config/apps/{appId}/{key}",{appId:"core",key:"cronErrors"});await(0,A.C5)();try{await l.Ay.delete(e)}catch(e){b.error(e)}}}},L=O;var C=n(85072),R=n.n(C),N=n(97825),y=n.n(N),P=n(77659),S=n.n(P),_=n(55056),D=n.n(_),k=n(10540),B=n.n(k),w=n(41113),x=n.n(w),M=n(24626),V={};V.styleTagTransform=x(),V.setAttributes=D(),V.insert=S().bind(null,"head"),V.domAPI=y(),V.insertStyleElement=B(),R()(M.A,V),M.A&&M.A.locals&&M.A.locals;var H=n(14486);const j=(0,H.A)(L,function(){var e=this,t=e._self._c;return t("NcSettingsSection",{attrs:{name:e.t("settings","Background jobs"),description:e.t("settings","For the server to work properly, it's important to configure background jobs correctly. Cron is the recommended setting. Please see the documentation for more information."),"doc-url":e.backgroundJobsDocUrl}},[0!==e.lastCron?[e.oldExecution?t("NcNoteCard",{attrs:{type:"error"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Last job execution ran {time}. Something seems wrong.",{time:e.relativeTime}))+"\n\t\t")]):e.longExecutionCron?t("NcNoteCard",{attrs:{type:"warning"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Some jobs have not been executed since {maxAgeRelativeTime}. Please consider increasing the execution frequency.",{maxAgeRelativeTime:e.maxAgeRelativeTime}))+"\n\t\t")]):e.longExecutionNotCron?t("NcNoteCard",{attrs:{type:"warning"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Some jobs have not been executed since {maxAgeRelativeTime}. Please consider switching to system cron.",{maxAgeRelativeTime:e.maxAgeRelativeTime}))+"\n\t\t")]):t("NcNoteCard",{attrs:{type:"success"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Last job ran {relativeTime}.",{relativeTime:e.relativeTime}))+"\n\t\t")])]:t("NcNoteCard",{attrs:{type:"error"}},[e._v("\n\t\t"+e._s(e.t("settings","Background job did not run yet!"))+"\n\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{staticClass:"ajaxSwitch",attrs:{type:"radio",name:"backgroundJobsMode",value:"ajax"},on:{"update:modelValue":e.onBackgroundJobModeChanged},model:{value:e.backgroundJobsMode,callback:function(t){e.backgroundJobsMode=t},expression:"backgroundJobsMode"}},[e._v("\n\t\t"+e._s(e.t("settings","AJAX"))+"\n\t")]),e._v(" "),t("em",[e._v(e._s(e.t("settings","Execute one task with each page loaded. Use case: Single account instance.")))]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"radio",name:"backgroundJobsMode",value:"webcron"},on:{"update:modelValue":e.onBackgroundJobModeChanged},model:{value:e.backgroundJobsMode,callback:function(t){e.backgroundJobsMode=t},expression:"backgroundJobsMode"}},[e._v("\n\t\t"+e._s(e.t("settings","Webcron"))+"\n\t")]),e._v(" "),t("em",[e._v(e._s(e.t("settings","cron.php is registered at a webcron service to call cron.php every 5 minutes over HTTP. Use case: Very small instance (1â€“5 accounts depending on the usage).")))]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"radio",disabled:!e.cliBasedCronPossible,value:"cron",name:"backgroundJobsMode"},on:{"update:modelValue":e.onBackgroundJobModeChanged},model:{value:e.backgroundJobsMode,callback:function(t){e.backgroundJobsMode=t},expression:"backgroundJobsMode"}},[e._v("\n\t\t"+e._s(e.t("settings","Cron (Recommended)"))+"\n\t")]),e._v(" "),t("em",{domProps:{innerHTML:e._s(e.cronLabel)}})],2)},[],!1,null,"2a5d4224",null).exports;var F=n(9165);const U=Object.freeze({ADDRESS:"address",AVATAR:"avatar",BIOGRAPHY:"biography",BIRTHDATE:"birthdate",DISPLAYNAME:"displayname",EMAIL_COLLECTION:"additional_mail",EMAIL:"email",FEDIVERSE:"fediverse",HEADLINE:"headline",NOTIFICATION_EMAIL:"notify_email",ORGANISATION:"organisation",PHONE:"phone",PROFILE_ENABLED:"profile_enabled",PRONOUNS:"pronouns",ROLE:"role",TWITTER:"twitter",BLUESKY:"bluesky",WEBSITE:"website"}),Y=Object.freeze({ADDRESS:(0,s.Tl)("settings","Location"),AVATAR:(0,s.Tl)("settings","Profile picture"),BIOGRAPHY:(0,s.Tl)("settings","About"),BIRTHDATE:(0,s.Tl)("settings","Date of birth"),DISPLAYNAME:(0,s.Tl)("settings","Full name"),EMAIL_COLLECTION:(0,s.Tl)("settings","Additional email"),EMAIL:(0,s.Tl)("settings","Email"),FEDIVERSE:(0,s.Tl)("settings","Fediverse (e.g. Mastodon)"),HEADLINE:(0,s.Tl)("settings","Headline"),ORGANISATION:(0,s.Tl)("settings","Organisation"),PHONE:(0,s.Tl)("settings","Phone number"),PROFILE_ENABLED:(0,s.Tl)("settings","Profile"),PRONOUNS:(0,s.Tl)("settings","Pronouns"),ROLE:(0,s.Tl)("settings","Role"),TWITTER:(0,s.Tl)("settings","X (formerly Twitter)"),BLUESKY:(0,s.Tl)("settings","Bluesky"),WEBSITE:(0,s.Tl)("settings","Website")});var J,G;Object.freeze({[U.ADDRESS]:Y.ADDRESS,[U.AVATAR]:Y.AVATAR,[U.BIOGRAPHY]:Y.BIOGRAPHY,[U.DISPLAYNAME]:Y.DISPLAYNAME,[U.EMAIL_COLLECTION]:Y.EMAIL_COLLECTION,[U.EMAIL]:Y.EMAIL,[U.HEADLINE]:Y.HEADLINE,[U.ORGANISATION]:Y.ORGANISATION,[U.PHONE]:Y.PHONE,[U.PROFILE_ENABLED]:Y.PROFILE_ENABLED,[U.ROLE]:Y.ROLE,[U.TWITTER]:Y.TWITTER,[U.BLUESKY]:Y.BLUESKY,[U.FEDIVERSE]:Y.FEDIVERSE,[U.WEBSITE]:Y.WEBSITE,[U.BIRTHDATE]:Y.BIRTHDATE,[U.PRONOUNS]:Y.PRONOUNS}),Object.freeze({PROFILE_VISIBILITY:(0,s.Tl)("settings","Profile visibility")}),Object.freeze({[Y.ADDRESS]:U.ADDRESS,[Y.AVATAR]:U.AVATAR,[Y.BIOGRAPHY]:U.BIOGRAPHY,[Y.DISPLAYNAME]:U.DISPLAYNAME,[Y.EMAIL_COLLECTION]:U.EMAIL_COLLECTION,[Y.EMAIL]:U.EMAIL,[Y.HEADLINE]:U.HEADLINE,[Y.ORGANISATION]:U.ORGANISATION,[Y.PHONE]:U.PHONE,[Y.PROFILE_ENABLED]:U.PROFILE_ENABLED,[Y.ROLE]:U.ROLE,[Y.TWITTER]:U.TWITTER,[Y.BLUESKY]:U.BLUESKY,[Y.FEDIVERSE]:U.FEDIVERSE,[Y.WEBSITE]:U.WEBSITE,[Y.BIRTHDATE]:U.BIRTHDATE,[Y.PRONOUNS]:U.PRONOUNS}),Object.freeze({LANGUAGE:"language",LOCALE:"locale",FIRST_DAY_OF_WEEK:"first_day_of_week",TIMEZONE:"timezone"}),Object.freeze({LANGUAGE:(0,s.Tl)("settings","Language"),LOCALE:(0,s.Tl)("settings","Locale"),FIRST_DAY_OF_WEEK:(0,s.Tl)("settings","First day of week"),TIMEZONE:(0,s.Tl)("settings","timezone")}),function(e){e.PRIVATE="v2-private",e.LOCAL="v2-local",e.FEDERATED="v2-federated",e.PUBLISHED="v2-published"}(J||(J={})),Object.freeze({[Y.ADDRESS]:[J.LOCAL,J.PRIVATE],[Y.AVATAR]:[J.LOCAL,J.PRIVATE],[Y.BIOGRAPHY]:[J.LOCAL,J.PRIVATE],[Y.DISPLAYNAME]:[J.LOCAL],[Y.EMAIL_COLLECTION]:[J.LOCAL],[Y.EMAIL]:[J.LOCAL],[Y.HEADLINE]:[J.LOCAL,J.PRIVATE],[Y.ORGANISATION]:[J.LOCAL,J.PRIVATE],[Y.PHONE]:[J.LOCAL,J.PRIVATE],[Y.PROFILE_ENABLED]:[J.LOCAL,J.PRIVATE],[Y.ROLE]:[J.LOCAL,J.PRIVATE],[Y.TWITTER]:[J.LOCAL,J.PRIVATE],[Y.BLUESKY]:[J.LOCAL,J.PRIVATE],[Y.FEDIVERSE]:[J.LOCAL,J.PRIVATE],[Y.WEBSITE]:[J.LOCAL,J.PRIVATE],[Y.BIRTHDATE]:[J.LOCAL,J.PRIVATE],[Y.PRONOUNS]:[J.LOCAL,J.PRIVATE]}),Object.freeze([Y.BIOGRAPHY,Y.HEADLINE,Y.ORGANISATION,Y.ROLE,Y.BIRTHDATE]),Object.freeze({[J.PRIVATE]:{name:J.PRIVATE,displayName:(0,s.Tl)("settings","Private"),tooltip:(0,s.Tl)("settings","Only visible to people matched via phone number integration through Talk on mobile"),tooltipDisabled:(0,s.Tl)("settings","Not available as this property is required for core functionality including file sharing and calendar invitations"),icon:F.vrq},[J.LOCAL]:{name:J.LOCAL,displayName:(0,s.Tl)("settings","Local"),tooltip:(0,s.Tl)("settings","Only visible to people on this instance and guests"),icon:F.uLB},[J.FEDERATED]:{name:J.FEDERATED,displayName:(0,s.Tl)("settings","Federated"),tooltip:(0,s.Tl)("settings","Only synchronize to trusted servers"),tooltipDisabled:(0,s.Tl)("settings","Not available as federation has been disabled for your account, contact your system administration if you have any questions"),icon:F.dgQ},[J.PUBLISHED]:{name:J.PUBLISHED,displayName:(0,s.Tl)("settings","Published"),tooltip:(0,s.Tl)("settings","Synchronize to trusted servers and the global and public address book"),tooltipDisabled:(0,s.Tl)("settings","Not available as publishing account specific data to the lookup server is not allowed, contact your system administration if you have any questions"),icon:F.zY6}}),J.LOCAL,function(e){e[e.NOT_VERIFIED=0]="NOT_VERIFIED",e[e.VERIFICATION_IN_PROGRESS=1]="VERIFICATION_IN_PROGRESS",e[e.VERIFIED=2]="VERIFIED"}(G||(G={}));const W=(0,r.C)("settings","profileEnabledByDefault",!0),z={name:"ProfileSettings",components:{NcCheckboxRadioSwitch:E.A},data:()=>({initialProfileEnabledByDefault:W}),methods:{async onProfileDefaultChange(e){"boolean"==typeof e&&await this.updateProfileDefault(e)},async updateProfileDefault(e){try{const t=await async function(e){e=e?"1":"0";const t=(0,u.KT)("/apps/provisioning_api/api/v1/config/apps/{appId}/{key}",{appId:"settings",key:"profile_enabled_by_default"});return await(0,A.C5)(),(await l.Ay.post(t,{value:e})).data}(e);this.handleResponse({isEnabled:e,status:t.ocs?.meta?.status})}catch(e){this.handleResponse({errorMessage:t("settings","Unable to update profile default setting"),error:e})}},handleResponse({isEnabled:e,status:t,errorMessage:o,error:n}){"ok"===t?this.initialProfileEnabledByDefault=e:((0,c.Qg)(o),b.error(o,n))}}},K=(0,H.A)(z,function(){var e=this,t=e._self._c;return t("div",{staticClass:"section",attrs:{id:"profile-settings"}},[t("h2",{staticClass:"inlineblock"},[e._v("\n\t\t"+e._s(e.t("settings","Profile"))+"\n\t")]),e._v(" "),t("p",{staticClass:"settings-hint"},[e._v("\n\t\t"+e._s(e.t("settings","Enable or disable profile by default for new accounts."))+"\n\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"switch"},on:{"update:modelValue":e.onProfileDefaultChange},model:{value:e.initialProfileEnabledByDefault,callback:function(t){e.initialProfileEnabledByDefault=t},expression:"initialProfileEnabledByDefault"}},[e._v("\n\t\t"+e._s(e.t("settings","Enable"))+"\n\t")])],1)},[],!1,null,null,null).exports;n.nc=(0,a.aV)();const q=(0,r.C)("settings","profileEnabledGlobally",!0);i.Ay.mixin({props:{logger:b},methods:{t:s.Tl}}),(new(i.Ay.extend(j))).$mount("#vue-admin-background-job"),q&&(new(i.Ay.extend(K))).$mount("#vue-admin-profile-settings")},24626(e,t,o){o.d(t,{A:()=>i});var n=o(71354),a=o.n(n),r=o(76314),s=o.n(r)()(a());s.push([e.id,".error[data-v-2a5d4224]{margin-top:8px;padding:5px;border-radius:var(--border-radius);color:var(--color-primary-element-text);background-color:var(--color-error);width:initial}.warning[data-v-2a5d4224]{margin-top:8px;padding:5px;border-radius:var(--border-radius);color:var(--color-primary-element-text);background-color:var(--color-warning);width:initial}.ajaxSwitch[data-v-2a5d4224]{margin-top:1rem}","",{version:3,sources:["webpack://./apps/settings/src/components/BasicSettings/BackgroundJob.vue"],names:[],mappings:"AACA,wBACC,cAAA,CACA,WAAA,CACA,kCAAA,CACA,uCAAA,CACA,mCAAA,CACA,aAAA,CAGD,0BACC,cAAA,CACA,WAAA,CACA,kCAAA,CACA,uCAAA,CACA,qCAAA,CACA,aAAA,CAGD,6BACC,eAAA",sourcesContent:["\n.error {\n\tmargin-top: 8px;\n\tpadding: 5px;\n\tborder-radius: var(--border-radius);\n\tcolor: var(--color-primary-element-text);\n\tbackground-color: var(--color-error);\n\twidth: initial;\n}\n\n.warning {\n\tmargin-top: 8px;\n\tpadding: 5px;\n\tborder-radius: var(--border-radius);\n\tcolor: var(--color-primary-element-text);\n\tbackground-color: var(--color-warning);\n\twidth: initial;\n}\n\n.ajaxSwitch {\n\tmargin-top: 1rem;\n}\n"],sourceRoot:""}]);const i=s}},r={};function s(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={id:e,loaded:!1,exports:{}};return a[e].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=a,e=[],s.O=(t,o,n,a)=>{if(!o){var r=1/0;for(d=0;d<e.length;d++){for(var[o,n,a]=e[d],i=!0,l=0;l<o.length;l++)(!1&a||r>=a)&&Object.keys(s.O).every(e=>s.O[e](o[l]))?o.splice(l--,1):(i=!1,a<r&&(r=a));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,n,a]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce((t,o)=>(s.f[o](e,t),t),[])),s.u=e=>e+"-"+e+".js?v="+{2710:"0319a4b5398392025378",4471:"9b3c8620f038b7593241",7004:"da5a822695a273d4d2eb",7394:"00400962a1291d103feb",7859:"449c6cbdb74832a2f6c7",8127:"8825f856581210b8af66",8453:"d4f76450bf0c442af291"}[e],s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},n="nextcloud-ui-legacy:",s.l=(e,t,a,r)=>{if(o[e])o[e].push(t);else{var i,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var A=c[d];if(A.getAttribute("src")==e||A.getAttribute("data-webpack")==n+a){i=A;break}}i||(l=!0,(i=document.createElement("script")).charset="utf-8",s.nc&&i.setAttribute("nonce",s.nc),i.setAttribute("data-webpack",n+a),i.src=e),o[e]=[t];var u=(t,n)=>{i.onerror=i.onload=null,clearTimeout(E);var a=o[e];if(delete o[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},E=setTimeout(u.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=u.bind(null,i.onerror),i.onload=u.bind(null,i.onload),l&&document.head.appendChild(i)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=6282,(()=>{var e;globalThis.importScripts&&(e=globalThis.location+"");var t=globalThis.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var n=o.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=o[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b="undefined"!=typeof document&&document.baseURI||self.location.href;var e={6282:0};s.f.j=(t,o)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var a=new Promise((o,a)=>n=e[t]=[o,a]);o.push(n[2]=a);var r=s.p+s.u(t),i=new Error;s.l(r,o=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+a+": "+r+")",i.name="ChunkLoadError",i.type=a,i.request=r,n[1](i)}},"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[r,i,l]=o,c=0;if(r.some(t=>0!==e[t])){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var d=l(s)}for(t&&t(o);c<r.length;c++)a=r[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(d)},o=globalThis.webpackChunknextcloud_ui_legacy=globalThis.webpackChunknextcloud_ui_legacy||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),s.nc=void 0;var i=s.O(void 0,[4208],()=>s(41399));i=s.O(i)})();
//# sourceMappingURL=settings-vue-settings-admin-basic-settings.js.map?v=36e70e11fd2d466d6cbb