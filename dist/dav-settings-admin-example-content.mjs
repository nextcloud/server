import{n as e}from"./rolldown-runtime-DiYpF8Fr.chunk.mjs";import{Dp as t,Hp as n,Op as r,Qm as i,Up as a,t as o}from"./common-F8F-l6RK.chunk.mjs";import{W as s}from"./common-BPS_5DGx.chunk.mjs";import{P as c}from"./common-ClkJEDcz.chunk.mjs";import{$ as l,J as u,Nt as d,St as f,X as p,Y as m,et as h,gt as g,nt as _,q as v,ut as y,xt as b}from"./common-BTwnNXu7.chunk.mjs";import{g as x}from"./common-DggTXc-f.chunk.mjs";import{Li as S,Ni as ee,Ri as te,gi as C,wr as w}from"./common-yxKQvbqc.chunk.mjs";import{h as T}from"./common-CTJeoPPu.chunk.mjs";import{Y as E,n as D}from"./common-JQNqxhkS.chunk.mjs";import{K as O,U as k}from"./common-BlapdzXl.chunk.mjs";import{tt as A}from"./common-Dt_qWDSk.chunk.mjs";import{n as j,r as M}from"./common-BT_nQ5jL.chunk.mjs";import{n as N,t as ne}from"./logger-dBasxgGw.chunk.mjs";var P,re=e((()=>{P=`<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cancel" viewBox="0 0 24 24"><path d="M12 2C17.5 2 22 6.5 22 12S17.5 22 12 22 2 17.5 2 12 6.5 2 12 2M12 4C10.1 4 8.4 4.6 7.1 5.7L18.3 16.9C19.3 15.5 20 13.8 20 12C20 7.6 16.4 4 12 4M16.9 18.3L5.7 7.1C4.6 8.4 4 10.1 4 12C4 16.4 7.6 20 12 20C13.9 20 15.6 19.4 16.9 18.3Z" /></svg>`})),F,ie=e((()=>{F=`<svg xmlns="http://www.w3.org/2000/svg" id="mdi-check" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>`}));function ae(e,t,n,r,i,a){return g(),p(`span`,y(e.$attrs,{"aria-hidden":n.title?null:`true`,"aria-label":n.title,class:`material-design-icon account-icon`,role:`img`,onClick:t[0]||=t=>e.$emit(`click`,t)}),[(g(),p(`svg`,{fill:n.fillColor,class:`material-design-icon__svg`,width:n.size,height:n.size,viewBox:`0 0 24 24`},[v(`path`,z,[n.title?(g(),p(`title`,B,s(n.title),1)):m(``,!0)])],8,R))],16,L)}var I,L,R,z,B,V,oe=e((()=>{i(),r(),I={name:`AccountIcon`,emits:[`click`],props:{title:{type:String},fillColor:{type:String,default:`currentColor`},size:{type:Number,default:24}}},L=[`aria-hidden`,`aria-label`],R=[`fill`,`width`,`height`],z={d:`M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z`},B={key:0},V=t(I,[[`render`,ae]])}));function se(e,t,n,r,i,a){return g(),p(`span`,y(e.$attrs,{"aria-hidden":n.title?null:`true`,"aria-label":n.title,class:`material-design-icon restore-icon`,role:`img`,onClick:t[0]||=t=>e.$emit(`click`,t)}),[(g(),p(`svg`,{fill:n.fillColor,class:`material-design-icon__svg`,width:n.size,height:n.size,viewBox:`0 0 24 24`},[v(`path`,G,[n.title?(g(),p(`title`,K,s(n.title),1)):m(``,!0)])],8,W))],16,U)}var H,U,W,G,K,q,J=e((()=>{i(),r(),H={name:`RestoreIcon`,emits:[`click`],props:{title:{type:String},fillColor:{type:String,default:`currentColor`},size:{type:Number,default:24}}},U=[`aria-hidden`,`aria-label`],W=[`fill`,`width`,`height`],G={d:`M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z`},K={key:0},q=t(H,[[`render`,se]])}));function ce(e,t,n,r,i,a){return g(),p(`span`,y(e.$attrs,{"aria-hidden":n.title?null:`true`,"aria-label":n.title,class:`material-design-icon tray-arrow-up-icon`,role:`img`,onClick:t[0]||=t=>e.$emit(`click`,t)}),[(g(),p(`svg`,{fill:n.fillColor,class:`material-design-icon__svg`,width:n.size,height:n.size,viewBox:`0 0 24 24`},[v(`path`,le,[n.title?(g(),p(`title`,ue,s(n.title),1)):m(``,!0)])],8,Z))],16,X)}var Y,X,Z,le,ue,Q,de=e((()=>{i(),r(),Y={name:`TrayArrowUpIcon`,emits:[`click`],props:{title:{type:String},fillColor:{type:String,default:`currentColor`},size:{type:Number,default:24}}},X=[`aria-hidden`,`aria-label`],Z=[`fill`,`width`,`height`],le={d:`M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 2L6.46 7.46L7.88 8.88L11 5.75V15H13V5.75L16.13 8.88L17.55 7.45L12 2Z`},ue={key:0},Q=t(Y,[[`render`,ce]])}));function fe(e,t,n,r,i,a){return g(),p(`span`,y(e.$attrs,{"aria-hidden":n.title?null:`true`,"aria-label":n.title,class:`material-design-icon tray-arrow-down-icon`,role:`img`,onClick:t[0]||=t=>e.$emit(`click`,t)}),[(g(),p(`svg`,{fill:n.fillColor,class:`material-design-icon__svg`,width:n.size,height:n.size,viewBox:`0 0 24 24`},[v(`path`,ge,[n.title?(g(),p(`title`,_e,s(n.title),1)):m(``,!0)])],8,he))],16,me)}var pe,me,he,ge,_e,ve,ye=e((()=>{i(),r(),pe={name:`TrayArrowDownIcon`,emits:[`click`],props:{title:{type:String},fillColor:{type:String,default:`currentColor`},size:{type:Number,default:24}}},me=[`aria-hidden`,`aria-label`],he=[`fill`,`width`,`height`],ge={d:`M2 12H4V17H20V12H22V17C22 18.11 21.11 19 20 19H4C2.9 19 2 18.11 2 17V12M12 15L17.55 9.54L16.13 8.13L13 11.25V2H11V11.25L7.88 8.13L6.46 9.55L12 15Z`},_e={key:0},ve=t(pe,[[`render`,fe]])})),be,xe,Se,Ce=e((()=>{i(),D(),ye(),be={class:`download-button`},xe={class:`download-button__label`},Se=_({__name:`ExampleContentDownloadButton`,props:{href:{}},setup(e){return(t,n)=>(g(),u(c(C),{variant:`tertiary`,href:e.href},{icon:d(()=>[b(t.$slots,`icon`,{},void 0,!0)]),default:d(()=>[v(`div`,be,[v(`span`,xe,[b(t.$slots,`default`,{},void 0,!0)]),h(ve,{class:`download-button__icon`,size:20})])]),_:3},8,[`href`]))}})})),we=e((()=>{})),$,Te=e((()=>{Ce(),Ce(),we(),r(),$=t(Se,[[`__scopeId`,`data-v-be40807a`]])})),Ee=e((()=>{}));function De(e,t,n,r,i,a){let o=f(`NcCheckboxRadioSwitch`),c=f(`IconAccount`),_=f(`ExampleContentDownloadButton`),y=f(`IconUpload`),b=f(`NcButton`),x=f(`IconRestore`),S=f(`NcDialog`);return g(),p(`div`,je,[h(o,{checked:i.enableDefaultContact,type:`switch`,"onUpdate:modelValue":a.updateEnableDefaultContact},{default:d(()=>[l(s(r.t(`dav`,`Add example contact to user's address book when they first log in`)),1)]),_:1},8,[`checked`,`onUpdate:modelValue`]),i.enableDefaultContact?(g(),p(`div`,Me,[h(_,{href:a.downloadUrl},{icon:d(()=>[h(c,{size:20})]),default:d(()=>[t[2]||=l(` example_contact.vcf `,-1)]),_:1},8,[`href`]),h(b,{variant:`secondary`,onClick:a.toggleModal},{icon:d(()=>[h(y,{size:20})]),default:d(()=>[l(` `+s(r.t(`dav`,`Import contact`)),1)]),_:1},8,[`onClick`]),i.hasCustomDefaultContact?(g(),u(b,{key:0,variant:`tertiary`,onClick:a.resetContact},{icon:d(()=>[h(x,{size:20})]),default:d(()=>[l(` `+s(r.t(`dav`,`Reset to default`)),1)]),_:1},8,[`onClick`])):m(``,!0)])):m(``,!0),h(S,{open:i.isModalOpen,"onUpdate:open":t[0]||=e=>i.isModalOpen=e,name:r.t(`dav`,`Import contacts`),buttons:i.buttons},{default:d(()=>[v(`div`,null,[v(`p`,null,s(r.t(`dav`,`Importing a new .vcf file will delete the existing default contact and replace it with the new one. Do you want to continue?`)),1)])]),_:1},8,[`open`,`name`,`buttons`]),v(`input`,{id:`example-contact-import`,ref:`exampleContactImportInput`,disabled:i.loading,type:`file`,accept:`.vcf`,class:`hidden-visually`,onChange:t[1]||=(...e)=>a.processFile&&a.processFile(...e)},null,40,Ne)])}var Oe,ke,Ae,je,Me,Ne,Pe,Fe=e((()=>{re(),ie(),te(),o(),n(),T(),O(),D(),oe(),J(),de(),Te(),ne(),i(),Ee(),r(),Oe=a(`dav`,`enableDefaultContact`,!1),ke=a(`dav`,`hasCustomDefaultContact`,!1),Ae={name:`ExampleContactSettings`,components:{NcDialog:w,NcButton:C,NcCheckboxRadioSwitch:A,IconUpload:Q,IconRestore:q,IconAccount:V,ExampleContentDownloadButton:$},setup(){return{t:E}},data(){return{enableDefaultContact:Oe,hasCustomDefaultContact:ke,isModalOpen:!1,loading:!1,buttons:[{label:E(`dav`,`Cancel`),icon:P,callback:()=>{this.isModalOpen=!1}},{label:E(`dav`,`Import`),icon:F,variant:`primary`,callback:()=>{this.clickImportInput()}}]}},computed:{downloadUrl(){return k(`/apps/dav/api/defaultcontact/contact`)}},methods:{updateEnableDefaultContact(){S.put(k(`apps/dav/api/defaultcontact/config`),{allow:!this.enableDefaultContact}).then(()=>{this.enableDefaultContact=!this.enableDefaultContact}).catch(()=>{j(E(`dav`,`Error while saving settings`))})},toggleModal(){this.isModalOpen=!this.isModalOpen},clickImportInput(){this.$refs.exampleContactImportInput.click()},resetContact(){this.loading=!0,S.put(k(`/apps/dav/api/defaultcontact/contact`)).then(()=>{this.hasCustomDefaultContact=!1,M(E(`dav`,`Contact reset successfully`))}).catch(e=>{N.error(`Error importing contact:`,{error:e}),j(E(`dav`,`Error while resetting contact`))}).finally(()=>{this.loading=!1})},processFile(e){this.loading=!0;let t=e.target.files[0],n=new FileReader;n.onload=async()=>{this.isModalOpen=!1;try{await S.put(k(`/apps/dav/api/defaultcontact/contact`),{contactData:n.result}),this.hasCustomDefaultContact=!0,M(E(`dav`,`Contact imported successfully`))}catch(e){N.error(`Error importing contact:`,{error:e}),j(E(`dav`,`Error while importing contact`))}finally{this.loading=!1,e.target.value=``}},n.readAsText(t)}}},je={class:`example-contact-settings`},Me={key:0,class:`example-contact-settings__buttons`},Ne=[`disabled`],Pe=t(Ae,[[`render`,De],[`__scopeId`,`data-v-cd78f96d`]])}));function Ie(e,t,n,r,i,a){return g(),p(`span`,y(e.$attrs,{"aria-hidden":n.title?null:`true`,"aria-label":n.title,class:`material-design-icon calendar-blank-icon`,role:`img`,onClick:t[0]||=t=>e.$emit(`click`,t)}),[(g(),p(`svg`,{fill:n.fillColor,class:`material-design-icon__svg`,width:n.size,height:n.size,viewBox:`0 0 24 24`},[v(`path`,Be,[n.title?(g(),p(`title`,Ve,s(n.title),1)):m(``,!0)])],8,ze))],16,Re)}var Le,Re,ze,Be,Ve,He,Ue=e((()=>{i(),r(),Le={name:`CalendarBlankIcon`,emits:[`click`],props:{title:{type:String},fillColor:{type:String,default:`currentColor`},size:{type:Number,default:24}}},Re=[`aria-hidden`,`aria-label`],ze=[`fill`,`width`,`height`],Be={d:`M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1`},Ve={key:0},He=t(Le,[[`render`,Ie]])}));async function We(e){let t=k(`/apps/dav/api/exampleEvent/enable`);await S.post(t,{enable:e})}async function Ge(e){let t=k(`/apps/dav/api/exampleEvent/event`);await S.post(t,{ics:e})}async function Ke(){let e=k(`/apps/dav/api/exampleEvent/event`);await S.delete(e)}var qe=e((()=>{te(),O()})),Je=e((()=>{}));function Ye(e,t,n,r,i,a){let o=f(`NcCheckboxRadioSwitch`),c=f(`IconCalendarBlank`),_=f(`ExampleContentDownloadButton`),y=f(`IconUpload`),b=f(`NcButton`),x=f(`IconRestore`),S=f(`NcDialog`);return g(),p(`div`,Ze,[h(o,{checked:i.createExampleEvent,disabled:i.savingConfig,type:`switch`,"onUpdate:modelValue":a.updateCreateExampleEvent},{default:d(()=>[l(s(r.t(`dav`,`Add example event to user's calendar when they first log in`)),1)]),_:1},8,[`checked`,`disabled`,`onUpdate:modelValue`]),i.createExampleEvent?(g(),p(`div`,Qe,[h(_,{href:a.downloadUrl},{icon:d(()=>[h(c,{size:20})]),default:d(()=>[t[4]||=l(` example_event.ics `,-1)]),_:1},8,[`href`]),h(b,{variant:`secondary`,onClick:t[0]||=e=>i.showImportModal=!0},{icon:d(()=>[h(y,{size:20})]),default:d(()=>[l(` `+s(r.t(`dav`,`Import calendar event`)),1)]),_:1}),i.hasCustomEvent?(g(),u(b,{key:0,variant:`tertiary`,disabled:i.deleting,onClick:a.deleteCustomEvent},{icon:d(()=>[h(x,{size:20})]),default:d(()=>[l(` `+s(r.t(`dav`,`Reset to default`)),1)]),_:1},8,[`disabled`,`onClick`])):m(``,!0)])):m(``,!0),h(S,{open:i.showImportModal,"onUpdate:open":t[3]||=e=>i.showImportModal=e,name:r.t(`dav`,`Import calendar event`)},{default:d(()=>[v(`div`,$e,[v(`p`,null,s(r.t(`dav`,`Uploading a new event will overwrite the existing one.`)),1),v(`input`,{ref:`event-file`,disabled:i.uploading,type:`file`,accept:`.ics,text/calendar`,class:`import-event-modal__file-picker`,onChange:t[1]||=(...e)=>a.selectFile&&a.selectFile(...e)},null,40,et),v(`div`,tt,[h(b,{disabled:i.uploading||!i.selectedFile,variant:`primary`,onClick:t[2]||=e=>a.uploadCustomEvent()},{icon:d(()=>[h(y,{size:20})]),default:d(()=>[l(` `+s(r.t(`dav`,`Upload event`)),1)]),_:1},8,[`disabled`])])])]),_:1},8,[`open`,`name`])])}var Xe,Ze,Qe,$e,et,tt,nt,rt=e((()=>{o(),n(),T(),O(),D(),Ue(),J(),de(),Te(),qe(),ne(),i(),Je(),r(),Xe={name:`ExampleEventSettings`,components:{NcButton:C,NcCheckboxRadioSwitch:A,NcDialog:w,IconCalendarBlank:He,IconUpload:Q,IconRestore:q,ExampleContentDownloadButton:$},setup(){return{t:E}},data(){return{createExampleEvent:a(`dav`,`create_example_event`,!1),hasCustomEvent:a(`dav`,`has_custom_example_event`,!1),showImportModal:!1,uploading:!1,deleting:!1,savingConfig:!1,selectedFile:void 0}},computed:{downloadUrl(){return k(`/apps/dav/api/exampleEvent/event`)}},methods:{selectFile(){this.selectedFile=this.$refs[`event-file`]?.files[0]},async updateCreateExampleEvent(){this.savingConfig=!0;let e=!this.createExampleEvent;try{await We(e)}catch(t){j(E(`dav`,`Failed to save example event creation setting`)),N.error(`Failed to save example event creation setting`,{error:t,enable:e})}finally{this.savingConfig=!1}this.createExampleEvent=e},uploadCustomEvent(){if(!this.selectedFile)return;this.uploading=!0;let e=new FileReader;e.addEventListener(`load`,async()=>{let t=e.result;try{await Ge(t)}catch(e){j(E(`dav`,`Failed to upload the example event`)),N.error(`Failed to upload example ICS`,{error:e,ics:t});return}finally{this.uploading=!1}M(E(`dav`,`Custom example event was saved successfully`)),this.showImportModal=!1,this.hasCustomEvent=!0}),e.readAsText(this.selectedFile)},async deleteCustomEvent(){this.deleting=!0;try{await Ke()}catch(e){j(E(`dav`,`Failed to delete the custom example event`)),N.error(`Failed to delete the custom example event`,{error:e});return}finally{this.deleting=!1}M(E(`dav`,`Custom example event was deleted successfully`)),this.hasCustomEvent=!1}}},Ze={class:`example-event-settings`},Qe={key:0,class:`example-event-settings__buttons`},$e={class:`import-event-modal`},et=[`disabled`],tt={class:`import-event-modal__buttons`},nt=t(Xe,[[`render`,Ye],[`__scopeId`,`data-v-6e8ec0f6`]])})),it,at=e((()=>{i(),n(),T(),D(),Fe(),rt(),it=_({__name:`ExampleContentSettingsSection`,setup(e){let t=a(`dav`,`contactsEnabled`),n=a(`dav`,`calendarEnabled`);return(e,r)=>(g(),u(c(ee),{id:`example-content`,name:c(E)(`dav`,`Example content`),description:c(E)(`dav`,`Example content serves to showcase the features of Nextcloud. Default content is shipped with Nextcloud, and can be replaced by custom content.`)},{default:d(()=>[c(t)?(g(),u(Pe,{key:0})):m(``,!0),c(n)?(g(),u(nt,{key:1})):m(``,!0)]),_:1},8,[`name`,`description`]))}})})),ot,st=e((()=>{at(),at(),ot=it}));e((()=>{i(),st(),x(ot).mount(`#settings-example-content`)}))();
//# sourceMappingURL=dav-settings-admin-example-content.mjs.map