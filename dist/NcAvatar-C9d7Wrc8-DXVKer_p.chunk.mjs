import{f as vt,a as R,u as W,s as F}from"./index-6_gsQFyp.chunk.mjs";import{c as ut}from"./index-zFO0wb5J.chunk.mjs";import{_ as ct,q as Y,k as bt,g as lt,r as St,s as _t,b as xt,a as G,N as At}from"./createElementId-DhjFt1I9-CRJVCjcq.chunk.mjs";import{j as A,o as b,k as j,m as ht,l as N,M as P,n as V,t as L,I as kt,p as X,r as wt,v as J,a3 as Ut,a2 as w,u as Lt,b as Mt,a6 as It,f as M,a7 as Nt,E as Ct,c as I,w as D,y as tt,e as et,F as Dt,C as Et,J as Ot,z as $t,g as jt}from"./runtime-dom.esm-bundler-nUg13ekW.chunk.mjs";import{d as Pt,e as Tt,h as K,i as zt,j as Bt,a as Wt,I as Ft}from"./index-7g--DU3C.chunk.mjs";import{l as T,N as Gt}from"./logger-D3RVzcfQ-B4GxPQ5t.chunk.mjs";import{g as Ht}from"./colors-BHGKZFDI-_xZPp21x.chunk.mjs";import"./translation-DoG5ZELJ-2ffMJaM4.chunk.mjs";import{g as qt}from"./index-Ma7sfat2.chunk.mjs";import{N as Zt,g as Rt}from"./NcUserStatusIcon-XiwrgeCm-CWELJm_n.chunk.mjs";import{a as Vt,N as Jt}from"./PencilOutline-DTERglfp.chunk.mjs";import{a as Kt,N as Qt}from"./NcDateTime.vue_vue_type_script_setup_true_lang-BhB8yA4U-Ti3vqDZ2.chunk.mjs";import{N as Xt}from"./mdi-DK5BPbEO.chunk.mjs";const Yt={name:"NcActionText",mixins:[Vt],inject:{isInSemanticMenu:{from:Pt,default:!1}}},te=["role"],ee={key:0,class:"action-text__longtext-wrapper"},se={class:"action-text__name"},ne=["textContent"],ae=["textContent"],re={key:2,class:"action-text__text"};function ie(i,r,n,s,t,e){return b(),A("li",{class:"action",role:e.isInSemanticMenu&&"presentation"},[j("span",{class:"action-text",onClick:r[0]||(r[0]=(...a)=>i.onClick&&i.onClick(...a))},[ht(i.$slots,"icon",{},()=>[i.icon!==""?(b(),A("span",{key:0,"aria-hidden":"true",class:V(["action-text__icon",[i.isIconUrl?"action-text__icon--url":i.icon]]),style:P({backgroundImage:i.isIconUrl?`url(${i.icon})`:null})},null,6)):N("",!0)],!0),i.name?(b(),A("span",ee,[j("strong",se,L(i.name),1),j("span",{class:"action-text__longtext",textContent:L(i.text)},null,8,ne)])):i.isLongText?(b(),A("span",{key:1,class:"action-text__longtext",textContent:L(i.text)},null,8,ae)):(b(),A("span",re,L(i.text),1)),N("",!0)])],8,te)}const oe=ct(Yt,[["render",ie],["__scopeId","data-v-fa684b48"]]),ue=Symbol.for("nc:theme:enforced");function ce(i){const r=X(()=>w(i)??document.body),n=wt(K(r.value)),s=Bt();function t(){n.value=K(r.value)}return zt(r,t,{attributes:!0}),J(r,t),J(s,t,{immediate:!0}),Ut(n)}const le=Tt(()=>ce());function he(){const i=le(),r=kt(ue,void 0);return X(()=>r?.value?r.value==="dark":i.value)}const de=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const fe=Object.prototype.toString,pe=i=>fe.call(i)==="[object Object]",O=()=>{};function H(i){return Array.isArray(i)?i:[i]}function ge(i,r,n){return J(i,r,{...n,immediate:!0})}const dt=de?window:void 0;function E(i){var r;const n=w(i);return(r=n?.$el)!==null&&r!==void 0?r:n}function q(...i){const r=(s,t,e,a)=>(s.addEventListener(t,e,a),()=>s.removeEventListener(t,e,a)),n=X(()=>{const s=H(w(i[0])).filter(t=>t!=null);return s.every(t=>typeof t!="string")?s:void 0});return ge(()=>{var s,t;return[(s=(t=n.value)===null||t===void 0?void 0:t.map(e=>E(e)))!==null&&s!==void 0?s:[dt].filter(e=>e!=null),H(w(n.value?i[1]:i[0])),H(Lt(n.value?i[2]:i[1])),w(n.value?i[3]:i[2])]},([s,t,e,a],h,o)=>{if(!s?.length||!t?.length||!e?.length)return;const v=pe(a)?{...a}:a,p=s.flatMap(g=>t.flatMap(_=>e.map(f=>r(g,_,f,v))));o(()=>{p.forEach(g=>g())})},{flush:"post"})}function st(i,r,n={}){const{window:s=dt,ignore:t=[],capture:e=!0,detectIframe:a=!1,controls:h=!1}=n;if(!s)return h?{stop:O,cancel:O,trigger:O}:O;let o=!0;const v=u=>w(t).some(d=>{if(typeof d=="string")return Array.from(s.document.querySelectorAll(d)).some(m=>m===u.target||u.composedPath().includes(m));{const m=E(d);return m&&(u.target===m||u.composedPath().includes(m))}});function p(u){const d=w(u);return d&&d.$.subTree.shapeFlag===16}function g(u,d){const m=w(u),y=m.$.subTree&&m.$.subTree.children;return y==null||!Array.isArray(y)?!1:y.some(U=>U.el===d.target||d.composedPath().includes(U.el))}const _=u=>{const d=E(i);if(u.target!=null&&!(!(d instanceof Element)&&p(i)&&g(i,u))&&!(!d||d===u.target||u.composedPath().includes(d))){if("detail"in u&&u.detail===0&&(o=!v(u)),!o){o=!0;return}r(u)}};let f=!1;const l=[q(s,"click",u=>{f||(f=!0,setTimeout(()=>{f=!1},0),_(u))},{passive:!0,capture:e}),q(s,"pointerdown",u=>{const d=E(i);o=!v(u)&&!!(d&&!u.composedPath().includes(d))},{passive:!0}),a&&q(s,"blur",u=>{setTimeout(()=>{var d;const m=E(i);((d=s.document.activeElement)===null||d===void 0?void 0:d.tagName)==="IFRAME"&&!m?.contains(s.document.activeElement)&&r(u)},0)},{passive:!0})].filter(Boolean),c=()=>l.forEach(u=>u());return h?{stop:c,cancel:()=>{o=!1},trigger:u=>{o=!0,_(u),o=!1}}:c}const Z=new WeakMap,me={mounted(i,r){const n=!r.modifiers.bubble;let s;if(typeof r.value=="function")s=st(i,r.value,{capture:n});else{const[t,e]=r.value;s=st(i,t,Object.assign({capture:n},e))}Z.set(i,s)},unmounted(i){const r=Z.get(i);r&&typeof r=="function"?r():r?.stop(),Z.delete(i)}};function $(i,r,n){const s={type:String(i)};return n==null&&(typeof r=="string"||Array.isArray(r))?n=r:Object.assign(s,r),Array.isArray(n)?s.children=n:n!=null&&(s.value=String(n)),s}const ft=(function(i){if(i==null)return Se;if(typeof i=="function")return z(i);if(typeof i=="object")return Array.isArray(i)?ye(i):ve(i);if(typeof i=="string")return be(i);throw new Error("Expected function, string, or object as test")});function ye(i){const r=[];let n=-1;for(;++n<i.length;)r[n]=ft(i[n]);return z(s);function s(...t){let e=-1;for(;++e<r.length;)if(r[e].apply(this,t))return!0;return!1}}function ve(i){const r=i;return z(n);function n(s){const t=s;let e;for(e in i)if(t[e]!==r[e])return!1;return!0}}function be(i){return z(r);function r(n){return n&&n.type===i}}function z(i){return r;function r(n,s,t){return!!(_e(n)&&i.call(this,n,typeof s=="number"?s:void 0,t||void 0))}}function Se(){return!0}function _e(i){return i!==null&&typeof i=="object"&&"type"in i}const pt=[],xe=!0,nt=!1,gt="skip";function Ae(i,r,n,s){let t;typeof r=="function"&&typeof n!="function"?(s=n,n=r):t=r;const e=ft(t),a=s?-1:1;h(i,void 0,[])();function h(o,v,p){const g=o&&typeof o=="object"?o:{};if(typeof g.type=="string"){const f=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(_,"name",{value:"node ("+(o.type+(f?"<"+f+">":""))+")"})}return _;function _(){let f=pt,l,c,u;if((!r||e(o,v,p[p.length-1]||void 0))&&(f=ke(n(o,p)),f[0]===nt))return f;if("children"in o&&o.children){const d=o;if(d.children&&f[0]!==gt)for(c=(s?d.children.length:-1)+a,u=p.concat(d);c>-1&&c<d.children.length;){const m=d.children[c];if(l=h(m,c,u)(),l[0]===nt)return l;c=typeof l[1]=="number"?l[1]:c+a}}return f}}}function ke(i){return Array.isArray(i)?i:typeof i=="number"?[xe,i]:i==null?pt:[i]}function we(i,r,n,s){let t,e,a;typeof r=="function"&&typeof n!="function"?(e=void 0,a=r,t=n):(e=r,a=n,t=s),Ae(i,e,h,t);function h(o,v){const p=v[v.length-1],g=p?p.children.indexOf(o):void 0;return a(o,g,p)}}const es=/(\s|^)(https?:\/\/)([-A-Z0-9+_.]+(?::[0-9]+)?(?:\/[-A-Z0-9+&@#%?=~_|!:,.;()]*)*)(\s|$)/ig,at=/(\s|\(|^)((https?:\/\/)([-A-Z0-9+_.]+[-A-Z0-9]+(?::[0-9]+)?(?:\/[-A-Z0-9+&@#%?=~_|!:,.;()]*)*))(?=\s|\)|$)/ig,Ue=Mt({name:"NcLink",props:{href:{type:String,required:!0}},render(){return It("a",{href:this.href,rel:"noopener noreferrer",target:"_blank",class:"rich-text--external-link"},[this.href.trim()])}});function ss({autolink:i,useMarkdown:r,useExtendedMarkdown:n}){return function(s){n||!r||!i||we(s,t=>t.type==="text",(t,e,a)=>{let h=Le(t.value);return typeof h=="string"?h=[$("text",h)]:h=h.map(o=>typeof o=="string"?$("text",o):$("link",{url:o.props.href},[$("text",o.props.href)])).filter(o=>o).flat(),a.children.splice(e,1,...h),[gt,(e??0)+h.length]})}}function Le(i){let r=at.exec(i);const n=[];let s=0;for(;r!==null;){let e=r[2],a,h=i.substring(s,r.index+r[1].length);e[0]===" "&&(h+=e[0],e=e.substring(1).trim());const o=e[e.length-1];(o==="."||o===","||o===";"||r[0][0]==="("&&o===")")&&(e=e.substring(0,e.length-1),a=o),n.push(h),n.push({component:Ue,props:{href:e}}),a&&n.push(a),s=r.index+r[0].length,r=at.exec(i)}n.push(i.substring(s));const t=n.map(e=>typeof e=="string"?e:e.props.href).join("");return i===t?n:(T.error("[NcRichText] Failed to reassemble the chunked text: "+i),i)}function Me(i,r){const n=(p,g)=>p.startsWith(g)?p.slice(g.length):p,s=(p,...g)=>g.reduce((_,f)=>n(_,f),p);if(!i)return null;const t=/^https?:\/\//.test(r),e=/^[a-z][a-z0-9+.-]*:.+/.test(r);if(!t&&e||t&&!r.startsWith(Y())||!t&&!r.startsWith("/"))return null;const a=t?s(r,Y(),"/index.php"):r,h=s(i.options.history.base,bt(),"/index.php"),o=s(a,h)||"/",v=i.resolve(o);return v.matched.length?v.fullPath:null}function Ie(i){return window._nc_contacts_menu_hooks?Object.values(window._nc_contacts_menu_hooks).filter(r=>r.enabled(i)):[]}const Ne=new Int32Array(4);class S{static hashStr(r,n=!1){return this.onePassHasher.start().appendStr(r).end(n)}static hashAsciiStr(r,n=!1){return this.onePassHasher.start().appendAsciiStr(r).end(n)}static stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]);static buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);static hexChars="0123456789abcdef";static hexOut=[];static onePassHasher=new S;static _hex(r){const n=S.hexChars,s=S.hexOut;let t,e,a,h;for(h=0;h<4;h+=1)for(e=h*8,t=r[h],a=0;a<8;a+=2)s[e+1+a]=n.charAt(t&15),t>>>=4,s[e+0+a]=n.charAt(t&15),t>>>=4;return s.join("")}static _md5cycle(r,n){let s=r[0],t=r[1],e=r[2],a=r[3];s+=(t&e|~t&a)+n[0]-680876936|0,s=(s<<7|s>>>25)+t|0,a+=(s&t|~s&e)+n[1]-389564586|0,a=(a<<12|a>>>20)+s|0,e+=(a&s|~a&t)+n[2]+606105819|0,e=(e<<17|e>>>15)+a|0,t+=(e&a|~e&s)+n[3]-1044525330|0,t=(t<<22|t>>>10)+e|0,s+=(t&e|~t&a)+n[4]-176418897|0,s=(s<<7|s>>>25)+t|0,a+=(s&t|~s&e)+n[5]+1200080426|0,a=(a<<12|a>>>20)+s|0,e+=(a&s|~a&t)+n[6]-1473231341|0,e=(e<<17|e>>>15)+a|0,t+=(e&a|~e&s)+n[7]-45705983|0,t=(t<<22|t>>>10)+e|0,s+=(t&e|~t&a)+n[8]+1770035416|0,s=(s<<7|s>>>25)+t|0,a+=(s&t|~s&e)+n[9]-1958414417|0,a=(a<<12|a>>>20)+s|0,e+=(a&s|~a&t)+n[10]-42063|0,e=(e<<17|e>>>15)+a|0,t+=(e&a|~e&s)+n[11]-1990404162|0,t=(t<<22|t>>>10)+e|0,s+=(t&e|~t&a)+n[12]+1804603682|0,s=(s<<7|s>>>25)+t|0,a+=(s&t|~s&e)+n[13]-40341101|0,a=(a<<12|a>>>20)+s|0,e+=(a&s|~a&t)+n[14]-1502002290|0,e=(e<<17|e>>>15)+a|0,t+=(e&a|~e&s)+n[15]+1236535329|0,t=(t<<22|t>>>10)+e|0,s+=(t&a|e&~a)+n[1]-165796510|0,s=(s<<5|s>>>27)+t|0,a+=(s&e|t&~e)+n[6]-1069501632|0,a=(a<<9|a>>>23)+s|0,e+=(a&t|s&~t)+n[11]+643717713|0,e=(e<<14|e>>>18)+a|0,t+=(e&s|a&~s)+n[0]-373897302|0,t=(t<<20|t>>>12)+e|0,s+=(t&a|e&~a)+n[5]-701558691|0,s=(s<<5|s>>>27)+t|0,a+=(s&e|t&~e)+n[10]+38016083|0,a=(a<<9|a>>>23)+s|0,e+=(a&t|s&~t)+n[15]-660478335|0,e=(e<<14|e>>>18)+a|0,t+=(e&s|a&~s)+n[4]-405537848|0,t=(t<<20|t>>>12)+e|0,s+=(t&a|e&~a)+n[9]+568446438|0,s=(s<<5|s>>>27)+t|0,a+=(s&e|t&~e)+n[14]-1019803690|0,a=(a<<9|a>>>23)+s|0,e+=(a&t|s&~t)+n[3]-187363961|0,e=(e<<14|e>>>18)+a|0,t+=(e&s|a&~s)+n[8]+1163531501|0,t=(t<<20|t>>>12)+e|0,s+=(t&a|e&~a)+n[13]-1444681467|0,s=(s<<5|s>>>27)+t|0,a+=(s&e|t&~e)+n[2]-51403784|0,a=(a<<9|a>>>23)+s|0,e+=(a&t|s&~t)+n[7]+1735328473|0,e=(e<<14|e>>>18)+a|0,t+=(e&s|a&~s)+n[12]-1926607734|0,t=(t<<20|t>>>12)+e|0,s+=(t^e^a)+n[5]-378558|0,s=(s<<4|s>>>28)+t|0,a+=(s^t^e)+n[8]-2022574463|0,a=(a<<11|a>>>21)+s|0,e+=(a^s^t)+n[11]+1839030562|0,e=(e<<16|e>>>16)+a|0,t+=(e^a^s)+n[14]-35309556|0,t=(t<<23|t>>>9)+e|0,s+=(t^e^a)+n[1]-1530992060|0,s=(s<<4|s>>>28)+t|0,a+=(s^t^e)+n[4]+1272893353|0,a=(a<<11|a>>>21)+s|0,e+=(a^s^t)+n[7]-155497632|0,e=(e<<16|e>>>16)+a|0,t+=(e^a^s)+n[10]-1094730640|0,t=(t<<23|t>>>9)+e|0,s+=(t^e^a)+n[13]+681279174|0,s=(s<<4|s>>>28)+t|0,a+=(s^t^e)+n[0]-358537222|0,a=(a<<11|a>>>21)+s|0,e+=(a^s^t)+n[3]-722521979|0,e=(e<<16|e>>>16)+a|0,t+=(e^a^s)+n[6]+76029189|0,t=(t<<23|t>>>9)+e|0,s+=(t^e^a)+n[9]-640364487|0,s=(s<<4|s>>>28)+t|0,a+=(s^t^e)+n[12]-421815835|0,a=(a<<11|a>>>21)+s|0,e+=(a^s^t)+n[15]+530742520|0,e=(e<<16|e>>>16)+a|0,t+=(e^a^s)+n[2]-995338651|0,t=(t<<23|t>>>9)+e|0,s+=(e^(t|~a))+n[0]-198630844|0,s=(s<<6|s>>>26)+t|0,a+=(t^(s|~e))+n[7]+1126891415|0,a=(a<<10|a>>>22)+s|0,e+=(s^(a|~t))+n[14]-1416354905|0,e=(e<<15|e>>>17)+a|0,t+=(a^(e|~s))+n[5]-57434055|0,t=(t<<21|t>>>11)+e|0,s+=(e^(t|~a))+n[12]+1700485571|0,s=(s<<6|s>>>26)+t|0,a+=(t^(s|~e))+n[3]-1894986606|0,a=(a<<10|a>>>22)+s|0,e+=(s^(a|~t))+n[10]-1051523|0,e=(e<<15|e>>>17)+a|0,t+=(a^(e|~s))+n[1]-2054922799|0,t=(t<<21|t>>>11)+e|0,s+=(e^(t|~a))+n[8]+1873313359|0,s=(s<<6|s>>>26)+t|0,a+=(t^(s|~e))+n[15]-30611744|0,a=(a<<10|a>>>22)+s|0,e+=(s^(a|~t))+n[6]-1560198380|0,e=(e<<15|e>>>17)+a|0,t+=(a^(e|~s))+n[13]+1309151649|0,t=(t<<21|t>>>11)+e|0,s+=(e^(t|~a))+n[4]-145523070|0,s=(s<<6|s>>>26)+t|0,a+=(t^(s|~e))+n[11]-1120210379|0,a=(a<<10|a>>>22)+s|0,e+=(s^(a|~t))+n[2]+718787259|0,e=(e<<15|e>>>17)+a|0,t+=(a^(e|~s))+n[9]-343485551|0,t=(t<<21|t>>>11)+e|0,r[0]=s+r[0]|0,r[1]=t+r[1]|0,r[2]=e+r[2]|0,r[3]=a+r[3]|0}_dataLength=0;_bufferLength=0;_state=new Int32Array(4);_buffer=new ArrayBuffer(68);_buffer8;_buffer32;constructor(){this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(S.stateIdentity),this}appendStr(r){const n=this._buffer8,s=this._buffer32;let t=this._bufferLength,e,a;for(a=0;a<r.length;a+=1){if(e=r.charCodeAt(a),e<128)n[t++]=e;else if(e<2048)n[t++]=(e>>>6)+192,n[t++]=e&63|128;else if(e<55296||e>56319)n[t++]=(e>>>12)+224,n[t++]=e>>>6&63|128,n[t++]=e&63|128;else{if(e=(e-55296)*1024+(r.charCodeAt(++a)-56320)+65536,e>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");n[t++]=(e>>>18)+240,n[t++]=e>>>12&63|128,n[t++]=e>>>6&63|128,n[t++]=e&63|128}t>=64&&(this._dataLength+=64,S._md5cycle(this._state,s),t-=64,s[0]=s[16])}return this._bufferLength=t,this}appendAsciiStr(r){const n=this._buffer8,s=this._buffer32;let t=this._bufferLength,e,a=0;for(;;){for(e=Math.min(r.length-a,64-t);e--;)n[t++]=r.charCodeAt(a++);if(t<64)break;this._dataLength+=64,S._md5cycle(this._state,s),t=0}return this._bufferLength=t,this}appendByteArray(r){const n=this._buffer8,s=this._buffer32;let t=this._bufferLength,e,a=0;for(;;){for(e=Math.min(r.length-a,64-t);e--;)n[t++]=r[a++];if(t<64)break;this._dataLength+=64,S._md5cycle(this._state,s),t=0}return this._bufferLength=t,this}getState(){const r=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[r[0],r[1],r[2],r[3]]}}setState(r){const n=r.buffer,s=r.state,t=this._state;let e;for(this._dataLength=r.length,this._bufferLength=r.buflen,t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],e=0;e<n.length;e+=1)this._buffer8[e]=n.charCodeAt(e)}end(r=!1){const n=this._bufferLength,s=this._buffer8,t=this._buffer32,e=(n>>2)+1;this._dataLength+=n;const a=this._dataLength*8;if(s[n]=128,s[n+1]=s[n+2]=s[n+3]=0,t.set(S.buffer32Identity.subarray(e),e),n>55&&(S._md5cycle(this._state,t),t.set(S.buffer32Identity)),a<=4294967295)t[14]=a;else{const h=a.toString(16).match(/(.*?)(.{0,8})$/);if(h===null)return r?Ne:"";const o=parseInt(h[2],16),v=parseInt(h[1],16)||0;t[14]=o,t[15]=v}return S._md5cycle(this._state,t),r?this._state:S._hex(this._state)}}if(S.hashStr("hello")!=="5d41402abc4b2a76b9719d911017c592")throw new Error("Md5 self test failed.");function Ce(i){let r=i;i.match(/^([0-9a-f]{4}-?){8}$/)===null&&(r=S.hashStr(i)),r=r.replace(/[^0-9a-f]/g,"");let n=0;for(let s=0;s<r.length;s++)n+=parseInt(r.charAt(s),16);return n}function rt(i){const r=Ht(6),n=Ce(i.toLocaleLowerCase());return r[n%r.length]}var Q={exports:{}},De=Q.exports,it;function Ee(){return it||(it=1,(function(i){(function(r){if(typeof n!="function"){var n=function(l){return l};n.nonNative=!0}const s=n("plaintext"),t=n("html"),e=n("comment"),a=/<(\w*)>/g,h=/<\/?([^\s\/>]+)/;function o(l,c,u){l=l||"",c=c||[],u=u||"";let d=p(c,u);return g(l,d)}function v(l,c){l=l||[],c=c||"";let u=p(l,c);return function(d){return g(d||"",u)}}o.init_streaming_mode=v;function p(l,c){return l=_(l),{allowable_tags:l,tag_replacement:c,state:s,tag_buffer:"",depth:0,in_quote_char:""}}function g(l,c){if(typeof l!="string")throw new TypeError("'html' parameter must be a string");let u=c.allowable_tags,d=c.tag_replacement,m=c.state,y=c.tag_buffer,U=c.depth,k=c.in_quote_char,C="";for(let B=0,yt=l.length;B<yt;B++){let x=l[B];if(m===s)x==="<"?(m=t,y+=x):C+=x;else if(m===t)switch(x){case"<":if(k)break;U++;break;case">":if(k)break;if(U){U--;break}k="",m=s,y+=">",u.has(f(y))?C+=y:C+=d,y="";break;case'"':case"'":x===k?k="":k=k||x,y+=x;break;case"-":y==="<!-"&&(m=e),y+=x;break;case" ":case`
`:if(y==="<"){m=s,C+="< ",y="";break}y+=x;break;default:y+=x;break}else m===e&&(x===">"?(y.slice(-2)=="--"&&(m=s),y=""):y+=x)}return c.state=m,c.tag_buffer=y,c.depth=U,c.in_quote_char=k,C}function _(l){let c=new Set;if(typeof l=="string"){let u;for(;u=a.exec(l);)c.add(u[1])}else!n.nonNative&&typeof l[n.iterator]=="function"?c=new Set(l):typeof l.forEach=="function"&&l.forEach(c.add,c);return c}function f(l){let c=h.exec(l);return c?c[1].toLowerCase():null}i.exports?i.exports=o:r.striptags=o})(De)})(Q)),Q.exports}Ee();function Oe(i,r){const n=(r?.size||64)<=64?64:512,s=r?.isGuest?"/guest":"",t=r?.isDarkTheme??K(document.body)?"/dark":"";return lt(`/avatar${s}/{user}/{size}${t}`,{user:i,size:n})}St(_t);const $e={data(){return{hasStatus:!1,userStatus:{status:null,message:null,icon:null}}},methods:{async fetchUserStatus(i){if(!i)return;const r=qt();if(!(!Object.hasOwn(r,"user_status")||!r.user_status.enabled)&&R())try{const{data:n}=await ut.get(xt("apps/user_status/api/v1/statuses/{userId}",{userId:i}));this.setUserStatus(n.ocs.data)}catch(n){if(n.response.status===404&&n.response.data.ocs?.data?.length===0)return;T.error("Failed to fetch user status",{error:n})}},setUserStatus({status:i,message:r,icon:n}){this.userStatus.status=i||"",this.userStatus.message=r||"",this.userStatus.icon=n||"",this.hasStatus=!!i}}},mt=vt("nextcloud").persist().build();function je(i){const r=mt.getItem("user-has-avatar."+i);return typeof r=="string"?!!r:null}function ot(i,r){i&&mt.setItem("user-has-avatar."+i,r)}const Pe={name:"NcAvatar",directives:{ClickOutside:me},components:{IconDotsHorizontal:Ft,NcActions:Wt,NcButton:Gt,NcIconSvgWrapper:At,NcLoadingIcon:Xt,NcUserStatusIcon:Zt},mixins:[$e],props:{url:{type:String,default:void 0},iconClass:{type:String,default:void 0},user:{type:String,default:void 0},hideStatus:{type:Boolean,default:!1},verboseStatus:{type:Boolean,default:!1},preloadedUserStatus:{type:Object,default:void 0},isGuest:{type:Boolean,default:!1},displayName:{type:String,default:void 0},size:{type:Number,default:32},noPlaceholder:{type:Boolean,default:!1},disableTooltip:{type:Boolean,default:!1},disableMenu:{type:Boolean,default:!1},tooltipMessage:{type:String,default:null},isNoUser:{type:Boolean,default:!1},menuContainer:{type:[Boolean,String,Object,Element],default:"body"}},setup(){return{isDarkTheme:he()}},data(){return{avatarUrlLoaded:null,avatarSrcSetLoaded:null,userDoesNotExist:!1,isAvatarLoaded:!1,isMenuLoaded:!1,contactsMenuLoading:!1,contactsMenuData:{},contactsMenuActions:[],contactsMenuOpenState:!1}},computed:{avatarAriaLabel(){if(this.hasMenu)return this.canDisplayUserStatus||this.showUserStatusIconOnAvatar?G("Avatar of {displayName}, {status}",{displayName:this.displayName??this.user,status:Rt(this.userStatus.status)}):G("Avatar of {displayName}",{displayName:this.displayName??this.user})},canDisplayUserStatus(){return!this.hideStatus&&this.hasStatus&&["online","away","busy","dnd"].includes(this.userStatus.status)},showUserStatusIconOnAvatar(){return!this.hideStatus&&!this.verboseStatus&&this.hasStatus&&this.userStatus.status!=="dnd"&&this.userStatus.icon},userIdentifier(){return this.isDisplayNameDefined?this.displayName:this.isUserDefined?this.user:""},isUserDefined(){return typeof this.user<"u"},isDisplayNameDefined(){return typeof this.displayName<"u"},isUrlDefined(){return typeof this.url<"u"},hasMenu(){return this.disableMenu?!1:this.isMenuLoaded?this.menu.length>0:!(this.user===R()?.uid||this.userDoesNotExist||this.url)},showInitials(){return!this.noPlaceholder&&this.userDoesNotExist&&!(this.iconClass||this.$slots.icon)},avatarStyle(){return{"--avatar-size":this.size+"px",lineHeight:this.showInitials?this.size+"px":0,fontSize:Math.round(this.size*.45)+"px"}},initialsWrapperStyle(){const{r:i,g:r,b:n}=rt(this.userIdentifier);return{backgroundColor:`rgba(${i}, ${r}, ${n}, 0.1)`}},initialsStyle(){const{r:i,g:r,b:n}=rt(this.userIdentifier);return{color:`rgb(${i}, ${r}, ${n})`}},tooltip(){return this.disableTooltip?null:this.tooltipMessage?this.tooltipMessage:this.displayName},initials(){let i="?";if(this.showInitials){const r=this.userIdentifier.trim();if(r==="")return i;const n=r.match(/[\p{L}\p{N}\s]/gu);if(!n)return i;const s=n.join(""),t=s.lastIndexOf(" ");i=String.fromCodePoint(s.codePointAt(0)),t!==-1&&(i=i.concat(String.fromCodePoint(s.codePointAt(t+1))))}return i.toLocaleUpperCase()},menu(){const i=this.contactsMenuActions.map(n=>{const s=Me(this.$router,n.hyperlink);return{ncActionComponent:s?Kt:Qt,ncActionComponentProps:s?{to:s,icon:n.icon}:{href:n.hyperlink,icon:n.icon},text:n.title}});for(const n of Ie(this.contactsMenuData))try{i.push({ncActionComponent:Jt,ncActionComponentProps:{onClick:()=>n.callback(this.contactsMenuData)},text:n.displayName(this.contactsMenuData),iconSvg:n.iconSvg(this.contactsMenuData)})}catch(s){T.error(`Failed to render ContactsMenu action ${n.id}`,{error:s,action:n})}function r(n){const s=document.createTextNode(n),t=document.createElement("p");return t.appendChild(s),t.innerHTML}if(!this.hideStatus&&(this.userStatus.icon||this.userStatus.message)){const n=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
					<text x="50%" y="50%" text-anchor="middle" style="dominant-baseline: central; font-size: 85%">${r(this.userStatus.icon)}</text>
				</svg>`;return[{ncActionComponent:oe,ncActionComponentProps:{},iconSvg:this.userStatus.icon?n:void 0,text:`${this.userStatus.message}`}].concat(i)}return i}},watch:{url(){this.userDoesNotExist=!1,this.loadAvatarUrl()},user(){this.userDoesNotExist=!1,this.isMenuLoaded=!1,this.loadAvatarUrl()}},mounted(){this.loadAvatarUrl(),F("settings:avatar:updated",this.loadAvatarUrl),F("settings:display-name:updated",this.loadAvatarUrl),!this.hideStatus&&this.user&&!this.isNoUser?(this.preloadedUserStatus?this.setUserStatus(this.preloadedUserStatus):this.fetchUserStatus(this.user),F("user_status:status.updated",this.handleUserStatusUpdated)):!this.hideStatus&&this.preloadedUserStatus&&this.setUserStatus(this.preloadedUserStatus)},beforeUnmount(){W("settings:avatar:updated",this.loadAvatarUrl),W("settings:display-name:updated",this.loadAvatarUrl),W("user_status:status.updated",this.handleUserStatusUpdated)},methods:{t:G,handleUserStatusUpdated(i){this.user===i.userId&&(this.userStatus={status:i.status,icon:i.icon,message:i.message},this.hasStatus=i.status!==null)},async toggleMenu(i){i.type==="keydown"&&i.key!=="Enter"||(this.contactsMenuOpenState||await this.fetchContactsMenu(),this.contactsMenuOpenState=!this.contactsMenuOpenState)},closeMenu(){this.contactsMenuOpenState=!1},async fetchContactsMenu(){this.contactsMenuLoading=!0;try{const i=encodeURIComponent(this.user),{data:r}=await ut.post(lt("contactsmenu/findOne"),`shareType=0&shareWith=${i}`);this.contactsMenuData=r,this.contactsMenuActions=r.topAction?[r.topAction].concat(r.actions):r.actions}catch{this.contactsMenuOpenState=!1}this.contactsMenuLoading=!1,this.isMenuLoaded=!0},loadAvatarUrl(){if(this.isAvatarLoaded=!1,!this.isUrlDefined&&(!this.isUserDefined||this.isNoUser||this.iconClass||this.$slots.icon)){this.isAvatarLoaded=!0,this.userDoesNotExist=!0;return}if(this.isUrlDefined){this.updateImageIfValid(this.url);return}if(this.size<=64){const i=this.avatarUrlGenerator(this.user,64),r=[i+" 1x",this.avatarUrlGenerator(this.user,512)+" 8x"].join(", ");this.updateImageIfValid(i,r)}else{const i=this.avatarUrlGenerator(this.user,512);this.updateImageIfValid(i)}},avatarUrlGenerator(i,r){let n=Oe(i,{size:r,isDarkTheme:this.isDarkTheme,isGuest:this.isGuest});return i===R()?.uid&&typeof oc_userconfig<"u"&&(n+="?v="+window.oc_userconfig.avatar.version),n},updateImageIfValid(i,r=null){const n=je(this.user);if(this.isUserDefined&&typeof n=="boolean"){this.isAvatarLoaded=!0,this.avatarUrlLoaded=i,r&&(this.avatarSrcSetLoaded=r),n===!1&&(this.userDoesNotExist=!0);return}const s=new Image;s.onload=()=>{this.avatarUrlLoaded=i,r&&(this.avatarSrcSetLoaded=r),this.isAvatarLoaded=!0,ot(this.user,!0)},s.onerror=t=>{T.debug("[NcAvatar] Invalid avatar url",{error:t,url:i}),this.avatarUrlLoaded=null,this.avatarSrcSetLoaded=null,this.userDoesNotExist=!0,this.isAvatarLoaded=!1,ot(this.user,!1)},r&&(s.srcset=r),s.src=i}}},Te=["title"],ze=["src","srcset"],Be={key:2,class:"avatardiv__user-status avatardiv__user-status--icon"};function We(i,r,n,s,t,e){const a=M("NcLoadingIcon"),h=M("IconDotsHorizontal"),o=M("NcButton"),v=M("NcIconSvgWrapper"),p=M("NcActions"),g=M("NcUserStatusIcon"),_=Nt("click-outside");return Ct((b(),A("span",{class:V(["avatardiv popovermenu-wrapper",{"avatardiv--unknown":t.userDoesNotExist,"avatardiv--with-menu":e.hasMenu,"avatardiv--with-menu-loading":t.contactsMenuLoading}]),style:P(e.avatarStyle),title:e.tooltip},[ht(i.$slots,"icon",{},()=>[n.iconClass?(b(),A("span",{key:0,class:V([n.iconClass,"avatar-class-icon"])},null,2)):t.isAvatarLoaded&&!t.userDoesNotExist?(b(),A("img",{key:1,src:t.avatarUrlLoaded,srcset:t.avatarSrcSetLoaded,alt:""},null,8,ze)):N("",!0)],!0),e.hasMenu&&e.menu.length===0?(b(),I(o,{key:0,"aria-label":e.avatarAriaLabel,class:"action-item action-item__menutoggle",variant:"tertiary-no-background",onClick:e.toggleMenu},{icon:D(()=>[t.contactsMenuLoading?(b(),I(a,{key:0})):(b(),I(h,{key:1,size:20}))]),_:1},8,["aria-label","onClick"])):e.hasMenu?(b(),I(p,{key:1,open:t.contactsMenuOpenState,"onUpdate:open":r[0]||(r[0]=f=>t.contactsMenuOpenState=f),"aria-label":e.avatarAriaLabel,container:n.menuContainer,forceMenu:"",manualOpen:"",variant:"tertiary-no-background",onClick:e.toggleMenu},tt({default:D(()=>[(b(!0),A(Dt,null,Et(e.menu,(f,l)=>(b(),I(Ot(f.ncActionComponent),$t({key:l},{ref_for:!0},f.ncActionComponentProps),tt({default:D(()=>[jt(" "+L(f.text),1)]),_:2},[f.iconSvg?{name:"icon",fn:D(()=>[et(v,{svg:f.iconSvg},null,8,["svg"])]),key:"0"}:void 0]),1040))),128))]),_:2},[t.contactsMenuLoading?{name:"icon",fn:D(()=>[et(a)]),key:"0"}:void 0]),1032,["open","aria-label","container","onClick"])):N("",!0),e.showUserStatusIconOnAvatar?(b(),A("span",Be,L(i.userStatus.icon),1)):e.canDisplayUserStatus?(b(),I(g,{key:3,class:"avatardiv__user-status",status:i.userStatus.status,"aria-hidden":String(e.hasMenu)},null,8,["status","aria-hidden"])):N("",!0),e.showInitials?(b(),A("span",{key:4,style:P(e.initialsWrapperStyle),class:"avatardiv__initials-wrapper"},[j("span",{style:P(e.initialsStyle),class:"avatardiv__initials"},L(e.initials),5)],4)):N("",!0)],14,Te)),[[_,e.closeMenu]])}const ns=ct(Pe,[["render",We],["__scopeId","data-v-72a1eed6"]]);export{nt as E,ns as N,gt as S,es as U,Ae as a,$e as b,ft as c,Me as g,Le as p,ss as r,$ as u,we as v};
//# sourceMappingURL=NcAvatar-C9d7Wrc8-DXVKer_p.chunk.mjs.map
