{"version":3,"file":"dav-RDXFFeC4.chunk.mjs","sources":["../node_modules/@nextcloud/sharing/dist/public.js","../node_modules/cancelable-promise/esm/CancelablePromise.mjs","../node_modules/@nextcloud/files/dist/dav.mjs"],"sourcesContent":["/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: GPL-3.0-or-later\n */\n/**\n * @module public\n */\nimport { loadState } from '@nextcloud/initial-state';\n/**\n * Check if the current page is on a public share\n */\nexport function isPublicShare() {\n    // check both the new initial state version and fallback to legacy input\n    return (loadState('files_sharing', 'isPublic', null)\n        ?? document.querySelector('input#isPublic[type=\"hidden\"][name=\"isPublic\"][value=\"1\"]') !== null);\n}\n/**\n * Get the sharing token for the current public share\n */\nexport function getSharingToken() {\n    return (loadState('files_sharing', 'sharingToken', null)\n        ?? document.querySelector('input#sharingToken[type=\"hidden\"]')?.value\n        ?? null);\n}\n","function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\n\nfunction _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\nfunction _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\n\nfunction _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n\nfunction _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\n\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\n\nfunction _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\n\nvar toStringTag = typeof Symbol !== 'undefined' ? Symbol.toStringTag : '@@toStringTag';\n\nvar _internals = /*#__PURE__*/new WeakMap();\n\nvar _promise = /*#__PURE__*/new WeakMap();\n\nclass CancelablePromiseInternal {\n  constructor(_ref) {\n    var {\n      executor = () => {},\n      internals = defaultInternals(),\n      promise = new Promise((resolve, reject) => executor(resolve, reject, onCancel => {\n        internals.onCancelList.push(onCancel);\n      }))\n    } = _ref;\n\n    _classPrivateFieldInitSpec(this, _internals, {\n      writable: true,\n      value: void 0\n    });\n\n    _classPrivateFieldInitSpec(this, _promise, {\n      writable: true,\n      value: void 0\n    });\n\n    _defineProperty(this, toStringTag, 'CancelablePromise');\n\n    this.cancel = this.cancel.bind(this);\n\n    _classPrivateFieldSet(this, _internals, internals);\n\n    _classPrivateFieldSet(this, _promise, promise || new Promise((resolve, reject) => executor(resolve, reject, onCancel => {\n      internals.onCancelList.push(onCancel);\n    })));\n  }\n\n  then(onfulfilled, onrejected) {\n    return makeCancelable(_classPrivateFieldGet(this, _promise).then(createCallback(onfulfilled, _classPrivateFieldGet(this, _internals)), createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  catch(onrejected) {\n    return makeCancelable(_classPrivateFieldGet(this, _promise).catch(createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  finally(onfinally, runWhenCanceled) {\n    if (runWhenCanceled) {\n      _classPrivateFieldGet(this, _internals).onCancelList.push(onfinally);\n    }\n\n    return makeCancelable(_classPrivateFieldGet(this, _promise).finally(createCallback(() => {\n      if (onfinally) {\n        if (runWhenCanceled) {\n          _classPrivateFieldGet(this, _internals).onCancelList = _classPrivateFieldGet(this, _internals).onCancelList.filter(callback => callback !== onfinally);\n        }\n\n        return onfinally();\n      }\n    }, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  cancel() {\n    _classPrivateFieldGet(this, _internals).isCanceled = true;\n\n    var callbacks = _classPrivateFieldGet(this, _internals).onCancelList;\n\n    _classPrivateFieldGet(this, _internals).onCancelList = [];\n\n    for (var callback of callbacks) {\n      if (typeof callback === 'function') {\n        try {\n          callback();\n        } catch (err) {\n          console.error(err);\n        }\n      }\n    }\n  }\n\n  isCanceled() {\n    return _classPrivateFieldGet(this, _internals).isCanceled === true;\n  }\n\n}\n\nexport class CancelablePromise extends CancelablePromiseInternal {\n  constructor(executor) {\n    super({\n      executor\n    });\n  }\n\n}\n\n_defineProperty(CancelablePromise, \"all\", function all(iterable) {\n  return makeAllCancelable(iterable, Promise.all(iterable));\n});\n\n_defineProperty(CancelablePromise, \"allSettled\", function allSettled(iterable) {\n  return makeAllCancelable(iterable, Promise.allSettled(iterable));\n});\n\n_defineProperty(CancelablePromise, \"any\", function any(iterable) {\n  return makeAllCancelable(iterable, Promise.any(iterable));\n});\n\n_defineProperty(CancelablePromise, \"race\", function race(iterable) {\n  return makeAllCancelable(iterable, Promise.race(iterable));\n});\n\n_defineProperty(CancelablePromise, \"resolve\", function resolve(value) {\n  return cancelable(Promise.resolve(value));\n});\n\n_defineProperty(CancelablePromise, \"reject\", function reject(reason) {\n  return cancelable(Promise.reject(reason));\n});\n\n_defineProperty(CancelablePromise, \"isCancelable\", isCancelablePromise);\n\nexport default CancelablePromise;\nexport function cancelable(promise) {\n  return makeCancelable(promise, defaultInternals());\n}\nexport function isCancelablePromise(promise) {\n  return promise instanceof CancelablePromise || promise instanceof CancelablePromiseInternal;\n}\n\nfunction createCallback(onResult, internals) {\n  if (onResult) {\n    return arg => {\n      if (!internals.isCanceled) {\n        var result = onResult(arg);\n\n        if (isCancelablePromise(result)) {\n          internals.onCancelList.push(result.cancel);\n        }\n\n        return result;\n      }\n\n      return arg;\n    };\n  }\n}\n\nfunction makeCancelable(promise, internals) {\n  return new CancelablePromiseInternal({\n    internals,\n    promise\n  });\n}\n\nfunction makeAllCancelable(iterable, promise) {\n  var internals = defaultInternals();\n  internals.onCancelList.push(() => {\n    for (var resolvable of iterable) {\n      if (isCancelablePromise(resolvable)) {\n        resolvable.cancel();\n      }\n    }\n  });\n  return new CancelablePromiseInternal({\n    internals,\n    promise\n  });\n}\n\nfunction defaultInternals() {\n  return {\n    isCanceled: false,\n    onCancelList: []\n  };\n}\n//# sourceMappingURL=CancelablePromise.mjs.map","import { getCurrentUser, onRequestTokenUpdate, getRequestToken } from \"@nextcloud/auth\";\nimport { isPublicShare, getSharingToken } from \"@nextcloud/sharing/public\";\nimport { generateRemoteUrl } from \"@nextcloud/router\";\nimport { CancelablePromise } from \"cancelable-promise\";\nimport { createClient, getPatcher } from \"webdav\";\nimport { P as Permission, l as logger, c as NodeStatus, a as File, b as Folder } from \"./chunks/folder-QTYeAiOH.mjs\";\nconst parsePermissions = function(permString = \"\") {\n  let permissions = Permission.NONE;\n  if (!permString) {\n    return permissions;\n  }\n  if (permString.includes(\"C\") || permString.includes(\"K\")) {\n    permissions |= Permission.CREATE;\n  }\n  if (permString.includes(\"G\")) {\n    permissions |= Permission.READ;\n  }\n  if (permString.includes(\"W\") || permString.includes(\"N\") || permString.includes(\"V\")) {\n    permissions |= Permission.UPDATE;\n  }\n  if (permString.includes(\"D\")) {\n    permissions |= Permission.DELETE;\n  }\n  if (permString.includes(\"R\")) {\n    permissions |= Permission.SHARE;\n  }\n  return permissions;\n};\nconst defaultDavProperties = [\n  \"d:getcontentlength\",\n  \"d:getcontenttype\",\n  \"d:getetag\",\n  \"d:getlastmodified\",\n  \"d:creationdate\",\n  \"d:displayname\",\n  \"d:quota-available-bytes\",\n  \"d:resourcetype\",\n  \"nc:has-preview\",\n  \"nc:is-encrypted\",\n  \"nc:mount-type\",\n  \"oc:comments-unread\",\n  \"oc:favorite\",\n  \"oc:fileid\",\n  \"oc:owner-display-name\",\n  \"oc:owner-id\",\n  \"oc:permissions\",\n  \"oc:size\"\n];\nconst defaultDavNamespaces = {\n  d: \"DAV:\",\n  nc: \"http://nextcloud.org/ns\",\n  oc: \"http://owncloud.org/ns\",\n  ocs: \"http://open-collaboration-services.org/ns\"\n};\nconst registerDavProperty = function(prop, namespace = { nc: \"http://nextcloud.org/ns\" }) {\n  if (typeof window._nc_dav_properties === \"undefined\") {\n    window._nc_dav_properties = [...defaultDavProperties];\n    window._nc_dav_namespaces = { ...defaultDavNamespaces };\n  }\n  const namespaces = { ...window._nc_dav_namespaces, ...namespace };\n  if (window._nc_dav_properties.find((search) => search === prop)) {\n    logger.warn(`${prop} already registered`, { prop });\n    return false;\n  }\n  if (prop.startsWith(\"<\") || prop.split(\":\").length !== 2) {\n    logger.error(`${prop} is not valid. See example: 'oc:fileid'`, { prop });\n    return false;\n  }\n  const ns = prop.split(\":\")[0];\n  if (!namespaces[ns]) {\n    logger.error(`${prop} namespace unknown`, { prop, namespaces });\n    return false;\n  }\n  window._nc_dav_properties.push(prop);\n  window._nc_dav_namespaces = namespaces;\n  return true;\n};\nconst getDavProperties = function() {\n  if (typeof window._nc_dav_properties === \"undefined\") {\n    window._nc_dav_properties = [...defaultDavProperties];\n  }\n  return window._nc_dav_properties.map((prop) => `<${prop} />`).join(\" \");\n};\nconst getDavNameSpaces = function() {\n  if (typeof window._nc_dav_namespaces === \"undefined\") {\n    window._nc_dav_namespaces = { ...defaultDavNamespaces };\n  }\n  return Object.keys(window._nc_dav_namespaces).map((ns) => `xmlns:${ns}=\"${window._nc_dav_namespaces?.[ns]}\"`).join(\" \");\n};\nconst getDefaultPropfind = function() {\n  return `<?xml version=\"1.0\"?>\n\t\t<d:propfind ${getDavNameSpaces()}>\n\t\t\t<d:prop>\n\t\t\t\t${getDavProperties()}\n\t\t\t</d:prop>\n\t\t</d:propfind>`;\n};\nconst getFavoritesReport = function() {\n  return `<?xml version=\"1.0\"?>\n\t\t<oc:filter-files ${getDavNameSpaces()}>\n\t\t\t<d:prop>\n\t\t\t\t${getDavProperties()}\n\t\t\t</d:prop>\n\t\t\t<oc:filter-rules>\n\t\t\t\t<oc:favorite>1</oc:favorite>\n\t\t\t</oc:filter-rules>\n\t\t</oc:filter-files>`;\n};\nconst getRecentSearch = function(lastModified) {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<d:searchrequest ${getDavNameSpaces()}\n\txmlns:ns=\"https://github.com/icewind1991/SearchDAV/ns\">\n\t<d:basicsearch>\n\t\t<d:select>\n\t\t\t<d:prop>\n\t\t\t\t${getDavProperties()}\n\t\t\t</d:prop>\n\t\t</d:select>\n\t\t<d:from>\n\t\t\t<d:scope>\n\t\t\t\t<d:href>/files/${getCurrentUser()?.uid}/</d:href>\n\t\t\t\t<d:depth>infinity</d:depth>\n\t\t\t</d:scope>\n\t\t</d:from>\n\t\t<d:where>\n\t\t\t<d:and>\n\t\t\t\t<d:or>\n\t\t\t\t\t<d:not>\n\t\t\t\t\t\t<d:eq>\n\t\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t\t<d:getcontenttype/>\n\t\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t\t\t<d:literal>httpd/unix-directory</d:literal>\n\t\t\t\t\t\t</d:eq>\n\t\t\t\t\t</d:not>\n\t\t\t\t\t<d:eq>\n\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t<oc:size/>\n\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t\t<d:literal>0</d:literal>\n\t\t\t\t\t</d:eq>\n\t\t\t\t</d:or>\n\t\t\t\t<d:gt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified/>\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>${lastModified}</d:literal>\n\t\t\t\t</d:gt>\n\t\t\t</d:and>\n\t\t</d:where>\n\t\t<d:orderby>\n\t\t\t<d:order>\n\t\t\t\t<d:prop>\n\t\t\t\t\t<d:getlastmodified/>\n\t\t\t\t</d:prop>\n\t\t\t\t<d:descending/>\n\t\t\t</d:order>\n\t\t</d:orderby>\n\t\t<d:limit>\n\t\t\t<d:nresults>100</d:nresults>\n\t\t\t<ns:firstresult>0</ns:firstresult>\n\t\t</d:limit>\n\t</d:basicsearch>\n</d:searchrequest>`;\n};\nfunction getRootPath() {\n  if (isPublicShare()) {\n    return `/files/${getSharingToken()}`;\n  }\n  return `/files/${getCurrentUser()?.uid}`;\n}\nconst defaultRootPath = getRootPath();\nfunction getRemoteURL() {\n  const url = generateRemoteUrl(\"dav\");\n  if (isPublicShare()) {\n    return url.replace(\"remote.php\", \"public.php\");\n  }\n  return url;\n}\nconst defaultRemoteURL = getRemoteURL();\nconst getClient = function(remoteURL = defaultRemoteURL, headers = {}) {\n  const client = createClient(remoteURL, { headers });\n  function setHeaders(token) {\n    client.setHeaders({\n      ...headers,\n      // Add this so the server knows it is an request from the browser\n      \"X-Requested-With\": \"XMLHttpRequest\",\n      // Inject user auth\n      requesttoken: token ?? \"\"\n    });\n  }\n  onRequestTokenUpdate(setHeaders);\n  setHeaders(getRequestToken());\n  const patcher = getPatcher();\n  patcher.patch(\"fetch\", (url, options) => {\n    const headers2 = options.headers;\n    if (headers2?.method) {\n      options.method = headers2.method;\n      delete headers2.method;\n    }\n    return fetch(url, options);\n  });\n  return client;\n};\nconst getFavoriteNodes = (davClient, path = \"/\", davRoot = defaultRootPath) => {\n  const controller = new AbortController();\n  return new CancelablePromise(async (resolve, reject, onCancel) => {\n    onCancel(() => controller.abort());\n    try {\n      const contentsResponse = await davClient.getDirectoryContents(`${davRoot}${path}`, {\n        signal: controller.signal,\n        details: true,\n        data: getFavoritesReport(),\n        headers: {\n          // see getClient for patched webdav client\n          method: \"REPORT\"\n        },\n        includeSelf: true\n      });\n      const nodes = contentsResponse.data.filter((node) => node.filename !== path).map((result) => resultToNode(result, davRoot));\n      resolve(nodes);\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nconst resultToNode = function(node, filesRoot = defaultRootPath, remoteURL = defaultRemoteURL) {\n  let userId = getCurrentUser()?.uid;\n  if (isPublicShare()) {\n    userId = userId ?? \"anonymous\";\n  } else if (!userId) {\n    throw new Error(\"No user id found\");\n  }\n  const props = node.props;\n  const permissions = parsePermissions(props?.permissions);\n  const owner = String(props?.[\"owner-id\"] || userId);\n  const id = props.fileid || 0;\n  const mtime = new Date(Date.parse(node.lastmod));\n  const crtime = new Date(Date.parse(props.creationdate));\n  const nodeData = {\n    id,\n    source: `${remoteURL}${node.filename}`,\n    mtime: !isNaN(mtime.getTime()) && mtime.getTime() !== 0 ? mtime : void 0,\n    crtime: !isNaN(crtime.getTime()) && crtime.getTime() !== 0 ? crtime : void 0,\n    mime: node.mime || \"application/octet-stream\",\n    // Manually cast to work around for https://github.com/perry-mitchell/webdav-client/pull/380\n    displayname: props.displayname !== void 0 ? String(props.displayname) : void 0,\n    size: props?.size || Number.parseInt(props.getcontentlength || \"0\"),\n    // The fileid is set to -1 for failed requests\n    status: id < 0 ? NodeStatus.FAILED : void 0,\n    permissions,\n    owner,\n    root: filesRoot,\n    attributes: {\n      ...node,\n      ...props,\n      hasPreview: props?.[\"has-preview\"]\n    }\n  };\n  delete nodeData.attributes?.props;\n  return node.type === \"file\" ? new File(nodeData) : new Folder(nodeData);\n};\nexport {\n  defaultDavNamespaces,\n  defaultDavProperties,\n  defaultRemoteURL,\n  defaultRootPath,\n  getClient,\n  getDavNameSpaces,\n  getDavProperties,\n  getDefaultPropfind,\n  getFavoriteNodes,\n  getFavoritesReport,\n  getRecentSearch,\n  getRemoteURL,\n  getRootPath,\n  parsePermissions,\n  registerDavProperty,\n  resultToNode\n};\n//# sourceMappingURL=dav.mjs.map\n"],"names":["isPublicShare","loadState","getSharingToken","_defineProperty","obj","key","value","_classPrivateFieldInitSpec","privateMap","_checkPrivateRedeclaration","privateCollection","_classPrivateFieldGet","receiver","descriptor","_classExtractFieldDescriptor","_classApplyDescriptorGet","_classPrivateFieldSet","_classApplyDescriptorSet","action","toStringTag","_internals","_promise","CancelablePromiseInternal","_ref","executor","internals","defaultInternals","promise","resolve","reject","onCancel","onfulfilled","onrejected","makeCancelable","createCallback","onfinally","runWhenCanceled","callback","callbacks","err","CancelablePromise","iterable","makeAllCancelable","cancelable","reason","isCancelablePromise","onResult","arg","result","resolvable","parsePermissions","permString","permissions","Permission","defaultDavProperties","defaultDavNamespaces","registerDavProperty","prop","namespace","namespaces","search","logger","ns","getDavProperties","getDavNameSpaces","getRootPath","getCurrentUser","defaultRootPath","getRemoteURL","url","generateRemoteUrl","defaultRemoteURL","getClient","remoteURL","headers","client","createClient","setHeaders","token","onRequestTokenUpdate","getRequestToken","getPatcher","options","headers2","resultToNode","node","filesRoot","userId","props","owner","id","mtime","crtime","nodeData","NodeStatus","File","Folder"],"mappings":"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","x_google_ignoreList":[0,1,2]}