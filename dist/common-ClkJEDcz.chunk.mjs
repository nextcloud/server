import{n as e}from"./rolldown-runtime-DiYpF8Fr.chunk.mjs";import{A as t,C as n,E as r,I as i,N as a,O as o,R as s,T as c,U as l,_ as u,d,h as f,l as p,m,q as h,v as g,w as _,x as v}from"./common-BPS_5DGx.chunk.mjs";function y(e){return new Re(e)}function b(){return R}function x(e,t=!1){R&&R.cleanups.push(e)}function S(e,t=!1){if(e.flags|=8,t){e.next=V,V=e;return}e.next=B,B=e}function C(){Ve++}function w(){if(--Ve>0)return;if(V){let e=V;for(V=void 0;e;){let t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;B;){let t=B;for(B=void 0;t;){let n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(t){e||=t}t=n}}if(e)throw e}function T(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function E(e){let t,n=e.depsTail,r=n;for(;r;){let e=r.prevDep;r.version===-1?(r===n&&(n=e),ne(r),re(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=e}e.deps=t,e.depsTail=n}function ee(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(te(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function te(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===U)||(e.globalVersion=U,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!ee(e))))return;e.flags|=2;let t=e.dep,n=z,r=H;z=e,H=!0;try{T(e);let n=e.fn(e._value);(t.version===0||u(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(e){throw t.version++,e}finally{z=n,H=r,E(e),e.flags&=-3}}function ne(e,t=!1){let{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)ne(e,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function re(e){let{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}function ie(){He.push(H),H=!1}function ae(){let e=He.pop();H=e===void 0?!0:e}function oe(e){let{cleanup:t}=e;if(e.cleanup=void 0,t){let e=z;z=void 0;try{t()}finally{z=e}}}function se(e){if(e.dep.sc++,e.sub.flags&4){let t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)se(e)}let n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}function D(e,t,n){if(H&&z){let t=G.get(e);t||G.set(e,t=new Map);let r=t.get(n);r||(t.set(n,r=new W),r.map=t,r.key=n),r.track()}}function O(e,t,a,o,s,l){let u=G.get(e);if(!u){U++;return}let d=e=>{e&&e.trigger()};if(C(),t===`clear`)u.forEach(d);else{let s=n(e),l=s&&c(a);if(s&&a===`length`){let e=Number(o);u.forEach((t,n)=>{(n===`length`||n===q||!i(n)&&n>=e)&&d(t)})}else switch((a!==void 0||u.has(void 0))&&d(u.get(a)),l&&d(u.get(q)),t){case`add`:s?l&&d(u.get(`length`)):(d(u.get(K)),r(e)&&d(u.get(We)));break;case`delete`:s||(d(u.get(K)),r(e)&&d(u.get(We)));break;case`set`:r(e)&&d(u.get(K));break}}w()}function ce(e,t){let n=G.get(e);return n&&n.get(t)}function k(e){let t=F(e);return t===e?t:(D(t,`iterate`,q),P(e)?t:t.map(Y))}function le(e){return D(e=F(e),`iterate`,q),e}function ue(e,t,n){let r=le(e),i=r[t]();return r!==e&&!P(e)&&(i._next=i.next,i.next=()=>{let e=i._next();return e.done||(e.value=n(e.value)),e}),i}function A(e,t,n,r,i,a){let o=le(e),s=o!==e&&!P(e),c=o[t];if(c!==Ke[t]){let t=c.apply(e,a);return s?Y(t):t}let l=n;o!==e&&(s?l=function(t,r){return n.call(this,Y(t),r,e)}:n.length>2&&(l=function(t,r){return n.call(this,t,r,e)}));let u=c.call(o,l,r);return s&&i?i(u):u}function de(e,t,n,r){let i=le(e),a=n;return i!==e&&(P(e)?n.length>3&&(a=function(t,r,i){return n.call(this,t,r,i,e)}):a=function(t,r,i){return n.call(this,t,Y(r),i,e)}),i[t](a,...r)}function fe(e,t,n){let r=F(e);D(r,`iterate`,q);let i=r[t](...n);return(i===-1||i===!1)&&we(n[0])?(n[0]=F(n[0]),r[t](...n)):i}function j(e,t,n=[]){ie(),C();let r=F(e)[t].apply(e,n);return w(),ae(),r}function pe(e){i(e)||(e=String(e));let t=F(this);return D(t,`has`,e),t.hasOwnProperty(e)}function me(e,t,n){return function(...i){let a=this.__v_raw,o=F(a),s=r(o),c=e===`entries`||e===Symbol.iterator&&s,l=e===`keys`&&s,u=a[e](...i),d=n?tt:t?X:Y;return!t&&D(o,`iterate`,l?We:K),{next(){let{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:c?[d(e[0]),d(e[1])]:d(e),done:t}},[Symbol.iterator](){return this}}}}function he(e){return function(...t){return e===`delete`?!1:e===`clear`?void 0:this}}function ge(e,t){let n={get(n){let r=this.__v_raw,i=F(r),a=F(n);e||(u(n,a)&&D(i,`get`,n),D(i,`get`,a));let{has:o}=J(i),s=t?tt:e?X:Y;if(o.call(i,n))return s(r.get(n));if(o.call(i,a))return s(r.get(a));r!==i&&r.get(n)},get size(){let t=this.__v_raw;return!e&&D(F(t),`iterate`,K),t.size},has(t){let n=this.__v_raw,r=F(n),i=F(t);return e||(u(t,i)&&D(r,`has`,t),D(r,`has`,i)),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,r){let i=this,a=i.__v_raw,o=F(a),s=t?tt:e?X:Y;return!e&&D(o,`iterate`,K),a.forEach((e,t)=>n.call(r,s(e),s(t),i))}};return f(n,e?{add:he(`add`),set:he(`set`),delete:he(`delete`),clear:he(`clear`)}:{add(e){!t&&!P(e)&&!N(e)&&(e=F(e));let n=F(this);return J(n).has.call(n,e)||(n.add(e),O(n,`add`,e,e)),this},set(e,n){!t&&!P(n)&&!N(n)&&(n=F(n));let r=F(this),{has:i,get:a}=J(r),o=i.call(r,e);o||=(e=F(e),i.call(r,e));let s=a.call(r,e);return r.set(e,n),o?u(n,s)&&O(r,`set`,e,n,s):O(r,`add`,e,n),this},delete(e){let t=F(this),{has:n,get:r}=J(t),i=n.call(t,e);i||=(e=F(e),n.call(t,e));let a=r?r.call(t,e):void 0,o=t.delete(e);return i&&O(t,`delete`,e,void 0,a),o},clear(){let e=F(this),t=e.size!==0,n=e.clear();return t&&O(e,`clear`,void 0,void 0,void 0),n}}),[`keys`,`values`,`entries`,Symbol.iterator].forEach(r=>{n[r]=me(r,e,t)}),n}function _e(e,t){let n=ge(e,t);return(t,r,i)=>r===`__v_isReactive`?!e:r===`__v_isReadonly`?e:r===`__v_raw`?t:Reflect.get(g(n,r)&&r in t?n:t,r,i)}function ve(e){switch(e){case`Object`:case`Array`:return 1;case`Map`:case`Set`:case`WeakMap`:case`WeakSet`:return 2;default:return 0}}function ye(e){return e.__v_skip||!Object.isExtensible(e)?0:ve(h(e))}function be(e){return N(e)?e:Ce(e,!1,Qe,nt,at)}function xe(e){return Ce(e,!1,et,rt,ot)}function Se(e){return Ce(e,!0,$e,it,st)}function Ce(e,t,n,r,i){if(!o(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;let a=ye(e);if(a===0)return e;let s=i.get(e);if(s)return s;let c=new Proxy(e,a===2?r:n);return i.set(e,c),c}function M(e){return N(e)?M(e.__v_raw):!!(e&&e.__v_isReactive)}function N(e){return!!(e&&e.__v_isReadonly)}function P(e){return!!(e&&e.__v_isShallow)}function we(e){return e?!!e.__v_raw:!1}function F(e){let t=e&&e.__v_raw;return t?F(t):e}function Te(e){return!g(e,`__v_skip`)&&Object.isExtensible(e)&&m(e,`__v_skip`,!0),e}function I(e){return e?e.__v_isRef===!0:!1}function Ee(e){return Oe(e,!1)}function De(e){return Oe(e,!0)}function Oe(e,t){return I(e)?e:new lt(e,t)}function ke(e){return I(e)?e.value:e}function Ae(e){return _(e)?e():ke(e)}function je(e){return M(e)?e:new Proxy(e,ut)}function Me(e){return new dt(e)}function Ne(e,t,n){return I(e)?e:_(e)?new pt(e):o(e)&&arguments.length>1?Pe(e,t,n):Ee(e)}function Pe(e,t,n){let r=e[t];return I(r)?r:new ft(e,t,n)}function Fe(e,t,n=!1){let r,i;return _(e)?r=e:(r=e.get,i=e.set),new mt(r,i,n)}function Ie(e,t=!1,n=$){if(n){let t=Q.get(n);t||Q.set(n,t=[]),t.push(e)}}function Le(e,t,r=p){let{immediate:i,deep:a,once:o,scheduler:s,augmentJob:c,call:f}=r,m=e=>a?e:P(e)||a===!1||a===0?L(e,1):L(e),h,g,v,y,x=!1,S=!1;if(I(e)?(g=()=>e.value,x=P(e)):M(e)?(g=()=>m(e),x=!0):n(e)?(S=!0,x=e.some(e=>M(e)||P(e)),g=()=>e.map(e=>{if(I(e))return e.value;if(M(e))return m(e);if(_(e))return f?f(e,2):e()})):g=_(e)?t?f?()=>f(e,2):e:()=>{if(v){ie();try{v()}finally{ae()}}let t=$;$=h;try{return f?f(e,3,[y]):e(y)}finally{$=t}}:d,t&&a){let e=g,t=a===!0?1/0:a;g=()=>L(e(),t)}let C=b(),w=()=>{h.stop(),C&&C.active&&l(C.effects,h)};if(o&&t){let e=t;t=(...t)=>{e(...t),w()}}let T=S?Array(e.length).fill(Z):Z,E=e=>{if(!(!(h.flags&1)||!h.dirty&&!e))if(t){let e=h.run();if(a||x||(S?e.some((e,t)=>u(e,T[t])):u(e,T))){v&&v();let n=$;$=h;try{let n=[e,T===Z?void 0:S&&T[0]===Z?[]:T,y];T=e,f?f(t,3,n):t(...n)}finally{$=n}}}else h.run()};return c&&c(E),h=new Be(g),h.scheduler=s?()=>s(E,!1):E,y=e=>Ie(e,!1,h),v=h.onStop=()=>{let e=Q.get(h);if(e){if(f)f(e,4);else for(let t of e)t();Q.delete(h)}},t?i?E(!0):T=h.run():s?s(E.bind(null,!0),!0):h.run(),w.pause=h.pause.bind(h),w.resume=h.resume.bind(h),w.stop=w,w}function L(e,i=1/0,s){if(i<=0||!o(e)||e.__v_skip||(s||=new Map,(s.get(e)||0)>=i))return e;if(s.set(e,i),i--,I(e))L(e.value,i,s);else if(n(e))for(let t=0;t<e.length;t++)L(e[t],i,s);else if(a(e)||r(e))e.forEach(e=>{L(e,i,s)});else if(t(e)){for(let t in e)L(e[t],i,s);for(let t of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,t)&&L(e[t],i,s)}return e}var R,Re,z,ze,Be,Ve,B,V,H,He,U,Ue,W,G,K,We,q,Ge,Ke,qe,Je,Ye,Xe,Ze,Qe,$e,et,tt,J,nt,rt,it,at,ot,st,ct,Y,X,lt,ut,dt,ft,pt,mt,Z,Q,$,ht=e((()=>{v(),Re=class{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=R,!e&&R&&(this.index=(R.scopes||=[]).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){let t=R;try{return R=this,e()}finally{R=t}}}on(){++this._on===1&&(this.prevScope=R,R=this)}off(){this._on>0&&--this._on===0&&(R=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){let e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}},ze=new WeakSet,Be=class{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,R&&R.active&&R.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ze.has(this)&&(ze.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||S(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,oe(this),T(this);let e=z,t=H;z=this,H=!0;try{return this.fn()}finally{E(this),z=e,H=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)ne(e);this.deps=this.depsTail=void 0,oe(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ze.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ee(this)&&this.run()}get dirty(){return ee(this)}},Ve=0,H=!0,He=[],U=0,Ue=class{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}},W=class{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!z||!H||z===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==z)t=this.activeLink=new Ue(z,this),z.deps?(t.prevDep=z.depsTail,z.depsTail.nextDep=t,z.depsTail=t):z.deps=z.depsTail=t,se(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){let e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=z.depsTail,t.nextDep=void 0,z.depsTail.nextDep=t,z.depsTail=t,z.deps===t&&(z.deps=e)}return t}trigger(e){this.version++,U++,this.notify(e)}notify(e){C();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{w()}}},G=new WeakMap,K=Symbol(``),We=Symbol(``),q=Symbol(``),Ge={__proto__:null,[Symbol.iterator](){return ue(this,Symbol.iterator,Y)},concat(...e){return k(this).concat(...e.map(e=>n(e)?k(e):e))},entries(){return ue(this,`entries`,e=>(e[1]=Y(e[1]),e))},every(e,t){return A(this,`every`,e,t,void 0,arguments)},filter(e,t){return A(this,`filter`,e,t,e=>e.map(Y),arguments)},find(e,t){return A(this,`find`,e,t,Y,arguments)},findIndex(e,t){return A(this,`findIndex`,e,t,void 0,arguments)},findLast(e,t){return A(this,`findLast`,e,t,Y,arguments)},findLastIndex(e,t){return A(this,`findLastIndex`,e,t,void 0,arguments)},forEach(e,t){return A(this,`forEach`,e,t,void 0,arguments)},includes(...e){return fe(this,`includes`,e)},indexOf(...e){return fe(this,`indexOf`,e)},join(e){return k(this).join(e)},lastIndexOf(...e){return fe(this,`lastIndexOf`,e)},map(e,t){return A(this,`map`,e,t,void 0,arguments)},pop(){return j(this,`pop`)},push(...e){return j(this,`push`,e)},reduce(e,...t){return de(this,`reduce`,e,t)},reduceRight(e,...t){return de(this,`reduceRight`,e,t)},shift(){return j(this,`shift`)},some(e,t){return A(this,`some`,e,t,void 0,arguments)},splice(...e){return j(this,`splice`,e)},toReversed(){return k(this).toReversed()},toSorted(e){return k(this).toSorted(e)},toSpliced(...e){return k(this).toSpliced(...e)},unshift(...e){return j(this,`unshift`,e)},values(){return ue(this,`values`,Y)}},Ke=Array.prototype,qe=s(`__proto__,__v_isRef,__isVue`),Je=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!==`arguments`&&e!==`caller`).map(e=>Symbol[e]).filter(i)),Ye=class{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t===`__v_skip`)return e.__v_skip;let a=this._isReadonly,s=this._isShallow;if(t===`__v_isReactive`)return!a;if(t===`__v_isReadonly`)return a;if(t===`__v_isShallow`)return s;if(t===`__v_raw`)return r===(a?s?ct:st:s?ot:at).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;let l=n(e);if(!a){let e;if(l&&(e=Ge[t]))return e;if(t===`hasOwnProperty`)return pe}let u=Reflect.get(e,t,I(e)?e:r);if((i(t)?Je.has(t):qe(t))||(a||D(e,`get`,t),s))return u;if(I(u)){let e=l&&c(t)?u:u.value;return a&&o(e)?Se(e):e}return o(u)?a?Se(u):be(u):u}},Xe=class extends Ye{constructor(e=!1){super(!1,e)}set(e,t,r,i){let a=e[t];if(!this._isShallow){let t=N(a);if(!P(r)&&!N(r)&&(a=F(a),r=F(r)),!n(e)&&I(a)&&!I(r))return t||(a.value=r),!0}let o=n(e)&&c(t)?Number(t)<e.length:g(e,t),s=Reflect.set(e,t,r,I(e)?e:i);return e===F(i)&&(o?u(r,a)&&O(e,`set`,t,r,a):O(e,`add`,t,r)),s}deleteProperty(e,t){let n=g(e,t),r=e[t],i=Reflect.deleteProperty(e,t);return i&&n&&O(e,`delete`,t,void 0,r),i}has(e,t){let n=Reflect.has(e,t);return(!i(t)||!Je.has(t))&&D(e,`has`,t),n}ownKeys(e){return D(e,`iterate`,n(e)?`length`:K),Reflect.ownKeys(e)}},Ze=class extends Ye{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}},Qe=new Xe,$e=new Ze,et=new Xe(!0),tt=e=>e,J=e=>Reflect.getPrototypeOf(e),nt={get:_e(!1,!1)},rt={get:_e(!1,!0)},it={get:_e(!0,!1)},at=new WeakMap,ot=new WeakMap,st=new WeakMap,ct=new WeakMap,Y=e=>o(e)?be(e):e,X=e=>o(e)?Se(e):e,lt=class{constructor(e,t){this.dep=new W,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:F(e),this._value=t?e:Y(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){let t=this._rawValue,n=this.__v_isShallow||P(e)||N(e);e=n?e:F(e),u(e,t)&&(this._rawValue=e,this._value=n?e:Y(e),this.dep.trigger())}},ut={get:(e,t,n)=>t===`__v_raw`?e:ke(Reflect.get(e,t,n)),set:(e,t,n,r)=>{let i=e[t];return I(i)&&!I(n)?(i.value=n,!0):Reflect.set(e,t,n,r)}},dt=class{constructor(e){this.__v_isRef=!0,this._value=void 0;let t=this.dep=new W,{get:n,set:r}=e(t.track.bind(t),t.trigger.bind(t));this._get=n,this._set=r}get value(){return this._value=this._get()}set value(e){this._set(e)}},ft=class{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){let e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return ce(F(this._object),this._key)}},pt=class{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}},mt=class{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new W(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=U-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&z!==this)return S(this,!0),!0}get value(){let e=this.dep.track();return te(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}},Z={},Q=new WeakMap,$=void 0})),gt,_t,vt,yt,bt,xt,St=e((()=>{if(Array.prototype.find||(Array.prototype.find=function(e){if(this===null)throw TypeError(`Array.prototype.find called on null or undefined`);if(typeof e!=`function`)throw TypeError(`predicate must be a function`);for(var t=Object(this),n=t.length>>>0,r=arguments[1],i,a=0;a<n;a++)if(i=t[a],e.call(r,i,a,t))return i}),window&&typeof window.CustomEvent!=`function`){let e=function(e,t){t||={bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent(`CustomEvent`);return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};typeof window.Event<`u`&&(e.prototype=window.Event.prototype),window.CustomEvent=e}gt=class e{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:`TAB`},{key:8,value:`DELETE`},{key:13,value:`ENTER`},{key:27,value:`ESCAPE`},{key:32,value:`SPACE`},{key:38,value:`UP`},{key:40,value:`DOWN`}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener(`keydown`,e.boundKeydown,!1),e.addEventListener(`keyup`,e.boundKeyup,!1),e.addEventListener(`input`,e.boundInput,!1)}unbind(e){e.removeEventListener(`keydown`,e.boundKeydown,!1),e.removeEventListener(`keyup`,e.boundKeyup,!1),e.removeEventListener(`input`,e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(t,n){t.shouldDeactivate(n)&&(t.tribute.isActive=!1,t.tribute.hideMenu());let r=this;t.commandEvent=!1,e.keys().forEach(e=>{e.key===n.keyCode&&(t.commandEvent=!0,t.callbacks()[e.value.toLowerCase()](n,r))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let n=e.tribute;if(n.menu&&n.menu.contains(t.target)){let e=t.target;for(t.preventDefault(),t.stopPropagation();e.nodeName.toLowerCase()!==`li`;)if(e=e.parentNode,!e||e===n.menu)throw Error(`cannot find the <li> container for the click`);n.selectItemAtIndex(e.getAttribute(`data-index`),t),n.hideMenu()}else n.current.element&&!n.current.externalTrigger&&(n.current.externalTrigger=!1,setTimeout(()=>n.hideMenu()))}keyup(e,t){if(e.inputEvent&&=!1,e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,``);else{let n=e.getKeyCode(e,this,t);if(isNaN(n)||!n)return;let r=e.tribute.triggers().find(e=>e.charCodeAt(0)===n);typeof r<`u`&&e.callbacks().triggerChar(t,this,r)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(t){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let n=!1;return e.keys().forEach(e=>{t.keyCode===e.key&&(n=!0)}),!n}return!1}getKeyCode(e,t,n){let r=e.tribute,i=r.range.getTriggerInfo(!1,r.hasTrailingSpace,!0,r.allowSpaces,r.autocompleteMode);return i?i.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,n)=>{let r=this.tribute;r.current.trigger=n;let i=r.collection.find(e=>e.trigger===n);r.current.collection=i,r.current.mentionText.length>=r.current.collection.menuShowMinLength&&r.inputEvent&&r.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length,n=this.tribute.menuSelected;t>n&&n>0?(this.tribute.menuSelected--,this.setActiveLi()):n===0&&(this.tribute.menuSelected=t-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let t=this.tribute.current.filteredItems.length-1,n=this.tribute.menuSelected;t>n?(this.tribute.menuSelected++,this.setActiveLi()):t===n&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll(`li`),n=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let e=0;e<n;e++){let n=t[e];if(e===this.tribute.menuSelected){n.classList.add(this.tribute.current.collection.selectClass);let e=n.getBoundingClientRect(),t=this.tribute.menu.getBoundingClientRect();if(e.bottom>t.bottom){let n=e.bottom-t.bottom;this.tribute.menu.scrollTop+=n}else if(e.top<t.top){let n=t.top-e.top;this.tribute.menu.scrollTop-=n}}else n.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let n=e.getBoundingClientRect().height;if(t){let t=e.currentStyle||window.getComputedStyle(e);return n+parseFloat(t.marginTop)+parseFloat(t.marginBottom)}return n}},_t=class{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.showMenuFor(this.tribute.current.element,!1)},300,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.range.positionMenuAtCaret(!0)},300,!1),this.tribute.range.getDocument().addEventListener(`MSPointerDown`,this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener(`mousedown`,this.menuClickEvent,!1),window.addEventListener(`resize`,this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener(`scroll`,this.menuContainerScrollEvent,!1):window.addEventListener(`scroll`,this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener(`mousedown`,this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener(`MSPointerDown`,this.menuClickEvent,!1),window.removeEventListener(`resize`,this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener(`scroll`,this.menuContainerScrollEvent,!1):window.removeEventListener(`scroll`,this.menuContainerScrollEvent)}debounce(e,t,n){var r;return()=>{var i=this,a=arguments,o=()=>{r=null,n||e.apply(i,a)},s=n&&!r;clearTimeout(r),r=setTimeout(o,t),s&&e.apply(i,a)}}},vt=class{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,n,r=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof r<`u`){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText=`display: block;`;return}n=this.isContentEditable(t.element)?this.getContentEditableCaretPosition(r.mentionPosition):this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,r.mentionPosition),this.tribute.menu.style.cssText=`top: ${n.top}px;
                                     left: ${n.left}px;
                                     right: ${n.right}px;
                                     bottom: ${n.bottom}px;
                                     position: absolute;
                                     display: block;`,n.left===`auto`&&(this.tribute.menu.style.left=`auto`),n.top===`auto`&&(this.tribute.menu.style.top=`auto`),e&&this.scrollIntoView(),window.setTimeout(()=>{let t={width:this.tribute.menu.offsetWidth,height:this.tribute.menu.offsetHeight},r=this.isMenuOffScreen(n,t),i=window.innerWidth>t.width&&(r.left||r.right),a=window.innerHeight>t.height&&(r.top||r.bottom);(i||a)&&(this.tribute.menu.style.cssText=`display: none`,this.positionMenuAtCaret(e))},0)}else this.tribute.menu.style.cssText=`display: none`}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,n){let r,i=e;if(t)for(var a=0;a<t.length;a++){if(i=i.childNodes[t[a]],i===void 0)return;for(;i.length<n;)n-=i.length,i=i.nextSibling;i.childNodes.length===0&&!i.length&&(i=i.previousSibling)}let o=this.getWindowSelection();r=this.getDocument().createRange(),r.setStart(i,n),r.setEnd(i,n),r.collapse(!0);try{o.removeAllRanges()}catch{}o.addRange(r),e.focus()}replaceTriggerText(e,t,n,r,i){let a=this.getTriggerInfo(!0,n,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(a!==void 0){let t=this.tribute.current,n=new CustomEvent(`tribute-replaced`,{detail:{item:i,instance:t,context:a,event:r}});if(this.isContentEditable(t.element)){let t=typeof this.tribute.replaceTextSuffix==`string`?this.tribute.replaceTextSuffix:`\xA0`;e+=t;let n=a.mentionPosition+a.mentionText.length;this.tribute.autocompleteMode||(n+=a.mentionTriggerChar.length),this.pasteHtml(e,a.mentionPosition,n)}else{let t=this.tribute.current.element,n=typeof this.tribute.replaceTextSuffix==`string`?this.tribute.replaceTextSuffix:` `;e+=n;let r=a.mentionPosition,i=a.mentionPosition+a.mentionText.length+n.length;this.tribute.autocompleteMode||(i+=a.mentionTriggerChar.length-1),t.value=t.value.substring(0,r)+e+t.value.substring(i,t.value.length),t.selectionStart=r+e.length,t.selectionEnd=r+e.length}t.element.dispatchEvent(new CustomEvent(`input`,{bubbles:!0})),t.element.dispatchEvent(n)}}pasteHtml(e,t,n){let r,i;i=this.getWindowSelection(),r=this.getDocument().createRange(),r.setStart(i.anchorNode,t),r.setEnd(i.anchorNode,n),r.deleteContents();let a=this.getDocument().createElement(`div`);a.innerHTML=e;let o=this.getDocument().createDocumentFragment(),s,c;for(;s=a.firstChild;)c=o.appendChild(s);r.insertNode(o),c&&(r=r.cloneRange(),r.setStartAfter(c),r.collapse(!0),i.removeAllRanges(),i.addRange(r))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),n=t.anchorNode,r=[],i;if(n!=null){let e,a=n.contentEditable;for(;n!==null&&a!==`true`;)e=this.getNodePositionInParent(n),r.push(e),n=n.parentNode,n!==null&&(a=n.contentEditable);return r.reverse(),i=t.getRangeAt(0).startOffset,{selected:n,path:r,offset:i}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t=``;if(this.isContentEditable(e.element)){let e=this.getWindowSelection().anchorNode;if(e!=null){let n=e.textContent,r=this.getWindowSelection().getRangeAt(0).startOffset;n&&r>=0&&(t=n.substring(0,r))}}else{let e=this.tribute.current.element;if(e){let n=e.selectionStart;e.value&&n>=0&&(t=e.value.substring(0,n))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g,` `);let t=e.split(/\s+/);return t[t.length-1].trim()}getTriggerInfo(e,t,n,r,i){let a=this.tribute.current,o,s,c;if(!this.isContentEditable(a.element))o=this.tribute.current.element;else{let e=this.getContentEditableSelectedPath(a);e&&(o=e.selected,s=e.path,c=e.offset)}let l=this.getTextPrecedingCurrentSelection(),u=this.getLastWordInText(l);if(i)return{mentionPosition:l.length-u.length,mentionText:u,mentionSelectedElement:o,mentionSelectedPath:s,mentionSelectedOffset:c};if(l!=null){let i=-1,a;if(this.tribute.collection.forEach(e=>{let t=e.trigger,r=e.requireLeadingSpace?this.lastIndexWithLeadingSpace(l,t):l.lastIndexOf(t);r>i&&(i=r,a=t,n=e.requireLeadingSpace)}),i>=0&&(i===0||!n||/[\xA0\s]/g.test(l.substring(i-1,i)))){let n=l.substring(i+a.length,l.length);a=l.substring(i,i+a.length);let u=n.substring(0,1),d=n.length>0&&(u===` `||u===`\xA0`);t&&(n=n.trim());let f=r?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=f.test(n),!d&&(e||!f.test(n)))return{mentionPosition:i,mentionText:n,mentionSelectedElement:o,mentionSelectedPath:s,mentionSelectedOffset:c,mentionTriggerChar:a}}}}lastIndexWithLeadingSpace(e,t){let n=e.split(``).reverse().join(``),r=-1;for(let i=0,a=e.length;i<a;i++){let a=i===e.length-1,o=/\s/.test(n[i+1]),s=!0;for(let e=t.length-1;e>=0;e--)if(t[e]!==n[i-e]){s=!1;break}if(s&&(a||o)){r=e.length-1-i;break}}return r}isContentEditable(e){return e.nodeName!==`INPUT`&&e.nodeName!==`TEXTAREA`}isMenuOffScreen(e,t){let n=window.innerWidth,r=window.innerHeight,i=document.documentElement,a=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),o=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),s=typeof e.top==`number`?e.top:o+r-e.bottom-t.height,c=typeof e.right==`number`?e.right:e.left+t.width,l=typeof e.bottom==`number`?e.bottom:e.top+t.height,u=typeof e.left==`number`?e.left:a+n-e.right-t.width;return{top:s<Math.floor(o),right:c>Math.ceil(a+n),bottom:l>Math.ceil(o+r),left:u<Math.floor(a)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText=`display: none;`,e}getTextAreaOrInputUnderlinePosition(e,t,n){let r=`direction.boxSizing.width.height.overflowX.overflowY.borderTopWidth.borderRightWidth.borderBottomWidth.borderLeftWidth.paddingTop.paddingRight.paddingBottom.paddingLeft.fontStyle.fontVariant.fontWeight.fontStretch.fontSize.fontSizeAdjust.lineHeight.fontFamily.textAlign.textTransform.textIndent.textDecoration.letterSpacing.wordSpacing`.split(`.`),i=window.mozInnerScreenX!==null,a=this.getDocument().createElement(`div`);a.id=`input-textarea-caret-position-mirror-div`,this.getDocument().body.appendChild(a);let o=a.style,s=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace=`pre-wrap`,e.nodeName!==`INPUT`&&(o.wordWrap=`break-word`),o.position=`absolute`,o.visibility=`hidden`,r.forEach(e=>{o[e]=s[e]}),i?(o.width=`${parseInt(s.width)-2}px`,e.scrollHeight>parseInt(s.height)&&(o.overflowY=`scroll`)):o.overflow=`hidden`,a.textContent=e.value.substring(0,t),e.nodeName===`INPUT`&&(a.textContent=a.textContent.replace(/\s/g,`\xA0`));let c=this.getDocument().createElement(`span`);c.textContent=e.value.substring(t)||`.`,a.appendChild(c);let l=e.getBoundingClientRect(),u=document.documentElement,d=(window.pageXOffset||u.scrollLeft)-(u.clientLeft||0),f=(window.pageYOffset||u.scrollTop)-(u.clientTop||0),p=0,m=0;this.menuContainerIsBody&&(p=l.top,m=l.left);let h={top:p+f+c.offsetTop+parseInt(s.borderTopWidth)+parseInt(s.fontSize)-e.scrollTop,left:m+d+c.offsetLeft+parseInt(s.borderLeftWidth)},g=window.innerWidth,_=window.innerHeight,v=this.getMenuDimensions(),y=this.isMenuOffScreen(h,v);y.right&&(h.right=g-h.left,h.left=`auto`);let b=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;return y.bottom&&(h.bottom=b-(_-(this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect()).top)+(_-l.top-c.offsetTop),h.top=`auto`),y=this.isMenuOffScreen(h,v),y.left&&(h.left=g>v.width?d+g-v.width:d,delete h.right),y.top&&(h.top=_>v.height?f+_-v.height:f,delete h.bottom),this.getDocument().body.removeChild(a),h}getContentEditableCaretPosition(e){let t,n=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(n.anchorNode,e),t.setEnd(n.anchorNode,e),t.collapse(!1);let r=t.getBoundingClientRect(),i=document.documentElement,a=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),o=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),s=r.left,c=r.top,l={left:s+a,top:c+r.height+o},u=window.innerWidth,d=window.innerHeight,f=this.getMenuDimensions(),p=this.isMenuOffScreen(l,f);p.right&&(l.left=`auto`,l.right=u-r.left-a);let m=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(p.bottom){let e=m-(d-(this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect()).top);l.top=`auto`,l.bottom=e+(d-r.top)}return p=this.isMenuOffScreen(l,f),p.left&&(l.left=u>f.width?a+u-f.width:a,delete l.right),p.top&&(l.top=d>f.height?o+d-f.height:o,delete l.bottom),this.menuContainerIsBody||(l.left=l.left?l.left-this.tribute.menuContainer.offsetLeft:l.left,l.top=l.top?l.top-this.tribute.menuContainer.offsetTop:l.top),l}scrollIntoView(e){let t,n=this.menu;if(typeof n>`u`)return;for(;t===void 0||t.height===0;)if(t=n.getBoundingClientRect(),t.height===0&&(n=n.childNodes[0],n===void 0||!n.getBoundingClientRect))return;let r=t.top,i=r+t.height;if(r<0)window.scrollTo(0,window.pageYOffset+t.top-20);else if(i>window.innerHeight){let e=window.pageYOffset+t.top-20;e-window.pageYOffset>100&&(e=window.pageYOffset+100);let n=window.pageYOffset-(window.innerHeight-i);n>e&&(n=e),window.scrollTo(0,n)}}},yt=class{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(t=>this.test(e,t))}test(e,t){return this.match(e,t)!==null}match(e,t,n){n||={},t.length;let r=n.pre||``,i=n.post||``,a=n.caseSensitive&&t||t.toLowerCase();if(n.skip)return{rendered:t,score:0};e=n.caseSensitive&&e||e.toLowerCase();let o=this.traverse(a,e,0,0,[]);return o?{rendered:this.render(t,o.cache,r,i),score:o.score}:null}traverse(e,t,n,r,i){if(t.length===r)return{score:this.calculateScore(i),cache:i.slice()};if(e.length===n||t.length-r>e.length-n)return;let a=t[r],o=e.indexOf(a,n),s,c;for(;o>-1;){if(i.push(o),c=this.traverse(e,t,o+1,r+1,i),i.pop(),!c)return s;(!s||s.score<c.score)&&(s=c),o=e.indexOf(a,o+1)}return s}calculateScore(e){let t=0,n=1;return e.forEach((r,i)=>{i>0&&(e[i-1]+1===r?n+=n+1:n=1),t+=n}),t}render(e,t,n,r){var i=e.substring(0,t[0]);return t.forEach((a,o)=>{i+=n+e[a]+r+e.substring(a+1,t[o+1]?t[o+1]:e.length)}),i}filter(e,t,n){return n||={},t.reduce((t,r,i,a)=>{let o=r;n.extract&&(o=n.extract(r),o||=``);let s=this.match(e,o,n);return s!=null&&(t[t.length]={string:s.rendered,score:s.score,index:i,original:r}),t},[]).sort((e,t)=>t.score-e.score||e.index-t.index)}},bt=class e{constructor({values:t=null,iframe:n=null,selectClass:r=`highlight`,containerClass:i=`tribute-container`,itemClass:a=``,trigger:o=`@`,autocompleteMode:s=!1,selectTemplate:c=null,menuItemTemplate:l=null,lookup:u=`key`,fillAttr:d=`value`,collection:f=null,menuContainer:p=null,noMatchTemplate:m=null,requireLeadingSpace:h=!0,allowSpaces:g=!1,replaceTextSuffix:_=null,positionMenu:v=!0,spaceSelectsMatch:y=!1,searchOpts:b={},menuItemLimit:x=null,menuShowMinLength:S=0}){if(this.autocompleteMode=s,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=p,this.allowSpaces=g,this.replaceTextSuffix=_,this.positionMenu=v,this.hasTrailingSpace=!1,this.spaceSelectsMatch=y,this.autocompleteMode&&(o=``,g=!1),t)this.collection=[{trigger:o,iframe:n,selectClass:r,containerClass:i,itemClass:a,selectTemplate:(c||e.defaultSelectTemplate).bind(this),menuItemTemplate:(l||e.defaultMenuItemTemplate).bind(this),noMatchTemplate:(e=>typeof e==`string`?e.trim()===``?null:e:typeof e==`function`?e.bind(this):m||function(){return`<li>No Match Found!</li>`}.bind(this))(m),lookup:u,fillAttr:d,values:t,requireLeadingSpace:h,searchOpts:b,menuItemLimit:x,menuShowMinLength:S}];else if(f)this.autocompleteMode&&console.warn(`Tribute in autocomplete mode does not work for collections`),this.collection=f.map(t=>({trigger:t.trigger||o,iframe:t.iframe||n,selectClass:t.selectClass||r,containerClass:t.containerClass||i,itemClass:t.itemClass||a,selectTemplate:(t.selectTemplate||e.defaultSelectTemplate).bind(this),menuItemTemplate:(t.menuItemTemplate||e.defaultMenuItemTemplate).bind(this),noMatchTemplate:(e=>typeof e==`string`?e.trim()===``?null:e:typeof e==`function`?e.bind(this):m||function(){return`<li>No Match Found!</li>`}.bind(this))(m),lookup:t.lookup||u,fillAttr:t.fillAttr||d,values:t.values,requireLeadingSpace:t.requireLeadingSpace,searchOpts:t.searchOpts||b,menuItemLimit:t.menuItemLimit||x,menuShowMinLength:t.menuShowMinLength||S}));else throw Error(`[Tribute] No collection specified.`);new vt(this),new gt(this),new _t(this),new yt(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>`u`?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?`<span class="tribute-mention">`+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+`</span>`:this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return[`TEXTAREA`,`INPUT`]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw Error(`[Tribute] Must pass in a DOM node or NodeList.`);if(typeof jQuery<`u`&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute(`data-tribute`)&&console.warn(`Tribute was already bound to `+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute(`data-tribute`,!0)}ensureEditable(t){if(e.inputTypes().indexOf(t.nodeName)===-1)if(t.contentEditable)t.contentEditable=!0;else throw Error(`[Tribute] Cannot bind to `+t.nodeName)}createMenu(e){let t=this.range.getDocument().createElement(`div`),n=this.range.getDocument().createElement(`ul`);return t.className=e,t.appendChild(n),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText=``);let n=e=>{if(!this.isActive)return;let n=this.search.filter(this.current.mentionText,e,{pre:this.current.collection.searchOpts.pre||`<span>`,post:this.current.collection.searchOpts.post||`</span>`,skip:this.current.collection.searchOpts.skip,extract:e=>{if(typeof this.current.collection.lookup==`string`)return e[this.current.collection.lookup];if(typeof this.current.collection.lookup==`function`)return this.current.collection.lookup(e,this.current.mentionText);throw Error(`Invalid lookup attribute, lookup must be string or function.`)}});this.current.collection.menuItemLimit&&(n=n.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=n;let r=this.menu.querySelector(`ul`);if(this.range.positionMenuAtCaret(t),!n.length){let e=new CustomEvent(`tribute-no-match`,{detail:this.menu});this.current.element.dispatchEvent(e),typeof this.current.collection.noMatchTemplate==`function`&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():typeof this.current.collection.noMatchTemplate==`function`?r.innerHTML=this.current.collection.noMatchTemplate():r.innerHTML=this.current.collection.noMatchTemplate;return}r.innerHTML=``;let i=this.range.getDocument().createDocumentFragment();n.forEach((e,t)=>{let n=this.range.getDocument().createElement(`li`);n.setAttribute(`data-index`,t),n.className=this.current.collection.itemClass,n.addEventListener(`mousemove`,e=>{let[t,n]=this._findLiTarget(e.target);e.movementY!==0&&this.events.setActiveLi(n)}),this.menuSelected===t&&n.classList.add(this.current.collection.selectClass),n.innerHTML=this.current.collection.menuItemTemplate(e),i.appendChild(n)}),r.appendChild(i)};typeof this.current.collection.values==`function`?this.current.collection.values(this.current.mentionText,n):n(this.current.collection.values)}_findLiTarget(e){if(!e)return[];let t=e.getAttribute(`data-index`);return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<`u`&&typeof document.createRange<`u`){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if(typeof document.body.createTextRange<`u`){var r=document.body.createTextRange();r.moveToElementText(e),r.collapse(!1),r.select()}}insertTextAtCursor(e){var t=window.getSelection(),n=t.getRangeAt(0);n.deleteContents();var r=document.createTextNode(e);n.insertNode(r),n.selectNodeContents(r),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}insertAtCaret(e,t){var n=e.scrollTop,r=e.selectionStart,i=e.value.substring(0,r),a=e.value.substring(e.selectionEnd,e.value.length);e.value=i+t+a,r+=t.length,e.selectionStart=r,e.selectionEnd=r,e.focus(),e.scrollTop=n}hideMenu(){this.menu&&(this.menu.style.cssText=`display: none;`,this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!=`number`||isNaN(e))return;let n=this.current.filteredItems[e],r=this.current.collection.selectTemplate(n);r!==null&&this.replaceText(r,t,n)}replaceText(e,t,n){this.range.replaceTriggerText(e,!0,!0,t,n)}_append(e,t,n){if(typeof e.values==`function`)throw Error(`Unable to append to values, as it is a function.`);n?e.values=t:e.values=e.values.concat(t)}append(e,t,n){let r=parseInt(e);if(typeof r!=`number`)throw Error(`please provide an index for the collection to update.`);let i=this.collection[r];this._append(i,t,n)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw Error(`No active state. Please use append instead and pass an index.`)}detach(e){if(!e)throw Error(`[Tribute] Must pass in a DOM node or NodeList.`);if(typeof jQuery<`u`&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let n=e.length;for(var t=0;t<n;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute(`data-tribute`),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}},xt=bt}));export{Ae as A,xe as C,Y as D,F as E,Le as F,L as M,O as N,X as O,ke as P,ae as S,De as T,ie as _,Fe as a,Se as b,b as c,M as d,N as f,x as g,Te as h,Be as i,D as j,Ne as k,ht as l,P as m,xt as n,Me as o,I as p,Re as r,y as s,St as t,we as u,je as v,le as w,Ee as x,be as y};
//# sourceMappingURL=common-ClkJEDcz.chunk.mjs.map