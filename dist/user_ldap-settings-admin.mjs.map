{"version":3,"file":"user_ldap-settings-admin.mjs","sources":["../build/frontend/apps/user_ldap/src/services/logger.ts","../build/frontend/apps/user_ldap/src/services/ldapConfigService.ts","../build/frontend/apps/user_ldap/src/store/configs.ts","../build/frontend/apps/user_ldap/src/components/SettingsTabs/AdvancedTab.vue","../build/frontend/apps/user_ldap/src/components/SettingsTabs/ExpertTab.vue","../build/frontend/apps/user_ldap/src/components/SettingsTabs/GroupsTab.vue","../build/frontend/apps/user_ldap/src/components/SettingsTabs/LoginTab.vue","../node_modules/vue-material-design-icons/Delete.vue","../build/frontend/apps/user_ldap/src/components/SettingsTabs/ServerTab.vue","../build/frontend/apps/user_ldap/src/components/SettingsTabs/UsersTab.vue","../build/frontend/apps/user_ldap/src/components/WizardControls.vue","../build/frontend/apps/user_ldap/src/views/LDAPSettingsApp.vue","../build/frontend/apps/user_ldap/src/store/index.ts","../build/frontend/apps/user_ldap/src/settings-admin.ts"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { getLoggerBuilder } from '@nextcloud/logger'\n\nexport default getLoggerBuilder()\n\t.setApp('LDAP')\n\t.detectUser()\n\t.build()\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { AxiosError } from '@nextcloud/axios'\nimport type { AxiosResponse } from '@nextcloud/axios'\nimport type { OCSResponse } from '@nextcloud/typings/ocs'\nimport type { LDAPConfig } from '../models/index.ts'\n\nimport axios, { isAxiosError } from '@nextcloud/axios'\nimport { getDialogBuilder, showError, showSuccess } from '@nextcloud/dialogs'\nimport { t } from '@nextcloud/l10n'\nimport { generateOcsUrl } from '@nextcloud/router'\nimport logger from './logger.ts'\n\nexport type WizardAction\n\t= 'guessPortAndTLS'\n\t\t| 'guessBaseDN'\n\t\t| 'detectEmailAttribute'\n\t\t| 'detectUserDisplayNameAttribute'\n\t\t| 'determineGroupMemberAssoc'\n\t\t| 'determineUserObjectClasses'\n\t\t| 'determineGroupObjectClasses'\n\t\t| 'determineGroupsForUsers'\n\t\t| 'determineGroupsForGroups'\n\t\t| 'determineAttributes'\n\t\t| 'getUserListFilter'\n\t\t| 'getUserLoginFilter'\n\t\t| 'getGroupFilter'\n\t\t| 'countUsers'\n\t\t| 'countGroups'\n\t\t| 'countInBaseDN'\n\t\t| 'testLoginName'\n\n/**\n * Create a new LDAP configuration\n */\nexport async function createConfig() {\n\tconst response = await axios.post(generateOcsUrl('apps/user_ldap/api/v1/config')) as AxiosResponse<OCSResponse<{ configID: string }>>\n\tlogger.debug('Created configuration', { configId: response.data.ocs.data.configID })\n\treturn response.data.ocs.data.configID\n}\n\n/**\n * Copy an existing LDAP configuration\n *\n * @param configId - ID of the configuration to copy\n */\nexport async function copyConfig(configId: string) {\n\tconst params = new FormData()\n\tparams.set('copyConfig', configId)\n\n\tconst response = await axios.post(\n\t\tgenerateOcsUrl('apps/user_ldap/api/v1/config/{configId}/copy', { configId }),\n\t\tparams,\n\t) as AxiosResponse<OCSResponse<{ configID: string }>>\n\n\tlogger.debug('Created configuration', { configId: response.data.ocs.data.configID })\n\treturn response.data.ocs.data.configID\n}\n\n/**\n * Get an LDAP configuration\n *\n * @param configId - ID of the configuration to fetch\n */\nexport async function getConfig(configId: string): Promise<LDAPConfig> {\n\tconst response = await axios.get(generateOcsUrl('apps/user_ldap/api/v1/config/{configId}', { configId })) as AxiosResponse<OCSResponse<LDAPConfig>>\n\tlogger.debug('Fetched configuration', { configId, config: response.data.ocs.data })\n\treturn response.data.ocs.data\n}\n\n/**\n * Update an LDAP configuration\n *\n * @param configId - ID of the configuration to update\n * @param config - Partial configuration data to update\n */\nexport async function updateConfig(configId: string, config: Partial<LDAPConfig>): Promise<LDAPConfig> {\n\tconst response = await axios.put(\n\t\tgenerateOcsUrl('apps/user_ldap/api/v1/config/{configId}', { configId }),\n\t\t{ configData: config },\n\t) as AxiosResponse<OCSResponse<LDAPConfig>>\n\n\tlogger.debug('Updated configuration', { configId, config })\n\n\treturn response.data.ocs.data\n}\n\n/**\n * Delete an LDAP configuration\n *\n * @param configId - ID of the configuration to delete\n */\nexport async function deleteConfig(configId: string): Promise<boolean> {\n\ttry {\n\t\tconst isConfirmed = await confirmOperation(\n\t\t\tt('user_ldap', 'Confirm action'),\n\t\t\tt('user_ldap', 'Are you sure you want to permanently delete this LDAP configuration? This cannot be undone.'),\n\t\t)\n\t\tif (!isConfirmed) {\n\t\t\treturn false\n\t\t}\n\n\t\tawait axios.delete(generateOcsUrl('apps/user_ldap/api/v1/config/{configId}', { configId }))\n\t\tlogger.debug('Deleted configuration', { configId })\n\t} catch (error) {\n\t\tconst errorResponse = (error as AxiosError<OCSResponse>).response\n\t\tshowError(errorResponse?.data.ocs.meta.message || t('user_ldap', 'Failed to delete config'))\n\t}\n\n\treturn true\n}\n\n/**\n * Test an LDAP configuration\n *\n * @param configId - ID of the configuration to test\n */\nexport async function testConfiguration(configId: string) {\n\tconst params = new FormData()\n\n\tconst response = await axios.post(generateOcsUrl('apps/user_ldap/api/v1/config/{configId}/test', { configId })) as AxiosResponse<OCSResponse<{ success: boolean, message: string }>>\n\n\tlogger.debug(`Configuration is ${response.data.ocs.data.success ? 'valide' : 'invalide'}`, { configId, params, response })\n\n\treturn response.data.ocs.data\n}\n\n/**\n * Clear LDAP mapping\n *\n * @param subject - 'user' or 'group'\n */\nexport async function clearMapping(subject: 'user' | 'group') {\n\tconst isConfirmed = await confirmOperation(\n\t\tt('user_ldap', 'Confirm action'),\n\t\tt('user_ldap', 'Are you sure you want to permanently clear the LDAP mapping? This cannot be undone.'),\n\t)\n\tif (!isConfirmed) {\n\t\treturn false\n\t}\n\n\ttry {\n\t\tconst response = await axios.post(\n\t\t\tgenerateOcsUrl('apps/user_ldap/api/v1/wizard/clearMappings'),\n\t\t\t{ subject },\n\t\t) as AxiosResponse<OCSResponse>\n\n\t\tlogger.debug('Cleared mapping', { subject, response })\n\t\tshowSuccess(t('user_ldap', 'Mapping cleared'))\n\t\treturn true\n\t} catch (error) {\n\t\tconst errorResponse = (error as AxiosError<OCSResponse>).response\n\t\tshowError(errorResponse?.data.ocs.meta.message || t('user_ldap', 'Failed to clear mapping'))\n\t}\n}\n\n/**\n * Call wizard action\n *\n * @param action - The wizard action to call\n * @param configId - ID of the configuration\n * @param extraParams - Additional parameters for the wizard action\n */\nexport async function callWizard(action: WizardAction, configId: string, extraParams: Record<string, string> = {}) {\n\tconst params = new FormData()\n\n\tObject.entries(extraParams).forEach(([key, value]) => {\n\t\tparams.set(key, value)\n\t})\n\n\ttry {\n\t\tconst response = await axios.post(\n\t\t\tgenerateOcsUrl('apps/user_ldap/api/v1/wizard/{configId}/{action}', { configId, action }),\n\t\t\tparams,\n\t\t) as AxiosResponse<OCSResponse<{ changes?: Record<string, unknown>, options?: Record<string, []> }>>\n\n\t\tlogger.debug(`Called wizard action: ${action}`, { configId, params, response })\n\n\t\treturn response.data.ocs.data\n\t} catch (error) {\n\t\tlet message = t('user_ldap', 'An error occurred')\n\n\t\tif (isAxiosError(error) && error.response?.data.ocs.meta.status === 'failure') {\n\t\t\tif (error.response.data.ocs.meta.message !== '' && error.response.data.ocs.meta.message !== undefined) {\n\t\t\t\tmessage = error.response.data.ocs.meta.message\n\t\t\t}\n\t\t}\n\n\t\tshowError(message)\n\n\t\tthrow error\n\t}\n}\n\n/**\n * Show info dialog when enabling automatic filter mode\n */\nexport async function showEnableAutomaticFilterInfo() {\n\treturn await confirmOperation(\n\t\tt('user_ldap', 'Mode switch'),\n\t\tt('user_ldap', 'Switching the mode will enable automatic LDAP queries. Depending on your LDAP size they may take a while. Do you still want to switch the mode?'),\n\t)\n}\n\n/**\n * Show confirmation dialog for dangerous operations\n *\n * @param name - Dialog title\n * @param text - Dialog text\n */\nexport async function confirmOperation(name: string, text: string): Promise<boolean> {\n\tlet result = false\n\tconst dialog = getDialogBuilder(name)\n\t\t.setText(text)\n\t\t.setSeverity('warning')\n\t\t.addButton({\n\t\t\tlabel: t('user_ldap', 'Cancel'),\n\t\t\tcallback() {},\n\t\t})\n\t\t.addButton({\n\t\t\tlabel: t('user_ldap', 'Confirm'),\n\t\t\tvariant: 'error',\n\t\t\tcallback() {\n\t\t\t\tresult = true\n\t\t\t},\n\t\t})\n\t\t.build()\n\n\tawait dialog.show()\n\treturn result\n}\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport type { LDAPConfig } from '../models/index.ts'\n\nimport { loadState } from '@nextcloud/initial-state'\nimport { defineStore } from 'pinia'\nimport { computed, ref } from 'vue'\nimport { copyConfig, createConfig, deleteConfig, getConfig, updateConfig } from '../services/ldapConfigService.ts'\n\nexport const useLDAPConfigsStore = defineStore('ldap-configs', () => {\n\tconst ldapConfigs = ref(loadState('user_ldap', 'ldapConfigs') as Record<string, LDAPConfig>)\n\tconst selectedConfigId = ref<string | undefined>(Object.keys(ldapConfigs.value)[0])\n\tconst selectedConfig = computed(() => selectedConfigId.value === undefined ? undefined : ldapConfigs.value[selectedConfigId.value])\n\tconst updatingConfig = ref(0)\n\n\t/**\n\t * Get a proxy for the LDAP configuration that automatically updates the backend on property set\n\t *\n\t * @param configId - ID of the configuration\n\t * @param postSetHooks - Optional hooks to call after a property has been set\n\t */\n\tfunction getConfigProxy<J>(configId: string, postSetHooks: Partial<Record<keyof LDAPConfig, (value: J) => void>> = {}) {\n\t\tif (ldapConfigs.value[configId] === undefined) {\n\t\t\tthrow new Error(`Config with id ${configId} does not exist`)\n\t\t}\n\n\t\treturn new Proxy(ldapConfigs.value[configId], {\n\t\t\tget(target, property) {\n\t\t\t\treturn target[property]\n\t\t\t},\n\t\t\tset(target, property: string, newValue) {\n\t\t\t\ttarget[property] = newValue\n\n\t\t\t\t;(async () => {\n\t\t\t\t\tupdatingConfig.value++\n\t\t\t\t\tawait updateConfig(configId, { [property]: newValue })\n\t\t\t\t\tupdatingConfig.value--\n\n\t\t\t\t\tif (postSetHooks[property] !== undefined) {\n\t\t\t\t\t\tpostSetHooks[property](target[property])\n\t\t\t\t\t}\n\t\t\t\t})()\n\n\t\t\t\treturn true\n\t\t\t},\n\t\t})\n\t}\n\n\t/**\n\t * Create a new LDAP configuration\n\t */\n\tasync function create() {\n\t\tconst configId = await createConfig()\n\t\tldapConfigs.value[configId] = await getConfig(configId)\n\t\tselectedConfigId.value = configId\n\t\treturn configId\n\t}\n\n\t/**\n\t * Copy an existing LDAP configuration\n\t *\n\t * @param fromConfigId - ID of the configuration to copy\n\t */\n\tasync function _copyConfig(fromConfigId: string) {\n\t\tif (ldapConfigs.value[fromConfigId] === undefined) {\n\t\t\tthrow new Error(`Config with id ${fromConfigId} does not exist`)\n\t\t}\n\n\t\tconst configId = await copyConfig(fromConfigId)\n\n\t\tldapConfigs.value[configId] = { ...ldapConfigs.value[fromConfigId] }\n\t\tselectedConfigId.value = configId\n\t\treturn configId\n\t}\n\n\t/**\n\t * Delete an LDAP configuration\n\t *\n\t * @param configId - ID of the configuration to delete\n\t */\n\tasync function removeConfig(configId: string) {\n\t\tconst result = await deleteConfig(configId)\n\n\t\tif (result === true) {\n\t\t\tif (Object.keys(ldapConfigs.value).length === 1) {\n\t\t\t\t// Ensure at least one config exists before deleting the last one\n\t\t\t\tselectedConfigId.value = await create()\n\t\t\t\t// The new config id could be the same as the deleted one, so only delete if different\n\t\t\t\tif (selectedConfigId.value !== configId) {\n\t\t\t\t\tdelete ldapConfigs.value[configId]\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Select the first config that is not the deleted one\n\t\t\t\tselectedConfigId.value = Object.keys(ldapConfigs.value).filter((_configId) => configId !== _configId)[0]\n\t\t\t\tdelete ldapConfigs.value[configId]\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tldapConfigs,\n\t\tselectedConfigId,\n\t\tselectedConfig,\n\t\tupdatingConfig,\n\t\tgetConfigProxy,\n\t\tcreate,\n\t\tcopyConfig: _copyConfig,\n\t\tremoveConfig,\n\t}\n})\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__advanced\">\n\t\t<details open name=\"ldap-wizard__advanced__section\" class=\"ldap-wizard__advanced__section\">\n\t\t\t<summary><h3>{{ t('user_ldap', 'Connection Settings') }}</h3></summary>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Backup (Replica) Host')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapBackupHost\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Give an optional backup host. It must be a replica of the main LDAP/AD server.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapBackupHost = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\ttype=\"number\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapBackupPort\"\n\t\t\t\t:label=\"t('user_ldap', 'Backup (Replica) Port')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapBackupPort = event.target.value\" />\n\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapOverrideMainServer === '1'\"\n\t\t\t\ttype=\"switch\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'Only connect to the replica server.')\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.ldapOverrideMainServer = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Disable Main Server') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.turnOffCertCheck === '1'\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'Not recommended, use it for testing only! If connection only works with this option, import the LDAP server\\'s SSL certificate in your {instanceName} server.', { instanceName })\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.turnOffCertCheck = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Turn off SSL certificate validation.') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcTextField\n\t\t\t\ttype=\"number\"\n\t\t\t\t:label=\"t('user_ldap', 'Cache Time-To-Live')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapCacheTTL\"\n\t\t\t\t:helperText=\"t('user_ldap', 'in seconds. A change empties the cache.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapCacheTTL = event.target.value\" />\n\t\t</details>\n\n\t\t<details name=\"ldap-wizard__advanced__section\" class=\"ldap-wizard__advanced__section\">\n\t\t\t<summary><h3>{{ t('user_ldap', 'Directory Settings') }}</h3></summary>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapUserDisplayName\"\n\t\t\t\t:label=\"t('user_ldap', 'User Display Name Field')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'The LDAP attribute to use to generate the user\\'s display name.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapUserDisplayName = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapUserDisplayName2\"\n\t\t\t\t:label=\"t('user_ldap', '2nd User Display Name Field')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Optional. An LDAP attribute to be added to the display name in brackets. Results in e.g. »John Doe (john.doe@example.org)«.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapUserDisplayName2 = event.target.value\" />\n\n\t\t\t<NcTextArea\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapBaseUsers\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'One User Base DN per line')\"\n\t\t\t\t:label=\"t('user_ldap', 'Base User Tree')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapBaseUsers = event.target.value\" />\n\n\t\t\t<NcTextArea\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributesForUserSearch\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'Optional; one attribute per line')\"\n\t\t\t\t:label=\"t('user_ldap', 'User Search Attributes')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributesForUserSearch = event.target.value\" />\n\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.markRemnantsAsDisabled === '1'\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'When switched on, users imported from LDAP which are then missing will be disabled')\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.markRemnantsAsDisabled = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Disable users missing from LDAP') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapGroupDisplayName\"\n\t\t\t\t:label=\"t('user_ldap', 'Group Display Name Field')\"\n\t\t\t\t:title=\"t('user_ldap', 'The LDAP attribute to use to generate the groups\\'s display name.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapGroupDisplayName = event.target.value\" />\n\n\t\t\t<NcTextArea\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapBaseGroups\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'One Group Base DN per line')\"\n\t\t\t\t:label=\"t('user_ldap', 'Base Group Tree')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapBaseGroups = event.target.value\" />\n\n\t\t\t<NcTextArea\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributesForGroupSearch\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'Optional; one attribute per line')\"\n\t\t\t\t:label=\"t('user_ldap', 'Group Search Attributes')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributesForGroupSearch = event.target.value\" />\n\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapConfigProxy.ldapGroupMemberAssocAttr\"\n\t\t\t\t:options=\"Object.keys(groupMemberAssociation)\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Group-Member association')\">\n\t\t\t\t<template #option=\"{ label }\">\n\t\t\t\t\t{{ groupMemberAssociation[label] }}\n\t\t\t\t</template>\n\t\t\t\t<template #selected-option=\"{ label }\">\n\t\t\t\t\t{{ groupMemberAssociation[label] }}\n\t\t\t\t</template>\n\t\t\t</NcSelect>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Dynamic Group Member URL')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapDynamicGroupMemberURL\"\n\t\t\t\t:helperText=\"t('user_ldap', 'The LDAP attribute that on group objects contains an LDAP search URL that determines what objects belong to the group. (An empty setting disables dynamic group membership functionality.)')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapDynamicGroupMemberURL = event.target.value\" />\n\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapNestedGroups === '1'\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'When switched on, groups that contain groups are supported. (Only works if the group member attribute contains DNs.)')\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.ldapNestedGroups = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Nested Groups') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcTextField\n\t\t\t\ttype=\"number\"\n\t\t\t\t:label=\"t('user_ldap', 'Paging chunksize')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapPagingSize\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Chunksize used for paged LDAP searches that may return bulky results like user or group enumeration. (Setting it 0 disables paged LDAP searches in those situations.)')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapPagingSize = event.target.value\" />\n\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.turnOnPasswordChange === '1'\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'Allow LDAP users to change their password and allow Super Administrators and Group Administrators to change the password of their LDAP users. Only works when access control policies are configured accordingly on the LDAP server. As passwords are sent in plaintext to the LDAP server, transport encryption must be used and password hashing should be configured on the LDAP server.')\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.turnOnPasswordChange = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Enable LDAP password changes per user') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<span class=\"tablecell\">\n\t\t\t\t{{ t('user_ldap', '(New password is sent as plain text to LDAP)') }}\n\t\t\t</span>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Default password policy DN')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapDefaultPPolicyDN\"\n\t\t\t\t:helperText=\"t('user_ldap', 'The DN of a default password policy that will be used for password expiry handling. Works only when LDAP password changes per user are enabled and is only supported by OpenLDAP. Leave empty to disable password expiry handling.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapDefaultPPolicyDN = event.target.value\" />\n\t\t</details>\n\n\t\t<details name=\"ldap-wizard__advanced__section\" class=\"ldap-wizard__advanced__section\">\n\t\t\t<summary><h3>{{ t('user_ldap', 'Special Attributes') }}</h3></summary>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapQuotaAttribute\"\n\t\t\t\t:label=\"t('user_ldap', 'Quota Field')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Leave empty for user\\'s default quota. Otherwise, specify an LDAP/AD attribute.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapQuotaAttribute = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapQuotaDefault\"\n\t\t\t\t:label=\"t('user_ldap', 'Quota Default')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Override default quota for LDAP users who do not have a quota set in the Quota Field.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapQuotaDefault = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapEmailAttribute\"\n\t\t\t\t:label=\"t('user_ldap', 'Email Field')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Set the user\\'s email from their LDAP attribute. Leave it empty for default behaviour.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapEmailAttribute = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'User Home Folder Naming Rule')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.homeFolderNamingRule\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Leave empty for username (default). Otherwise, specify an LDAP/AD attribute.')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.homeFolderNamingRule = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', '`$home` Placeholder Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapExtStorageHomeAttribute\"\n\t\t\t\t:helperText=\"t('user_ldap', '$home in an external storage configuration will be replaced with the value of the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapExtStorageHomeAttribute = event.target.value\" />\n\t\t</details>\n\n\t\t<details name=\"ldap-wizard__advanced__section\" class=\"ldap-wizard__advanced__section\">\n\t\t\t<summary><h3>{{ t('user_ldap', 'User Profile Attributes') }}</h3></summary>\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Phone Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributePhone\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Phone will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributePhone = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Website Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeWebsite\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Website will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeWebsite = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Address Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeAddress\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Address will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeAddress = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Twitter Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeTwitter\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Twitter will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeTwitter = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Fediverse Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeFediverse\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Fediverse will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeFediverse = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Organisation Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeOrganisation\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Organisation will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeOrganisation = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Role Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeRole\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Role will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeRole = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Headline Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeHeadline\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Headline will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeHeadline = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Biography Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeBiography\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Biography will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeBiography = event.target.value\" />\n\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Birthdate Field')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapAttributeBirthDate\"\n\t\t\t\t:helperText=\"t('user_ldap', 'User profile Date of birth will be set from the specified attribute')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapAttributeBirthDate = event.target.value\" />\n\t\t</details>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { t } from '@nextcloud/l10n'\nimport { NcCheckboxRadioSwitch, NcSelect, NcTextArea, NcTextField } from '@nextcloud/vue'\nimport { computed } from 'vue'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId))\n\nconst instanceName = (getCapabilities() as { theming: { name: string } }).theming.name\n\nconst groupMemberAssociation = {\n\tuniqueMember: 'uniqueMember',\n\tmemberUid: 'memberUid',\n\tmember: 'member (AD)',\n\tgidNumber: 'gidNumber',\n\tzimbraMailForwardingAddress: 'zimbraMailForwardingAddress',\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__advanced {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\t&__section {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tborder: 1px solid var(--color-text-lighter);\n\t\tborder-radius: var(--border-radius);\n\t\tpadding: 8px;\n\n\t\t& > * {\n\t\t\tmargin-top: 12px !important;\n\t\t}\n\n\t\tsummary {\n\t\t\tmargin-top: 0 !important;\n\n\t\t\th3 {\n\t\t\t\tmargin: 0;\n\t\t\t\tdisplay: inline;\n\t\t\t\tcursor: pointer;\n\t\t\t\tcolor: var(--color-text-lighter);\n\t\t\t\tfont-size: 16px;\n\n\t\t\t}\n\t\t}\n\n\t\t&:hover, &[open] {\n\t\t\th3 {\n\t\t\t\tcolor: var(--color-text-light);\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__expert\">\n\t\t<div class=\"ldap-wizard__expert__line\">\n\t\t\t<strong>{{ t('user_ldap', 'Internal Username') }}</strong>\n\t\t\t<p id=\"ldap_expert_username_attr\">\n\t\t\t\t{{ t('user_ldap', 'By default the internal username will be created from the UUID attribute. It makes sure that the username is unique and characters do not need to be converted. The internal username has the restriction that only these characters are allowed: [a-zA-Z0-9_.@-]. Other characters are replaced with their ASCII correspondence or simply omitted. On collisions a number will be added/increased. The internal username is used to identify a user internally. It is also the default name for the user home folder. It is also a part of remote URLs, for instance for all DAV services. With this setting, the default behavior can be overridden. Changes will have effect only on newly mapped (added) LDAP users. Leave it empty for default behavior.') }}\n\t\t\t</p>\n\t\t\t<NcTextField\n\t\t\t\taria-describedby=\"ldap_expert_username_attr\"\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'Internal Username Attribute:')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapExpertUsernameAttr\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapExpertUsernameAttr = event.target.value\" />\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__expert__line\">\n\t\t\t<strong>{{ t('user_ldap', 'Override UUID detection') }}</strong>\n\t\t\t<p id=\"ldap_expert_uuid_user_attr\">\n\t\t\t\t{{ t('user_ldap', 'By default, the UUID attribute is automatically detected. The UUID attribute is used to doubtlessly identify LDAP users and groups. Also, the internal username will be created based on the UUID, if not specified otherwise above. You can override the setting and pass an attribute of your choice. You must make sure that the attribute of your choice can be fetched for both users and groups and it is unique. Leave it empty for default behavior. Changes will have effect only on newly mapped (added) LDAP users and groups.') }}\n\t\t\t</p>\n\t\t\t<NcTextField\n\t\t\t\taria-describedby=\"ldap_expert_uuid_user_attr\"\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'UUID Attribute for Users')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapExpertUUIDUserAttr\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapExpertUUIDUserAttr = event.target.value\" />\n\t\t\t<NcTextField\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t:label=\"t('user_ldap', 'UUID Attribute for Groups')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapExpertUUIDGroupAttr\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapExpertUUIDGroupAttr = event.target.value\" />\n\t\t</div>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { t } from '@nextcloud/l10n'\nimport { NcTextField } from '@nextcloud/vue'\nimport { computed } from 'vue'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId))\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__expert {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\t&__line {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding-inline-start: 32px;\n\t\tgap: 4px;\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__groups\">\n\t\t<legend>\n\t\t\t{{ t('user_ldap', 'Groups meeting these criteria are available in {instanceName}:', { instanceName }) }}\n\t\t</legend>\n\n\t\t<div class=\"ldap-wizard__groups__line ldap-wizard__groups__filter-selection\">\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapGroupFilterObjectclass\"\n\t\t\t\tclass=\"ldap-wizard__groups__group-filter-groups__select\"\n\t\t\t\t:options=\"groupObjectClasses\"\n\t\t\t\t:disabled=\"ldapConfigProxy.ldapGroupFilterMode === '1'\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Only these object classes:')\"\n\t\t\t\t:multiple=\"true\" />\n\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapGroupFilterGroups\"\n\t\t\t\tclass=\"ldap-wizard__groups__group-filter-groups__select\"\n\t\t\t\t:options=\"groupGroups\"\n\t\t\t\t:disabled=\"ldapConfigProxy.ldapGroupFilterMode === '1'\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Only from these groups:')\"\n\t\t\t\t:multiple=\"true\" />\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__groups__line ldap-wizard__groups__groups-filter\">\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapGroupFilterMode === '1'\"\n\t\t\t\t@update:modelValue=\"toggleFilterMode\">\n\t\t\t\t{{ t('user_ldap', 'Edit LDAP Query') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<div v-if=\"ldapConfigProxy.ldapGroupFilterMode === '1'\">\n\t\t\t\t<NcTextArea\n\t\t\t\t\tv-model=\"ldapConfigProxy.ldapGroupFilter\"\n\t\t\t\t\t:placeholder=\"t('user_ldap', 'Edit LDAP Query')\"\n\t\t\t\t\t:helperText=\"t('user_ldap', 'The filter specifies which LDAP groups shall have access to the {instanceName} instance.', { instanceName })\" />\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t<span>{{ t('user_ldap', 'LDAP Filter:') }}</span>\n\t\t\t\t<code>{{ ldapConfigProxy.ldapGroupFilter }}</code>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__groups__line ldap-wizard__groups__groups-count-check\">\n\t\t\t<NcButton :disabled=\"loadingGroupCount\" @click=\"countGroups\">\n\t\t\t\t{{ t('user_ldap', 'Verify settings and count the groups') }}\n\t\t\t</NcButton>\n\n\t\t\t<NcLoadingIcon v-if=\"loadingGroupCount\" :size=\"20\" />\n\t\t\t<span v-if=\"groupsCountLabel !== undefined && !loadingGroupCount\">{{ groupsCountLabel }}</span>\n\t\t</div>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { t } from '@nextcloud/l10n'\nimport { NcButton, NcCheckboxRadioSwitch, NcLoadingIcon, NcSelect, NcTextArea } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, ref } from 'vue'\nimport { callWizard, showEnableAutomaticFilterInfo } from '../../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { ldapConfigs } = storeToRefs(ldapConfigsStore)\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId, {\n\tldapGroupFilterObjectclass: getGroupFilter,\n\tldapGroupFilterGroups: getGroupFilter,\n}))\n\nconst instanceName = (getCapabilities() as { theming: { name: string } }).theming.name\n\nconst groupsCountLabel = ref<number | undefined>(undefined)\n\nconst groupObjectClasses = ref([] as string[])\nconst groupGroups = ref([] as string[])\nconst loadingGroupCount = ref(false)\n\nconst ldapGroupFilterObjectclass = computed({\n\tget() { return ldapConfigProxy.value.ldapGroupFilterObjectclass.split(';').filter((item) => item !== '') },\n\tset(value) { ldapConfigProxy.value.ldapGroupFilterObjectclass = value.join(';') },\n})\nconst ldapGroupFilterGroups = computed({\n\tget() { return ldapConfigProxy.value.ldapGroupFilterGroups.split(';').filter((item) => item !== '') },\n\tset(value) { ldapConfigProxy.value.ldapGroupFilterGroups = value.join(';') },\n})\n\n/**\n *\n */\nasync function init() {\n\tconst response1 = await callWizard('determineGroupObjectClasses', props.configId)\n\tgroupObjectClasses.value = response1.options?.ldap_groupfilter_objectclass ?? []\n\n\tconst response2 = await callWizard('determineGroupsForGroups', props.configId)\n\tgroupGroups.value = response2.options?.ldap_groupfilter_groups ?? []\n}\n\ninit()\n\n/**\n *\n */\nasync function getGroupFilter() {\n\tconst response = await callWizard('getGroupFilter', props.configId)\n\t// Not using ldapConfig to avoid triggering the save logic.\n\tldapConfigs.value[props.configId]!.ldapGroupFilter = (response.changes?.ldap_group_filter as string | undefined) ?? ''\n}\n\n/**\n *\n */\nasync function countGroups() {\n\ttry {\n\t\tloadingGroupCount.value = true\n\t\tconst response = await callWizard('countGroups', props.configId)\n\t\tgroupsCountLabel.value = response.changes!.ldap_group_count as number\n\t} finally {\n\t\tloadingGroupCount.value = false\n\t}\n}\n\n/**\n * Toggle filter mode\n *\n * @param value - new value\n */\nasync function toggleFilterMode(value: boolean) {\n\tif (value) {\n\t\tldapConfigProxy.value.ldapGroupFilterMode = '1'\n\t} else {\n\t\tldapConfigProxy.value.ldapGroupFilterMode = await showEnableAutomaticFilterInfo() ? '0' : '1'\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__groups {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\t&__line {\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t}\n\n\t&__filter-selection {\n\t\tflex-direction: column;\n\t}\n\n\t&__groups-filter {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\n\t\tcode {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t\tpadding: 4px;\n\t\t\tborder-radius: 4px;\n\t\t}\n\t}\n\n\t&__groups-count-check {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__login\">\n\t\t<legend>\n\t\t\t{{ t('user_ldap', 'When logging in, {instanceName} will find the user based on the following attributes:', { instanceName }) }}\n\t\t</legend>\n\n\t\t<NcCheckboxRadioSwitch\n\t\t\t:modelValue=\"ldapConfigProxy.ldapLoginFilterUsername === '1'\"\n\t\t\t:description=\"t('user_ldap', 'Allows login against the LDAP/AD username, which is either \\'uid\\' or \\'sAMAccountName\\' and will be detected.')\"\n\t\t\t@update:modelValue=\"ldapConfigProxy.ldapLoginFilterUsername = $event ? '1' : '0'\">\n\t\t\t{{ t('user_ldap', 'LDAP/AD Username:') }}\n\t\t</NcCheckboxRadioSwitch>\n\n\t\t<NcCheckboxRadioSwitch\n\t\t\t:modelValue=\"ldapConfigProxy.ldapLoginFilterEmail === '1'\"\n\t\t\t:description=\"t('user_ldap', 'Allows login against an email attribute. \\'mail\\' and \\'mailPrimaryAddress\\' allowed.')\"\n\t\t\t@update:modelValue=\"ldapConfigProxy.ldapLoginFilterEmail = $event ? '1' : '0'\">\n\t\t\t{{ t('user_ldap', 'LDAP/AD Email Address:') }}\n\t\t</NcCheckboxRadioSwitch>\n\n\t\t<div class=\"ldap-wizard__login__line ldap-wizard__login__login-attributes\">\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapLoginFilterAttributes\"\n\t\t\t\tkeepOpen\n\t\t\t\t:disabled=\"ldapLoginFilterMode\"\n\t\t\t\t:options=\"filteredLoginFilterOptions\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Other Attributes:')\"\n\t\t\t\t:multiple=\"true\" />\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__login__line ldap-wizard__login__user-login-filter\">\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapLoginFilterMode\"\n\t\t\t\t@update:modelValue=\"toggleFilterMode\">\n\t\t\t\t{{ t('user_ldap', 'Edit LDAP Query') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcTextArea\n\t\t\t\tv-if=\"ldapLoginFilterMode\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapLoginFilter\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'Edit LDAP Query')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Defines the filter to apply, when login is attempted. `%%uid` replaces the username in the login action. Example: `uid=%%uid`')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapLoginFilter = event.target.value\" />\n\t\t\t<div v-else>\n\t\t\t\t<span>{{ t('user_ldap', 'LDAP Filter:') }}</span>\n\t\t\t\t<code>{{ ldapConfigProxy.ldapLoginFilter }}</code>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__login__line\">\n\t\t\t<NcTextField\n\t\t\t\tv-model=\"testUsername\"\n\t\t\t\t:helperText=\"t('user_ldap', 'Attempts to receive a DN for the given login name and the current login filter')\"\n\t\t\t\t:label=\"t('user_ldap', 'Test Login name')\"\n\t\t\t\tautocomplete=\"off\" />\n\n\t\t\t<NcButton\n\t\t\t\t:disabled=\"testUsername.length === 0\"\n\t\t\t\t@click=\"verifyLoginName\">\n\t\t\t\t{{ t('user_ldap', 'Verify settings') }}\n\t\t\t</NcButton>\n\t\t</div>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { showError, showSuccess, showWarning } from '@nextcloud/dialogs'\nimport { t } from '@nextcloud/l10n'\nimport { NcButton, NcCheckboxRadioSwitch, NcSelect, NcTextArea, NcTextField } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, onBeforeMount, ref } from 'vue'\nimport { callWizard, showEnableAutomaticFilterInfo } from '../../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { ldapConfigs } = storeToRefs(ldapConfigsStore)\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId, {\n\tldapLoginFilterAttributes: getUserLoginFilter,\n\tldapLoginFilterUsername: getUserLoginFilter,\n\tldapLoginFilterEmail: getUserLoginFilter,\n}))\n\nconst instanceName = (getCapabilities() as { theming: { name: string } }).theming.name\nconst testUsername = ref('')\nconst loginFilterOptions = ref<string[]>([])\n\nconst ldapLoginFilterAttributes = computed({\n\tget() { return ldapConfigProxy.value.ldapLoginFilterAttributes.split(';').filter((item) => item !== '') },\n\tset(value) { ldapConfigProxy.value.ldapLoginFilterAttributes = value.join(';') },\n})\n\nconst ldapLoginFilterMode = computed(() => ldapConfigProxy.value.ldapLoginFilterMode === '1')\nconst filteredLoginFilterOptions = computed(() => loginFilterOptions.value.filter((option) => !ldapLoginFilterAttributes.value.includes(option)))\n\nonBeforeMount(init)\n\n/**\n * Initialize login filter options\n */\nasync function init() {\n\tconst response = await callWizard('determineAttributes', props.configId)\n\tloginFilterOptions.value = response.options?.ldap_loginfilter_attributes ?? []\n}\n\n/**\n * Get user login filter\n */\nasync function getUserLoginFilter() {\n\tif (ldapConfigProxy.value.ldapLoginFilterMode === '0') {\n\t\tconst response = await callWizard('getUserLoginFilter', props.configId)\n\t\t// Not using ldapConfig to avoid triggering the save logic.\n\t\tldapConfigs.value[props.configId]!.ldapLoginFilter = (response.changes?.ldap_login_filter as string | undefined) ?? ''\n\t}\n}\n\n/**\n * Verify login name\n */\nasync function verifyLoginName() {\n\ttry {\n\t\tconst response = await callWizard('testLoginName', props.configId, { loginName: testUsername.value })\n\n\t\tconst testLoginName = response.changes!.ldap_test_loginname as number\n\t\tconst testEffectiveFilter = response.changes!.ldap_test_effective_filter as string\n\n\t\tif (testLoginName < 1) {\n\t\t\tshowError(t('user_ldap', 'User not found. Please check your login attributes and username. Effective filter (to copy-and-paste for command-line validation): {filter}', { filter: testEffectiveFilter }))\n\t\t} else if (testLoginName === 1) {\n\t\t\tshowSuccess(t('user_ldap', 'User found and settings verified.'))\n\t\t} else if (testLoginName > 1) {\n\t\t\tshowWarning(t('user_ldap', 'Consider narrowing your search, as it encompassed many users, only the first one of whom will be able to log in.'))\n\t\t}\n\t} catch (error) {\n\t\tconst message = error ?? t('user_ldap', 'An unspecified error occurred. Please check log and settings.')\n\n\t\tswitch (message) {\n\t\t\tcase 'Bad search filter':\n\t\t\t\tshowError(t('user_ldap', 'The search filter is invalid, probably due to syntax issues like uneven number of opened and closed brackets. Please revise.'))\n\t\t\t\tbreak\n\t\t\tcase 'connection error':\n\t\t\t\tshowError(t('user_ldap', 'A connection error to LDAP/AD occurred. Please check host, port and credentials.'))\n\t\t\t\tbreak\n\t\t\tcase 'missing placeholder':\n\t\t\t\tshowError(t('user_ldap', 'The \"%uid\" placeholder is missing. It will be replaced with the login name when querying LDAP/AD.'))\n\t\t\t\tbreak\n\t\t}\n\t}\n}\n\n/**\n * Toggle filter mode\n *\n * @param value - new value\n */\nasync function toggleFilterMode(value: boolean) {\n\tif (value) {\n\t\tldapConfigProxy.value.ldapLoginFilterMode = '1'\n\t} else {\n\t\tldapConfigProxy.value.ldapLoginFilterMode = await showEnableAutomaticFilterInfo() ? '0' : '1'\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__login {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\tbutton {\n\t\tflex-shrink: 0;\n\t}\n\n\t&__line {\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t\tgap: 8px;\n\t}\n\n\t&__login-attributes {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\n\t&__user-login-filter {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\n\t\tcode {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t\tpadding: 4px;\n\t\t\tborder-radius: 4px;\n\t\t}\n\t}\n}\n</style>\n","<template>\n  <span v-bind=\"$attrs\"\n        :aria-hidden=\"title ? null : 'true'\"\n        :aria-label=\"title\"\n        class=\"material-design-icon delete-icon\"\n        role=\"img\"\n        @click=\"$emit('click', $event)\">\n    <svg :fill=\"fillColor\"\n         class=\"material-design-icon__svg\"\n         :width=\"size\"\n         :height=\"size\"\n         viewBox=\"0 0 24 24\">\n      <path d=\"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z\">\n        <title v-if=\"title\">{{ title }}</title>\n      </path>\n    </svg>\n  </span>\n</template>\n\n<script>\nexport default {\n  name: \"DeleteIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n</script>","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__server\">\n\t\t<div class=\"ldap-wizard__server__line\">\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapConfigurationActive === '1'\"\n\t\t\t\ttype=\"switch\"\n\t\t\t\t:aria-label=\"t('user_ldap', 'When unchecked, this configuration will be skipped.')\"\n\t\t\t\t@update:modelValue=\"ldapConfigProxy.ldapConfigurationActive = $event ? '1' : '0'\">\n\t\t\t\t{{ t('user_ldap', 'Configuration active') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<NcButton\n\t\t\t\t:title=\"t('user_ldap', 'Copy current configuration into new directory binding')\"\n\t\t\t\t@click=\"ldapConfigsStore.copyConfig(configId)\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ContentCopy :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ t('user_ldap', 'Copy configuration') }}\n\t\t\t</NcButton>\n\t\t\t<NcButton\n\t\t\t\tvariant=\"error\"\n\t\t\t\t@click=\"ldapConfigsStore.removeConfig(configId)\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<Delete :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ t('user_ldap', 'Delete configuration') }}\n\t\t\t</NcButton>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__server__line\">\n\t\t\t<NcTextField\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapHost\"\n\t\t\t\t:helperText=\"t('user_ldap', 'You can omit the protocol, unless you require SSL. If so, start with ldaps://')\"\n\t\t\t\t:label=\"t('user_ldap', 'Host')\"\n\t\t\t\tplaceholder=\"ldaps://localhost\"\n\t\t\t\tautocomplete=\"off\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapHost = event.target.value\" />\n\t\t\t<div class=\"ldap-wizard__server__host__port\">\n\t\t\t\t<NcTextField\n\t\t\t\t\t:modelValue=\"ldapConfigProxy.ldapPort\"\n\t\t\t\t\t:label=\"t('user_ldap', 'Port')\"\n\t\t\t\t\tplaceholder=\"389\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapPort = event.target.value\" />\n\t\t\t\t<NcButton :disabled=\"loadingGuessPortAndTLS\" @click=\"guessPortAndTLS\">\n\t\t\t\t\t{{ t('user_ldap', 'Detect Port') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__server__line\">\n\t\t\t<NcTextField\n\t\t\t\tv-model=\"localLdapAgentName\"\n\t\t\t\t:helperText=\"t('user_ldap', 'The DN of the client user with which the bind shall be done. For anonymous access, leave DN and Password empty.')\"\n\t\t\t\t:label=\"t('user_ldap', 'User DN')\"\n\t\t\t\tplaceholder=\"uid=agent,dc=example,dc=com\"\n\t\t\t\tautocomplete=\"off\" />\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__server__line\">\n\t\t\t<NcTextField\n\t\t\t\tv-model=\"localLdapAgentPassword\"\n\t\t\t\ttype=\"password\"\n\t\t\t\t:helperText=\"t('user_ldap', 'For anonymous access, leave DN and Password empty.')\"\n\t\t\t\t:label=\"t('user_ldap', 'Password')\"\n\t\t\t\tautocomplete=\"off\" />\n\n\t\t\t<NcButton :disabled=\"!needsToSaveCredentials\" @click=\"updateCredentials\">\n\t\t\t\t{{ t('user_ldap', 'Save credentials') }}\n\t\t\t</NcButton>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__server__line\">\n\t\t\t<NcTextArea\n\t\t\t\t:label=\"t('user_ldap', 'Base DN')\"\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapBase\"\n\t\t\t\t:placeholder=\"t('user_ldap', 'One Base DN per line')\"\n\t\t\t\t:helperText=\"t('user_ldap', 'You can specify Base DN for users and groups in the Advanced tab')\"\n\t\t\t\t@change=\"(event) => ldapConfigProxy.ldapBase = event.target.value\" />\n\n\t\t\t<NcButton :disabled=\"loadingGuessBaseDN || needsToSaveCredentials\" @click=\"guessBaseDN\">\n\t\t\t\t{{ t('user_ldap', 'Detect Base DN') }}\n\t\t\t</NcButton>\n\t\t\t<NcButton :disabled=\"loadingCountInBaseDN || ldapConfigProxy.ldapBase === ''\" @click=\"countInBaseDN\">\n\t\t\t\t{{ t('user_ldap', 'Test Base DN') }}\n\t\t\t</NcButton>\n\t\t</div>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { showInfo } from '@nextcloud/dialogs'\nimport { n, t } from '@nextcloud/l10n'\nimport { NcButton, NcCheckboxRadioSwitch, NcTextArea, NcTextField } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, ref, watch } from 'vue'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\nimport Delete from 'vue-material-design-icons/Delete.vue'\nimport { callWizard } from '../../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { ldapConfigs } = storeToRefs(ldapConfigsStore)\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId))\n\nconst loadingGuessPortAndTLS = ref(false)\nconst loadingCountInBaseDN = ref(false)\nconst loadingGuessBaseDN = ref(false)\n\nconst localLdapAgentName = ref(ldapConfigProxy.value.ldapAgentName)\nconst localLdapAgentPassword = ref(ldapConfigProxy.value.ldapAgentPassword)\nconst needsToSaveCredentials = computed(() => {\n\treturn ldapConfigProxy.value.ldapAgentName !== localLdapAgentName.value || ldapConfigProxy.value.ldapAgentPassword !== localLdapAgentPassword.value\n})\n\nwatch(\n\tldapConfigProxy,\n\t(newVal) => {\n\t\tlocalLdapAgentName.value = newVal.ldapAgentName\n\t\tif (newVal.ldapAgentPassword === '***') {\n\t\t\tlocalLdapAgentPassword.value = ''\n\t\t} else {\n\t\t\tlocalLdapAgentPassword.value = newVal.ldapAgentPassword\n\t\t}\n\t},\n)\n\n/**\n *\n */\nfunction updateCredentials() {\n\tldapConfigProxy.value.ldapAgentName = localLdapAgentName.value\n\tldapConfigProxy.value.ldapAgentPassword = localLdapAgentPassword.value\n}\n\n/**\n *\n */\nasync function guessPortAndTLS() {\n\ttry {\n\t\tloadingGuessPortAndTLS.value = true\n\t\tconst { changes } = await callWizard('guessPortAndTLS', props.configId)\n\t\t// Not using ldapConfigProxy to avoid triggering the save logic.\n\t\tldapConfigs.value[props.configId]!.ldapPort = (changes!.ldap_port as string) ?? ''\n\t} finally {\n\t\tloadingGuessPortAndTLS.value = false\n\t}\n}\n\n/**\n *\n */\nasync function guessBaseDN() {\n\ttry {\n\t\tloadingGuessBaseDN.value = true\n\t\tconst { changes } = await callWizard('guessBaseDN', props.configId)\n\t\tldapConfigProxy.value.ldapBase = (changes!.ldap_base as string) ?? ''\n\t} finally {\n\t\tloadingGuessBaseDN.value = false\n\t}\n}\n\n/**\n *\n */\nasync function countInBaseDN() {\n\ttry {\n\t\tloadingCountInBaseDN.value = true\n\t\tconst { changes } = await callWizard('countInBaseDN', props.configId)\n\t\tconst ldapTestBase = changes!.ldap_test_base as number\n\n\t\tif (ldapTestBase < 1) {\n\t\t\tshowInfo(t('user_ldap', 'No object found in the given Base DN. Please revise.'))\n\t\t} else if (ldapTestBase > 1000) {\n\t\t\tshowInfo(t('user_ldap', 'More than 1,000 directory entries available.'))\n\t\t} else {\n\t\t\tshowInfo(n(\n\t\t\t\t'user_ldap',\n\t\t\t\t'{ldapTestBase} entry available within the provided Base DN',\n\t\t\t\t'{ldapTestBase} entries available within the provided Base DN',\n\t\t\t\tldapTestBase,\n\t\t\t\t{ ldapTestBase },\n\t\t\t))\n\t\t}\n\t} finally {\n\t\tloadingCountInBaseDN.value = false\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__server {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\tbutton {\n\t\tflex-shrink: 0;\n\t}\n\n\t&__line {\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t\tgap: 16px;\n\t}\n\n\t&__host__port {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex-shrink: 0;\n\t\tgap: 16px;\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<fieldset class=\"ldap-wizard__users\">\n\t\t{{ t('user_ldap', 'Listing and searching for users is constrained by these criteria:') }}\n\n\t\t<div class=\"ldap-wizard__users__line ldap-wizard__users__user-filter-object-class\">\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapUserFilterObjectclass\"\n\t\t\t\t:disabled=\"ldapConfigProxy.ldapUserFilterMode === '1'\"\n\t\t\t\tclass=\"ldap-wizard__users__user-filter-object-class__select\"\n\t\t\t\t:options=\"userObjectClasses\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Only these object classes:')\"\n\t\t\t\t:multiple=\"true\" />\n\t\t\t{{ t('user_ldap', 'The most common object classes for users are organizationalPerson, person, user, and inetOrgPerson. If you are not sure which object class to select, please consult your directory admin.') }}\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__users__line ldap-wizard__users__user-filter-groups\">\n\t\t\t<NcSelect\n\t\t\t\tv-model=\"ldapUserFilterGroups\"\n\t\t\t\tclass=\"ldap-wizard__users__user-filter-groups__select\"\n\t\t\t\t:disabled=\"ldapConfigProxy.ldapUserFilterMode === '1'\"\n\t\t\t\t:options=\"userGroups\"\n\t\t\t\t:inputLabel=\"t('user_ldap', 'Only from these groups:')\"\n\t\t\t\t:multiple=\"true\" />\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__users__line ldap-wizard__users__user-filter\">\n\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t:modelValue=\"ldapConfigProxy.ldapUserFilterMode === '1'\"\n\t\t\t\t@update:modelValue=\"toggleFilterMode\">\n\t\t\t\t{{ t('user_ldap', 'Edit LDAP Query') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\n\t\t\t<div v-if=\"ldapConfigProxy.ldapUserFilterMode === '1'\">\n\t\t\t\t<NcTextArea\n\t\t\t\t\tv-model=\"ldapConfigProxy.ldapUserFilter\"\n\t\t\t\t\t:placeholder=\"t('user_ldap', 'Edit LDAP Query')\"\n\t\t\t\t\t:helperText=\"t('user_ldap', 'The filter specifies which LDAP users shall have access to the {instanceName} instance.', { instanceName })\" />\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t<label>{{ t('user_ldap', 'LDAP Filter:') }}</label>\n\t\t\t\t<code>{{ ldapConfigProxy.ldapUserFilter }}</code>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"ldap-wizard__users__line ldap-wizard__users__user-count-check\">\n\t\t\t<NcButton :disabled=\"loadingUserCount\" @click=\"countUsers\">\n\t\t\t\t{{ t('user_ldap', 'Verify settings and count users') }}\n\t\t\t</NcButton>\n\n\t\t\t<NcLoadingIcon v-if=\"loadingUserCount\" :size=\"16\" />\n\t\t\t<span v-if=\"usersCount !== undefined && !loadingUserCount\">{{ t('user_ldap', 'User count: {usersCount}', { usersCount }, { escape: false }) }}</span>\n\t\t</div>\n\t</fieldset>\n</template>\n\n<script lang=\"ts\" setup>\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { t } from '@nextcloud/l10n'\nimport { NcButton, NcCheckboxRadioSwitch, NcLoadingIcon, NcSelect, NcTextArea } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, onBeforeMount, ref } from 'vue'\nimport { callWizard, showEnableAutomaticFilterInfo } from '../../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { ldapConfigs } = storeToRefs(ldapConfigsStore)\nconst ldapConfigProxy = computed(() => ldapConfigsStore.getConfigProxy(props.configId, {\n\tldapUserFilterObjectclass: reloadFilters,\n\tldapUserFilterGroups: reloadFilters,\n}))\n\nconst usersCount = ref<number | undefined>(undefined)\nconst loadingUserCount = ref(false)\n\nconst instanceName = (getCapabilities() as { theming: { name: string } }).theming.name\n\nconst userObjectClasses = ref([] as string[])\nconst userGroups = ref([] as string[])\n\nconst ldapUserFilterObjectclass = computed({\n\tget() { return ldapConfigProxy.value.ldapUserFilterObjectclass?.split(';').filter((item) => item !== '') ?? [] },\n\tset(value) { ldapConfigProxy.value.ldapUserFilterObjectclass = value.join(';') },\n})\nconst ldapUserFilterGroups = computed({\n\tget() { return ldapConfigProxy.value.ldapUserFilterGroups.split(';').filter((item) => item !== '') },\n\tset(value) { ldapConfigProxy.value.ldapUserFilterGroups = value.join(';') },\n})\n\nonBeforeMount(init)\n\n/**\n * Initialize user filter options\n */\nasync function init() {\n\tconst response1 = await callWizard('determineUserObjectClasses', props.configId)\n\tuserObjectClasses.value = response1.options?.ldap_userfilter_objectclass ?? []\n\t// Not using ldapConfig to avoid triggering the save logic.\n\tldapConfigs.value[props.configId]!.ldapUserFilterObjectclass = (response1.changes?.ldap_userfilter_objectclass as string[] | undefined)?.join(';') ?? ''\n\n\tconst response2 = await callWizard('determineGroupsForUsers', props.configId)\n\tuserGroups.value = response2.options?.ldap_userfilter_groups ?? []\n\t// Not using ldapConfig to avoid triggering the save logic.\n\tldapConfigs.value[props.configId]!.ldapUserFilterGroups = (response2.changes?.ldap_userfilter_groups as string[] | undefined)?.join(';') ?? ''\n}\n\n/**\n * Reload filters\n */\nasync function reloadFilters() {\n\tif (ldapConfigProxy.value.ldapUserFilterMode === '0') {\n\t\tconst response1 = await callWizard('getUserListFilter', props.configId)\n\t\t// Not using ldapConfig to avoid triggering the save logic.\n\t\tldapConfigs.value[props.configId]!.ldapUserFilter = (response1.changes?.ldap_userlist_filter as string | undefined) ?? ''\n\n\t\tconst response2 = await callWizard('getUserLoginFilter', props.configId)\n\t\t// Not using ldapConfig to avoid triggering the save logic.\n\t\tldapConfigs.value[props.configId]!.ldapLoginFilter = (response2.changes?.ldap_login_filter as string | undefined) ?? ''\n\t}\n}\n\n/**\n * Count users\n */\nasync function countUsers() {\n\ttry {\n\t\tloadingUserCount.value = true\n\t\tconst response = await callWizard('countUsers', props.configId)\n\t\tusersCount.value = response.changes!.ldap_user_count as number\n\t} finally {\n\t\tloadingUserCount.value = false\n\t}\n}\n\n/**\n * Toggle filter mode\n *\n * @param value - new value\n */\nasync function toggleFilterMode(value: boolean) {\n\tif (value) {\n\t\tldapConfigProxy.value.ldapUserFilterMode = '1'\n\t} else {\n\t\tldapConfigProxy.value.ldapUserFilterMode = await showEnableAutomaticFilterInfo() ? '0' : '1'\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__users {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n\n\t&__line {\n\t\tdisplay: flex;\n\t\talign-items: start;\n\t}\n\n\t&__user-filter-object-class {\n\t\tdisplay: flex;\n\t\tgap: 16px;\n\n\t\t&__select {\n\t\t\tmin-width: 50%;\n\t\t\tflex-grow: 1;\n\t\t}\n\t}\n\n\t&__user-filter-groups {\n\t\tdisplay: flex;\n\t\tgap: 16px;\n\t}\n\n\t&__user-filter {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\n\t\tcode {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t\tpadding: 4px;\n\t\t\tborder-radius: 4px;\n\t\t}\n\t}\n\n\t&__user-count-check {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 16px;\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<div class=\"ldap-wizard__controls\">\n\t\t<NcButton variant=\"primary\" :disabled=\"loading\" @click=\"testSelectedConfig\">\n\t\t\t{{ t('user_ldap', 'Test Configuration') }}\n\t\t</NcButton>\n\n\t\t<NcButton\n\t\t\tvariant=\"tertiary\"\n\t\t\thref=\"https://docs.nextcloud.com/server/stable/go.php?to=admin-ldap\"\n\t\t\ttarget=\"_blank\"\n\t\t\trel=\"noreferrer noopener\">\n\t\t\t<template #icon>\n\t\t\t\t<Information :size=\"20\" />\n\t\t\t</template>\n\t\t\t<span>{{ t('user_ldap', 'Help') }}</span>\n\t\t</NcButton>\n\n\t\t<template v-if=\"result !== null && !loading\">\n\t\t\t<span\n\t\t\t\tclass=\"ldap-wizard__controls__state_indicator\"\n\t\t\t\t:class=\"{ 'ldap-wizard__controls__state_indicator--valid': isValide }\" />\n\n\t\t\t<span class=\"ldap-wizard__controls__state_message\">\n\t\t\t\t{{ result.message }}\n\t\t\t</span>\n\t\t</template>\n\n\t\t<NcLoadingIcon v-if=\"loading\" :size=\"16\" />\n\t</div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { t } from '@nextcloud/l10n'\nimport { NcButton, NcLoadingIcon } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, ref, watch } from 'vue'\nimport Information from 'vue-material-design-icons/ContentCopy.vue'\nimport { testConfiguration } from '../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../store/configs.ts'\n\nconst props = defineProps<{ configId: string }>()\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { updatingConfig } = storeToRefs(ldapConfigsStore)\n\nconst loading = ref(false)\nconst result = ref<{ success: boolean, message: string } | null>(null)\nconst isValide = computed(() => result.value?.success)\n\nwatch(updatingConfig, () => {\n\tresult.value = null\n})\n\n/**\n *\n */\nasync function testSelectedConfig() {\n\ttry {\n\t\tloading.value = true\n\t\tresult.value = await testConfiguration(props.configId)\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard__controls {\n\tdisplay: flex;\n\tgap: 16px;\n\talign-items: center;\n\tmin-height: 45px; // Prevents jumping when the message length need two lines.\n\n\t& > * {\n\t\tflex-shrink: 0;\n\t}\n\n\t&__state_message {\n\t\tflex-shrink: 1;\n\t}\n\n\t&__state_indicator {\n\t\twidth: 16px;\n\t\theight: 16px;\n\t\tborder-radius: 100%;\n\t\tbackground-color: var(--color-element-error);\n\n\t\t&--valid {\n\t\t\tbackground-color: var(--color-element-success);\n\t\t}\n\t}\n}\n</style>\n","<!--\n - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n - SPDX-License-Identifier: AGPL-3.0-or-later\n -->\n<template>\n\t<form class=\"ldap-wizard\">\n\t\t<h2>{{ t('user_ldap', 'LDAP/AD integration') }}</h2>\n\n\t\t<NcNoteCard\n\t\t\tv-if=\"!ldapModuleInstalled\"\n\t\t\ttype=\"warning\"\n\t\t\t:text=\"t('user_ldap', 'The PHP LDAP module is not installed, the backend will not work. Please ask your system administrator to install it.')\" />\n\n\t\t<template v-if=\"ldapModuleInstalled\">\n\t\t\t<div class=\"ldap-wizard__config-selection\">\n\t\t\t\t<NcSelect\n\t\t\t\t\tv-if=\"selectedConfigId !== undefined\"\n\t\t\t\t\tv-model=\"selectedConfigId\"\n\t\t\t\t\t:options=\"Object.keys(ldapConfigs)\"\n\t\t\t\t\t:inputLabel=\"t('user_ldap', 'Select LDAP Config')\">\n\t\t\t\t\t<template #option=\"{ label: configId }\">\n\t\t\t\t\t\t{{ `${configId}: ${ldapConfigs[configId]?.ldapHost ?? ''}` }}\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #selected-option=\"{ label: configId }\">\n\t\t\t\t\t\t{{ `${configId}: ${ldapConfigs[configId]?.ldapHost ?? ''}` }}\n\t\t\t\t\t</template>\n\t\t\t\t</NcSelect>\n\t\t\t\t<NcButton\n\t\t\t\t\t:label=\"t('user_ldap', 'Create New Config')\"\n\t\t\t\t\tclass=\"ldap-wizard__config-selection__create-button\"\n\t\t\t\t\t@click=\"ldapConfigsStore.create\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<Plus :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('user_ldap', 'Create configuration') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\n\t\t\t<div v-if=\"selectedConfigId !== undefined\" class=\"ldap-wizard__tab-container\">\n\t\t\t\t<div class=\"ldap-wizard__tab-selection-container\">\n\t\t\t\t\t<div class=\"ldap-wizard__tab-selection\">\n\t\t\t\t\t\t<NcCheckboxRadioSwitch\n\t\t\t\t\t\t\tv-for=\"(tabLabel, tabId) in tabs\"\n\t\t\t\t\t\t\t:key=\"tabId\"\n\t\t\t\t\t\t\tv-model=\"selectedTab\"\n\t\t\t\t\t\t\t:buttonVariant=\"true\"\n\t\t\t\t\t\t\t:value=\"tabId\"\n\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t:disabled=\"tabId !== 'server' && !selectedConfigHasServerInfo\"\n\t\t\t\t\t\t\tbuttonVariantGrouped=\"horizontal\">\n\t\t\t\t\t\t\t{{ tabLabel }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<ServerTab v-if=\"selectedTab === 'server'\" :configId=\"selectedConfigId\" />\n\t\t\t\t<UsersTab v-else-if=\"selectedTab === 'users'\" :configId=\"selectedConfigId\" />\n\t\t\t\t<LoginTab v-else-if=\"selectedTab === 'login'\" :configId=\"selectedConfigId\" />\n\t\t\t\t<GroupsTab v-else-if=\"selectedTab === 'groups'\" :configId=\"selectedConfigId\" />\n\t\t\t\t<ExpertTab v-else-if=\"selectedTab === 'expert'\" :configId=\"selectedConfigId\" />\n\t\t\t\t<AdvancedTab v-else-if=\"selectedTab === 'advanced'\" :configId=\"selectedConfigId\" />\n\n\t\t\t\t<WizardControls class=\"ldap-wizard__controls\" :configId=\"selectedConfigId\" />\n\t\t\t</div>\n\n\t\t\t<div class=\"ldap-wizard__clear-mapping\">\n\t\t\t\t<strong>{{ t('user_ldap', 'Username-LDAP User Mapping') }}</strong>\n\t\t\t\t{{ t('user_ldap', 'Usernames are used to store and assign metadata. In order to precisely identify and recognize users, each LDAP user will have an internal username. This requires a mapping from username to LDAP user. The created username is mapped to the UUID of the LDAP user. Additionally the DN is cached as well to reduce LDAP interaction, but it is not used for identification. If the DN changes, the changes will be found. The internal username is used all over. Clearing the mappings will have leftovers everywhere. Clearing the mappings is not configuration sensitive, it affects all LDAP configurations! Never clear the mappings in a production environment, only in a testing or experimental stage.') }}\n\n\t\t\t\t<div class=\"ldap-wizard__clear-mapping__buttons\">\n\t\t\t\t\t<NcButton\n\t\t\t\t\t\tvariant=\"error\"\n\t\t\t\t\t\t:disabled=\"clearMappingLoading\"\n\t\t\t\t\t\t@click=\"requestClearMapping('user')\">\n\t\t\t\t\t\t{{ t('user_ldap', 'Clear Username-LDAP User Mapping') }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t\t<NcButton\n\t\t\t\t\t\tvariant=\"error\"\n\t\t\t\t\t\t:disabled=\"clearMappingLoading\"\n\t\t\t\t\t\t@click=\"requestClearMapping('group')\">\n\t\t\t\t\t\t{{ t('user_ldap', 'Clear Groupname-LDAP Group Mapping') }}\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</form>\n</template>\n\n<script lang=\"ts\" setup>\nimport { loadState } from '@nextcloud/initial-state'\nimport { t } from '@nextcloud/l10n'\nimport { NcButton, NcCheckboxRadioSwitch, NcNoteCard, NcSelect } from '@nextcloud/vue'\nimport { storeToRefs } from 'pinia'\nimport { computed, ref } from 'vue'\nimport Plus from 'vue-material-design-icons/Plus.vue'\nimport AdvancedTab from '../components/SettingsTabs/AdvancedTab.vue'\nimport ExpertTab from '../components/SettingsTabs/ExpertTab.vue'\nimport GroupsTab from '../components/SettingsTabs/GroupsTab.vue'\nimport LoginTab from '../components/SettingsTabs/LoginTab.vue'\nimport ServerTab from '../components/SettingsTabs/ServerTab.vue'\nimport UsersTab from '../components/SettingsTabs/UsersTab.vue'\nimport WizardControls from '../components/WizardControls.vue'\nimport { clearMapping } from '../services/ldapConfigService.ts'\nimport { useLDAPConfigsStore } from '../store/configs.ts'\n\nconst ldapModuleInstalled = loadState('user_ldap', 'ldapModuleInstalled')\n\nconst tabs = {\n\tserver: t('user_ldap', 'Server'),\n\tusers: t('user_ldap', 'Users'),\n\tlogin: t('user_ldap', 'Login Attributes'),\n\tgroups: t('user_ldap', 'Groups'),\n\tadvanced: t('user_ldap', 'Advanced'),\n\texpert: t('user_ldap', 'Expert'),\n}\n\nconst ldapConfigsStore = useLDAPConfigsStore()\nconst { ldapConfigs, selectedConfigId, selectedConfig } = storeToRefs(ldapConfigsStore)\n\nconst selectedTab = ref('server')\nconst clearMappingLoading = ref(false)\n\nconst selectedConfigHasServerInfo = computed(() => {\n\treturn selectedConfig.value !== undefined\n\t\t&& selectedConfig.value.ldapHost !== ''\n\t\t&& selectedConfig.value.ldapPort !== ''\n\t\t&& selectedConfig.value.ldapBase !== ''\n\t\t&& selectedConfig.value.ldapAgentName !== ''\n\t\t&& selectedConfig.value.ldapAgentPassword !== ''\n})\n\n/**\n * Request to clear the mapping.\n *\n * @param subject - The subject to clear\n */\nasync function requestClearMapping(subject: 'user' | 'group') {\n\ttry {\n\t\tclearMappingLoading.value = true\n\t\tawait clearMapping(subject)\n\t} finally {\n\t\tclearMappingLoading.value = false\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ldap-wizard {\n\tpadding: 16px;\n\tmax-width: 1000px;\n\n\t&__config-selection {\n\t\tdisplay: flex;\n\t\talign-items: end;\n\t\tmargin-bottom: 8px;\n\t\tgap: 16px;\n\n\t\t&__create-button {\n\t\t\tmargin-bottom: 4px;\n\t\t}\n\t}\n\n\t&__tab-selection-container {\n\t\tdisplay: flex;\n\t}\n\n\t&__tab-selection {\n\t\tdisplay: flex;\n\t\tmargin-inline-start: -16px;\n\t\tmargin-bottom: 16px;\n\n\t\t&:last-of-type {\n\t\t\tmargin-inline-end: -16px;\n\t\t}\n\t}\n\n\t&__tab-container {\n\t\tborder-bottom: 1px solid var(--color-text-light);\n\t\tpadding: 0 16px 16px 16px;\n\t}\n\n\t&__controls {\n\t\tmargin-top: 16px;\n\t}\n\n\t&__clear-mapping {\n\t\tpadding: 16px;\n\n\t\t&__buttons {\n\t\t\tdisplay: flex;\n\t\t\tmargin-top: 8px;\n\t\t\tgap: 16px;\n\t\t}\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createPinia } from 'pinia'\n\nexport const pinia = createPinia()\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue'\nimport LDAPSettingsApp from './views/LDAPSettingsApp.vue'\nimport { pinia } from './store/index.ts'\n\nconst app = createApp(LDAPSettingsApp)\napp.use(pinia)\napp.mount('#content-ldap-settings')\n"],"names":["logger","getLoggerBuilder","createConfig","response","axios","generateOcsUrl","copyConfig","configId","params","getConfig","updateConfig","config","deleteConfig","confirmOperation","t","error","errorResponse","showError","testConfiguration","clearMapping","subject","showSuccess","callWizard","action","extraParams","key","value","message","isAxiosError","showEnableAutomaticFilterInfo","name","text","result","getDialogBuilder","useLDAPConfigsStore","defineStore","ldapConfigs","ref","loadState","selectedConfigId","selectedConfig","computed","updatingConfig","getConfigProxy","postSetHooks","target","property","newValue","create","_copyConfig","fromConfigId","removeConfig","_configId","props","__props","ldapConfigsStore","ldapConfigProxy","instanceName","getCapabilities","groupMemberAssociation","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_unref","_createVNode","NcTextField","_cache","event","NcCheckboxRadioSwitch","$event","_hoisted_3","NcTextArea","NcSelect","_withCtx","label","_createTextVNode","_toDisplayString","_hoisted_4","_hoisted_5","_hoisted_6","storeToRefs","getGroupFilter","groupsCountLabel","groupObjectClasses","groupGroups","loadingGroupCount","ldapGroupFilterObjectclass","item","ldapGroupFilterGroups","init","response1","response2","countGroups","toggleFilterMode","NcButton","_createBlock","NcLoadingIcon","getUserLoginFilter","testUsername","loginFilterOptions","ldapLoginFilterAttributes","ldapLoginFilterMode","filteredLoginFilterOptions","option","onBeforeMount","verifyLoginName","testLoginName","testEffectiveFilter","showWarning","_sfc_main","_mergeProps","_ctx","$props","loadingGuessPortAndTLS","loadingCountInBaseDN","loadingGuessBaseDN","localLdapAgentName","localLdapAgentPassword","needsToSaveCredentials","watch","newVal","updateCredentials","guessPortAndTLS","changes","guessBaseDN","countInBaseDN","ldapTestBase","showInfo","n","ContentCopy","Delete","_hoisted_7","reloadFilters","usersCount","loadingUserCount","userObjectClasses","userGroups","ldapUserFilterObjectclass","ldapUserFilterGroups","countUsers","_hoisted_8","loading","isValide","testSelectedConfig","Information","_Fragment","_normalizeClass","ldapModuleInstalled","tabs","selectedTab","clearMappingLoading","selectedConfigHasServerInfo","requestClearMapping","NcNoteCard","Plus","_renderList","tabLabel","tabId","ServerTab","UsersTab","LoginTab","GroupsTab","ExpertTab","AdvancedTab","WizardControls","pinia","createPinia","app","createApp","LDAPSettingsApp"],"mappings":"olEAOA,MAAAA,EAAeC,KACb,OAAO,MAAM,EACb,WAAA,EACA,MAAA,EC4BF,eAAsBC,IAAe,CACpC,MAAMC,EAAW,MAAMC,EAAM,KAAKC,EAAe,8BAA8B,CAAC,EAChF,OAAAL,EAAO,MAAM,wBAAyB,CAAE,SAAUG,EAAS,KAAK,IAAI,KAAK,SAAU,EAC5EA,EAAS,KAAK,IAAI,KAAK,QAC/B,CAOA,eAAsBG,GAAWC,EAAkB,CAClD,MAAMC,EAAS,IAAI,SACnBA,EAAO,IAAI,aAAcD,CAAQ,EAEjC,MAAMJ,EAAW,MAAMC,EAAM,KAC5BC,EAAe,+CAAgD,CAAE,SAAAE,EAAU,EAC3EC,CAAA,EAGD,OAAAR,EAAO,MAAM,wBAAyB,CAAE,SAAUG,EAAS,KAAK,IAAI,KAAK,SAAU,EAC5EA,EAAS,KAAK,IAAI,KAAK,QAC/B,CAOA,eAAsBM,GAAUF,EAAuC,CACtE,MAAMJ,EAAW,MAAMC,EAAM,IAAIC,EAAe,0CAA2C,CAAE,SAAAE,CAAA,CAAU,CAAC,EACxG,OAAAP,EAAO,MAAM,wBAAyB,CAAE,SAAAO,EAAU,OAAQJ,EAAS,KAAK,IAAI,KAAM,EAC3EA,EAAS,KAAK,IAAI,IAC1B,CAQA,eAAsBO,GAAaH,EAAkBI,EAAkD,CACtG,MAAMR,EAAW,MAAMC,EAAM,IAC5BC,EAAe,0CAA2C,CAAE,SAAAE,EAAU,EACtE,CAAE,WAAYI,CAAA,CAAO,EAGtB,OAAAX,EAAO,MAAM,wBAAyB,CAAE,SAAAO,EAAU,OAAAI,EAAQ,EAEnDR,EAAS,KAAK,IAAI,IAC1B,CAOA,eAAsBS,GAAaL,EAAoC,CACtE,GAAI,CAKH,GAAI,CAJgB,MAAMM,EACzBC,EAAE,YAAa,gBAAgB,EAC/BA,EAAE,YAAa,6FAA6F,CAAA,EAG5G,MAAO,GAGR,MAAMV,EAAM,OAAOC,EAAe,0CAA2C,CAAE,SAAAE,CAAA,CAAU,CAAC,EAC1FP,EAAO,MAAM,wBAAyB,CAAE,SAAAO,CAAA,CAAU,CACnD,OAASQ,EAAO,CACf,MAAMC,EAAiBD,EAAkC,SACzDE,EAAUD,GAAe,KAAK,IAAI,KAAK,SAAWF,EAAE,YAAa,yBAAyB,CAAC,CAC5F,CAEA,MAAO,EACR,CAOA,eAAsBI,GAAkBX,EAAkB,CACzD,MAAMC,EAAS,IAAI,SAEbL,EAAW,MAAMC,EAAM,KAAKC,EAAe,+CAAgD,CAAE,SAAAE,CAAA,CAAU,CAAC,EAE9G,OAAAP,EAAO,MAAM,oBAAoBG,EAAS,KAAK,IAAI,KAAK,QAAU,SAAW,UAAU,GAAI,CAAE,SAAAI,EAAU,OAAAC,EAAQ,SAAAL,EAAU,EAElHA,EAAS,KAAK,IAAI,IAC1B,CAOA,eAAsBgB,GAAaC,EAA2B,CAK7D,GAAI,CAJgB,MAAMP,EACzBC,EAAE,YAAa,gBAAgB,EAC/BA,EAAE,YAAa,qFAAqF,CAAA,EAGpG,MAAO,GAGR,GAAI,CACH,MAAMX,EAAW,MAAMC,EAAM,KAC5BC,EAAe,4CAA4C,EAC3D,CAAE,QAAAe,CAAA,CAAQ,EAGX,OAAApB,EAAO,MAAM,kBAAmB,CAAE,QAAAoB,EAAS,SAAAjB,EAAU,EACrDkB,GAAYP,EAAE,YAAa,iBAAiB,CAAC,EACtC,EACR,OAASC,EAAO,CACf,MAAMC,EAAiBD,EAAkC,SACzDE,EAAUD,GAAe,KAAK,IAAI,KAAK,SAAWF,EAAE,YAAa,yBAAyB,CAAC,CAC5F,CACD,CASA,eAAsBQ,EAAWC,EAAsBhB,EAAkBiB,EAAsC,CAAA,EAAI,CAClH,MAAMhB,EAAS,IAAI,SAEnB,OAAO,QAAQgB,CAAW,EAAE,QAAQ,CAAC,CAACC,EAAKC,CAAK,IAAM,CACrDlB,EAAO,IAAIiB,EAAKC,CAAK,CACtB,CAAC,EAED,GAAI,CACH,MAAMvB,EAAW,MAAMC,EAAM,KAC5BC,EAAe,mDAAoD,CAAE,SAAAE,EAAU,OAAAgB,EAAQ,EACvFf,CAAA,EAGD,OAAAR,EAAO,MAAM,yBAAyBuB,CAAM,GAAI,CAAE,SAAAhB,EAAU,OAAAC,EAAQ,SAAAL,EAAU,EAEvEA,EAAS,KAAK,IAAI,IAC1B,OAASY,EAAO,CACf,IAAIY,EAAUb,EAAE,YAAa,mBAAmB,EAEhD,MAAIc,GAAab,CAAK,GAAKA,EAAM,UAAU,KAAK,IAAI,KAAK,SAAW,WAC/DA,EAAM,SAAS,KAAK,IAAI,KAAK,UAAY,IAAMA,EAAM,SAAS,KAAK,IAAI,KAAK,UAAY,SAC3FY,EAAUZ,EAAM,SAAS,KAAK,IAAI,KAAK,SAIzCE,EAAUU,CAAO,EAEXZ,CACP,CACD,CAKA,eAAsBc,GAAgC,CACrD,OAAO,MAAMhB,EACZC,EAAE,YAAa,aAAa,EAC5BA,EAAE,YAAa,iJAAiJ,CAAA,CAElK,CAQA,eAAsBD,EAAiBiB,EAAcC,EAAgC,CACpF,IAAIC,EAAS,GAiBb,OAAA,MAhBeC,GAAiBH,CAAI,EAClC,QAAQC,CAAI,EACZ,YAAY,SAAS,EACrB,UAAU,CACV,MAAOjB,EAAE,YAAa,QAAQ,EAC9B,UAAW,CAAC,CAAA,CACZ,EACA,UAAU,CACV,MAAOA,EAAE,YAAa,SAAS,EAC/B,QAAS,QACT,UAAW,CACVkB,EAAS,EACV,CAAA,CACA,EACA,MAAA,EAEW,KAAA,EACNA,CACR,CC7NO,MAAME,EAAsBC,GAAY,eAAgB,IAAM,CACpE,MAAMC,EAAcC,EAAIC,GAAU,YAAa,aAAa,CAA+B,EACrFC,EAAmBF,EAAwB,OAAO,KAAKD,EAAY,KAAK,EAAE,CAAC,CAAC,EAC5EI,EAAiBC,EAAS,IAAMF,EAAiB,QAAU,OAAY,OAAYH,EAAY,MAAMG,EAAiB,KAAK,CAAC,EAC5HG,EAAiBL,EAAI,CAAC,EAQ5B,SAASM,EAAkBpC,EAAkBqC,EAAsE,GAAI,CACtH,GAAIR,EAAY,MAAM7B,CAAQ,IAAM,OACnC,MAAM,IAAI,MAAM,kBAAkBA,CAAQ,iBAAiB,EAG5D,OAAO,IAAI,MAAM6B,EAAY,MAAM7B,CAAQ,EAAG,CAC7C,IAAIsC,EAAQC,EAAU,CACrB,OAAOD,EAAOC,CAAQ,CACvB,EACA,IAAID,EAAQC,EAAkBC,EAAU,CACvC,OAAAF,EAAOC,CAAQ,EAAIC,GAEjB,UACDL,EAAe,QACf,MAAMhC,GAAaH,EAAU,CAAE,CAACuC,CAAQ,EAAGC,EAAU,EACrDL,EAAe,QAEXE,EAAaE,CAAQ,IAAM,QAC9BF,EAAaE,CAAQ,EAAED,EAAOC,CAAQ,CAAC,IAAA,EAIlC,EACR,CAAA,CACA,CACF,CAKA,eAAeE,GAAS,CACvB,MAAMzC,EAAW,MAAML,GAAA,EACvB,OAAAkC,EAAY,MAAM7B,CAAQ,EAAI,MAAME,GAAUF,CAAQ,EACtDgC,EAAiB,MAAQhC,EAClBA,CACR,CAOA,eAAe0C,EAAYC,EAAsB,CAChD,GAAId,EAAY,MAAMc,CAAY,IAAM,OACvC,MAAM,IAAI,MAAM,kBAAkBA,CAAY,iBAAiB,EAGhE,MAAM3C,EAAW,MAAMD,GAAW4C,CAAY,EAE9C,OAAAd,EAAY,MAAM7B,CAAQ,EAAI,CAAE,GAAG6B,EAAY,MAAMc,CAAY,CAAA,EACjEX,EAAiB,MAAQhC,EAClBA,CACR,CAOA,eAAe4C,EAAa5C,EAAkB,CAC9B,MAAMK,GAAaL,CAAQ,IAE3B,KACV,OAAO,KAAK6B,EAAY,KAAK,EAAE,SAAW,GAE7CG,EAAiB,MAAQ,MAAMS,EAAA,EAE3BT,EAAiB,QAAUhC,GAC9B,OAAO6B,EAAY,MAAM7B,CAAQ,IAIlCgC,EAAiB,MAAQ,OAAO,KAAKH,EAAY,KAAK,EAAE,OAAQgB,GAAc7C,IAAa6C,CAAS,EAAE,CAAC,EACvG,OAAOhB,EAAY,MAAM7B,CAAQ,GAGpC,CAEA,MAAO,CACN,YAAA6B,EACA,iBAAAG,EACA,eAAAC,EACA,eAAAE,EACA,eAAAC,EACA,OAAAK,EACA,WAAYC,EACZ,aAAAE,CAAA,CAEF,CAAC,ocCiKD,MAAME,EAAQC,EAERC,EAAmBrB,EAAA,EACnBsB,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,QAAQ,CAAC,EAEhFI,EAAgBC,IAAoD,QAAQ,KAE5EC,EAAyB,CAC9B,aAAc,eACd,UAAW,YACX,OAAQ,cACR,UAAW,YACX,4BAA6B,6BAAA,gBAxR7BC,EAAA,EAAAC,EAkQW,WAlQXC,GAkQW,CAjQVC,EAqCU,UArCVC,GAqCU,CApCTD,EAAuE,UAAA,KAAA,CAA9DA,EAAoD,YAA7CE,EAAAnD,CAAA,EAAC,YAAA,qBAAA,CAAA,EAAA,CAAA,CAAA,GAEjBoD,EAK4ED,EAAAE,CAAA,EAAA,CAJ3E,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,uBAAA,EACR,WAAY0C,EAAA,MAAgB,eAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,gFAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,eAAiBa,EAAM,OAAO,MAAA,8CAEnEH,EAI4ED,EAAAE,CAAA,EAAA,CAH3E,KAAK,SACJ,WAAYX,EAAA,MAAgB,eAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,uBAAA,EACR,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,eAAiBa,EAAM,OAAO,MAAA,iCAEnEH,EAMwBD,EAAAK,CAAA,EAAA,CALtB,WAAYd,EAAA,MAAgB,yBAAsB,IACnD,KAAK,SACJ,aAAYS,EAAAnD,CAAA,EAAC,YAAA,qCAAA,EACb,sBAAiBsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,uBAAyBe,EAAM,IAAA,IAAA,aACnE,IAA2C,KAAxCN,EAAAnD,CAAA,EAAC,YAAA,qBAAA,CAAA,EAAA,CAAA,CAAA,uCAGLoD,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,mBAAgB,IAC5C,aAAYS,EAAAnD,CAAA,EAAC,YAAA,+JAAA,CAAA,aAAiLmD,EAAAR,CAAA,EAAY,EAC1M,sBAAiBW,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,iBAAmBe,EAAM,IAAA,IAAA,aAC7D,IAA4D,KAAzDN,EAAAnD,CAAA,EAAC,YAAA,sCAAA,CAAA,EAAA,CAAA,CAAA,uCAGLoD,EAK0ED,EAAAE,CAAA,EAAA,CAJzE,KAAK,SACJ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,oBAAA,EACR,WAAY0C,EAAA,MAAgB,aAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,yCAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,aAAea,EAAM,OAAO,MAAA,gDAGlEN,EAwGU,UAxGVS,GAwGU,CAvGTT,EAAsE,UAAA,KAAA,CAA7DA,EAAmD,YAA5CE,EAAAnD,CAAA,EAAC,YAAA,oBAAA,CAAA,EAAA,CAAA,CAAA,GAEjBoD,EAKiFD,EAAAE,CAAA,EAAA,CAJhF,aAAa,MACZ,WAAYX,EAAA,MAAgB,oBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,yBAAA,EACR,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,gEAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,oBAAsBa,EAAM,OAAO,MAAA,8CAExEH,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,WAAYX,EAAA,MAAgB,qBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,6BAAA,EACR,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,6HAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,8CAEzEH,EAI2ED,EAAAQ,CAAA,EAAA,CAHzE,WAAYjB,EAAA,MAAgB,cAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,2BAAA,EACd,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,gBAAA,EACR,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,cAAgBa,EAAM,OAAO,MAAA,+CAElEH,EAIyFD,EAAAQ,CAAA,EAAA,CAHvF,WAAYjB,EAAA,MAAgB,4BAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,kCAAA,EACd,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,wBAAA,EACR,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,4BAA8Ba,EAAM,OAAO,MAAA,+CAEhFH,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,yBAAsB,IAClD,aAAYS,EAAAnD,CAAA,EAAC,YAAA,oFAAA,EACb,sBAAiBsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,uBAAyBe,EAAM,IAAA,IAAA,aACnE,IAAuD,KAApDN,EAAAnD,CAAA,EAAC,YAAA,iCAAA,CAAA,EAAA,CAAA,CAAA,uCAGLoD,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,WAAYX,EAAA,MAAgB,qBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,0BAAA,EACR,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,kEAAA,EACR,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,yCAEzEH,EAI4ED,EAAAQ,CAAA,EAAA,CAH1E,WAAYjB,EAAA,MAAgB,eAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,4BAAA,EACd,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACR,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,eAAiBa,EAAM,OAAO,MAAA,+CAEnEH,EAI0FD,EAAAQ,CAAA,EAAA,CAHxF,WAAYjB,EAAA,MAAgB,6BAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,kCAAA,EACd,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,yBAAA,EACR,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,6BAA+Ba,EAAM,OAAO,MAAA,+CAEjFH,EAUWD,EAAAS,CAAA,EAAA,CATD,WAAAlB,EAAA,MAAgB,yBAAhB,sBAAAY,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAG,GAAAf,EAAA,MAAgB,yBAAwBe,GAChD,QAAS,OAAO,KAAKZ,CAAsB,EAC3C,WAAYM,EAAAnD,CAAA,EAAC,YAAA,0BAAA,CAAA,GACH,OAAM6D,EAChB,CAAmC,CADf,MAAAC,KAAK,CACtBC,EAAAC,EAAAnB,EAAuBiB,CAAK,CAAA,EAAA,CAAA,CAAA,GAErB,kBAAeD,EACzB,CAAmC,CADN,MAAAC,KAAK,CAC/BC,EAAAC,EAAAnB,EAAuBiB,CAAK,CAAA,EAAA,CAAA,CAAA,iDAIjCV,EAKuFD,EAAAE,CAAA,EAAA,CAJtF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,0BAAA,EACR,WAAY0C,EAAA,MAAgB,0BAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,4LAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,0BAA4Ba,EAAM,OAAO,MAAA,8CAE9EH,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,mBAAgB,IAC5C,aAAYS,EAAAnD,CAAA,EAAC,YAAA,sHAAA,EACb,sBAAiBsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAG,GAAEf,EAAA,MAAgB,iBAAmBe,EAAM,IAAA,IAAA,aAC7D,IAAqC,KAAlCN,EAAAnD,CAAA,EAAC,YAAA,eAAA,CAAA,EAAA,CAAA,CAAA,uCAGLoD,EAK4ED,EAAAE,CAAA,EAAA,CAJ3E,KAAK,SACJ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,kBAAA,EACR,WAAY0C,EAAA,MAAgB,eAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,uKAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,eAAiBa,EAAM,OAAO,MAAA,8CAEnEH,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,uBAAoB,IAChD,aAAYS,EAAAnD,CAAA,EAAC,YAAA,6XAAA,EACb,sBAAiBsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAG,GAAEf,EAAA,MAAgB,qBAAuBe,EAAM,IAAA,IAAA,aACjE,IAA6D,KAA1DN,EAAAnD,CAAA,EAAC,YAAA,uCAAA,CAAA,EAAA,CAAA,CAAA,uCAELiD,EAEO,OAFPgB,GAEOD,EADHb,EAAAnD,CAAA,EAAC,YAAA,8CAAA,CAAA,EAAA,CAAA,EAGLoD,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,4BAAA,EACR,WAAY0C,EAAA,MAAgB,qBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,oOAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,gDAG1EN,EAqCU,UArCViB,GAqCU,CApCTjB,EAAsE,UAAA,KAAA,CAA7DA,EAAmD,YAA5CE,EAAAnD,CAAA,EAAC,YAAA,oBAAA,CAAA,EAAA,CAAA,CAAA,GAEjBoD,EAKgFD,EAAAE,CAAA,EAAA,CAJ/E,aAAa,MACZ,WAAYX,EAAA,MAAgB,mBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,aAAA,EACR,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,gFAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,mBAAqBa,EAAM,OAAO,MAAA,8CAEvEH,EAK8ED,EAAAE,CAAA,EAAA,CAJ7E,aAAa,MACZ,WAAYX,EAAA,MAAgB,iBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,eAAA,EACR,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,uFAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,iBAAmBa,EAAM,OAAO,MAAA,8CAErEH,EAKgFD,EAAAE,CAAA,EAAA,CAJ/E,aAAa,MACZ,WAAYX,EAAA,MAAgB,mBAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,aAAA,EACR,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,uFAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,mBAAqBa,EAAM,OAAO,MAAA,8CAEvEH,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,8BAAA,EACR,WAAY0C,EAAA,MAAgB,qBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,8EAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,8CAEzEH,EAKyFD,EAAAE,CAAA,EAAA,CAJxF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,2BAAA,EACR,WAAY0C,EAAA,MAAgB,4BAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,uGAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,4BAA8Ba,EAAM,OAAO,MAAA,gDAGjFN,EAwEU,UAxEVkB,GAwEU,CAvETlB,EAA2E,UAAA,KAAA,CAAlEA,EAAwD,YAAjDE,EAAAnD,CAAA,EAAC,YAAA,yBAAA,CAAA,EAAA,CAAA,CAAA,GAEjBoD,EAKgFD,EAAAE,CAAA,EAAA,CAJ/E,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,aAAA,EACR,WAAY0C,EAAA,MAAgB,mBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,6DAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,mBAAqBa,EAAM,OAAO,MAAA,8CAEvEH,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,eAAA,EACR,WAAY0C,EAAA,MAAgB,qBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,+DAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,8CAEzEH,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,eAAA,EACR,WAAY0C,EAAA,MAAgB,qBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,+DAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,8CAEzEH,EAKkFD,EAAAE,CAAA,EAAA,CAJjF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,eAAA,EACR,WAAY0C,EAAA,MAAgB,qBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,+DAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,qBAAuBa,EAAM,OAAO,MAAA,8CAEzEH,EAKoFD,EAAAE,CAAA,EAAA,CAJnF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACR,WAAY0C,EAAA,MAAgB,uBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,iEAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,uBAAyBa,EAAM,OAAO,MAAA,8CAE3EH,EAKuFD,EAAAE,CAAA,EAAA,CAJtF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,oBAAA,EACR,WAAY0C,EAAA,MAAgB,0BAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,oEAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,0BAA4Ba,EAAM,OAAO,MAAA,8CAE9EH,EAK+ED,EAAAE,CAAA,EAAA,CAJ9E,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,YAAA,EACR,WAAY0C,EAAA,MAAgB,kBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,4DAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,kBAAoBa,EAAM,OAAO,MAAA,8CAEtEH,EAKmFD,EAAAE,CAAA,EAAA,CAJlF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,gBAAA,EACR,WAAY0C,EAAA,MAAgB,sBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,gEAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,sBAAwBa,EAAM,OAAO,MAAA,8CAE1EH,EAKoFD,EAAAE,CAAA,EAAA,CAJnF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACR,WAAY0C,EAAA,MAAgB,uBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,iEAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,uBAAyBa,EAAM,OAAO,MAAA,8CAE3EH,EAKoFD,EAAAE,CAAA,EAAA,CAJnF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACR,WAAY0C,EAAA,MAAgB,uBAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,qEAAA,EACb,SAAMsD,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAGC,GAAUb,EAAA,MAAgB,uBAAyBa,EAAM,OAAO,MAAA,+UCxN9E,MAAMhB,EAAQC,EAERC,EAAmBrB,EAAA,EACnBsB,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,QAAQ,CAAC,gBA3CrFO,EAAA,EAAAC,EA+BW,WA/BXC,GA+BW,CA9BVC,EAWM,MAXNC,GAWM,CAVLD,EAA0D,gBAA/CE,EAAAnD,CAAA,EAAC,YAAA,mBAAA,CAAA,EAAA,CAAA,EACZiD,EAEI,IAFJS,GAEIM,EADAb,EAAAnD,CAAA,EAAC,YAAA,+tBAAA,CAAA,EAAA,CAAA,EAELoD,EAKoFD,EAAAE,CAAA,EAAA,CAJnF,mBAAiB,4BACjB,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,8BAAA,EACR,WAAY0C,EAAA,MAAgB,uBAC5B,SAAMY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,uBAAyBa,EAAM,OAAO,MAAA,mCAG5EN,EAgBM,MAhBNgB,GAgBM,CAfLhB,EAAgE,gBAArDE,EAAAnD,CAAA,EAAC,YAAA,yBAAA,CAAA,EAAA,CAAA,EACZiD,EAEI,IAFJiB,GAEIF,EADAb,EAAAnD,CAAA,EAAC,YAAA,2gBAAA,CAAA,EAAA,CAAA,EAELoD,EAKoFD,EAAAE,CAAA,EAAA,CAJnF,mBAAiB,6BACjB,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,0BAAA,EACR,WAAY0C,EAAA,MAAgB,uBAC5B,SAAMY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,uBAAyBa,EAAM,OAAO,MAAA,iCAC3EH,EAIqFD,EAAAE,CAAA,EAAA,CAHpF,aAAa,MACZ,MAAOF,EAAAnD,CAAA,EAAC,YAAA,2BAAA,EACR,WAAY0C,EAAA,MAAgB,wBAC5B,SAAMY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,wBAA0Ba,EAAM,OAAO,MAAA,kbCiC/E,MAAMhB,EAAQC,EAERC,EAAmBrB,EAAA,EACnB,CAAE,YAAAE,CAAA,EAAgB8C,EAAY3B,CAAgB,EAC9CC,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,SAAU,CACtF,2BAA4B8B,EAC5B,sBAAuBA,CAAA,CACvB,CAAC,EAEI1B,EAAgBC,IAAoD,QAAQ,KAE5E0B,EAAmB/C,EAAwB,MAAS,EAEpDgD,EAAqBhD,EAAI,EAAc,EACvCiD,EAAcjD,EAAI,EAAc,EAChCkD,EAAoBlD,EAAI,EAAK,EAE7BmD,EAA6B/C,EAAS,CAC3C,KAAM,CAAE,OAAOe,EAAgB,MAAM,2BAA2B,MAAM,GAAG,EAAE,OAAQiC,GAASA,IAAS,EAAE,CAAE,EACzG,IAAI/D,EAAO,CAAE8B,EAAgB,MAAM,2BAA6B9B,EAAM,KAAK,GAAG,CAAE,CAAA,CAChF,EACKgE,EAAwBjD,EAAS,CACtC,KAAM,CAAE,OAAOe,EAAgB,MAAM,sBAAsB,MAAM,GAAG,EAAE,OAAQiC,GAASA,IAAS,EAAE,CAAE,EACpG,IAAI/D,EAAO,CAAE8B,EAAgB,MAAM,sBAAwB9B,EAAM,KAAK,GAAG,CAAE,CAAA,CAC3E,EAKD,eAAeiE,GAAO,CACrB,MAAMC,EAAY,MAAMtE,EAAW,8BAA+B+B,EAAM,QAAQ,EAChFgC,EAAmB,MAAQO,EAAU,SAAS,8BAAgC,CAAA,EAE9E,MAAMC,EAAY,MAAMvE,EAAW,2BAA4B+B,EAAM,QAAQ,EAC7EiC,EAAY,MAAQO,EAAU,SAAS,yBAA2B,CAAA,CACnE,CAEAF,EAAA,EAKA,eAAeR,GAAiB,CAC/B,MAAMhF,EAAW,MAAMmB,EAAW,iBAAkB+B,EAAM,QAAQ,EAElEjB,EAAY,MAAMiB,EAAM,QAAQ,EAAG,gBAAmBlD,EAAS,SAAS,mBAA4C,EACrH,CAKA,eAAe2F,GAAc,CAC5B,GAAI,CACHP,EAAkB,MAAQ,GAC1B,MAAMpF,EAAW,MAAMmB,EAAW,cAAe+B,EAAM,QAAQ,EAC/D+B,EAAiB,MAAQjF,EAAS,QAAS,gBAC5C,QAAA,CACCoF,EAAkB,MAAQ,EAC3B,CACD,CAOA,eAAeQ,EAAiBrE,EAAgB,CAC3CA,EACH8B,EAAgB,MAAM,oBAAsB,IAE5CA,EAAgB,MAAM,oBAAsB,MAAM3B,EAAA,EAAkC,IAAM,GAE5F,eAtIC+B,EAAA,EAAAC,EAkDW,WAlDXC,GAkDW,CAjDVC,EAES,SAAA,KAAAe,EADLb,EAAAnD,CAAA,EAAC,YAAA,iEAAA,CAAA,aAAkFmD,EAAAR,CAAA,EAAY,CAAA,EAAA,CAAA,EAGnGM,EAgBM,MAhBNC,GAgBM,CAfLE,EAMoBD,EAAAS,CAAA,EAAA,YALVc,EAAA,2CAAAA,EAA0B,MAAAjB,GACnC,MAAM,mDACL,QAASc,EAAA,MACT,SAAU7B,EAAA,MAAgB,sBAAmB,IAC7C,WAAYS,EAAAnD,CAAA,EAAC,YAAA,4BAAA,EACb,SAAU,EAAA,2DAEZoD,EAMoBD,EAAAS,CAAA,EAAA,YALVgB,EAAA,2CAAAA,EAAqB,MAAAnB,GAC9B,MAAM,mDACL,QAASe,EAAA,MACT,SAAU9B,EAAA,MAAgB,sBAAmB,IAC7C,WAAYS,EAAAnD,CAAA,EAAC,YAAA,yBAAA,EACb,SAAU,EAAA,6DAGbiD,EAiBM,MAjBNS,GAiBM,CAhBLN,EAIwBD,EAAAK,CAAA,EAAA,CAHtB,WAAYd,EAAA,MAAgB,sBAAmB,IAC/C,sBAAmBuC,CAAA,aACpB,IAAuC,KAApC9B,EAAAnD,CAAA,EAAC,YAAA,iBAAA,CAAA,EAAA,CAAA,CAAA,0BAGM0C,EAAA,MAAgB,sBAAmB,SAA9CK,EAKM,MAAAkB,GAAA,CAJLb,EAG8ID,EAAAQ,CAAA,EAAA,CAFpI,WAAAjB,EAAA,MAAgB,gBAAhB,sBAAAY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAAf,EAAA,MAAgB,gBAAee,GACvC,YAAaN,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACd,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,2FAAA,CAAA,aAA4GmD,EAAAR,CAAA,CAAA,CAAY,CAAA,4DAExII,EAGM,MAAAmB,GAAA,CAFLjB,EAAiD,cAAxCE,EAAAnD,CAAA,EAAC,YAAA,cAAA,CAAA,EAAA,CAAA,EACViD,EAAkD,OAAA,KAAAe,EAAzCtB,EAAA,MAAgB,eAAe,EAAA,CAAA,CAAA,MAI1CO,EAOM,MAPNkB,GAOM,CANLf,EAEWD,EAAA+B,CAAA,EAAA,CAFA,SAAUT,EAAA,MAAoB,QAAOO,CAAA,aAC/C,IAA4D,KAAzD7B,EAAAnD,CAAA,EAAC,YAAA,sCAAA,CAAA,EAAA,CAAA,CAAA,wBAGgByE,EAAA,WAArBU,EAAqDhC,EAAAiC,CAAA,EAAA,OAAZ,KAAM,EAAA,aACnCd,EAAA,QAAqB,QAAS,CAAKG,EAAA,OAA/C3B,IAAAC,EAA+F,YAA1BuB,EAAA,KAAgB,EAAA,CAAA,4VC0BxF,MAAM/B,EAAQC,EAERC,EAAmBrB,EAAA,EACnB,CAAE,YAAAE,CAAA,EAAgB8C,EAAY3B,CAAgB,EAC9CC,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,SAAU,CACtF,0BAA2B8C,EAC3B,wBAAyBA,EACzB,qBAAsBA,CAAA,CACtB,CAAC,EAEI1C,EAAgBC,IAAoD,QAAQ,KAC5E0C,EAAe/D,EAAI,EAAE,EACrBgE,EAAqBhE,EAAc,EAAE,EAErCiE,EAA4B7D,EAAS,CAC1C,KAAM,CAAE,OAAOe,EAAgB,MAAM,0BAA0B,MAAM,GAAG,EAAE,OAAQiC,GAASA,IAAS,EAAE,CAAE,EACxG,IAAI/D,EAAO,CAAE8B,EAAgB,MAAM,0BAA4B9B,EAAM,KAAK,GAAG,CAAE,CAAA,CAC/E,EAEK6E,EAAsB9D,EAAS,IAAMe,EAAgB,MAAM,sBAAwB,GAAG,EACtFgD,EAA6B/D,EAAS,IAAM4D,EAAmB,MAAM,OAAQI,GAAW,CAACH,EAA0B,MAAM,SAASG,CAAM,CAAC,CAAC,EAEhJC,EAAcf,CAAI,EAKlB,eAAeA,GAAO,CACrB,MAAMxF,EAAW,MAAMmB,EAAW,sBAAuB+B,EAAM,QAAQ,EACvEgD,EAAmB,MAAQlG,EAAS,SAAS,6BAA+B,CAAA,CAC7E,CAKA,eAAegG,GAAqB,CACnC,GAAI3C,EAAgB,MAAM,sBAAwB,IAAK,CACtD,MAAMrD,EAAW,MAAMmB,EAAW,qBAAsB+B,EAAM,QAAQ,EAEtEjB,EAAY,MAAMiB,EAAM,QAAQ,EAAG,gBAAmBlD,EAAS,SAAS,mBAA4C,EACrH,CACD,CAKA,eAAewG,GAAkB,CAChC,GAAI,CACH,MAAMxG,EAAW,MAAMmB,EAAW,gBAAiB+B,EAAM,SAAU,CAAE,UAAW+C,EAAa,MAAO,EAE9FQ,EAAgBzG,EAAS,QAAS,oBAClC0G,EAAsB1G,EAAS,QAAS,2BAE1CyG,EAAgB,EACnB3F,EAAUH,EAAE,YAAa,8IAA+I,CAAE,OAAQ+F,CAAA,CAAqB,CAAC,EAC9LD,IAAkB,EAC5BvF,GAAYP,EAAE,YAAa,mCAAmC,CAAC,EACrD8F,EAAgB,GAC1BE,GAAYhG,EAAE,YAAa,kHAAkH,CAAC,CAEhJ,OAASC,EAAO,CAGf,OAFgBA,GAASD,EAAE,YAAa,+DAA+D,EAE/F,CACP,IAAK,oBACJG,EAAUH,EAAE,YAAa,8HAA8H,CAAC,EACxJ,MACD,IAAK,mBACJG,EAAUH,EAAE,YAAa,kFAAkF,CAAC,EAC5G,MACD,IAAK,sBACJG,EAAUH,EAAE,YAAa,mGAAmG,CAAC,EAC7H,KAAA,CAEH,CACD,CAOA,eAAeiF,EAAiBrE,EAAgB,CAC3CA,EACH8B,EAAgB,MAAM,oBAAsB,IAE5CA,EAAgB,MAAM,oBAAsB,MAAM3B,EAAA,EAAkC,IAAM,GAE5F,eAlKC+B,EAAA,EAAAC,EA6DW,WA7DXC,GA6DW,CA5DVC,EAES,SAAA,KAAAe,EADLb,EAAAnD,CAAA,EAAC,YAAA,wFAAA,CAAA,aAAyGmD,EAAAR,CAAA,EAAY,CAAA,EAAA,CAAA,EAG1HS,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,0BAAuB,IACnD,YAAaS,EAAAnD,CAAA,EAAC,YAAA,4GAAA,EACd,sBAAiBsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,wBAA0Be,EAAM,IAAA,IAAA,aACpE,IAAyC,KAAtCN,EAAAnD,CAAA,EAAC,YAAA,mBAAA,CAAA,EAAA,CAAA,CAAA,wCAGLoD,EAKwBD,EAAAK,CAAA,EAAA,CAJtB,WAAYd,EAAA,MAAgB,uBAAoB,IAChD,YAAaS,EAAAnD,CAAA,EAAC,YAAA,mFAAA,EACd,sBAAiBsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,qBAAuBe,EAAM,IAAA,IAAA,aACjE,IAA8C,KAA3CN,EAAAnD,CAAA,EAAC,YAAA,wBAAA,CAAA,EAAA,CAAA,CAAA,wCAGLiD,EAQM,MARNC,GAQM,CAPLE,EAMoBD,EAAAS,CAAA,EAAA,YALV4B,EAAA,2CAAAA,EAAyB,MAAA/B,GAClC,SAAA,GACC,SAAUgC,EAAA,MACV,QAASC,EAAA,MACT,WAAYvC,EAAAnD,CAAA,EAAC,YAAA,mBAAA,EACb,SAAU,EAAA,6DAGbiD,EAiBM,MAjBNS,GAiBM,CAhBLN,EAIwBD,EAAAK,CAAA,EAAA,CAHtB,WAAYiC,EAAA,MACZ,sBAAmBR,CAAA,aACpB,IAAuC,KAApC9B,EAAAnD,CAAA,EAAC,YAAA,iBAAA,CAAA,EAAA,CAAA,CAAA,0BAIEyF,EAAA,WADPN,EAK6EhC,EAAAQ,CAAA,EAAA,OAH3E,WAAYjB,EAAA,MAAgB,gBAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACd,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,+HAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,gBAAkBa,EAAM,OAAO,MAAA,0DACpER,EAGM,MAAAkB,GAAA,CAFLhB,EAAiD,cAAxCE,EAAAnD,CAAA,EAAC,YAAA,cAAA,CAAA,EAAA,CAAA,EACViD,EAAkD,OAAA,KAAAe,EAAzCtB,EAAA,MAAgB,eAAe,EAAA,CAAA,CAAA,MAI1CO,EAYM,MAZNiB,GAYM,CAXLd,EAIsBD,EAAAE,CAAA,EAAA,YAHZiC,EAAA,2CAAAA,EAAY,MAAA7B,GACpB,WAAYN,EAAAnD,CAAA,EAAC,YAAA,gFAAA,EACb,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACT,aAAa,KAAA,8CAEdoD,EAIWD,EAAA+B,CAAA,EAAA,CAHT,SAAUI,EAAA,MAAa,SAAM,EAC7B,QAAOO,CAAA,aACR,IAAuC,KAApC1C,EAAAnD,CAAA,EAAC,YAAA,iBAAA,CAAA,EAAA,CAAA,CAAA,2EC3CHiG,GAAU,CACb,KAAM,aACN,MAAO,CAAC,OAAO,EACf,MAAO,CACL,MAAO,CACL,KAAM,QAER,UAAW,CACT,KAAM,OACN,QAAS,gBAEX,KAAM,CACJ,KAAM,OACN,QAAS,EACX,CACF,CACF,+DAxBYvC,GAAA,CAAA,EAAE,mFAAmF,iDAX/FX,EAeO,OAfPmD,GAAcC,EAAA,OAAM,CACb,cAAaC,EAAA,MAAK,KAAA,OAClB,aAAYA,EAAA,MACb,MAAM,mCACN,KAAK,MACJ,QAAK9C,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAE0C,EAAA,MAAK,QAAU1C,CAAM,WACjCV,EAQM,MAAA,CARA,KAAMqD,EAAA,UACP,MAAM,4BACL,MAAOA,EAAA,KACP,OAAQA,EAAA,KACT,QAAQ,cACXnD,EAEO,OAFPS,GAEO,CADQ0C,EAAA,OAAbtD,EAAA,EAAAC,EAAuC,aAAhBqD,EAAA,KAAK,EAAA,CAAA,oYC6FpC,MAAM7D,EAAQC,EAERC,EAAmBrB,EAAA,EACnB,CAAE,YAAAE,CAAA,EAAgB8C,EAAY3B,CAAgB,EAC9CC,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,QAAQ,CAAC,EAEhF8D,EAAyB9E,EAAI,EAAK,EAClC+E,EAAuB/E,EAAI,EAAK,EAChCgF,EAAqBhF,EAAI,EAAK,EAE9BiF,EAAqBjF,EAAImB,EAAgB,MAAM,aAAa,EAC5D+D,EAAyBlF,EAAImB,EAAgB,MAAM,iBAAiB,EACpEgE,EAAyB/E,EAAS,IAChCe,EAAgB,MAAM,gBAAkB8D,EAAmB,OAAS9D,EAAgB,MAAM,oBAAsB+D,EAAuB,KAC9I,EAEDE,GACCjE,EACCkE,GAAW,CACXJ,EAAmB,MAAQI,EAAO,cAC9BA,EAAO,oBAAsB,MAChCH,EAAuB,MAAQ,GAE/BA,EAAuB,MAAQG,EAAO,iBAExC,CAAA,EAMD,SAASC,GAAoB,CAC5BnE,EAAgB,MAAM,cAAgB8D,EAAmB,MACzD9D,EAAgB,MAAM,kBAAoB+D,EAAuB,KAClE,CAKA,eAAeK,GAAkB,CAChC,GAAI,CACHT,EAAuB,MAAQ,GAC/B,KAAM,CAAE,QAAAU,CAAA,EAAY,MAAMvG,EAAW,kBAAmB+B,EAAM,QAAQ,EAEtEjB,EAAY,MAAMiB,EAAM,QAAQ,EAAG,SAAYwE,EAAS,WAAwB,EACjF,QAAA,CACCV,EAAuB,MAAQ,EAChC,CACD,CAKA,eAAeW,GAAc,CAC5B,GAAI,CACHT,EAAmB,MAAQ,GAC3B,KAAM,CAAE,QAAAQ,CAAA,EAAY,MAAMvG,EAAW,cAAe+B,EAAM,QAAQ,EAClEG,EAAgB,MAAM,SAAYqE,EAAS,WAAwB,EACpE,QAAA,CACCR,EAAmB,MAAQ,EAC5B,CACD,CAKA,eAAeU,GAAgB,CAC9B,GAAI,CACHX,EAAqB,MAAQ,GAC7B,KAAM,CAAE,QAAAS,CAAA,EAAY,MAAMvG,EAAW,gBAAiB+B,EAAM,QAAQ,EAC9D2E,EAAeH,EAAS,eAE1BG,EAAe,EAClBC,EAASnH,EAAE,YAAa,sDAAsD,CAAC,EACrEkH,EAAe,IACzBC,EAASnH,EAAE,YAAa,8CAA8C,CAAC,EAEvEmH,EAASC,GACR,YACA,6DACA,+DACAF,EACA,CAAE,aAAAA,CAAA,CAAa,CACf,CAEH,QAAA,CACCZ,EAAqB,MAAQ,EAC9B,CACD,eA7LCxD,EAAA,EAAAC,EAuFW,WAvFXC,GAuFW,CAtFVC,EAyBM,MAzBNC,GAyBM,CAxBLE,EAMwBD,EAAAK,CAAA,EAAA,CALtB,WAAYd,EAAA,MAAgB,0BAAuB,IACpD,KAAK,SACJ,aAAYS,EAAAnD,CAAA,EAAC,YAAA,qDAAA,EACb,sBAAiBsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEf,EAAA,MAAgB,wBAA0Be,EAAM,IAAA,IAAA,aACpE,IAA4C,KAAzCN,EAAAnD,CAAA,EAAC,YAAA,sBAAA,CAAA,EAAA,CAAA,CAAA,uCAGLoD,EAOWD,EAAA+B,CAAA,EAAA,CANT,MAAO/B,EAAAnD,CAAA,EAAC,YAAA,uDAAA,EACR,QAAKsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEN,EAAAV,CAAA,EAAiB,WAAWD,EAAA,QAAQ,EAAA,GACjC,OACV,IAA0B,CAA1BY,EAA0BiE,GAAA,CAAZ,KAAM,GAAE,CAAA,aACZ,IACX,CADWtD,EAAA,MACRZ,EAAAnD,CAAA,EAAC,YAAA,oBAAA,CAAA,EAAA,CAAA,CAAA,qBAELoD,EAOWD,EAAA+B,CAAA,EAAA,CANV,QAAQ,QACP,QAAK5B,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAEN,EAAAV,CAAA,EAAiB,aAAaD,EAAA,QAAQ,EAAA,GACnC,OACV,IAAqB,CAArBY,EAAqBkE,GAAA,CAAZ,KAAM,GAAE,CAAA,aACP,IACX,CADWvD,EAAA,MACRZ,EAAAnD,CAAA,EAAC,YAAA,sBAAA,CAAA,EAAA,CAAA,CAAA,WAINiD,EAoBM,MApBNS,GAoBM,CAnBLN,EAMsED,EAAAE,CAAA,EAAA,CALpE,WAAYX,EAAA,MAAgB,SAC5B,WAAYS,EAAAnD,CAAA,EAAC,YAAA,+EAAA,EACb,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,MAAA,EACT,YAAY,oBACZ,aAAa,MACZ,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,SAAWa,EAAM,OAAO,MAAA,8CAC7DN,EAWM,MAXNgB,GAWM,CAVLb,EAMsED,EAAAE,CAAA,EAAA,CALpE,WAAYX,EAAA,MAAgB,SAC5B,MAAOS,EAAAnD,CAAA,EAAC,YAAA,MAAA,EACT,YAAY,MACZ,KAAK,SACL,aAAa,MACZ,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,SAAWa,EAAM,OAAO,MAAA,iCAC7DH,EAEWD,EAAA+B,CAAA,EAAA,CAFA,SAAUmB,EAAA,MAAyB,QAAOS,CAAA,aACpD,IAAmC,KAAhC3D,EAAAnD,CAAA,EAAC,YAAA,aAAA,CAAA,EAAA,CAAA,CAAA,4BAKPiD,EAOM,MAPNiB,GAOM,CANLd,EAKsBD,EAAAE,CAAA,EAAA,YAJZmD,EAAA,2CAAAA,EAAkB,MAAA/C,GAC1B,WAAYN,EAAAnD,CAAA,EAAC,YAAA,iHAAA,EACb,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,SAAA,EACT,YAAY,8BACZ,aAAa,KAAA,gDAGfiD,EAWM,MAXNkB,GAWM,CAVLf,EAKsBD,EAAAE,CAAA,EAAA,YAJZoD,EAAA,2CAAAA,EAAsB,MAAAhD,GAC/B,KAAK,WACJ,WAAYN,EAAAnD,CAAA,EAAC,YAAA,oDAAA,EACb,MAAOmD,EAAAnD,CAAA,EAAC,YAAA,UAAA,EACT,aAAa,KAAA,8CAEdoD,EAEWD,EAAA+B,CAAA,EAAA,CAFA,UAAWwB,EAAA,MAAyB,QAAOG,CAAA,aACrD,IAAwC,KAArC1D,EAAAnD,CAAA,EAAC,YAAA,kBAAA,CAAA,EAAA,CAAA,CAAA,0BAINiD,EAcM,MAdNsE,GAcM,CAbLnE,EAKsED,EAAAQ,CAAA,EAAA,CAJpE,MAAOR,EAAAnD,CAAA,EAAC,YAAA,SAAA,EACR,WAAY0C,EAAA,MAAgB,SAC5B,YAAaS,EAAAnD,CAAA,EAAC,YAAA,sBAAA,EACd,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,kEAAA,EACb,SAAMsD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAGC,GAAUb,EAAA,MAAgB,SAAWa,EAAM,OAAO,MAAA,4DAE7DH,EAEWD,EAAA+B,CAAA,EAAA,CAFA,SAAUqB,EAAA,OAAsBG,EAAA,MAAyB,QAAOM,CAAA,aAC1E,IAAsC,KAAnC7D,EAAAnD,CAAA,EAAC,YAAA,gBAAA,CAAA,EAAA,CAAA,CAAA,wBAELoD,EAEWD,EAAA+B,CAAA,EAAA,CAFA,SAAUoB,EAAA,OAAwB5D,EAAA,MAAgB,WAAQ,GAAU,QAAOuE,CAAA,aACrF,IAAoC,KAAjC9D,EAAAnD,CAAA,EAAC,YAAA,cAAA,CAAA,EAAA,CAAA,CAAA,kfCrBR,MAAMuC,EAAQC,EAERC,EAAmBrB,EAAA,EACnB,CAAE,YAAAE,CAAA,EAAgB8C,EAAY3B,CAAgB,EAC9CC,EAAkBf,EAAS,IAAMc,EAAiB,eAAeF,EAAM,SAAU,CACtF,0BAA2BiF,EAC3B,qBAAsBA,CAAA,CACtB,CAAC,EAEIC,EAAalG,EAAwB,MAAS,EAC9CmG,EAAmBnG,EAAI,EAAK,EAE5BoB,EAAgBC,IAAoD,QAAQ,KAE5E+E,EAAoBpG,EAAI,EAAc,EACtCqG,EAAarG,EAAI,EAAc,EAE/BsG,EAA4BlG,EAAS,CAC1C,KAAM,CAAE,OAAOe,EAAgB,MAAM,2BAA2B,MAAM,GAAG,EAAE,OAAQiC,GAASA,IAAS,EAAE,GAAK,CAAA,CAAG,EAC/G,IAAI/D,EAAO,CAAE8B,EAAgB,MAAM,0BAA4B9B,EAAM,KAAK,GAAG,CAAE,CAAA,CAC/E,EACKkH,EAAuBnG,EAAS,CACrC,KAAM,CAAE,OAAOe,EAAgB,MAAM,qBAAqB,MAAM,GAAG,EAAE,OAAQiC,GAASA,IAAS,EAAE,CAAE,EACnG,IAAI/D,EAAO,CAAE8B,EAAgB,MAAM,qBAAuB9B,EAAM,KAAK,GAAG,CAAE,CAAA,CAC1E,EAEDgF,EAAcf,CAAI,EAKlB,eAAeA,GAAO,CACrB,MAAMC,EAAY,MAAMtE,EAAW,6BAA8B+B,EAAM,QAAQ,EAC/EoF,EAAkB,MAAQ7C,EAAU,SAAS,6BAA+B,CAAA,EAE5ExD,EAAY,MAAMiB,EAAM,QAAQ,EAAG,0BAA6BuC,EAAU,SAAS,6BAAsD,KAAK,GAAG,GAAK,GAEtJ,MAAMC,EAAY,MAAMvE,EAAW,0BAA2B+B,EAAM,QAAQ,EAC5EqF,EAAW,MAAQ7C,EAAU,SAAS,wBAA0B,CAAA,EAEhEzD,EAAY,MAAMiB,EAAM,QAAQ,EAAG,qBAAwBwC,EAAU,SAAS,wBAAiD,KAAK,GAAG,GAAK,EAC7I,CAKA,eAAeyC,GAAgB,CAC9B,GAAI9E,EAAgB,MAAM,qBAAuB,IAAK,CACrD,MAAMoC,EAAY,MAAMtE,EAAW,oBAAqB+B,EAAM,QAAQ,EAEtEjB,EAAY,MAAMiB,EAAM,QAAQ,EAAG,eAAkBuC,EAAU,SAAS,sBAA+C,GAEvH,MAAMC,EAAY,MAAMvE,EAAW,qBAAsB+B,EAAM,QAAQ,EAEvEjB,EAAY,MAAMiB,EAAM,QAAQ,EAAG,gBAAmBwC,EAAU,SAAS,mBAA4C,EACtH,CACD,CAKA,eAAegD,GAAa,CAC3B,GAAI,CACHL,EAAiB,MAAQ,GACzB,MAAMrI,EAAW,MAAMmB,EAAW,aAAc+B,EAAM,QAAQ,EAC9DkF,EAAW,MAAQpI,EAAS,QAAS,eACtC,QAAA,CACCqI,EAAiB,MAAQ,EAC1B,CACD,CAOA,eAAezC,EAAiBrE,EAAgB,CAC3CA,EACH8B,EAAgB,MAAM,mBAAqB,IAE3CA,EAAgB,MAAM,mBAAqB,MAAM3B,EAAA,EAAkC,IAAM,GAE3F,eAjJC+B,EAAA,EAAAC,EAmDW,WAnDXC,GAmDW,CAlDPe,EAAAC,EAAAb,EAAAnD,CAAA,oFAAsF,IAEzF,CAAA,EAAAiD,EASM,MATNC,GASM,CARLE,EAMoBD,EAAAS,CAAA,EAAA,YALViE,EAAA,2CAAAA,EAAyB,MAAApE,GACjC,SAAUf,EAAA,MAAgB,qBAAkB,IAC7C,MAAM,uDACL,QAASiF,EAAA,MACT,WAAYxE,EAAAnD,CAAA,EAAC,YAAA,4BAAA,EACb,SAAU,EAAA,2DAAQ+D,EAAA,MACjBZ,EAAAnD,CAAA,EAAC,YAAA,4LAAA,CAAA,EAAA,CAAA,CAAA,GAGLiD,EAQM,MARNS,GAQM,CAPLN,EAMoBD,EAAAS,CAAA,EAAA,YALVkE,EAAA,2CAAAA,EAAoB,MAAArE,GAC7B,MAAM,iDACL,SAAUf,EAAA,MAAgB,qBAAkB,IAC5C,QAASkF,EAAA,MACT,WAAYzE,EAAAnD,CAAA,EAAC,YAAA,yBAAA,EACb,SAAU,EAAA,6DAGbiD,EAiBM,MAjBNgB,GAiBM,CAhBLb,EAIwBD,EAAAK,CAAA,EAAA,CAHtB,WAAYd,EAAA,MAAgB,qBAAkB,IAC9C,sBAAmBuC,CAAA,aACpB,IAAuC,KAApC9B,EAAAnD,CAAA,EAAC,YAAA,iBAAA,CAAA,EAAA,CAAA,CAAA,0BAGM0C,EAAA,MAAgB,qBAAkB,SAA7CK,EAKM,MAAAmB,GAAA,CAJLd,EAG6ID,EAAAQ,CAAA,EAAA,CAFnI,WAAAjB,EAAA,MAAgB,eAAhB,sBAAAY,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,GAAAf,EAAA,MAAgB,eAAce,GACtC,YAAaN,EAAAnD,CAAA,EAAC,YAAA,iBAAA,EACd,WAAYmD,EAAAnD,CAAA,EAAC,YAAA,0FAAA,CAAA,aAA2GmD,EAAAR,CAAA,CAAA,CAAY,CAAA,4DAEvII,EAGM,MAAAoB,GAAA,CAFLlB,EAAmD,eAAzCE,EAAAnD,CAAA,EAAC,YAAA,cAAA,CAAA,EAAA,CAAA,EACXiD,EAAiD,OAAA,KAAAe,EAAxCtB,EAAA,MAAgB,cAAc,EAAA,CAAA,CAAA,MAIzCO,EAOM,MAPNsE,GAOM,CANLnE,EAEWD,EAAA+B,CAAA,EAAA,CAFA,SAAUwC,EAAA,MAAmB,QAAOK,CAAA,aAC9C,IAAuD,KAApD5E,EAAAnD,CAAA,EAAC,YAAA,iCAAA,CAAA,EAAA,CAAA,CAAA,wBAGgB0H,EAAA,WAArBvC,EAAoDhC,EAAAiC,CAAA,EAAA,OAAZ,KAAM,EAAA,aAClCqC,EAAA,QAAe,QAAS,CAAKC,EAAA,WAAzC3E,EAAqJ,OAAAiF,GAAAhE,EAAvFb,EAAAnD,CAAA,EAAC,YAAA,2BAAA,CAAA,WAA4CyH,EAAA,KAAA,EAAU,CAAA,OAAA,EAAA,CAAA,CAAA,EAAA,CAAA,+MCVxH,MAAMlF,EAAQC,EAERC,EAAmBrB,EAAA,EACnB,CAAE,eAAAQ,CAAA,EAAmBwC,EAAY3B,CAAgB,EAEjDwF,EAAU1G,EAAI,EAAK,EACnBL,EAASK,EAAkD,IAAI,EAC/D2G,EAAWvG,EAAS,IAAMT,EAAO,OAAO,OAAO,EAErDyF,GAAM/E,EAAgB,IAAM,CAC3BV,EAAO,MAAQ,IAChB,CAAC,EAKD,eAAeiH,GAAqB,CACnC,GAAI,CACHF,EAAQ,MAAQ,GAChB/G,EAAO,MAAQ,MAAMd,GAAkBmC,EAAM,QAAQ,CACtD,QAAA,CACC0F,EAAQ,MAAQ,EACjB,CACD,eA9DCnF,EAAA,EAAAC,EA2BM,MA3BNC,GA2BM,CA1BLI,EAEWD,EAAA+B,CAAA,EAAA,CAFD,QAAQ,UAAW,SAAU+C,EAAA,MAAU,QAAOE,CAAA,aACvD,IAA0C,KAAvChF,EAAAnD,CAAA,EAAC,YAAA,oBAAA,CAAA,EAAA,CAAA,CAAA,wBAGLoD,EASWD,EAAA+B,CAAA,EAAA,CARV,QAAQ,WACR,KAAK,gEACL,OAAO,SACP,IAAI,qBAAA,GACO,OACV,IAA0B,CAA1B9B,EAA0BgF,GAAA,CAAZ,KAAM,GAAE,CAAA,aAEvB,IAAyC,CAAzCnF,EAAyC,cAAhCE,EAAAnD,CAAA,EAAC,YAAA,MAAA,CAAA,EAAA,CAAA,CAAA,SAGKkB,EAAA,eAAoB+G,EAAA,WAApClF,EAQWsF,EAAA,CAAA,IAAA,GAAA,CAPVpF,EAE0E,OAAA,CADzE,MAAKqF,GAAA,CAAC,yCAAwC,CAAA,gDACaJ,EAAA,MAAQ,CAAA,CAAA,UAEpEjF,EAEO,OAFPC,GAEOc,EADH9C,EAAA,MAAO,OAAO,EAAA,CAAA,CAAA,gBAIE+G,EAAA,WAArB9C,EAA2ChC,EAAAiC,CAAA,EAAA,OAAZ,KAAM,EAAA,2YC0EvC,MAAMmD,EAAsB/G,GAAU,YAAa,qBAAqB,EAElEgH,EAAO,CACZ,OAAQxI,EAAE,YAAa,QAAQ,EAC/B,MAAOA,EAAE,YAAa,OAAO,EAC7B,MAAOA,EAAE,YAAa,kBAAkB,EACxC,OAAQA,EAAE,YAAa,QAAQ,EAC/B,SAAUA,EAAE,YAAa,UAAU,EACnC,OAAQA,EAAE,YAAa,QAAQ,CAAA,EAG1ByC,EAAmBrB,EAAA,EACnB,CAAE,YAAAE,EAAa,iBAAAG,EAAkB,eAAAC,CAAA,EAAmB0C,EAAY3B,CAAgB,EAEhFgG,EAAclH,EAAI,QAAQ,EAC1BmH,EAAsBnH,EAAI,EAAK,EAE/BoH,EAA8BhH,EAAS,IACrCD,EAAe,QAAU,QAC5BA,EAAe,MAAM,WAAa,IAClCA,EAAe,MAAM,WAAa,IAClCA,EAAe,MAAM,WAAa,IAClCA,EAAe,MAAM,gBAAkB,IACvCA,EAAe,MAAM,oBAAsB,EAC/C,EAOD,eAAekH,EAAoBtI,EAA2B,CAC7D,GAAI,CACHoI,EAAoB,MAAQ,GAC5B,MAAMrI,GAAaC,CAAO,CAC3B,SACCoI,EAAoB,MAAQ,EAC7B,CACD,eA1IC5F,EAAA,EAAAC,EAgFO,OAhFPC,GAgFO,CA/ENC,EAAoD,YAA7CE,EAAAnD,CAAA,EAAC,YAAA,qBAAA,CAAA,EAAA,CAAA,EAGAmD,EAAAoF,CAAA,gBADRpD,EAGkJhC,EAAA0F,EAAA,EAAA,OADjJ,KAAK,UACJ,KAAM1F,EAAAnD,CAAA,EAAC,YAAA,sHAAA,CAAA,oBAEOmD,EAAAoF,CAAA,OAAhBxF,EAuEWsF,EAAA,CAAA,IAAA,GAAA,CAtEVpF,EAsBM,MAtBNC,GAsBM,CApBEC,EAAA1B,CAAA,IAAqB,YAD5B0D,EAWWhC,EAAAS,CAAA,EAAA,kBATDT,EAAA1B,CAAA,6CAAAA,EAAgB,MAAAgC,EAAA,MACxB,QAAS,OAAO,KAAKN,EAAA7B,CAAA,CAAW,EAChC,WAAY6B,EAAAnD,CAAA,EAAC,YAAA,oBAAA,CAAA,GACH,OAAM6D,EAChB,CAA6D,CAAA,MADlCpE,KAAQ,CAC7BsE,EAAAC,EAAA,GAAAvE,CAAQ,KAAK0D,EAAA7B,CAAA,EAAY7B,CAAQ,GAAG,UAAQ,EAAA,EAAA,EAAA,CAAA,CAAA,GAExC,kBAAeoE,EACzB,CAA6D,CAAA,MADzBpE,KAAQ,CACtCsE,EAAAC,EAAA,GAAAvE,CAAQ,KAAK0D,EAAA7B,CAAA,EAAY7B,CAAQ,GAAG,UAAQ,EAAA,EAAA,EAAA,CAAA,CAAA,2DAGpD2D,EAQWD,EAAA+B,CAAA,EAAA,CAPT,MAAO/B,EAAAnD,CAAA,EAAC,YAAA,mBAAA,EACT,MAAM,+CACL,QAAOmD,EAAAV,CAAA,EAAiB,MAAA,GACd,OACV,IAAmB,CAAnBW,EAAmB0F,GAAA,CAAZ,KAAM,GAAE,CAAA,aACL,IACX,CADW/E,EAAA,MACRZ,EAAAnD,CAAA,EAAC,YAAA,sBAAA,CAAA,EAAA,CAAA,CAAA,iCAIKmD,EAAA1B,CAAA,IAAqB,QAAhCqB,IAAAC,EAyBM,MAzBNW,GAyBM,CAxBLT,EAcM,MAdNgB,GAcM,CAbLhB,EAYM,MAZNiB,GAYM,EAXLpB,EAAA,EAAAC,EAUwBsF,EAAA,KAAAU,GATKP,EAAI,CAAxBQ,EAAUC,IADnB7F,EAUwBD,EAAAK,CAAA,EAAA,CARtB,IAAKyF,aACGR,EAAA,2CAAAA,EAAW,MAAAhF,GACnB,cAAe,GACf,MAAOwF,EACR,KAAK,QACJ,SAAUA,IAAK,UAAA,CAAkBN,EAAA,MAClC,qBAAqB,YAAA,aACrB,IAAc,KAAXK,CAAQ,EAAA,CAAA,CAAA,0DAKGP,EAAA,QAAW,cAA5BtD,EAA0E+D,GAAA,OAA9B,SAAU/F,EAAA1B,CAAA,CAAA,wBACjCgH,EAAA,QAAW,aAAhCtD,EAA6EgE,GAAA,OAA9B,SAAUhG,EAAA1B,CAAA,CAAA,wBACpCgH,EAAA,QAAW,aAAhCtD,EAA6EiE,GAAA,OAA9B,SAAUjG,EAAA1B,CAAA,CAAA,wBACnCgH,EAAA,QAAW,cAAjCtD,EAA+EkE,GAAA,OAA9B,SAAUlG,EAAA1B,CAAA,CAAA,wBACrCgH,EAAA,QAAW,cAAjCtD,EAA+EmE,GAAA,OAA9B,SAAUnG,EAAA1B,CAAA,CAAA,wBACnCgH,EAAA,QAAW,gBAAnCtD,EAAmFoE,GAAA,OAA9B,SAAUpG,EAAA1B,CAAA,CAAA,iCAE/D2B,EAA6EoG,GAAA,CAA7D,MAAM,wBAAyB,SAAUrG,EAAA1B,CAAA,CAAA,mCAG1DwB,EAkBM,MAlBNkB,GAkBM,CAjBLlB,EAAmE,gBAAxDE,EAAAnD,CAAA,EAAC,YAAA,4BAAA,CAAA,EAAA,CAAA,IAAuD,IACnEgE,EAAGb,EAAAnD,CAAA,EAAC,YAAA,orBAAA,CAAA,EAAssB,IAE1sB,CAAA,EAAAiD,EAaM,MAbNsE,GAaM,CAZLnE,EAKWD,EAAA+B,CAAA,EAAA,CAJV,QAAQ,QACP,SAAUwD,EAAA,MACV,uBAAOE,EAAmB,MAAA,EAAA,aAC3B,IAAwD,KAArDzF,EAAAnD,CAAA,EAAC,YAAA,kCAAA,CAAA,EAAA,CAAA,CAAA,wBAELoD,EAKWD,EAAA+B,CAAA,EAAA,CAJV,QAAQ,QACP,SAAUwD,EAAA,MACV,uBAAOE,EAAmB,OAAA,EAAA,aAC3B,IAA0D,KAAvDzF,EAAAnD,CAAA,EAAC,YAAA,oCAAA,CAAA,EAAA,CAAA,CAAA,4FCzEGyJ,GAAQC,GAAA,ECEfC,EAAMC,GAAUC,EAAe,EACrCF,EAAI,IAAIF,EAAK,EACbE,EAAI,MAAM,wBAAwB","x_google_ignoreList":[7]}