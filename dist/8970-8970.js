"use strict";(self.webpackChunknextcloud=self.webpackChunknextcloud||[]).push([[8970],{28970:(t,e,i)=>{i.r(e),i.d(e,{default:()=>b});var n=i(85471),a=i(93457),r=i(21777),s=i(95674),o=i(94219),l=i(31133),u=i(82182),c=i(67145),m=i(35810);const d=(0,a.c0)("public").build(),p=(0,n.pM)({name:"PublicAuthPrompt",components:{NcDialog:o.A,NcNoteCard:l.A,NcTextField:u.A},props:{nickname:{type:String,default:""},title:{type:String,default:(0,c.t)("Guest identification")},text:{type:String,default:""},notice:{type:String,default:""},submitLabel:{type:String,default:(0,c.t)("Submit name")},cancellable:{type:Boolean,default:!1}},setup:()=>({t:c.t}),emits:["close"],data:()=>({name:""}),computed:{dialogButtons(){const t={label:(0,c.t)("Cancel"),variant:"tertiary",callback:()=>this.$emit("close")},e={label:this.submitLabel,type:"submit",variant:"primary"};return this.cancellable?[t,e]:[e]},defaultNotice(){return this.notice?this.notice:this.nickname?(0,c.t)("You are currently identified as {nickname}.",{nickname:this.nickname}):(0,c.t)("You are currently not identified.")}},watch:{nickname:{handler(){this.name=this.nickname},immediate:!0},name(){const t=this.name.trim?.()||"",e=this.$refs.input?.$el.querySelector("input");if(!e)return;const i=function(t){if(""===t.trim())return(0,c.t)("Names must not be empty.");if(t.startsWith("."))return(0,c.t)("Names must not start with a dot.");if(t.length>64)return(0,c.t)("Names may be at most 64 characters long.");try{return(0,m.KT)(t),""}catch(t){if(!(t instanceof m.di))throw t;switch(t.reason){case m.nF.Character:return(0,c.t)('"{char}" is not allowed inside a name.',{char:t.segment});case m.nF.ReservedName:return(0,c.t)('"{segment}" is a reserved name and not allowed.',{segment:t.segment});case m.nF.Extension:return t.segment.match(/\.[a-z]/i)?(0,c.t)('"{extension}" is not an allowed name.',{extension:t.segment}):(0,c.t)('Names must not end with "{extension}".',{extension:t.segment});default:return(0,c.t)("Invalid name.")}}}(t);e.setCustomValidity(i),e.reportValidity()}},methods:{onSubmit(){const t=this.$refs.input,e=this.name.trim();if(""===e)return t.setCustomValidity((0,c.t)("You cannot leave the name empty.")),t.reportValidity(),void t.focus();if(e.length<2)return t.setCustomValidity((0,c.t)("Please enter a name with at least 2 characters.")),t.reportValidity(),void t.focus();try{(0,r.L$)(e)}catch(e){return(0,s.Qg)((0,c.t)("Failed to set nickname.")),console.error("Failed to set nickname",e),void t.focus()}d.setItem("public-auth-prompt-shown","true"),this.$emit("close",this.name)}}});var h=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("NcDialog",{staticClass:"public-auth-prompt",attrs:{buttons:t.dialogButtons,"data-cy-public-auth-prompt-dialog":"","is-form":"","no-close":"",name:t.title},on:{submit:t.onSubmit}},[t.text?e("p",{staticClass:"public-auth-prompt__text"},[t._v(" "+t._s(t.text)+" ")]):t._e(),e("NcNoteCard",{staticClass:"public-auth-prompt__header",attrs:{text:t.defaultNotice,type:"info"}}),e("NcTextField",{ref:"input",staticClass:"public-auth-prompt__input",attrs:{"data-cy-public-auth-prompt-dialog-name":"",label:t.t("Name"),placeholder:t.t("Enter your name"),required:!t.cancellable,minlength:"2",maxlength:"64",name:"name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)},f=[];const b=(0,c.n)(p,h,f,!1,null,"414f7090").exports},67368:(t,e)=>{function i(t,e,i){var n;return(e="symbol"==typeof(n=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;class n{constructor(t,e,a){i(this,"scope",void 0),i(this,"wrapped",void 0),this.scope="".concat(a?n.GLOBAL_SCOPE_PERSISTENT:n.GLOBAL_SCOPE_VOLATILE,"_").concat(btoa(t),"_"),this.wrapped=e}scopeKey(t){return"".concat(this.scope).concat(t)}setItem(t,e){this.wrapped.setItem(this.scopeKey(t),e)}getItem(t){return this.wrapped.getItem(this.scopeKey(t))}removeItem(t){this.wrapped.removeItem(this.scopeKey(t))}clear(){Object.keys(this.wrapped).filter(t=>t.startsWith(this.scope)).map(this.wrapped.removeItem.bind(this.wrapped))}}e.default=n,i(n,"GLOBAL_SCOPE_VOLATILE","nextcloud_vol"),i(n,"GLOBAL_SCOPE_PERSISTENT","nextcloud_per")},91017:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,a=(n=i(67368))&&n.__esModule?n:{default:n};function r(t,e,i){var n;return(e="symbol"==typeof(n=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e))?n:n+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}e.default=class{constructor(t){r(this,"appId",void 0),r(this,"persisted",!1),r(this,"clearedOnLogout",!1),this.appId=t}persist(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.persisted=t,this}clearOnLogout(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.clearedOnLogout=t,this}build(){return new a.default(this.appId,this.persisted?window.localStorage:window.sessionStorage,!this.clearedOnLogout)}}},93457:(t,e,i)=>{e.c0=function(t){return new n.default(t)};var n=a(i(91017));a(i(67368));function a(t){return t&&t.__esModule?t:{default:t}}}}]);
//# sourceMappingURL=8970-8970.js.map?v=1a3b6844f3a72d08ba45