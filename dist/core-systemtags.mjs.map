{"version":3,"file":"core-systemtags.mjs","sources":["../core/src/systemtags/systemtags.js","../core/src/systemtags/systemtagmodel.js","../core/src/systemtags/systemtagsmappingcollection.js","../core/src/systemtags/systemtagscollection.js","../core/src/systemtags/templates/result.handlebars.cjs","../core/src/systemtags/templates/result_form.handlebars.cjs","../core/src/systemtags/templates/selection.handlebars.cjs","../core/src/systemtags/systemtagsinputfield.js"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2016-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-FileCopyrightText: 2016 ownCloud, Inc.\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n/* eslint-disable */\nimport escapeHTML from 'escape-html'\n\n(function(OC) {\n\t/**\n\t * @namespace\n\t */\n\tOC.SystemTags = {\n\t\t/**\n\t\t *\n\t\t * @param {OC.SystemTags.SystemTagModel|Object|String} tag\n\t\t * @returns {HTMLElement}\n\t\t */\n\t\tgetDescriptiveTag: function(tag) {\n\t\t\tif (_.isUndefined(tag.name) && !_.isUndefined(tag.toJSON)) {\n\t\t\t\ttag = tag.toJSON()\n\t\t\t}\n\n\t\t\tvar $span = document.createElement('span')\n\n\t\t\tif (_.isUndefined(tag.name)) {\n\t\t\t\t$span.classList.add('non-existing-tag')\n\t\t\t\t$span.textContent = t('core', 'Non-existing tag #{tag}', {\n\t\t\t\t\t\ttag: tag\n\t\t\t\t})\n\t\t\t\treturn $span\n\t\t\t}\n\n\t\t\t$span.textContent = escapeHTML(tag.name)\n\n\t\t\tvar scope\n\t\t\tif (!tag.userAssignable) {\n\t\t\t\tscope = t('core', 'Restricted')\n\t\t\t}\n\t\t\tif (!tag.userVisible) {\n\t\t\t\t// invisible also implicitly means not assignable\n\t\t\t\tscope = t('core', 'Invisible')\n\t\t\t}\n\t\t\tif (scope) {\n\t\t\t\tvar $scope = document.createElement('em')\n\t\t\t\t$scope.textContent = ' (' + scope + ')'\n\t\t\t\t$span.appendChild($scope)\n\t\t\t}\n\t\t\treturn $span\n\t\t}\n\t}\n})(OC)\n","/**\n * SPDX-FileCopyrightText: 2016-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-FileCopyrightText: 2016 ownCloud, Inc.\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n(function(OC) {\n\tif (OC?.Files?.Client) {\n\t\t_.extend(OC.Files.Client, {\n\t\t\tPROPERTY_FILEID: '{' + OC.Files.Client.NS_OWNCLOUD + '}id',\n\t\t\tPROPERTY_CAN_ASSIGN: '{' + OC.Files.Client.NS_OWNCLOUD + '}can-assign',\n\t\t\tPROPERTY_DISPLAYNAME: '{' + OC.Files.Client.NS_OWNCLOUD + '}display-name',\n\t\t\tPROPERTY_USERVISIBLE: '{' + OC.Files.Client.NS_OWNCLOUD + '}user-visible',\n\t\t\tPROPERTY_USERASSIGNABLE: '{' + OC.Files.Client.NS_OWNCLOUD + '}user-assignable',\n\t\t})\n\n\t\t/**\n\t\t * @class OCA.SystemTags.SystemTagsCollection\n\t\t * @classdesc\n\t\t *\n\t\t * System tag\n\t\t *\n\t\t */\n\t\tconst SystemTagModel = OC.Backbone.Model.extend(\n\t\t\t/** @lends OCA.SystemTags.SystemTagModel.prototype */ {\n\t\t\t\tsync: OC.Backbone.davSync,\n\n\t\t\t\tdefaults: {\n\t\t\t\t\tuserVisible: true,\n\t\t\t\t\tuserAssignable: true,\n\t\t\t\t\tcanAssign: true,\n\t\t\t\t},\n\n\t\t\t\tdavProperties: {\n\t\t\t\t\tid: OC.Files.Client.PROPERTY_FILEID,\n\t\t\t\t\tname: OC.Files.Client.PROPERTY_DISPLAYNAME,\n\t\t\t\t\tuserVisible: OC.Files.Client.PROPERTY_USERVISIBLE,\n\t\t\t\t\tuserAssignable: OC.Files.Client.PROPERTY_USERASSIGNABLE,\n\t\t\t\t\t// read-only, effective permissions computed by the server,\n\t\t\t\t\tcanAssign: OC.Files.Client.PROPERTY_CAN_ASSIGN,\n\t\t\t\t},\n\n\t\t\t\tparse(data) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid: data.id,\n\t\t\t\t\t\tname: data.name,\n\t\t\t\t\t\tuserVisible: data.userVisible === true || data.userVisible === 'true',\n\t\t\t\t\t\tuserAssignable: data.userAssignable === true || data.userAssignable === 'true',\n\t\t\t\t\t\tcanAssign: data.canAssign === true || data.canAssign === 'true',\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t})\n\n\t\tOC.SystemTags = OC.SystemTags || {}\n\t\tOC.SystemTags.SystemTagModel = SystemTagModel\n\t}\n})(OC)\n","/**\n * SPDX-FileCopyrightText: 2016-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-FileCopyrightText: 2016 ownCloud, Inc.\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { generateRemoteUrl } from '@nextcloud/router'\n\n(function(OC) {\n\t/**\n\t * @class OC.SystemTags.SystemTagsMappingCollection\n\t * @classdesc\n\t *\n\t * Collection of tags assigned to a an object\n\t *\n\t */\n\tconst SystemTagsMappingCollection = OC.Backbone.Collection.extend(\n\t\t/** @lends OC.SystemTags.SystemTagsMappingCollection.prototype */ {\n\n\t\t\tsync: OC.Backbone.davSync,\n\n\t\t\t/**\n\t\t\t * Use PUT instead of PROPPATCH\n\t\t\t */\n\t\t\tusePUT: true,\n\n\t\t\t/**\n\t\t\t * Id of the file for which to filter activities by\n\t\t\t *\n\t\t\t * @member int\n\t\t\t */\n\t\t\t_objectId: null,\n\n\t\t\t/**\n\t\t\t * Type of the object to filter by\n\t\t\t *\n\t\t\t * @member string\n\t\t\t */\n\t\t\t_objectType: 'files',\n\n\t\t\tmodel: OC.SystemTags.SystemTagModel,\n\n\t\t\turl() {\n\t\t\t\treturn generateRemoteUrl('dav') + '/systemtags-relations/' + this._objectType + '/' + this._objectId\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Sets the object id to filter by or null for all.\n\t\t\t *\n\t\t\t * @param {number} objectId file id or null\n\t\t\t */\n\t\t\tsetObjectId(objectId) {\n\t\t\t\tthis._objectId = objectId\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Sets the object type to filter by or null for all.\n\t\t\t *\n\t\t\t * @param {number} objectType file id or null\n\t\t\t */\n\t\t\tsetObjectType(objectType) {\n\t\t\t\tthis._objectType = objectType\n\t\t\t},\n\n\t\t\tinitialize(models, options) {\n\t\t\t\toptions = options || {}\n\t\t\t\tif (!_.isUndefined(options.objectId)) {\n\t\t\t\t\tthis._objectId = options.objectId\n\t\t\t\t}\n\t\t\t\tif (!_.isUndefined(options.objectType)) {\n\t\t\t\t\tthis._objectType = options.objectType\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetTagIds() {\n\t\t\t\treturn this.map(function(model) {\n\t\t\t\t\treturn model.id\n\t\t\t\t})\n\t\t\t},\n\t\t})\n\n\tOC.SystemTags = OC.SystemTags || {}\n\tOC.SystemTags.SystemTagsMappingCollection = SystemTagsMappingCollection\n})(OC)\n","/**\n * SPDX-FileCopyrightText: 2016-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-FileCopyrightText: 2016 ownCloud, Inc.\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n/* eslint-disable */\n(function(OC) {\n\n\tfunction filterFunction(model, term) {\n\t\treturn model.get('name').substr(0, term.length).toLowerCase() === term.toLowerCase()\n\t}\n\n\t/**\n\t * @class OCA.SystemTags.SystemTagsCollection\n\t * @classdesc\n\t *\n\t * Collection of tags assigned to a file\n\t *\n\t */\n\tvar SystemTagsCollection = OC.Backbone.Collection.extend(\n\t\t/** @lends OC.SystemTags.SystemTagsCollection.prototype */ {\n\n\t\t\tsync: OC.Backbone.davSync,\n\n\t\t\tmodel: OC.SystemTags.SystemTagModel,\n\n\t\t\turl: function() {\n\t\t\t\treturn OC.linkToRemote('dav') + '/systemtags/'\n\t\t\t},\n\n\t\t\tfilterByName: function(name) {\n\t\t\t\treturn this.filter(function(model) {\n\t\t\t\t\treturn filterFunction(model, name)\n\t\t\t\t})\n\t\t\t},\n\n\t\t\treset: function() {\n\t\t\t\tthis.fetched = false\n\t\t\t\treturn OC.Backbone.Collection.prototype.reset.apply(this, arguments)\n\t\t\t},\n\n\t\t\t/**\n\t\t * Lazy fetch.\n\t\t * Only fetches once, subsequent calls will directly call the success handler.\n\t\t *\n\t\t * @param {any} options -\n\t\t * @param [options.force] true to force fetch even if cached entries exist\n\t\t *\n\t\t * @see Backbone.Collection#fetch\n\t\t */\n\t\t\tfetch: function(options) {\n\t\t\t\tvar self = this\n\t\t\t\toptions = options || {}\n\t\t\t\tif (this.fetched || this.working || options.force) {\n\t\t\t\t// directly call handler\n\t\t\t\t\tif (options.success) {\n\t\t\t\t\t\toptions.success(this, null, options)\n\t\t\t\t\t}\n\t\t\t\t\t// trigger sync event\n\t\t\t\t\tthis.trigger('sync', this, null, options)\n\t\t\t\t\treturn Promise.resolve()\n\t\t\t\t}\n\n\t\t\t\tthis.working = true\n\n\t\t\t\tvar success = options.success\n\t\t\t\toptions = _.extend({}, options)\n\t\t\t\toptions.success = function() {\n\t\t\t\t\tself.fetched = true\n\t\t\t\t\tself.working = false\n\t\t\t\t\tif (success) {\n\t\t\t\t\t\treturn success.apply(this, arguments)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn OC.Backbone.Collection.prototype.fetch.call(this, options)\n\t\t\t}\n\t\t})\n\n\tOC.SystemTags = OC.SystemTags || {}\n\tOC.SystemTags.SystemTagsCollection = SystemTagsCollection\n\n\t/**\n\t * @type OC.SystemTags.SystemTagsCollection\n\t */\n\tOC.SystemTags.collection = new OC.SystemTags.SystemTagsCollection()\n})(OC)\n","/* eslint-disable valid-typeof */\nconst Handlebars = require('handlebars')\nconst template = Handlebars.template\nconst templates = Handlebars.templates = Handlebars.templates || {}\ntemplates.result = template({\n\t1(container, depth0, helpers, partials, data) {\n\t\treturn ' new-item'\n\t},\n\t3(container, depth0, helpers, partials, data) {\n\t\tlet stack1; let helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t\t<span class=\"label\">'\n    + ((stack1 = ((helper = (helper = lookupProperty(helpers, 'tagMarkup') || (depth0 != null ? lookupProperty(depth0, 'tagMarkup') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'tagMarkup', hash: {}, data, loc: { start: { line: 4, column: 22 }, end: { line: 4, column: 37 } } }) : helper))) != null ? stack1 : '')\n    + '</span>\\n'\n\t},\n\t5(container, depth0, helpers, partials, data) {\n\t\tlet helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t\t<span class=\"label\">'\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers, 'name') || (depth0 != null ? lookupProperty(depth0, 'name') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'name', hash: {}, data, loc: { start: { line: 6, column: 22 }, end: { line: 6, column: 30 } } }) : helper)))\n    + '</span>\\n'\n\t},\n\t7(container, depth0, helpers, partials, data) {\n\t\tlet helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t\t<span class=\"systemtags-actions\">\\n\t\t\t<a href=\"#\" class=\"rename icon icon-rename\" title=\"'\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers, 'renameTooltip') || (depth0 != null ? lookupProperty(depth0, 'renameTooltip') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'renameTooltip', hash: {}, data, loc: { start: { line: 10, column: 54 }, end: { line: 10, column: 71 } } }) : helper)))\n    + '\"></a>\\n\t\t</span>\\n'\n\t},\n\tcompiler: [8, '>= 4.3.0'],\n\tmain(container, depth0, helpers, partials, data) {\n\t\tlet stack1; let helper; let options; const alias1 = depth0 != null ? depth0 : (container.nullContext || {}); const alias2 = container.hooks.helperMissing; const alias3 = 'function'; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}; let buffer\n  = '<span class=\"systemtags-item'\n    + ((stack1 = lookupProperty(helpers, 'if').call(alias1, (depth0 != null ? lookupProperty(depth0, 'isNew') : depth0), { name: 'if', hash: {}, fn: container.program(1, data, 0), inverse: container.noop, data, loc: { start: { line: 1, column: 28 }, end: { line: 1, column: 57 } } })) != null ? stack1 : '')\n    + '\" data-id=\"'\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers, 'id') || (depth0 != null ? lookupProperty(depth0, 'id') : depth0)) != null ? helper : alias2), (typeof helper === alias3 ? helper.call(alias1, { name: 'id', hash: {}, data, loc: { start: { line: 1, column: 68 }, end: { line: 1, column: 74 } } }) : helper)))\n    + '\">\\n<span class=\"checkmark icon icon-checkmark\"></span>\\n'\n    + ((stack1 = lookupProperty(helpers, 'if').call(alias1, (depth0 != null ? lookupProperty(depth0, 'isAdmin') : depth0), { name: 'if', hash: {}, fn: container.program(3, data, 0), inverse: container.program(5, data, 0), data, loc: { start: { line: 3, column: 1 }, end: { line: 7, column: 8 } } })) != null ? stack1 : '')\n\t\tstack1 = ((helper = (helper = lookupProperty(helpers, 'allowActions') || (depth0 != null ? lookupProperty(depth0, 'allowActions') : depth0)) != null ? helper : alias2), (options = { name: 'allowActions', hash: {}, fn: container.program(7, data, 0), inverse: container.noop, data, loc: { start: { line: 8, column: 1 }, end: { line: 12, column: 18 } } }), (typeof helper === alias3 ? helper.call(alias1, options) : helper))\n\t\tif (!lookupProperty(helpers, 'allowActions')) { stack1 = container.hooks.blockHelperMissing.call(depth0, stack1, options) }\n\t\tif (stack1 != null) { buffer += stack1 }\n\t\treturn buffer + '</span>\\n'\n\t},\n\tuseData: true,\n})\n","/* eslint-disable valid-typeof */\nconst Handlebars = require('handlebars')\nconst template = Handlebars.template\nconst templates = Handlebars.templates = Handlebars.templates || {}\ntemplates.result_form = template({\n\t1(container, depth0, helpers, partials, data) {\n\t\tlet helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t\t<a href=\"#\" class=\"delete icon icon-delete\" title=\"'\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers, 'deleteTooltip') || (depth0 != null ? lookupProperty(depth0, 'deleteTooltip') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'deleteTooltip', hash: {}, data, loc: { start: { line: 5, column: 53 }, end: { line: 5, column: 70 } } }) : helper)))\n    + '\"></a>\\n'\n\t},\n\tcompiler: [8, '>= 4.3.0'],\n\tmain(container, depth0, helpers, partials, data) {\n\t\tlet stack1; let helper; const alias1 = depth0 != null ? depth0 : (container.nullContext || {}); const alias2 = container.hooks.helperMissing; const alias3 = 'function'; const alias4 = container.escapeExpression; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '<form class=\"systemtags-rename-form\">\\n\t <label class=\"hidden-visually\" for=\"'\n    + alias4(((helper = (helper = lookupProperty(helpers, 'cid') || (depth0 != null ? lookupProperty(depth0, 'cid') : depth0)) != null ? helper : alias2), (typeof helper === alias3 ? helper.call(alias1, { name: 'cid', hash: {}, data, loc: { start: { line: 2, column: 38 }, end: { line: 2, column: 45 } } }) : helper)))\n    + '-rename-input\">'\n    + alias4(((helper = (helper = lookupProperty(helpers, 'renameLabel') || (depth0 != null ? lookupProperty(depth0, 'renameLabel') : depth0)) != null ? helper : alias2), (typeof helper === alias3 ? helper.call(alias1, { name: 'renameLabel', hash: {}, data, loc: { start: { line: 2, column: 60 }, end: { line: 2, column: 75 } } }) : helper)))\n    + '</label>\\n\t<input id=\"'\n    + alias4(((helper = (helper = lookupProperty(helpers, 'cid') || (depth0 != null ? lookupProperty(depth0, 'cid') : depth0)) != null ? helper : alias2), (typeof helper === alias3 ? helper.call(alias1, { name: 'cid', hash: {}, data, loc: { start: { line: 3, column: 12 }, end: { line: 3, column: 19 } } }) : helper)))\n    + '-rename-input\" type=\"text\" value=\"'\n    + alias4(((helper = (helper = lookupProperty(helpers, 'name') || (depth0 != null ? lookupProperty(depth0, 'name') : depth0)) != null ? helper : alias2), (typeof helper === alias3 ? helper.call(alias1, { name: 'name', hash: {}, data, loc: { start: { line: 3, column: 53 }, end: { line: 3, column: 61 } } }) : helper)))\n    + '\">\\n'\n    + ((stack1 = lookupProperty(helpers, 'if').call(alias1, (depth0 != null ? lookupProperty(depth0, 'isAdmin') : depth0), { name: 'if', hash: {}, fn: container.program(1, data, 0), inverse: container.noop, data, loc: { start: { line: 4, column: 1 }, end: { line: 6, column: 8 } } })) != null ? stack1 : '')\n    + '</form>\\n'\n\t},\n\tuseData: true,\n})\n","const Handlebars = require('handlebars'); const template = Handlebars.template; const templates = Handlebars.templates = Handlebars.templates || {}\ntemplates.selection = template({\n\t1(container, depth0, helpers, partials, data) {\n\t\tlet stack1; let helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t<span class=\"label\">'\n    + ((stack1 = ((helper = (helper = lookupProperty(helpers, 'tagMarkup') || (depth0 != null ? lookupProperty(depth0, 'tagMarkup') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'tagMarkup', hash: {}, data, loc: { start: { line: 2, column: 21 }, end: { line: 2, column: 36 } } }) : helper))) != null ? stack1 : '')\n    + '</span>\\n'\n\t},\n\t3(container, depth0, helpers, partials, data) {\n\t\tlet helper; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn '\t<span class=\"label\">'\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers, 'name') || (depth0 != null ? lookupProperty(depth0, 'name') : depth0)) != null ? helper : container.hooks.helperMissing), (typeof helper === 'function' ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}), { name: 'name', hash: {}, data, loc: { start: { line: 4, column: 21 }, end: { line: 4, column: 29 } } }) : helper)))\n    + '</span>\\n'\n\t},\n\tcompiler: [8, '>= 4.3.0'],\n\tmain(container, depth0, helpers, partials, data) {\n\t\tlet stack1; const lookupProperty = container.lookupProperty || function(parent, propertyName) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n\t\t\t\treturn parent[propertyName]\n\t\t\t}\n\t\t\treturn undefined\n\t\t}\n\n\t\treturn ((stack1 = lookupProperty(helpers, 'if').call(depth0 != null ? depth0 : (container.nullContext || {}), (depth0 != null ? lookupProperty(depth0, 'isAdmin') : depth0), { name: 'if', hash: {}, fn: container.program(1, data, 0), inverse: container.program(3, data, 0), data, loc: { start: { line: 1, column: 0 }, end: { line: 5, column: 7 } } })) != null ? stack1 : '')\n\t},\n\tuseData: true,\n})\n","/**\n * SPDX-FileCopyrightText: 2016-2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-FileCopyrightText: 2016 ownCloud, Inc.\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n/* eslint-disable */\nimport templateResult from './templates/result.handlebars.cjs'\nimport templateResultForm from './templates/result_form.handlebars.cjs'\nimport templateSelection from './templates/selection.handlebars.cjs'\n\n(function(OC) {\n\n\t/**\n\t * @class OC.SystemTags.SystemTagsInputField\n\t * @classdesc\n\t *\n\t * Displays a file's system tags\n\t *\n\t */\n\tvar SystemTagsInputField = OC.Backbone.View.extend(\n\t\t/** @lends OC.SystemTags.SystemTagsInputField.prototype */ {\n\n\t\t\t_rendered: false,\n\n\t\t\t_newTag: null,\n\n\t\t\t_lastUsedTags: [],\n\n\t\t\tclassName: 'systemTagsInputFieldContainer',\n\n\t\t\ttemplate: function(data) {\n\t\t\t\treturn '<input class=\"systemTagsInputField\" type=\"hidden\" name=\"tags\" value=\"\"/>'\n\t\t\t},\n\n\t\t\t/**\n\t\t * Creates a new SystemTagsInputField\n\t\t *\n\t\t * @param {Object} [options]\n\t\t * @param {string} [options.objectType=files] object type for which tags are assigned to\n\t\t * @param {boolean} [options.multiple=false] whether to allow selecting multiple tags\n\t\t * @param {boolean} [options.allowActions=true] whether tags can be renamed/delete within the dropdown\n\t\t * @param {boolean} [options.allowCreate=true] whether new tags can be created\n\t\t * @param {boolean} [options.isAdmin=true] whether the user is an administrator\n\t\t * @param {Function} options.initSelection function to convert selection to data\n\t\t */\n\t\t\tinitialize: function(options) {\n\t\t\t\toptions = options || {}\n\n\t\t\t\tthis._multiple = !!options.multiple\n\t\t\t\tthis._allowActions = _.isUndefined(options.allowActions) || !!options.allowActions\n\t\t\t\tthis._allowCreate = _.isUndefined(options.allowCreate) || !!options.allowCreate\n\t\t\t\tthis._isAdmin = !!options.isAdmin\n\n\t\t\t\tif (_.isFunction(options.initSelection)) {\n\t\t\t\t\tthis._initSelection = options.initSelection\n\t\t\t\t}\n\n\t\t\t\tthis.collection = options.collection || OC.SystemTags.collection\n\n\t\t\t\tvar self = this\n\t\t\t\tthis.collection.on('change:name remove', function() {\n\t\t\t\t// refresh selection\n\t\t\t\t\t_.defer(self._refreshSelection)\n\t\t\t\t})\n\n\t\t\t\t_.defer(_.bind(this._getLastUsedTags, this))\n\n\t\t\t\t_.bindAll(\n\t\t\t\t\tthis,\n\t\t\t\t\t'_refreshSelection',\n\t\t\t\t\t'_onClickRenameTag',\n\t\t\t\t\t'_onClickDeleteTag',\n\t\t\t\t\t'_onSelectTag',\n\t\t\t\t\t'_onDeselectTag',\n\t\t\t\t\t'_onSubmitRenameTag'\n\t\t\t\t)\n\t\t\t},\n\n\t\t\t_getLastUsedTags: function() {\n\t\t\t\tvar self = this\n\t\t\t\t$.ajax({\n\t\t\t\t\ttype: 'GET',\n\t\t\t\t\turl: OC.generateUrl('/apps/systemtags/lastused'),\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tself._lastUsedTags = response\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t/**\n\t\t * Refreshes the selection, triggering a call to\n\t\t * select2's initSelection\n\t\t */\n\t\t\t_refreshSelection: function() {\n\t\t\t\tthis.$tagsField.select2('val', this.$tagsField.val())\n\t\t\t},\n\n\t\t\t/**\n\t\t * Event handler whenever the user clicked the \"rename\" action.\n\t\t * This will display the rename field.\n\t\t */\n\t\t\t_onClickRenameTag: function(ev) {\n\t\t\t\tvar $item = $(ev.target).closest('.systemtags-item')\n\t\t\t\tvar tagId = $item.attr('data-id')\n\t\t\t\tvar tagModel = this.collection.get(tagId)\n\n\t\t\t\tvar oldName = tagModel.get('name')\n\t\t\t\tvar $renameForm = $(templateResultForm({\n\t\t\t\t\tcid: this.cid,\n\t\t\t\t\tname: oldName,\n\t\t\t\t\tdeleteTooltip: t('core', 'Delete'),\n\t\t\t\t\trenameLabel: t('core', 'Rename'),\n\t\t\t\t\tisAdmin: this._isAdmin\n\t\t\t\t}))\n\t\t\t\t$item.find('.label').after($renameForm)\n\t\t\t\t$item.find('.label, .systemtags-actions').addClass('hidden')\n\t\t\t\t$item.closest('.select2-result').addClass('has-form')\n\n\t\t\t\t$renameForm.find('[title]').tooltip({\n\t\t\t\t\tplacement: 'bottom',\n\t\t\t\t\tcontainer: 'body'\n\t\t\t\t})\n\t\t\t\t$renameForm.find('input').focus().selectRange(0, oldName.length)\n\t\t\t\treturn false\n\t\t\t},\n\n\t\t\t/**\n\t\t * Event handler whenever the rename form has been submitted after\n\t\t * the user entered a new tag name.\n\t\t * This will submit the change to the server.\n\t\t *\n\t\t * @param {Object} ev event\n\t\t */\n\t\t\t_onSubmitRenameTag: function(ev) {\n\t\t\t\tev.preventDefault()\n\t\t\t\tvar $form = $(ev.target)\n\t\t\t\tvar $item = $form.closest('.systemtags-item')\n\t\t\t\tvar tagId = $item.attr('data-id')\n\t\t\t\tvar tagModel = this.collection.get(tagId)\n\t\t\t\tvar newName = $(ev.target).find('input').val().trim()\n\t\t\t\tif (newName && newName !== tagModel.get('name')) {\n\t\t\t\t\ttagModel.save({ 'name': newName })\n\t\t\t\t\t// TODO: spinner, and only change text after finished saving\n\t\t\t\t\t$item.find('.label').text(newName)\n\t\t\t\t}\n\t\t\t\t$item.find('.label, .systemtags-actions').removeClass('hidden')\n\t\t\t\t$form.remove()\n\t\t\t\t$item.closest('.select2-result').removeClass('has-form')\n\t\t\t},\n\n\t\t\t/**\n\t\t * Event handler whenever a tag must be deleted\n\t\t *\n\t\t * @param {Object} ev event\n\t\t */\n\t\t\t_onClickDeleteTag: function(ev) {\n\t\t\t\tvar $item = $(ev.target).closest('.systemtags-item')\n\t\t\t\tvar tagId = $item.attr('data-id')\n\t\t\t\tthis.collection.get(tagId).destroy()\n\t\t\t\t$(ev.target).tooltip('option', 'hide')\n\t\t\t\t$item.closest('.select2-result').remove()\n\t\t\t\t// TODO: spinner\n\t\t\t\treturn false\n\t\t\t},\n\n\t\t\t_addToSelect2Selection: function(selection) {\n\t\t\t\tvar data = this.$tagsField.select2('data')\n\t\t\t\tdata.push(selection)\n\t\t\t\tthis.$tagsField.select2('data', data)\n\t\t\t},\n\n\t\t\t/**\n\t\t * Event handler whenever a tag is selected.\n\t\t * Also called whenever tag creation is requested through the dummy tag object.\n\t\t *\n\t\t * @param {Object} e event\n\t\t */\n\t\t\t_onSelectTag: function(e) {\n\t\t\t\tvar self = this\n\t\t\t\tvar tag\n\t\t\t\tif (e.object && e.object.isNew) {\n\t\t\t\t// newly created tag, check if existing\n\t\t\t\t// create a new tag\n\t\t\t\t\ttag = this.collection.create({\n\t\t\t\t\t\tname: e.object.name.trim(),\n\t\t\t\t\t\tuserVisible: true,\n\t\t\t\t\t\tuserAssignable: true,\n\t\t\t\t\t\tcanAssign: true\n\t\t\t\t\t}, {\n\t\t\t\t\t\tsuccess: function(model) {\n\t\t\t\t\t\t\tself._addToSelect2Selection(model.toJSON())\n\t\t\t\t\t\t\tself._lastUsedTags.unshift(model.id)\n\t\t\t\t\t\t\tself.trigger('select', model)\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function(model, xhr) {\n\t\t\t\t\t\t\tif (xhr.status === 409) {\n\t\t\t\t\t\t\t// re-fetch collection to get the missing tag\n\t\t\t\t\t\t\t\tself.collection.reset()\n\t\t\t\t\t\t\t\tself.collection.fetch({\n\t\t\t\t\t\t\t\t\tsuccess: function(collection) {\n\t\t\t\t\t\t\t\t\t// find the tag in the collection\n\t\t\t\t\t\t\t\t\t\tvar model = collection.where({\n\t\t\t\t\t\t\t\t\t\t\tname: e.object.name.trim(),\n\t\t\t\t\t\t\t\t\t\t\tuserVisible: true,\n\t\t\t\t\t\t\t\t\t\t\tuserAssignable: true\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tif (model.length) {\n\t\t\t\t\t\t\t\t\t\t\tmodel = model[0]\n\t\t\t\t\t\t\t\t\t\t\t// the tag already exists or was already assigned,\n\t\t\t\t\t\t\t\t\t\t\t// add it to the list anyway\n\t\t\t\t\t\t\t\t\t\t\tself._addToSelect2Selection(model.toJSON())\n\t\t\t\t\t\t\t\t\t\t\tself.trigger('select', model)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tthis.$tagsField.select2('close')\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\treturn false\n\t\t\t\t} else {\n\t\t\t\t\ttag = this.collection.get(e.object.id)\n\t\t\t\t\tthis._lastUsedTags.unshift(tag.id)\n\t\t\t\t}\n\t\t\t\tthis._newTag = null\n\t\t\t\tthis.trigger('select', tag)\n\t\t\t},\n\n\t\t\t/**\n\t\t * Event handler whenever a tag gets deselected.\n\t\t *\n\t\t * @param {Object} e event\n\t\t */\n\t\t\t_onDeselectTag: function(e) {\n\t\t\t\tthis.trigger('deselect', e.choice.id)\n\t\t\t},\n\n\t\t\t/**\n\t\t * Autocomplete function for dropdown results\n\t\t *\n\t\t * @param {Object} query select2 query object\n\t\t */\n\t\t\t_queryTagsAutocomplete: function(query) {\n\t\t\t\tvar self = this\n\t\t\t\tthis.collection.fetch({\n\t\t\t\t\tsuccess: function(collection) {\n\t\t\t\t\t\tvar tagModels = collection.filterByName(query.term.trim())\n\t\t\t\t\t\tif (!self._isAdmin) {\n\t\t\t\t\t\t\ttagModels = _.filter(tagModels, function(tagModel) {\n\t\t\t\t\t\t\t\treturn tagModel.get('canAssign')\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tquery.callback({\n\t\t\t\t\t\t\tresults: _.invoke(tagModels, 'toJSON')\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t_preventDefault: function(e) {\n\t\t\t\te.stopPropagation()\n\t\t\t},\n\n\t\t\t/**\n\t\t * Formats a single dropdown result\n\t\t *\n\t\t * @param {Object} data data to format\n\t\t * @returns {string} HTML markup\n\t\t */\n\t\t\t_formatDropDownResult: function(data) {\n\t\t\t\treturn templateResult(_.extend({\n\t\t\t\t\trenameTooltip: t('core', 'Rename'),\n\t\t\t\t\tallowActions: this._allowActions,\n\t\t\t\t\ttagMarkup: this._isAdmin ? OC.SystemTags.getDescriptiveTag(data).innerHTML : null,\n\t\t\t\t\tisAdmin: this._isAdmin\n\t\t\t\t}, data))\n\t\t\t},\n\n\t\t\t/**\n\t\t * Formats a single selection item\n\t\t *\n\t\t * @param {Object} data data to format\n\t\t * @returns {string} HTML markup\n\t\t */\n\t\t\t_formatSelection: function(data) {\n\t\t\t\treturn templateSelection(_.extend({\n\t\t\t\t\ttagMarkup: this._isAdmin ? OC.SystemTags.getDescriptiveTag(data).innerHTML : null,\n\t\t\t\t\tisAdmin: this._isAdmin\n\t\t\t\t}, data))\n\t\t\t},\n\n\t\t\t/**\n\t\t * Create new dummy choice for select2 when the user\n\t\t * types an arbitrary string\n\t\t *\n\t\t * @param {string} term entered term\n\t\t * @returns {Object} dummy tag\n\t\t */\n\t\t\t_createSearchChoice: function(term) {\n\t\t\t\tterm = term.trim()\n\t\t\t\tif (this.collection.filter(function(entry) {\n\t\t\t\t\treturn entry.get('name') === term\n\t\t\t\t}).length) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (!this._newTag) {\n\t\t\t\t\tthis._newTag = {\n\t\t\t\t\t\tid: -1,\n\t\t\t\t\t\tname: term,\n\t\t\t\t\t\tuserAssignable: true,\n\t\t\t\t\t\tuserVisible: true,\n\t\t\t\t\t\tcanAssign: true,\n\t\t\t\t\t\tisNew: true\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._newTag.name = term\n\t\t\t\t}\n\n\t\t\t\treturn this._newTag\n\t\t\t},\n\n\t\t\t_initSelection: function(element, callback) {\n\t\t\t\tvar self = this\n\t\t\t\tvar ids = $(element).val().split(',')\n\n\t\t\t\tfunction modelToSelection(model) {\n\t\t\t\t\tvar data = model.toJSON()\n\t\t\t\t\tif (!self._isAdmin && !data.canAssign) {\n\t\t\t\t\t// lock static tags for non-admins\n\t\t\t\t\t\tdata.locked = true\n\t\t\t\t\t}\n\t\t\t\t\treturn data\n\t\t\t\t}\n\n\t\t\t\tfunction findSelectedObjects(ids) {\n\t\t\t\t\tvar selectedModels = self.collection.filter(function(model) {\n\t\t\t\t\t\treturn ids.indexOf(model.id) >= 0 && (self._isAdmin || model.get('userVisible'))\n\t\t\t\t\t})\n\t\t\t\t\treturn _.map(selectedModels, modelToSelection)\n\t\t\t\t}\n\n\t\t\t\tthis.collection.fetch({\n\t\t\t\t\tsuccess: function() {\n\t\t\t\t\t\tcallback(findSelectedObjects(ids))\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\n\t\t\t/**\n\t\t * Renders this details view\n\t\t */\n\t\t\trender: function() {\n\t\t\t\tvar self = this\n\t\t\t\tthis.$el.html(this.template())\n\n\t\t\t\tthis.$el.find('[title]').tooltip({ placement: 'bottom' })\n\t\t\t\tthis.$tagsField = this.$el.find('[name=tags]')\n\t\t\t\tthis.$tagsField.select2({\n\t\t\t\t\tplaceholder: t('core', 'Collaborative tags'),\n\t\t\t\t\tcontainerCssClass: 'systemtags-select2-container',\n\t\t\t\t\tdropdownCssClass: 'systemtags-select2-dropdown',\n\t\t\t\t\tcloseOnSelect: false,\n\t\t\t\t\tallowClear: false,\n\t\t\t\t\tmultiple: this._multiple,\n\t\t\t\t\ttoggleSelect: this._multiple,\n\t\t\t\t\tquery: _.bind(this._queryTagsAutocomplete, this),\n\t\t\t\t\tid: function(tag) {\n\t\t\t\t\t\treturn tag.id\n\t\t\t\t\t},\n\t\t\t\t\tinitSelection: _.bind(this._initSelection, this),\n\t\t\t\t\tformatResult: _.bind(this._formatDropDownResult, this),\n\t\t\t\t\tformatSelection: _.bind(this._formatSelection, this),\n\t\t\t\t\tcreateSearchChoice: this._allowCreate ? _.bind(this._createSearchChoice, this) : undefined,\n\t\t\t\t\tsortResults: function(results) {\n\t\t\t\t\t\tvar selectedItems = _.pluck(self.$tagsField.select2('data'), 'id')\n\t\t\t\t\t\tresults.sort(function(a, b) {\n\t\t\t\t\t\t\tvar aSelected = selectedItems.indexOf(a.id) >= 0\n\t\t\t\t\t\t\tvar bSelected = selectedItems.indexOf(b.id) >= 0\n\t\t\t\t\t\t\tif (aSelected === bSelected) {\n\t\t\t\t\t\t\t\tvar aLastUsed = self._lastUsedTags.indexOf(a.id)\n\t\t\t\t\t\t\t\tvar bLastUsed = self._lastUsedTags.indexOf(b.id)\n\n\t\t\t\t\t\t\t\tif (aLastUsed !== bLastUsed) {\n\t\t\t\t\t\t\t\t\tif (bLastUsed === -1) {\n\t\t\t\t\t\t\t\t\t\treturn -1\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (aLastUsed === -1) {\n\t\t\t\t\t\t\t\t\t\treturn 1\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn aLastUsed < bLastUsed ? -1 : 1\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Both not found\n\t\t\t\t\t\t\t\treturn OC.Util.naturalSortCompare(a.name, b.name)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (aSelected && !bSelected) {\n\t\t\t\t\t\t\t\treturn -1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 1\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn results\n\t\t\t\t\t},\n\t\t\t\t\tformatNoMatches: function() {\n\t\t\t\t\t\treturn t('core', 'No tags found')\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\t.on('select2-selecting', this._onSelectTag)\n\t\t\t\t\t.on('select2-removing', this._onDeselectTag)\n\n\t\t\t\tvar $dropDown = this.$tagsField.select2('dropdown')\n\t\t\t\t// register events for inside the dropdown\n\t\t\t\t$dropDown.on('mouseup', '.rename', this._onClickRenameTag)\n\t\t\t\t$dropDown.on('mouseup', '.delete', this._onClickDeleteTag)\n\t\t\t\t$dropDown.on('mouseup', '.select2-result-selectable.has-form', this._preventDefault)\n\t\t\t\t$dropDown.on('submit', '.systemtags-rename-form', this._onSubmitRenameTag)\n\n\t\t\t\tthis.delegateEvents()\n\t\t\t},\n\n\t\t\tremove: function() {\n\t\t\t\tif (this.$tagsField) {\n\t\t\t\t\tthis.$tagsField.select2('destroy')\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetValues: function() {\n\t\t\t\tthis.$tagsField.select2('val')\n\t\t\t},\n\n\t\t\tsetValues: function(values) {\n\t\t\t\tthis.$tagsField.select2('val', values)\n\t\t\t},\n\n\t\t\tsetData: function(data) {\n\t\t\t\tthis.$tagsField.select2('data', data)\n\t\t\t}\n\t\t})\n\n\tOC.SystemTags = OC.SystemTags || {}\n\tOC.SystemTags.SystemTagsInputField = SystemTagsInputField\n\n})(OC)\n"],"names":["OC","tag","$span","escapeHTML","scope","$scope","SystemTagModel","data","SystemTagsMappingCollection","generateRemoteUrl","objectId","objectType","models","options","model","filterFunction","term","SystemTagsCollection","name","self","success","Handlebars","require$$0","template","templates","container","depth0","helpers","partials","stack1","helper","lookupProperty","parent","propertyName","alias1","alias2","alias3","buffer","alias4","SystemTagsInputField","response","ev","$item","tagId","tagModel","oldName","$renameForm","templateResultForm","$form","newName","selection","xhr","collection","query","tagModels","templateResult","templateSelection","entry","element","callback","ids","modelToSelection","findSelectedObjects","selectedModels","results","selectedItems","a","b","aSelected","bSelected","aLastUsed","bLastUsed","$dropDown","values"],"mappings":"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"}