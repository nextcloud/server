import{j as be,k as oe,O as Pt,F as _,o as E,G as $,x as ue,y as w,b as de,t as x,r as Pe,c as M,a as P,v as Bt,w as k,I,H as me,z as ee,R as Ne,P as ae,aK as ht,aa as ce,aq as si,J as ni,A as De,B as oi,C as li,D as ci,aI as ui,ad as di,a6 as xt,q as B,ao as pi,ah as Ee,K as Je,s as O,as as Ze,n as Mt,a5 as Ut,a9 as we,a7 as mi,l as zt,p as hi,Q as Le,m as fi,u as ft,a3 as Ei,aL as gi,al as vi,U as _i}from"./_plugin-vue_export-helper-BwgIbNvA.chunk.mjs";import{v as et,S as bi,h as wi,T as yi,U as Vt,g as Te,k as ve,V as A,N as Ii,W as _e,s as tt}from"./index-JpgrUA2Z-Qpi8cQdR.chunk.mjs";import{P as Ti,a as Ni}from"./index-ByjAN_PJ.chunk.mjs";import{d as Ai,B as Be,c as Gt}from"./index-BcCtRSKw.chunk.mjs";import{i as ye,g as Li,C as it}from"./CancelablePromise-SyEhZvCS.chunk.mjs";import{a as Ri,u as Di}from"./index-D143LVaV.chunk.mjs";import{c as ge,g as Ci,a as Oi,N as Xt}from"./NcNoteCard-CVhtNL04-Bzk0vKjS.chunk.mjs";import{r as Si}from"./string_decoder-C9H9-gax.chunk.mjs";import{N as jt}from"./NcCheckboxRadioSwitch-BCSKF7Tk-BgZ3fLJ5.chunk.mjs";import{a as Et,b as gt,N as vt,_ as ki}from"./NcDateTime.vue_vue_type_script_setup_true_lang-BhB8yA4U-C7OUjTKq.chunk.mjs";import{e as Fi,f as $i,g as Pi,h as Bi,i as xi,j as Mi,k as _t,l as Ui,n as zi}from"./mdi-BYxzaY1_.chunk.mjs";import{S as bt}from"./ShareType-suoNfd7y.chunk.mjs";import{N as Vi}from"./NcSelect-Czzsi3P_-14eTUaCw.chunk.mjs";import{_ as Gi}from"./TrashCanOutline-B5y9LjkO.chunk.mjs";import"./NcPasswordField-djttkA5Q-IesYRA4g.chunk.mjs";import"./NcInputField-Bwsh2aHY-Khfbio19.chunk.mjs";const Xi=["aria-labelledby"],ji={key:0,class:"empty-content__icon","aria-hidden":"true"},Hi=["id"],qi={key:2,class:"empty-content__description"},Wi={key:3,class:"empty-content__action"},Yi=oe({__name:"NcEmptyContent",props:{description:{default:""},name:{default:""}},setup(e){const a=Pt();return(i,o)=>(E(),_("div",{"aria-labelledby":w(a),class:"empty-content",role:"note"},[i.$slots.icon?(E(),_("div",ji,[ue(i.$slots,"icon",{},void 0,!0)])):$("",!0),i.name!==""||i.$slots.name?(E(),_("div",{key:1,id:w(a),class:"empty-content__name"},[ue(i.$slots,"name",{},()=>[de(x(i.name),1)],!0)],8,Hi)):$("",!0),i.description!==""||i.$slots.description?(E(),_("p",qi,[ue(i.$slots,"description",{},()=>[de(x(i.description),1)],!0)])):$("",!0),i.$slots.action?(E(),_("div",Wi,[ue(i.$slots,"action",{},void 0,!0)])):$("",!0)],8,Xi))}}),wt=be(Yi,[["__scopeId","data-v-b101d636"]]),Qi={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Zi=["aria-hidden","aria-label"],Ki=["fill","width","height"],Ji={d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},er={key:0};function tr(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon chevron-right-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",Ji,[i.title?(E(),_("title",er,x(i.title),1)):$("",!0)])],8,Ki))],16,Zi)}const ir=be(Qi,[["render",tr]]),rr={name:"NcBreadcrumb",components:{NcActions:et,ChevronRight:ir,NcButton:ge},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1},class:{type:[String,Array,Object],default:""}},emits:["dragenter","dragleave","dropped","update:open"],setup(){const e=Pt();return{actionsContainer:`.vue-crumb[data-crumb-id="${e}"]`,crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?{to:this.to,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.$emit("dragenter",e),!this.disableDrop&&(this.hovering=!0)},dragLeave(e){this.$emit("dragleave",e),!this.disableDrop&&(e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1))}}},ar=["data-crumb-id"];function sr(e,a,i,o,c,h){const u=Pe("NcButton"),f=Pe("NcActions"),d=Pe("ChevronRight");return E(),_("li",{ref:"crumb",class:me(["vue-crumb",[{"vue-crumb--hovered":c.hovering},e.$props.class]]),"data-crumb-id":o.crumbId,draggable:"false",onDragstart:Ne(()=>{},["prevent"]),onDrop:a[0]||(a[0]=Ne((...p)=>h.dropped&&h.dropped(...p),["prevent"])),onDragover:Ne(()=>{},["prevent"]),onDragenter:a[1]||(a[1]=(...p)=>h.dragEnter&&h.dragEnter(...p)),onDragleave:a[2]||(a[2]=(...p)=>h.dragLeave&&h.dragLeave(...p))},[(i.name||i.icon||e.$slots.icon)&&!e.$slots.default?(E(),M(u,ee({key:0,"aria-label":i.icon?i.name:void 0,variant:"tertiary"},h.linkAttributes),Bt({_:2},[e.$slots.icon||i.icon?{name:"icon",fn:k(()=>[ue(e.$slots,"icon",{},()=>[I("span",{class:me([i.icon,"icon"])},null,2)],!0)]),key:"0"}:void 0,!(e.$slots.icon||i.icon)||i.forceIconText?{name:"default",fn:k(()=>[de(x(i.name),1)]),key:"1"}:void 0]),1040,["aria-label"])):$("",!0),e.$slots.default?(E(),M(f,{key:1,ref:"actions",container:o.actionsContainer,"force-menu":i.forceMenu,"force-name":"","menu-name":i.name,open:i.open,title:i.title,variant:"tertiary","onUpdate:open":h.onOpenChange},{icon:k(()=>[ue(e.$slots,"menu-icon",{},void 0,!0)]),default:k(()=>[ue(e.$slots,"default",{},void 0,!0)]),_:3},8,["container","force-menu","menu-name","open","title","onUpdate:open"])):$("",!0),P(d,{class:"vue-crumb__separator",size:20})],42,ar)}const Re=be(rr,[["render",sr],["__scopeId","data-v-28ef52a4"]]),nr={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},or=["aria-hidden","aria-label"],lr=["fill","width","height"],cr={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},ur={key:0};function dr(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon folder-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",cr,[i.title?(E(),_("title",ur,x(i.title),1)):$("",!0)])],8,lr))],16,or)}const yt=be(nr,[["render",dr]]),q="vue-crumb",pr={name:"NcBreadcrumbs",components:{NcActions:et,NcActionButton:vt,NcActionRouter:gt,NcActionLink:Et,NcBreadcrumb:Re,IconFolder:yt},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:[]}},created(){window.addEventListener("resize",Ai(()=>{this.handleWindowResize()},100)),ni("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeUnmount(){window.removeEventListener("resize",this.handleWindowResize),si("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=this.breadcrumbsRefs.length,a=[],i=this.$refs.container.offsetWidth;let o=this.getTotalWidth();this.$refs.breadcrumb__actions&&(o+=this.$refs.breadcrumb__actions.offsetWidth);let c=o-i;c+=c>0?64:0;let h=0;const u=Math.floor(e/2);for(;c>0&&h<e-2;){const f=u+(h%2?h+1:h)/2*Math.pow(-1,h+e%2);c-=this.getWidth(this.breadcrumbsRefs[f]?.$el,f===this.breadcrumbsRefs.length-1),a.push(f),h++}this.arraysEqual(this.hiddenIndices,a.sort((f,d)=>f-d))||(this.hiddenIndices=a)},arraysEqual(e,a){if(e.length!==a.length)return!1;if(e===a)return!0;if(e===null||a===null)return!1;for(let i=0;i<e.length;++i)if(e[i]!==a[i])return!1;return!0},getTotalWidth(){return this.breadcrumbsRefs.reduce((e,a,i)=>e+this.getWidth(a.$el,i===this.breadcrumbsRefs.length-1),0)},getWidth(e,a){if(!e?.classList)return 0;const i=e.classList.contains(`${q}--hidden`);e.style.minWidth="auto",a&&(e.style.maxWidth="210px"),e.classList.remove(`${q}--hidden`);const o=e.offsetWidth;return i&&e.classList.add(`${q}--hidden`),e.style.minWidth="",e.style.maxWidth="",o},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,a,i){i||this.$emit("dropped",e,a),this.menuBreadcrumbProps.open=!1;const o=document.querySelectorAll(`.${q}`);for(const c of o)c.classList.remove(`${q}--hovered`);return this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,a){if(!a&&e.target.closest){const i=e.target.closest(`.${q}`);if(i.classList&&i.classList.contains(q)){const o=document.querySelectorAll(`.${q}`);for(const c of o)c.classList.remove(`${q}--hovered`);i.classList.add(`${q}--hovered`)}}},dragLeave(e,a){if(!a&&!e.target.contains(e.relatedTarget)&&e.target.closest){const i=e.target.closest(`.${q}`);if(i.contains(e.relatedTarget))return;i.classList&&i.classList.contains(q)&&i.classList.remove(`${q}--hovered`)}},hideCrumbs(){this.breadcrumbsRefs.forEach((e,a)=>{e?.$el?.classList&&(this.hiddenIndices.includes(a)?e.$el.classList.add(`${q}--hidden`):e.$el.classList.remove(`${q}--hidden`))})},isBreadcrumb(e){return e?.type?.name==="NcBreadcrumb"}},render(){let e=[];if(this.$slots.default?.().forEach(c=>{if(this.isBreadcrumb(c)){e.push(c);return}c?.type===ae&&c?.children?.forEach?.(h=>{this.isBreadcrumb(h)&&e.push(h)})}),e.length===0)return;e[0]=ht(e[0],{icon:this.rootIcon,ref:"breadcrumbs"});const a=[];e=e.map((c,h)=>ht(c,{ref:u=>{a[h]=u}}));const i=[...e];this.hiddenIndices.length&&i.splice(Math.round(e.length/2),0,ce(Re,{class:"dropdown",...this.menuBreadcrumbProps,"aria-hidden":!0,ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",onDragenter:()=>{this.menuBreadcrumbProps.open=!0},onDragleave:this.closeActions,"onUpdate:open":c=>{this.menuBreadcrumbProps.open=c}},{default:()=>this.hiddenIndices.filter(c=>c<=e.length-1).map(c=>{const h=e[c],{to:u,href:f,disableDrop:d,name:p,...l}=h.props;delete l.ref;let g=vt,v="";f&&(g=Et,v=f),u&&(g=gt,v=u);const T=ce(yt,{size:20});return ce(g,{...l,class:q,href:f||null,to:u||null,draggable:!1,onDragstart:this.dragStart,onDrop:G=>this.dropped(G,v,d),onDragover:this.dragOver,onDragenter:G=>this.dragEnter(G,d),onDragleave:G=>this.dragLeave(G,d)},{default:()=>p,icon:()=>T})})}));const o=[ce("nav",{"aria-label":this.ariaLabel},[ce("ul",{class:"breadcrumb__crumbs"},[i])])];return bi(this.$slots.actions?.())&&o.push(ce("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions?.())),this.breadcrumbsRefs=a,ce("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===e.length-2}],ref:"container"},o)}},mr=be(pr,[["__scopeId","data-v-af2b1226"]]),hr=Ci().setApp("@nextcloud/files").detectUser().build();var se=(e=>(e.Folder="folder",e.File="file",e))(se||{}),K=(e=>(e[e.NONE=0]="NONE",e[e.CREATE=4]="CREATE",e[e.READ=1]="READ",e[e.UPDATE=2]="UPDATE",e[e.DELETE=8]="DELETE",e[e.SHARE=16]="SHARE",e[e.ALL=31]="ALL",e))(K||{});const Ht=function(e,a){return e.match(a)!==null},ne=(e,a)=>{if(e.id&&typeof e.id!="number")throw new Error("Invalid id type of value");if(!e.source)throw new Error("Missing mandatory source");try{new URL(e.source)}catch{throw new Error("Invalid source format, source must be a valid URL")}if(!e.source.startsWith("http"))throw new Error("Invalid source format, only http(s) is supported");if(e.displayname&&typeof e.displayname!="string")throw new Error("Invalid displayname type");if(e.mtime&&!(e.mtime instanceof Date))throw new Error("Invalid mtime type");if(e.crtime&&!(e.crtime instanceof Date))throw new Error("Invalid crtime type");if(!e.mime||typeof e.mime!="string"||!e.mime.match(/^[-\w.]+\/[-+\w.]+$/gi))throw new Error("Missing or invalid mandatory mime");if("size"in e&&typeof e.size!="number"&&e.size!==void 0)throw new Error("Invalid size type");if("permissions"in e&&e.permissions!==void 0&&!(typeof e.permissions=="number"&&e.permissions>=K.NONE&&e.permissions<=K.ALL))throw new Error("Invalid permissions");if(e.owner&&e.owner!==null&&typeof e.owner!="string")throw new Error("Invalid owner type");if(e.attributes&&typeof e.attributes!="object")throw new Error("Invalid attributes type");if(e.root&&typeof e.root!="string")throw new Error("Invalid root type");if(e.root&&!e.root.startsWith("/"))throw new Error("Root must start with a leading slash");if(e.root&&!e.source.includes(e.root))throw new Error("Root must be part of the source");if(e.root&&Ht(e.source,a)){const i=e.source.match(a)[0];if(!e.source.includes(ve(i,e.root)))throw new Error("The root must be relative to the service. e.g /files/emma")}if(e.status&&!Object.values(rt).includes(e.status))throw new Error("Status must be a valid NodeStatus")};var rt=(e=>(e.NEW="new",e.FAILED="failed",e.LOADING="loading",e.LOCKED="locked",e))(rt||{});class Ce{_data;_attributes;_knownDavService=/(remote|public)\.php\/(web)?dav/i;readonlyAttributes=Object.entries(Object.getOwnPropertyDescriptors(Ce.prototype)).filter(a=>typeof a[1].get=="function"&&a[0]!=="__proto__").map(a=>a[0]);handler={set:(a,i,o)=>this.readonlyAttributes.includes(i)?!1:Reflect.set(a,i,o),deleteProperty:(a,i)=>this.readonlyAttributes.includes(i)?!1:Reflect.deleteProperty(a,i),get:(a,i,o)=>this.readonlyAttributes.includes(i)?(hr.warn(`Accessing "Node.attributes.${i}" is deprecated, access it directly on the Node instance.`),Reflect.get(this,i)):Reflect.get(a,i,o)};constructor(a,i){a.mime||(a.mime="application/octet-stream"),ne(a,i||this._knownDavService),this._data={displayname:a.attributes?.displayname,...a,attributes:{}},this._attributes=new Proxy(this._data.attributes,this.handler),this.update(a.attributes??{}),i&&(this._knownDavService=i)}get source(){return this._data.source.replace(/\/$/i,"")}get encodedSource(){const{origin:a}=new URL(this.source);return a+wi(this.source.slice(a.length))}get basename(){return yi(this.source)}get displayname(){return this._data.displayname||this.basename}set displayname(a){ne({...this._data,displayname:a},this._knownDavService),this._data.displayname=a}get extension(){return Vt(this.source)}get dirname(){if(this.root){let i=this.source;this.isDavResource&&(i=i.split(this._knownDavService).pop());const o=i.indexOf(this.root),c=this.root.replace(/\/$/,"");return Te(i.slice(o+c.length)||"/")}const a=new URL(this.source);return Te(a.pathname)}get mime(){return this._data.mime||"application/octet-stream"}set mime(a){a??="application/octet-stream",ne({...this._data,mime:a},this._knownDavService),this._data.mime=a}get mtime(){return this._data.mtime}set mtime(a){ne({...this._data,mtime:a},this._knownDavService),this._data.mtime=a}get crtime(){return this._data.crtime}get size(){return this._data.size}set size(a){ne({...this._data,size:a},this._knownDavService),this.updateMtime(),this._data.size=a}get attributes(){return this._attributes}get permissions(){return this.owner===null&&!this.isDavResource?K.READ:this._data.permissions!==void 0?this._data.permissions:K.NONE}set permissions(a){ne({...this._data,permissions:a},this._knownDavService),this.updateMtime(),this._data.permissions=a}get owner(){return this.isDavResource?this._data.owner:null}get isDavResource(){return Ht(this.source,this._knownDavService)}get isDavRessource(){return this.isDavResource}get root(){return this._data.root?this._data.root.replace(/^(.+)\/$/,"$1"):this.isDavResource&&Te(this.source).split(this._knownDavService).pop()||null}get path(){if(this.root){let a=this.source;this.isDavResource&&(a=a.split(this._knownDavService).pop());const i=a.indexOf(this.root),o=this.root.replace(/\/$/,"");return a.slice(i+o.length)||"/"}return(this.dirname+"/"+this.basename).replace(/\/\//g,"/")}get fileid(){return this._data?.id}get status(){return this._data?.status}set status(a){ne({...this._data,status:a},this._knownDavService),this._data.status=a}get data(){return structuredClone(this._data)}move(a){ne({...this._data,source:a},this._knownDavService);const i=this.basename;this._data.source=a,this.displayname===i&&this.basename!==i&&(this.displayname=this.basename)}rename(a){if(a.includes("/"))throw new Error("Invalid basename");this.move(Te(this.source)+"/"+a)}updateMtime(){this._data.mtime&&(this._data.mtime=new Date)}update(a){for(const[i,o]of Object.entries(a))try{o===void 0?delete this.attributes[i]:this.attributes[i]=o}catch(c){if(c instanceof TypeError)continue;throw c}}}class at extends Ce{get type(){return se.File}clone(){return new at(this.data)}}class st extends Ce{constructor(a){super({...a,mime:"httpd/unix-directory"})}get type(){return se.Folder}get extension(){return null}get mime(){return"httpd/unix-directory"}clone(){return new st(this.data)}}const fr=function(e=""){let a=K.NONE;return e&&((e.includes("C")||e.includes("K"))&&(a|=K.CREATE),e.includes("G")&&(a|=K.READ),(e.includes("W")||e.includes("N")||e.includes("V"))&&(a|=K.UPDATE),e.includes("D")&&(a|=K.DELETE),e.includes("R")&&(a|=K.SHARE)),a},Er=["d:getcontentlength","d:getcontenttype","d:getetag","d:getlastmodified","d:creationdate","d:displayname","d:quota-available-bytes","d:resourcetype","nc:has-preview","nc:is-encrypted","nc:mount-type","oc:comments-unread","oc:favorite","oc:fileid","oc:owner-display-name","oc:owner-id","oc:permissions","oc:size"],gr={d:"DAV:",nc:"http://nextcloud.org/ns",oc:"http://owncloud.org/ns",ocs:"http://open-collaboration-services.org/ns"},nt=function(){return typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...Er]),window._nc_dav_properties.map(e=>`<${e} />`).join(" ")},ot=function(){return typeof window._nc_dav_namespaces>"u"&&(window._nc_dav_namespaces={...gr}),Object.keys(window._nc_dav_namespaces).map(e=>`xmlns:${e}="${window._nc_dav_namespaces?.[e]}"`).join(" ")},qt=function(){return`<?xml version="1.0"?>
		<d:propfind ${ot()}>
			<d:prop>
				${nt()}
			</d:prop>
		</d:propfind>`},vr=function(){return`<?xml version="1.0"?>
		<oc:filter-files ${ot()}>
			<d:prop>
				${nt()}
			</d:prop>
			<oc:filter-rules>
				<oc:favorite>1</oc:favorite>
			</oc:filter-rules>
		</oc:filter-files>`},_r=function(e){return`<?xml version="1.0" encoding="UTF-8"?>
<d:searchrequest ${ot()}
	xmlns:ns="https://github.com/icewind1991/SearchDAV/ns">
	<d:basicsearch>
		<d:select>
			<d:prop>
				${nt()}
			</d:prop>
		</d:select>
		<d:from>
			<d:scope>
				<d:href>/files/${De()?.uid}/</d:href>
				<d:depth>infinity</d:depth>
			</d:scope>
		</d:from>
		<d:where>
			<d:and>
				<d:or>
					<d:not>
						<d:eq>
							<d:prop>
								<d:getcontenttype/>
							</d:prop>
							<d:literal>httpd/unix-directory</d:literal>
						</d:eq>
					</d:not>
					<d:eq>
						<d:prop>
							<oc:size/>
						</d:prop>
						<d:literal>0</d:literal>
					</d:eq>
				</d:or>
				<d:gt>
					<d:prop>
						<d:getlastmodified/>
					</d:prop>
					<d:literal>${e}</d:literal>
				</d:gt>
			</d:and>
		</d:where>
		<d:orderby>
			<d:order>
				<d:prop>
					<d:getlastmodified/>
				</d:prop>
				<d:descending/>
			</d:order>
		</d:orderby>
		<d:limit>
			<d:nresults>100</d:nresults>
			<ns:firstresult>0</ns:firstresult>
		</d:limit>
	</d:basicsearch>
</d:searchrequest>`};function br(){return ye()?`/files/${Li()}`:`/files/${De()?.uid}`}const Ie=br();function wr(){const e=oi("dav");return ye()?e.replace("remote.php","public.php"):e}const Wt=wr(),yr=function(e=Wt,a={}){const i=Ri(e,{headers:a});function o(c){i.setHeaders({...a,"X-Requested-With":"XMLHttpRequest",requesttoken:c??""})}return ci(o),o(li()),Di().patch("fetch",(c,h)=>{const u=h.headers;return u?.method&&(h.method=u.method,delete u.method),fetch(c,h)}),i},Ir=(e,a="/",i=Ie)=>{const o=new AbortController;return new it(async(c,h,u)=>{u(()=>o.abort());try{const f=(await e.getDirectoryContents(`${i}${a}`,{signal:o.signal,details:!0,data:vr(),headers:{method:"REPORT"},includeSelf:!0})).data.filter(d=>d.filename!==a).map(d=>Oe(d,i));c(f)}catch(f){h(f)}})},Oe=function(e,a=Ie,i=Wt){let o=De()?.uid;if(ye())o=o??"anonymous";else if(!o)throw new Error("No user id found");const c=e.props,h=fr(c?.permissions),u=String(c?.["owner-id"]||o),f=c.fileid||0,d=new Date(Date.parse(e.lastmod)),p=new Date(Date.parse(c.creationdate)),l={id:f,source:`${i}${e.filename}`,mtime:!isNaN(d.getTime())&&d.getTime()!==0?d:void 0,crtime:!isNaN(p.getTime())&&p.getTime()!==0?p:void 0,mime:e.mime||"application/octet-stream",displayname:c.displayname!==void 0?String(c.displayname):void 0,size:c?.size||Number.parseInt(c.getcontentlength||"0"),status:f<0?rt.FAILED:void 0,permissions:h,owner:u,root:a,attributes:{...e,...c,hasPreview:c?.["has-preview"]}};return delete l.attributes?.props,e.type==="file"?new at(l):new st(l)};var xe={},It,Tt;function Yt(){return Tt||(Tt=1,It=typeof ui=="object"&&xe&&xe.NODE_DEBUG&&/\bsemver\b/i.test(xe.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{}),It}var Me,Nt;function Qt(){if(Nt)return Me;Nt=1;const e="2.0.0",a=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,o=16,c=a-6;return Me={MAX_LENGTH:a,MAX_SAFE_COMPONENT_LENGTH:o,MAX_SAFE_BUILD_LENGTH:c,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Me}var Ue={exports:{}},At;function Tr(){return At||(At=1,(function(e,a){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:c}=Qt(),h=Yt();a=e.exports={};const u=a.re=[],f=a.safeRe=[],d=a.src=[],p=a.safeSrc=[],l=a.t={};let g=0;const v="[a-zA-Z0-9-]",T=[["\\s",1],["\\d",c],[v,o]],G=H=>{for(const[X,J]of T)H=H.split(`${X}*`).join(`${X}{0,${J}}`).split(`${X}+`).join(`${X}{1,${J}}`);return H},b=(H,X,J)=>{const Z=G(X),L=g++;h(H,L,X),l[H]=L,d[L]=X,p[L]=Z,u[L]=new RegExp(X,J?"g":void 0),f[L]=new RegExp(Z,J?"g":void 0)};b("NUMERICIDENTIFIER","0|[1-9]\\d*"),b("NUMERICIDENTIFIERLOOSE","\\d+"),b("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${v}*`),b("MAINVERSION",`(${d[l.NUMERICIDENTIFIER]})\\.(${d[l.NUMERICIDENTIFIER]})\\.(${d[l.NUMERICIDENTIFIER]})`),b("MAINVERSIONLOOSE",`(${d[l.NUMERICIDENTIFIERLOOSE]})\\.(${d[l.NUMERICIDENTIFIERLOOSE]})\\.(${d[l.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASEIDENTIFIER",`(?:${d[l.NONNUMERICIDENTIFIER]}|${d[l.NUMERICIDENTIFIER]})`),b("PRERELEASEIDENTIFIERLOOSE",`(?:${d[l.NONNUMERICIDENTIFIER]}|${d[l.NUMERICIDENTIFIERLOOSE]})`),b("PRERELEASE",`(?:-(${d[l.PRERELEASEIDENTIFIER]}(?:\\.${d[l.PRERELEASEIDENTIFIER]})*))`),b("PRERELEASELOOSE",`(?:-?(${d[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[l.PRERELEASEIDENTIFIERLOOSE]})*))`),b("BUILDIDENTIFIER",`${v}+`),b("BUILD",`(?:\\+(${d[l.BUILDIDENTIFIER]}(?:\\.${d[l.BUILDIDENTIFIER]})*))`),b("FULLPLAIN",`v?${d[l.MAINVERSION]}${d[l.PRERELEASE]}?${d[l.BUILD]}?`),b("FULL",`^${d[l.FULLPLAIN]}$`),b("LOOSEPLAIN",`[v=\\s]*${d[l.MAINVERSIONLOOSE]}${d[l.PRERELEASELOOSE]}?${d[l.BUILD]}?`),b("LOOSE",`^${d[l.LOOSEPLAIN]}$`),b("GTLT","((?:<|>)?=?)"),b("XRANGEIDENTIFIERLOOSE",`${d[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),b("XRANGEIDENTIFIER",`${d[l.NUMERICIDENTIFIER]}|x|X|\\*`),b("XRANGEPLAIN",`[v=\\s]*(${d[l.XRANGEIDENTIFIER]})(?:\\.(${d[l.XRANGEIDENTIFIER]})(?:\\.(${d[l.XRANGEIDENTIFIER]})(?:${d[l.PRERELEASE]})?${d[l.BUILD]}?)?)?`),b("XRANGEPLAINLOOSE",`[v=\\s]*(${d[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[l.XRANGEIDENTIFIERLOOSE]})(?:${d[l.PRERELEASELOOSE]})?${d[l.BUILD]}?)?)?`),b("XRANGE",`^${d[l.GTLT]}\\s*${d[l.XRANGEPLAIN]}$`),b("XRANGELOOSE",`^${d[l.GTLT]}\\s*${d[l.XRANGEPLAINLOOSE]}$`),b("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),b("COERCE",`${d[l.COERCEPLAIN]}(?:$|[^\\d])`),b("COERCEFULL",d[l.COERCEPLAIN]+`(?:${d[l.PRERELEASE]})?(?:${d[l.BUILD]})?(?:$|[^\\d])`),b("COERCERTL",d[l.COERCE],!0),b("COERCERTLFULL",d[l.COERCEFULL],!0),b("LONETILDE","(?:~>?)"),b("TILDETRIM",`(\\s*)${d[l.LONETILDE]}\\s+`,!0),a.tildeTrimReplace="$1~",b("TILDE",`^${d[l.LONETILDE]}${d[l.XRANGEPLAIN]}$`),b("TILDELOOSE",`^${d[l.LONETILDE]}${d[l.XRANGEPLAINLOOSE]}$`),b("LONECARET","(?:\\^)"),b("CARETTRIM",`(\\s*)${d[l.LONECARET]}\\s+`,!0),a.caretTrimReplace="$1^",b("CARET",`^${d[l.LONECARET]}${d[l.XRANGEPLAIN]}$`),b("CARETLOOSE",`^${d[l.LONECARET]}${d[l.XRANGEPLAINLOOSE]}$`),b("COMPARATORLOOSE",`^${d[l.GTLT]}\\s*(${d[l.LOOSEPLAIN]})$|^$`),b("COMPARATOR",`^${d[l.GTLT]}\\s*(${d[l.FULLPLAIN]})$|^$`),b("COMPARATORTRIM",`(\\s*)${d[l.GTLT]}\\s*(${d[l.LOOSEPLAIN]}|${d[l.XRANGEPLAIN]})`,!0),a.comparatorTrimReplace="$1$2$3",b("HYPHENRANGE",`^\\s*(${d[l.XRANGEPLAIN]})\\s+-\\s+(${d[l.XRANGEPLAIN]})\\s*$`),b("HYPHENRANGELOOSE",`^\\s*(${d[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[l.XRANGEPLAINLOOSE]})\\s*$`),b("STAR","(<|>)?=?\\s*\\*"),b("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),b("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ue,Ue.exports)),Ue.exports}var ze,Lt;function Nr(){if(Lt)return ze;Lt=1;const e=Object.freeze({loose:!0}),a=Object.freeze({});return ze=i=>i?typeof i!="object"?e:i:a,ze}var Ve,Rt;function Ar(){if(Rt)return Ve;Rt=1;const e=/^[0-9]+$/,a=(i,o)=>{if(typeof i=="number"&&typeof o=="number")return i===o?0:i<o?-1:1;const c=e.test(i),h=e.test(o);return c&&h&&(i=+i,o=+o),i===o?0:c&&!h?-1:h&&!c?1:i<o?-1:1};return Ve={compareIdentifiers:a,rcompareIdentifiers:(i,o)=>a(o,i)},Ve}var Ge,Dt;function Zt(){if(Dt)return Ge;Dt=1;const e=Yt(),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=Qt(),{safeRe:o,t:c}=Tr(),h=Nr(),{compareIdentifiers:u}=Ar();class f{constructor(p,l){if(l=h(l),p instanceof f){if(p.loose===!!l.loose&&p.includePrerelease===!!l.includePrerelease)return p;p=p.version}else if(typeof p!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof p}".`);if(p.length>a)throw new TypeError(`version is longer than ${a} characters`);e("SemVer",p,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const g=p.trim().match(l.loose?o[c.LOOSE]:o[c.FULL]);if(!g)throw new TypeError(`Invalid Version: ${p}`);if(this.raw=p,this.major=+g[1],this.minor=+g[2],this.patch=+g[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");g[4]?this.prerelease=g[4].split(".").map(v=>{if(/^[0-9]+$/.test(v)){const T=+v;if(T>=0&&T<i)return T}return v}):this.prerelease=[],this.build=g[5]?g[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(p){if(e("SemVer.compare",this.version,this.options,p),!(p instanceof f)){if(typeof p=="string"&&p===this.version)return 0;p=new f(p,this.options)}return p.version===this.version?0:this.compareMain(p)||this.comparePre(p)}compareMain(p){return p instanceof f||(p=new f(p,this.options)),this.major<p.major?-1:this.major>p.major?1:this.minor<p.minor?-1:this.minor>p.minor?1:this.patch<p.patch?-1:this.patch>p.patch?1:0}comparePre(p){if(p instanceof f||(p=new f(p,this.options)),this.prerelease.length&&!p.prerelease.length)return-1;if(!this.prerelease.length&&p.prerelease.length)return 1;if(!this.prerelease.length&&!p.prerelease.length)return 0;let l=0;do{const g=this.prerelease[l],v=p.prerelease[l];if(e("prerelease compare",l,g,v),g===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(g===void 0)return-1;if(g!==v)return u(g,v)}while(++l)}compareBuild(p){p instanceof f||(p=new f(p,this.options));let l=0;do{const g=this.build[l],v=p.build[l];if(e("build compare",l,g,v),g===void 0&&v===void 0)return 0;if(v===void 0)return 1;if(g===void 0)return-1;if(g!==v)return u(g,v)}while(++l)}inc(p,l,g){if(p.startsWith("pre")){if(!l&&g===!1)throw new Error("invalid increment argument: identifier is empty");if(l){const v=`-${l}`.match(this.options.loose?o[c.PRERELEASELOOSE]:o[c.PRERELEASE]);if(!v||v[1]!==l)throw new Error(`invalid identifier: ${l}`)}}switch(p){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",l,g);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",l,g);break;case"prepatch":this.prerelease.length=0,this.inc("patch",l,g),this.inc("pre",l,g);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",l,g),this.inc("pre",l,g);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const v=Number(g)?1:0;if(this.prerelease.length===0)this.prerelease=[v];else{let T=this.prerelease.length;for(;--T>=0;)typeof this.prerelease[T]=="number"&&(this.prerelease[T]++,T=-2);if(T===-1){if(l===this.prerelease.join(".")&&g===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(v)}}if(l){let T=[l,v];g===!1&&(T=[l]),u(this.prerelease[0],l)===0?isNaN(this.prerelease[1])&&(this.prerelease=T):this.prerelease=T}break}default:throw new Error(`invalid increment argument: ${p}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ge=f,Ge}var Xe,Ct;function Lr(){if(Ct)return Xe;Ct=1;const e=Zt();return Xe=(a,i)=>new e(a,i).major,Xe}Lr();var je,Ot;function Rr(){if(Ot)return je;Ot=1;const e=Zt();return je=(a,i,o=!1)=>{if(a instanceof e)return a;try{return new e(a,i)}catch(c){if(!o)return null;throw c}},je}var He,St;function Dr(){if(St)return He;St=1;const e=Rr();return He=(a,i)=>{const o=e(a,i);return o?o.version:null},He}Dr();var kt={},Ft;function Cr(){return Ft||(Ft=1,(function(e){(function(a){a.parser=function(r,t){return new o(r,t)},a.SAXParser=o,a.SAXStream=l,a.createStream=p,a.MAX_BUFFER_LENGTH=64*1024;var i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];a.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function o(r,t){if(!(this instanceof o))return new o(r,t);var m=this;h(m),m.q=m.c="",m.bufferCheckPosition=a.MAX_BUFFER_LENGTH,m.opt=t||{},m.opt.lowercase=m.opt.lowercase||m.opt.lowercasetags,m.looseCase=m.opt.lowercase?"toLowerCase":"toUpperCase",m.tags=[],m.closed=m.closedRoot=m.sawRoot=!1,m.tag=m.error=null,m.strict=!!r,m.noscript=!!(r||m.opt.noscript),m.state=n.BEGIN,m.strictEntities=m.opt.strictEntities,m.ENTITIES=m.strictEntities?Object.create(a.XML_ENTITIES):Object.create(a.ENTITIES),m.attribList=[],m.opt.xmlns&&(m.ns=Object.create(b)),m.opt.unquotedAttributeValues===void 0&&(m.opt.unquotedAttributeValues=!r),m.trackPosition=m.opt.position!==!1,m.trackPosition&&(m.position=m.line=m.column=0),y(m,"onready")}Object.create||(Object.create=function(r){function t(){}t.prototype=r;var m=new t;return m}),Object.keys||(Object.keys=function(r){var t=[];for(var m in r)r.hasOwnProperty(m)&&t.push(m);return t});function c(r){for(var t=Math.max(a.MAX_BUFFER_LENGTH,10),m=0,s=0,R=i.length;s<R;s++){var z=r[i[s]].length;if(z>t)switch(i[s]){case"textNode":ie(r);break;case"cdata":N(r,"oncdata",r.cdata),r.cdata="";break;case"script":N(r,"onscript",r.script),r.script="";break;default:he(r,"Max buffer length exceeded: "+i[s])}m=Math.max(m,z)}var V=a.MAX_BUFFER_LENGTH-m;r.bufferCheckPosition=V+r.position}function h(r){for(var t=0,m=i.length;t<m;t++)r[i[t]]=""}function u(r){ie(r),r.cdata!==""&&(N(r,"oncdata",r.cdata),r.cdata=""),r.script!==""&&(N(r,"onscript",r.script),r.script="")}o.prototype={end:function(){ct(this)},write:ri,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){u(this)}};var f;try{f=require("stream").Stream}catch{f=function(){}}f||(f=function(){});var d=a.EVENTS.filter(function(r){return r!=="error"&&r!=="end"});function p(r,t){return new l(r,t)}function l(r,t){if(!(this instanceof l))return new l(r,t);f.apply(this),this._parser=new o(r,t),this.writable=!0,this.readable=!0;var m=this;this._parser.onend=function(){m.emit("end")},this._parser.onerror=function(s){m.emit("error",s),m._parser.error=null},this._decoder=null,d.forEach(function(s){Object.defineProperty(m,"on"+s,{get:function(){return m._parser["on"+s]},set:function(R){if(!R)return m.removeAllListeners(s),m._parser["on"+s]=R,R;m.on(s,R)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(f.prototype,{constructor:{value:l}}),l.prototype.write=function(r){if(typeof Be=="function"&&typeof Be.isBuffer=="function"&&Be.isBuffer(r)){if(!this._decoder){var t=Si.StringDecoder;this._decoder=new t("utf8")}r=this._decoder.write(r)}return this._parser.write(r.toString()),this.emit("data",r),!0},l.prototype.end=function(r){return r&&r.length&&this.write(r),this._parser.end(),!0},l.prototype.on=function(r,t){var m=this;return!m._parser["on"+r]&&d.indexOf(r)!==-1&&(m._parser["on"+r]=function(){var s=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);s.splice(0,0,r),m.emit.apply(m,s)}),f.prototype.on.call(m,r,t)};var g="[CDATA[",v="DOCTYPE",T="http://www.w3.org/XML/1998/namespace",G="http://www.w3.org/2000/xmlns/",b={xml:T,xmlns:G},H=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,J=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Z=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function L(r){return r===" "||r===`
`||r==="\r"||r==="	"}function F(r){return r==='"'||r==="'"}function U(r){return r===">"||L(r)}function D(r,t){return r.test(t)}function te(r,t){return!D(r,t)}var n=0;a.STATE={BEGIN:n++,BEGIN_WHITESPACE:n++,TEXT:n++,TEXT_ENTITY:n++,OPEN_WAKA:n++,SGML_DECL:n++,SGML_DECL_QUOTED:n++,DOCTYPE:n++,DOCTYPE_QUOTED:n++,DOCTYPE_DTD:n++,DOCTYPE_DTD_QUOTED:n++,COMMENT_STARTING:n++,COMMENT:n++,COMMENT_ENDING:n++,COMMENT_ENDED:n++,CDATA:n++,CDATA_ENDING:n++,CDATA_ENDING_2:n++,PROC_INST:n++,PROC_INST_BODY:n++,PROC_INST_ENDING:n++,OPEN_TAG:n++,OPEN_TAG_SLASH:n++,ATTRIB:n++,ATTRIB_NAME:n++,ATTRIB_NAME_SAW_WHITE:n++,ATTRIB_VALUE:n++,ATTRIB_VALUE_QUOTED:n++,ATTRIB_VALUE_CLOSED:n++,ATTRIB_VALUE_UNQUOTED:n++,ATTRIB_VALUE_ENTITY_Q:n++,ATTRIB_VALUE_ENTITY_U:n++,CLOSE_TAG:n++,CLOSE_TAG_SAW_WHITE:n++,SCRIPT:n++,SCRIPT_ENDING:n++},a.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},a.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(a.ENTITIES).forEach(function(r){var t=a.ENTITIES[r],m=typeof t=="number"?String.fromCharCode(t):t;a.ENTITIES[r]=m});for(var S in a.STATE)a.STATE[a.STATE[S]]=S;n=a.STATE;function y(r,t,m){r[t]&&r[t](m)}function N(r,t,m){r.textNode&&ie(r),y(r,t,m)}function ie(r){r.textNode=lt(r.opt,r.textNode),r.textNode&&y(r,"ontext",r.textNode),r.textNode=""}function lt(r,t){return r.trim&&(t=t.trim()),r.normalize&&(t=t.replace(/\s+/g," ")),t}function he(r,t){return ie(r),r.trackPosition&&(t+=`
Line: `+r.line+`
Column: `+r.column+`
Char: `+r.c),t=new Error(t),r.error=t,y(r,"onerror",t),r}function ct(r){return r.sawRoot&&!r.closedRoot&&C(r,"Unclosed root tag"),r.state!==n.BEGIN&&r.state!==n.BEGIN_WHITESPACE&&r.state!==n.TEXT&&he(r,"Unexpected end"),ie(r),r.c="",r.closed=!0,y(r,"onend"),o.call(r,r.strict,r.opt),r}function C(r,t){if(typeof r!="object"||!(r instanceof o))throw new Error("bad call to strictFail");r.strict&&he(r,t)}function ti(r){r.strict||(r.tagName=r.tagName[r.looseCase]());var t=r.tags[r.tags.length-1]||r,m=r.tag={name:r.tagName,attributes:{}};r.opt.xmlns&&(m.ns=t.ns),r.attribList.length=0,N(r,"onopentagstart",m)}function Se(r,t){var m=r.indexOf(":"),s=m<0?["",r]:r.split(":"),R=s[0],z=s[1];return t&&r==="xmlns"&&(R="xmlns",z=""),{prefix:R,local:z}}function ke(r){if(r.strict||(r.attribName=r.attribName[r.looseCase]()),r.attribList.indexOf(r.attribName)!==-1||r.tag.attributes.hasOwnProperty(r.attribName)){r.attribName=r.attribValue="";return}if(r.opt.xmlns){var t=Se(r.attribName,!0),m=t.prefix,s=t.local;if(m==="xmlns")if(s==="xml"&&r.attribValue!==T)C(r,"xml: prefix must be bound to "+T+`
Actual: `+r.attribValue);else if(s==="xmlns"&&r.attribValue!==G)C(r,"xmlns: prefix must be bound to "+G+`
Actual: `+r.attribValue);else{var R=r.tag,z=r.tags[r.tags.length-1]||r;R.ns===z.ns&&(R.ns=Object.create(z.ns)),R.ns[s]=r.attribValue}r.attribList.push([r.attribName,r.attribValue])}else r.tag.attributes[r.attribName]=r.attribValue,N(r,"onattribute",{name:r.attribName,value:r.attribValue});r.attribName=r.attribValue=""}function le(r,t){if(r.opt.xmlns){var m=r.tag,s=Se(r.tagName);m.prefix=s.prefix,m.local=s.local,m.uri=m.ns[s.prefix]||"",m.prefix&&!m.uri&&(C(r,"Unbound namespace prefix: "+JSON.stringify(r.tagName)),m.uri=s.prefix);var R=r.tags[r.tags.length-1]||r;m.ns&&R.ns!==m.ns&&Object.keys(m.ns).forEach(function(mt){N(r,"onopennamespace",{prefix:mt,uri:m.ns[mt]})});for(var z=0,V=r.attribList.length;z<V;z++){var W=r.attribList[z],Y=W[0],pe=W[1],j=Se(Y,!0),re=j.prefix,ai=j.local,pt=re===""?"":m.ns[re]||"",$e={name:Y,value:pe,prefix:re,local:ai,uri:pt};re&&re!=="xmlns"&&!pt&&(C(r,"Unbound namespace prefix: "+JSON.stringify(re)),$e.uri=re),r.tag.attributes[Y]=$e,N(r,"onattribute",$e)}r.attribList.length=0}r.tag.isSelfClosing=!!t,r.sawRoot=!0,r.tags.push(r.tag),N(r,"onopentag",r.tag),t||(!r.noscript&&r.tagName.toLowerCase()==="script"?r.state=n.SCRIPT:r.state=n.TEXT,r.tag=null,r.tagName=""),r.attribName=r.attribValue="",r.attribList.length=0}function Fe(r){if(!r.tagName){C(r,"Weird empty close tag."),r.textNode+="</>",r.state=n.TEXT;return}if(r.script){if(r.tagName!=="script"){r.script+="</"+r.tagName+">",r.tagName="",r.state=n.SCRIPT;return}N(r,"onscript",r.script),r.script=""}var t=r.tags.length,m=r.tagName;r.strict||(m=m[r.looseCase]());for(var s=m;t--;){var R=r.tags[t];if(R.name!==s)C(r,"Unexpected close tag");else break}if(t<0){C(r,"Unmatched closing tag: "+r.tagName),r.textNode+="</"+r.tagName+">",r.state=n.TEXT;return}r.tagName=m;for(var z=r.tags.length;z-- >t;){var V=r.tag=r.tags.pop();r.tagName=r.tag.name,N(r,"onclosetag",r.tagName);var W={};for(var Y in V.ns)W[Y]=V.ns[Y];var pe=r.tags[r.tags.length-1]||r;r.opt.xmlns&&V.ns!==pe.ns&&Object.keys(V.ns).forEach(function(j){var re=V.ns[j];N(r,"onclosenamespace",{prefix:j,uri:re})})}t===0&&(r.closedRoot=!0),r.tagName=r.attribValue=r.attribName="",r.attribList.length=0,r.state=n.TEXT}function ii(r){var t=r.entity,m=t.toLowerCase(),s,R="";return r.ENTITIES[t]?r.ENTITIES[t]:r.ENTITIES[m]?r.ENTITIES[m]:(t=m,t.charAt(0)==="#"&&(t.charAt(1)==="x"?(t=t.slice(2),s=parseInt(t,16),R=s.toString(16)):(t=t.slice(1),s=parseInt(t,10),R=s.toString(10))),t=t.replace(/^0+/,""),isNaN(s)||R.toLowerCase()!==t?(C(r,"Invalid character entity"),"&"+r.entity+";"):String.fromCodePoint(s))}function ut(r,t){t==="<"?(r.state=n.OPEN_WAKA,r.startTagPosition=r.position):L(t)||(C(r,"Non-whitespace before first tag."),r.textNode=t,r.state=n.TEXT)}function dt(r,t){var m="";return t<r.length&&(m=r.charAt(t)),m}function ri(r){var t=this;if(this.error)throw this.error;if(t.closed)return he(t,"Cannot write after close. Assign an onready handler.");if(r===null)return ct(t);typeof r=="object"&&(r=r.toString());for(var m=0,s="";s=dt(r,m++),t.c=s,!!s;)switch(t.trackPosition&&(t.position++,s===`
`?(t.line++,t.column=0):t.column++),t.state){case n.BEGIN:if(t.state=n.BEGIN_WHITESPACE,s==="\uFEFF")continue;ut(t,s);continue;case n.BEGIN_WHITESPACE:ut(t,s);continue;case n.TEXT:if(t.sawRoot&&!t.closedRoot){for(var R=m-1;s&&s!=="<"&&s!=="&";)s=dt(r,m++),s&&t.trackPosition&&(t.position++,s===`
`?(t.line++,t.column=0):t.column++);t.textNode+=r.substring(R,m-1)}s==="<"&&!(t.sawRoot&&t.closedRoot&&!t.strict)?(t.state=n.OPEN_WAKA,t.startTagPosition=t.position):(!L(s)&&(!t.sawRoot||t.closedRoot)&&C(t,"Text data outside of root node."),s==="&"?t.state=n.TEXT_ENTITY:t.textNode+=s);continue;case n.SCRIPT:s==="<"?t.state=n.SCRIPT_ENDING:t.script+=s;continue;case n.SCRIPT_ENDING:s==="/"?t.state=n.CLOSE_TAG:(t.script+="<"+s,t.state=n.SCRIPT);continue;case n.OPEN_WAKA:if(s==="!")t.state=n.SGML_DECL,t.sgmlDecl="";else if(!L(s))if(D(H,s))t.state=n.OPEN_TAG,t.tagName=s;else if(s==="/")t.state=n.CLOSE_TAG,t.tagName="";else if(s==="?")t.state=n.PROC_INST,t.procInstName=t.procInstBody="";else{if(C(t,"Unencoded <"),t.startTagPosition+1<t.position){var z=t.position-t.startTagPosition;s=new Array(z).join(" ")+s}t.textNode+="<"+s,t.state=n.TEXT}continue;case n.SGML_DECL:if(t.sgmlDecl+s==="--"){t.state=n.COMMENT,t.comment="",t.sgmlDecl="";continue}t.doctype&&t.doctype!==!0&&t.sgmlDecl?(t.state=n.DOCTYPE_DTD,t.doctype+="<!"+t.sgmlDecl+s,t.sgmlDecl=""):(t.sgmlDecl+s).toUpperCase()===g?(N(t,"onopencdata"),t.state=n.CDATA,t.sgmlDecl="",t.cdata=""):(t.sgmlDecl+s).toUpperCase()===v?(t.state=n.DOCTYPE,(t.doctype||t.sawRoot)&&C(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):s===">"?(N(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=n.TEXT):(F(s)&&(t.state=n.SGML_DECL_QUOTED),t.sgmlDecl+=s);continue;case n.SGML_DECL_QUOTED:s===t.q&&(t.state=n.SGML_DECL,t.q=""),t.sgmlDecl+=s;continue;case n.DOCTYPE:s===">"?(t.state=n.TEXT,N(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=s,s==="["?t.state=n.DOCTYPE_DTD:F(s)&&(t.state=n.DOCTYPE_QUOTED,t.q=s));continue;case n.DOCTYPE_QUOTED:t.doctype+=s,s===t.q&&(t.q="",t.state=n.DOCTYPE);continue;case n.DOCTYPE_DTD:s==="]"?(t.doctype+=s,t.state=n.DOCTYPE):s==="<"?(t.state=n.OPEN_WAKA,t.startTagPosition=t.position):F(s)?(t.doctype+=s,t.state=n.DOCTYPE_DTD_QUOTED,t.q=s):t.doctype+=s;continue;case n.DOCTYPE_DTD_QUOTED:t.doctype+=s,s===t.q&&(t.state=n.DOCTYPE_DTD,t.q="");continue;case n.COMMENT:s==="-"?t.state=n.COMMENT_ENDING:t.comment+=s;continue;case n.COMMENT_ENDING:s==="-"?(t.state=n.COMMENT_ENDED,t.comment=lt(t.opt,t.comment),t.comment&&N(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+s,t.state=n.COMMENT);continue;case n.COMMENT_ENDED:s!==">"?(C(t,"Malformed comment"),t.comment+="--"+s,t.state=n.COMMENT):t.doctype&&t.doctype!==!0?t.state=n.DOCTYPE_DTD:t.state=n.TEXT;continue;case n.CDATA:s==="]"?t.state=n.CDATA_ENDING:t.cdata+=s;continue;case n.CDATA_ENDING:s==="]"?t.state=n.CDATA_ENDING_2:(t.cdata+="]"+s,t.state=n.CDATA);continue;case n.CDATA_ENDING_2:s===">"?(t.cdata&&N(t,"oncdata",t.cdata),N(t,"onclosecdata"),t.cdata="",t.state=n.TEXT):s==="]"?t.cdata+="]":(t.cdata+="]]"+s,t.state=n.CDATA);continue;case n.PROC_INST:s==="?"?t.state=n.PROC_INST_ENDING:L(s)?t.state=n.PROC_INST_BODY:t.procInstName+=s;continue;case n.PROC_INST_BODY:if(!t.procInstBody&&L(s))continue;s==="?"?t.state=n.PROC_INST_ENDING:t.procInstBody+=s;continue;case n.PROC_INST_ENDING:s===">"?(N(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=n.TEXT):(t.procInstBody+="?"+s,t.state=n.PROC_INST_BODY);continue;case n.OPEN_TAG:D(X,s)?t.tagName+=s:(ti(t),s===">"?le(t):s==="/"?t.state=n.OPEN_TAG_SLASH:(L(s)||C(t,"Invalid character in tag name"),t.state=n.ATTRIB));continue;case n.OPEN_TAG_SLASH:s===">"?(le(t,!0),Fe(t)):(C(t,"Forward-slash in opening tag not followed by >"),t.state=n.ATTRIB);continue;case n.ATTRIB:if(L(s))continue;s===">"?le(t):s==="/"?t.state=n.OPEN_TAG_SLASH:D(H,s)?(t.attribName=s,t.attribValue="",t.state=n.ATTRIB_NAME):C(t,"Invalid attribute name");continue;case n.ATTRIB_NAME:s==="="?t.state=n.ATTRIB_VALUE:s===">"?(C(t,"Attribute without value"),t.attribValue=t.attribName,ke(t),le(t)):L(s)?t.state=n.ATTRIB_NAME_SAW_WHITE:D(X,s)?t.attribName+=s:C(t,"Invalid attribute name");continue;case n.ATTRIB_NAME_SAW_WHITE:if(s==="=")t.state=n.ATTRIB_VALUE;else{if(L(s))continue;C(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",N(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",s===">"?le(t):D(H,s)?(t.attribName=s,t.state=n.ATTRIB_NAME):(C(t,"Invalid attribute name"),t.state=n.ATTRIB)}continue;case n.ATTRIB_VALUE:if(L(s))continue;F(s)?(t.q=s,t.state=n.ATTRIB_VALUE_QUOTED):(t.opt.unquotedAttributeValues||he(t,"Unquoted attribute value"),t.state=n.ATTRIB_VALUE_UNQUOTED,t.attribValue=s);continue;case n.ATTRIB_VALUE_QUOTED:if(s!==t.q){s==="&"?t.state=n.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=s;continue}ke(t),t.q="",t.state=n.ATTRIB_VALUE_CLOSED;continue;case n.ATTRIB_VALUE_CLOSED:L(s)?t.state=n.ATTRIB:s===">"?le(t):s==="/"?t.state=n.OPEN_TAG_SLASH:D(H,s)?(C(t,"No whitespace between attributes"),t.attribName=s,t.attribValue="",t.state=n.ATTRIB_NAME):C(t,"Invalid attribute name");continue;case n.ATTRIB_VALUE_UNQUOTED:if(!U(s)){s==="&"?t.state=n.ATTRIB_VALUE_ENTITY_U:t.attribValue+=s;continue}ke(t),s===">"?le(t):t.state=n.ATTRIB;continue;case n.CLOSE_TAG:if(t.tagName)s===">"?Fe(t):D(X,s)?t.tagName+=s:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=n.SCRIPT):(L(s)||C(t,"Invalid tagname in closing tag"),t.state=n.CLOSE_TAG_SAW_WHITE);else{if(L(s))continue;te(H,s)?t.script?(t.script+="</"+s,t.state=n.SCRIPT):C(t,"Invalid tagname in closing tag."):t.tagName=s}continue;case n.CLOSE_TAG_SAW_WHITE:if(L(s))continue;s===">"?Fe(t):C(t,"Invalid characters in closing tag");continue;case n.TEXT_ENTITY:case n.ATTRIB_VALUE_ENTITY_Q:case n.ATTRIB_VALUE_ENTITY_U:var V,W;switch(t.state){case n.TEXT_ENTITY:V=n.TEXT,W="textNode";break;case n.ATTRIB_VALUE_ENTITY_Q:V=n.ATTRIB_VALUE_QUOTED,W="attribValue";break;case n.ATTRIB_VALUE_ENTITY_U:V=n.ATTRIB_VALUE_UNQUOTED,W="attribValue";break}if(s===";"){var Y=ii(t);t.opt.unparsedEntities&&!Object.values(a.XML_ENTITIES).includes(Y)?(t.entity="",t.state=V,t.write(Y)):(t[W]+=Y,t.entity="",t.state=V)}else D(t.entity.length?Z:J,s)?t.entity+=s:(C(t,"Invalid character in entity name"),t[W]+="&"+t.entity+s,t.entity="",t.state=V);continue;default:throw new Error(t,"Unknown state: "+t.state)}return t.position>=t.bufferCheckPosition&&c(t),t}String.fromCodePoint||(function(){var r=String.fromCharCode,t=Math.floor,m=function(){var s=16384,R=[],z,V,W=-1,Y=arguments.length;if(!Y)return"";for(var pe="";++W<Y;){var j=Number(arguments[W]);if(!isFinite(j)||j<0||j>1114111||t(j)!==j)throw RangeError("Invalid code point: "+j);j<=65535?R.push(j):(j-=65536,z=(j>>10)+55296,V=j%1024+56320,R.push(z,V)),(W+1===Y||R.length>s)&&(pe+=r.apply(null,R),R.length=0)}return pe};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:m,configurable:!0,writable:!0}):String.fromCodePoint=m})()})(e)})(kt)),kt}Cr();var Ae=(e=>(e.ReservedName="reserved name",e.Character="character",e.Extension="extension",e))(Ae||{});class fe extends Error{constructor(a){super(`Invalid ${a.reason} '${a.segment}' in filename '${a.filename}'`,{cause:a})}get filename(){return this.cause.filename}get reason(){return this.cause.reason}get segment(){return this.cause.segment}}function Or(e){const a=Oi().files,i=a.forbidden_filename_characters??window._oc_config?.forbidden_filenames_characters??["/","\\"];for(const u of i)if(e.includes(u))throw new fe({segment:u,reason:"character",filename:e});if(e=e.toLocaleLowerCase(),(a.forbidden_filenames??[".htaccess"]).includes(e))throw new fe({filename:e,segment:e,reason:"reserved name"});const o=e.indexOf(".",1),c=e.substring(0,o===-1?void 0:o);if((a.forbidden_filename_basenames??[]).includes(c))throw new fe({filename:e,segment:c,reason:"reserved name"});const h=a.forbidden_filename_extensions??[".part",".filepart"];for(const u of h)if(e.length>u.length&&e.endsWith(u))throw new fe({segment:u,reason:"extension",filename:e})}const qe=["B","KB","MB","GB","TB","PB"],We=["B","KiB","MiB","GiB","TiB","PiB"];function Sr(e,a=!1,i=!1,o=!1){i=i&&!o,typeof e=="string"&&(e=Number(e));let c=e>0?Math.floor(Math.log(e)/Math.log(o?1e3:1024)):0;c=Math.min((i?We.length:qe.length)-1,c);const h=i?We[c]:qe[c];let u=(e/Math.pow(o?1e3:1024,c)).toFixed(1);return a===!0&&c===0?(u!=="0.0"?"< 1 ":"0 ")+(i?We[1]:qe[1]):(c<2?u=parseFloat(u).toFixed(0):u=parseFloat(u).toLocaleString(xt()),u+" "+h)}function $t(e){return e instanceof Date?e.toISOString():String(e)}function kr(e,a,i){a=a??[h=>h],i=i??[];const o=a.map((h,u)=>(i[u]??"asc")==="asc"?1:-1),c=Intl.Collator([di(),xt()],{numeric:!0,usage:"sort"});return[...e].sort((h,u)=>{for(const[f,d]of a.entries()){const p=c.compare($t(d(h)),$t(d(u)));if(p!==0)return p*o[f]}return 0})}function Fr(e,a={}){const i={sortingMode:"basename",sortingOrder:"asc",...a};function o(u){const f=u.displayname||u.attributes?.displayname||u.basename||"";return u.type===se.Folder?f:f.lastIndexOf(".")>0?f.slice(0,f.lastIndexOf(".")):f}const c=[...i.sortFavoritesFirst?[u=>u.attributes?.favorite!==1]:[],...i.sortFoldersFirst?[u=>u.type!=="folder"]:[],...i.sortingMode!=="basename"?[u=>u[i.sortingMode]??u.attributes[i.sortingMode]]:[],u=>o(u),u=>u.basename],h=[...i.sortFavoritesFirst?["asc"]:[],...i.sortFoldersFirst?["asc"]:[],...i.sortingMode==="mtime"?[i.sortingOrder==="asc"?"desc":"asc"]:[],...i.sortingMode!=="mtime"&&i.sortingMode!=="basename"?[i.sortingOrder]:[],i.sortingOrder,i.sortingOrder];return kr(e,c,h)}const $r=new Ti({concurrency:5});function Pr(e){const{resolve:a,promise:i}=Promise.withResolvers();return $r.add(()=>{const o=new Image;return o.onerror=()=>a(!1),o.onload=()=>a(!0),o.src=e,i}),i}function Br(e,a={}){a={size:32,cropPreview:!1,mimeFallback:!0,...a};try{const i=e.attributes?.previewUrl||Je("/core/preview?fileId={fileid}",{fileid:e.fileid});let o;try{o=new URL(i)}catch{o=new URL(i,window.location.origin)}return o.searchParams.set("x",`${a.size}`),o.searchParams.set("y",`${a.size}`),o.searchParams.set("mimeFallback",`${a.mimeFallback}`),o.searchParams.set("a",a.cropPreview===!0?"0":"1"),o.searchParams.set("c",`${e.attributes.etag}`),o}catch{return null}}function xr(e,a){const i=B(null),o=B(!1);return pi(()=>{o.value=!1,i.value=Br(Ee(e),Ee(a||{})),i.value&&Ee(e).type===se.File&&Pr(i.value.href).then(c=>{o.value=c})}),{previewURL:i,previewLoaded:o}}const Q=(e,a)=>{const i=e.__vccOpts||e;for(const[o,c]of a)i[o]=c;return i},Mr={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ur=["aria-hidden","aria-label"],zr=["fill","width","height"],Vr={d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"},Gr={key:0};function Xr(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon file-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",Vr,[i.title?(E(),_("title",Gr,x(i.title),1)):$("",!0)])],8,zr))],16,Ur)}const Ke=Q(Mr,[["render",Xr]]),jr={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Hr=["aria-hidden","aria-label"],qr=["fill","width","height"],Wr={d:"M7,10L12,15L17,10H7Z"},Yr={key:0};function Qr(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon menu-down-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",Wr,[i.title?(E(),_("title",Yr,x(i.title),1)):$("",!0)])],8,qr))],16,Hr)}const Ye=Q(jr,[["render",Qr]]),Zr={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Kr=["aria-hidden","aria-label"],Jr=["fill","width","height"],ea={d:"M7,15L12,10L17,15H7Z"},ta={key:0};function ia(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon menu-up-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",ea,[i.title?(E(),_("title",ta,x(i.title),1)):$("",!0)])],8,Jr))],16,Kr)}const Qe=Q(Zr,[["render",ia]]),ra={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},aa=["aria-hidden","aria-label"],sa=["fill","width","height"],na={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},oa={key:0};function la(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon folder-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",na,[i.title?(E(),_("title",oa,x(i.title),1)):$("",!0)])],8,sa))],16,aa)}const Kt=Q(ra,[["render",la]]),Jt={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},ca=oe({__name:"FilePreview",props:{node:{},cropImagePreviews:{type:Boolean}},setup(e){const a=e,i=B(Jt),{previewURL:o,previewLoaded:c}=xr(Ut(a,"node"),O(()=>({cropPreview:a.cropImagePreviews}))),h=O(()=>a.node.type===se.File),u=O(()=>{if(a.node.type!==se.Folder)return null;if(a.node.attributes?.["is-encrypted"]===1)return Bi;if(a.node.attributes?.["is-tag"])return xi;const f=Object.values(a.node.attributes?.["share-types"]||{}).flat();if(f.some(d=>d===bt.Link||d===bt.Email))return Mi;if(f.length>0)return _t;switch(a.node.attributes?.["mount-type"]){case"external":case"external-session":return zi;case"group":return Ui;case"shared":return _t}return null});return(f,d)=>(E(),_("div",{style:_i(w(c)?{backgroundImage:`url(${w(o)})`}:void 0),class:me(i.value["file-picker__file-icon"])},[w(c)?$("",!0):(E(),_(ae,{key:0},[h.value?(E(),M(Ke,{key:0,size:32})):(E(),_(ae,{key:1},[u.value?(E(),M(w(Xt),{key:0,class:me(i.value["file-picker__file-icon-overlay"]),inline:"",path:u.value,size:16},null,8,["class","path"])):$("",!0),P(Kt,{class:me(i.value["file-picker__file-icon--primary"]),size:32},null,8,["class"])],64))],64))],6))}}),ua=["tabindex","aria-selected","data-filename"],da={class:"row-name"},pa={class:"file-picker__name-container","data-testid":"row-name"},ma=["title","textContent"],ha=["textContent"],fa={class:"row-size"},Ea={class:"row-modified"},ga=oe({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:{},cropImagePreviews:{type:Boolean}},emits:["update:selected","enterDirectory"],setup(e,{emit:a}){const i=e,o=a,c=O(()=>i.node.mtime??0),h=O(()=>Vt(i.node.displayname)),u=O(()=>i.node.displayname.slice(0,h.value?-h.value.length:void 0)),f=O(()=>i.node.type===se.Folder),d=O(()=>i.canPick&&(i.allowPickDirectory||!f.value)),p=O(()=>(i.node.permissions&K.READ)===K.READ);function l(){d.value&&o("update:selected",!i.selected)}function g(){f.value?p.value&&o("enterDirectory",i.node):l()}function v(T){T.key==="Enter"&&g()}return(T,G)=>(E(),_("tr",ee({tabindex:e.showCheckbox&&!f.value?void 0:0,"aria-selected":d.value?e.selected:void 0,class:["file-picker__row",[{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":f.value&&!p.value,"file-picker__row--not-pickable":!d.value}]],"data-filename":e.node.basename,"data-testid":"file-list-row"},vi({click:g,...!e.showCheckbox||f.value?{keydown:v}:{}},!0)),[e.showCheckbox?(E(),_("td",{key:0,class:"row-checkbox",onClick:Ne(()=>{},["stop"])},[P(w(jt),{"aria-label":w(A)("Select the row for {nodename}",{nodename:u.value}),disabled:!d.value,"data-testid":"row-checkbox","model-value":e.selected,"onUpdate:modelValue":l},null,8,["aria-label","disabled","model-value"])])):$("",!0),I("td",da,[I("div",pa,[P(ca,{node:e.node,"crop-image-previews":e.cropImagePreviews},null,8,["node","crop-image-previews"]),I("div",{class:"file-picker__file-name",title:u.value,textContent:x(u.value)},null,8,ma),I("div",{class:"file-picker__file-extension",textContent:x(h.value)},null,8,ha)])]),I("td",fa,x(w(Sr)(e.node.size||0)),1),I("td",Ea,[P(w(ki),{timestamp:c.value,"ignore-seconds":""},null,8,["timestamp"])])],16,ua))}}),va=Q(ga,[["__scopeId","data-v-2af740c4"]]),_a={"aria-hidden":"true",class:"file-picker__row loading-row"},ba={key:0,class:"row-checkbox"},wa={class:"row-name"},ya={class:"row-wrapper"},Ia=oe({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return(a,i)=>(E(),_("tr",_a,[e.showCheckbox?(E(),_("td",ba,[...i[0]||(i[0]=[I("span",null,null,-1)])])):$("",!0),I("td",wa,[I("div",ya,[I("span",{class:me(w(Jt)["file-picker__file-icon"])},null,2),i[1]||(i[1]=I("span",null,null,-1))])]),i[2]||(i[2]=I("td",{class:"row-size"},[I("span")],-1)),i[3]||(i[3]=I("td",{class:"row-modified"},[I("span")],-1))]))}}),Ta=Q(Ia,[["__scopeId","data-v-1f96131b"]]);function ei(){const e=zt("files","config",null),a=B(e?.show_hidden??!0),i=B(e?.sort_favorites_first??!0),o=B(e?.crop_image_previews??!0);return we(async()=>{if(ye())_e.debug("Skip loading files settings - currently on public share");else try{const{data:c}=await Gt.get(Je("/apps/files/api/v1/configs"));a.value=c?.data?.show_hidden??!1,i.value=c?.data?.sort_favorites_first??!0,o.value=c?.data?.crop_image_previews??!0}catch(c){_e.error("Could not load files settings",{error:c}),tt(A("Could not load files settings"))}}),{showHiddenFiles:a,sortFavoritesFirst:i,cropImagePreviews:o}}function Na(e){const a=p=>p==="asc"?"ascending":p==="desc"?"descending":"none",i=zt("files","viewConfigs",null),o=B({sortBy:i?.files?.sorting_mode??"basename",order:a(i?.files?.sorting_direction??"asc")}),c=B({sortBy:i?.recent?.sorting_mode??"basename",order:a(i?.recent?.sorting_direction??"asc")}),h=B({sortBy:i?.favorites?.sorting_mode??"basename",order:a(i?.favorites?.sorting_direction??"asc")});we(async()=>{if(ye())_e.debug("Skip loading files views - currently on public share");else try{const{data:p}=await Gt.get(Je("/apps/files/api/v1/views"));o.value={sortBy:p?.data?.files?.sorting_mode??"basename",order:a(p?.data?.files?.sorting_direction)},h.value={sortBy:p?.data?.favorites?.sorting_mode??"basename",order:a(p?.data?.favorites?.sorting_direction)},c.value={sortBy:p?.data?.recent?.sorting_mode??"basename",order:a(p?.data?.recent?.sorting_direction)}}catch(p){_e.error("Could not load files views",{error:p}),tt(A("Could not load files views"))}});const u=O(()=>Ee(e||"files")==="files"?o.value:Ee(e)==="recent"?c.value:h.value),f=O(()=>u.value.sortBy),d=O(()=>u.value.order);return{filesViewConfig:o,favoritesViewConfig:h,recentViewConfig:c,currentConfig:u,sortBy:f,order:d}}const Aa={key:0,class:"row-checkbox"},La={class:"hidden-visually"},Ra=["aria-sort"],Da={class:"header-wrapper"},Ca={key:2,style:{width:"44px"}},Oa=["aria-sort"],Sa={key:2,style:{width:"44px"}},ka=["aria-sort"],Fa={key:2,style:{width:"44px"}},$a=oe({__name:"FileList",props:fi({currentView:{},multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:{},canPick:{type:Function}},{path:{required:!0},pathModifiers:{},selectedFiles:{required:!0},selectedFilesModifiers:{}}),emits:["update:path","update:selectedFiles"],setup(e){const a=ft(e,"path"),i=ft(e,"selectedFiles"),o=e,c=B(),{currentConfig:h}=Na(o.currentView),u=O(()=>c.value??h.value),f=O(()=>u.value.sortBy==="basename"?u.value.order==="none"?void 0:u.value.order:void 0),d=O(()=>u.value.sortBy==="size"?u.value.order==="none"?void 0:u.value.order:void 0),p=O(()=>u.value.sortBy==="mtime"?u.value.order==="none"?void 0:u.value.order:void 0);function l(F){u.value.sortBy===F?u.value.order==="ascending"?c.value={sortBy:u.value.sortBy,order:"descending"}:c.value={sortBy:u.value.sortBy,order:"ascending"}:c.value={sortBy:F,order:"ascending"}}const{sortFavoritesFirst:g,cropImagePreviews:v}=ei(),T=O(()=>Fr(o.files,{sortFoldersFirst:!0,sortFavoritesFirst:g.value,sortingOrder:u.value.order==="descending"?"desc":"asc",sortingMode:u.value.sortBy})),G=O(()=>o.files.filter(F=>o.allowPickDirectory||F.type!==se.Folder)),b=O(()=>!o.loading&&i.value.length>0&&i.value.length>=G.value.length);function H(){i.value.length<G.value.length?i.value=[...G.value]:i.value=[]}function X(F){i.value.includes(F)?i.value=i.value.filter(U=>U.path!==F.path):o.multiselect?i.value=[...i.value,F]:i.value=[F]}function J(F){a.value=F.path}const Z=B(4),L=B();{const F=()=>Ei(()=>{const U=L.value?.parentElement?.children||[];let D=L.value?.parentElement?.clientHeight||450;for(let te=0;te<U.length;te++)L.value?.isSameNode(U[te])||(D-=U[te].clientHeight);Z.value=Math.max(1,Math.floor((D-50)/50))});we(()=>{window.addEventListener("resize",F),F()}),gi(()=>{window.removeEventListener("resize",F)})}return(F,U)=>(E(),_("div",{ref_key:"fileContainer",ref:L,class:"file-picker__files"},[I("table",null,[I("thead",null,[I("tr",null,[e.multiselect?(E(),_("th",Aa,[I("span",La,x(w(A)("Select entry")),1),e.multiselect?(E(),M(w(jt),{key:0,"aria-label":w(A)("Select all entries"),"data-testid":"select-all-checkbox","model-value":b.value,"onUpdate:modelValue":H},null,8,["aria-label","model-value"])):$("",!0)])):$("",!0),I("th",{"aria-sort":f.value,class:"row-name"},[I("div",Da,[U[3]||(U[3]=I("span",{class:"file-picker__header-preview"},null,-1)),P(w(ge),{"data-test":"file-picker_sort-name",variant:"tertiary",wide:"",onClick:U[0]||(U[0]=D=>l("basename"))},{icon:k(()=>[f.value==="ascending"?(E(),M(Qe,{key:0,size:20})):f.value==="descending"?(E(),M(Ye,{key:1,size:20})):(E(),_("span",Ca))]),default:k(()=>[de(" "+x(w(A)("Name")),1)]),_:1})])],8,Ra),I("th",{"aria-sort":d.value,class:"row-size"},[P(w(ge),{variant:"tertiary",wide:"",onClick:U[1]||(U[1]=D=>l("size"))},{icon:k(()=>[d.value==="ascending"?(E(),M(Qe,{key:0,size:20})):d.value==="descending"?(E(),M(Ye,{key:1,size:20})):(E(),_("span",Sa))]),default:k(()=>[de(" "+x(w(A)("Size")),1)]),_:1})],8,Oa),I("th",{"aria-sort":p.value,class:"row-modified"},[P(w(ge),{variant:"tertiary",wide:"",onClick:U[2]||(U[2]=D=>l("mtime"))},{icon:k(()=>[p.value==="ascending"?(E(),M(Qe,{key:0,size:20})):p.value==="descending"?(E(),M(Ye,{key:1,size:20})):(E(),_("span",Fa))]),default:k(()=>[de(" "+x(w(A)("Modified")),1)]),_:1})],8,ka)])]),I("tbody",null,[e.loading?(E(!0),_(ae,{key:0},Le(Z.value,D=>(E(),M(Ta,{key:D,"show-checkbox":e.multiselect},null,8,["show-checkbox"]))),128)):(E(!0),_(ae,{key:1},Le(T.value,D=>(E(),M(va,{key:D.fileid||D.path,"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||i.value.length===0||i.value.includes(D))&&(e.canPick===void 0||e.canPick(D)),selected:i.value.includes(D),node:D,"crop-image-previews":w(v),"onUpdate:selected":te=>X(D),onEnterDirectory:J},null,8,["allow-pick-directory","show-checkbox","can-pick","selected","node","crop-image-previews","onUpdate:selected"]))),128))])])],512))}}),Pa=Q($a,[["__scopeId","data-v-68ec5c33"]]),Ba={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},xa=["aria-hidden","aria-label"],Ma=["fill","width","height"],Ua={d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},za={key:0};function Va(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon home-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",Ua,[i.title?(E(),_("title",za,x(i.title),1)):$("",!0)])],8,Ma))],16,xa)}const Ga=Q(Ba,[["render",Va]]),Xa={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ja=["aria-hidden","aria-label"],Ha=["fill","width","height"],qa={d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},Wa={key:0};function Ya(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon plus-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",qa,[i.title?(E(),_("title",Wa,x(i.title),1)):$("",!0)])],8,Ha))],16,ja)}const Qa=Q(Xa,[["render",Ya]]),Za=oe({__name:"FilePickerBreadcrumbs",props:{path:{},showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:a}){const i=e,o=a,c=B(!1),h=B(""),u=hi("nameInput");function f(){const l=h.value.trim(),g=u.value?.$el?.querySelector("input");let v="";try{Or(l)}catch(T){if(!(T instanceof fe))throw T;switch(T.reason){case Ae.Character:v=A('"{char}" is not allowed inside a folder name.',{char:T.segment});break;case Ae.ReservedName:v=A('"{segment}" is a reserved name and not allowed for folder names.',{segment:T.segment});break;case Ae.Extension:v=A('Folder names must not end with "{extension}".',{extension:T.segment});break;default:v=A("Invalid folder name.")}}return g&&g.setCustomValidity(v),v===""}function d(){const l=h.value.trim();f()&&(c.value=!1,o("create-node",l),h.value="")}const p=O(()=>i.path.split("/").filter(l=>l!=="").map((l,g,v)=>({name:l,path:"/"+v.slice(0,g+1).join("/")})));return(l,g)=>(E(),M(w(mr),{class:"file-picker__breadcrumbs"},Bt({default:k(()=>[P(w(Re),{name:w(A)("All files"),title:w(A)("Home"),onClick:g[0]||(g[0]=v=>o("update:path","/"))},{icon:k(()=>[P(Ga,{size:20})]),_:1},8,["name","title"]),(E(!0),_(ae,null,Le(p.value,v=>(E(),M(w(Re),{key:v.path,name:v.name,title:v.path,onClick:T=>o("update:path",v.path)},null,8,["name","title","onClick"]))),128))]),_:2},[e.showMenu?{name:"actions",fn:k(()=>[P(w(et),{open:c.value,"onUpdate:open":g[2]||(g[2]=v=>c.value=v),"aria-label":w(A)("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":w(A)("New"),variant:"secondary",onClose:g[3]||(g[3]=v=>h.value="")},{icon:k(()=>[P(Qa,{size:20})]),default:k(()=>[P(w(Ni),{ref_key:"nameInput",ref:u,modelValue:h.value,"onUpdate:modelValue":[g[1]||(g[1]=v=>h.value=v),f],label:w(A)("New folder"),placeholder:w(A)("New folder name"),onSubmit:d},{icon:k(()=>[P(Kt,{size:20})]),_:1},8,["modelValue","label","placeholder"])]),_:1},8,["open","aria-label","menu-name"])]),key:"0"}:void 0]),1024))}}),Ka=Q(Za,[["__scopeId","data-v-4ce40fd0"]]),Ja={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},es=["aria-hidden","aria-label"],ts=["fill","width","height"],is={d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},rs={key:0};function as(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon close-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",is,[i.title?(E(),_("title",rs,x(i.title),1)):$("",!0)])],8,ts))],16,es)}const ss=Q(Ja,[["render",as]]),ns={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},os=["aria-hidden","aria-label"],ls=["fill","width","height"],cs={d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},us={key:0};function ds(e,a,i,o,c,h){return E(),_("span",ee(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon magnify-icon",role:"img",onClick:a[0]||(a[0]=u=>e.$emit("click",u))}),[(E(),_("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[I("path",cs,[i.title?(E(),_("title",us,x(i.title),1)):$("",!0)])],8,ls))],16,os)}const ps=Q(ns,[["render",ds]]);function ms(e){const a=[{id:"files",label:A("All files"),icon:Fi},{id:"recent",label:A("Recent"),icon:$i},{id:"favorites",label:A("Favorites"),icon:Pi}],i=e.value?a.filter(({id:o})=>o==="files"):a;return{allViews:a,availableViews:i}}const hs={key:0,class:"file-picker__side"},fs=oe({__name:"FilePickerNavigation",props:{currentView:{},filterString:{},isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:a}){const i=e,o=a,{availableViews:c}=ms(B(De()===null)),h=O(()=>c.filter(f=>f.id===i.currentView)[0]??c[0]),u=f=>o("update:filterString",f.toString());return(f,d)=>(E(),_(ae,null,[P(w(Gi),{class:"file-picker__filter-input",label:w(A)("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString,"onUpdate:modelValue":u,onTrailingButtonClick:d[0]||(d[0]=p=>u(""))},{"trailing-button-icon":k(()=>[P(ss,{size:16})]),default:k(()=>[P(ps,{size:16})]),_:1},8,["label","show-trailing-button","model-value"]),w(c).length>1&&!e.disabledNavigation?(E(),_(ae,{key:0},[e.isCollapsed?(E(),M(w(Vi),{key:1,"aria-label":w(A)("Current view selector"),clearable:!1,searchable:!1,options:w(c),"model-value":h.value,"onUpdate:modelValue":d[1]||(d[1]=p=>o("update:currentView",p.id))},null,8,["aria-label","options","model-value"])):(E(),_("ul",hs,[(E(!0),_(ae,null,Le(w(c),p=>(E(),_("li",{key:p.id},[P(w(ge),{variant:e.currentView===p.id?"primary":"tertiary",wide:!0,onClick:l=>f.$emit("update:currentView",p.id)},{icon:k(()=>[P(w(Xt),{path:p.icon,size:20},null,8,["path"])]),default:k(()=>[de(" "+x(p.label),1)]),_:2},1032,["variant","onClick"])]))),128))]))],64)):$("",!0)],64))}}),Es=Q(fs,[["__scopeId","data-v-b91fd905"]]);function gs(e){const a=new AbortController,i=Math.round(Date.now()/1e3)-3600*24*14;return new it(async(o,c,h)=>{h(()=>a.abort());try{const{data:u}=await e.search("/",{signal:a.signal,details:!0,data:_r(i)}),f=u.results.map(d=>Oe(d));o(f)}catch(u){c(u)}})}function vs(e,a){const i=new AbortController;return new it(async(o,c,h)=>{h(()=>i.abort());try{const u=(await e.getDirectoryContents(ve(Ie,a),{signal:i.signal,details:!0,includeSelf:!0,data:qt()})).data.map(f=>Oe(f));o({contents:u.filter(({path:f})=>f!==a),folder:u.find(({path:f})=>f===a)})}catch(u){c(u)}})}async function _s(e,a){const{data:i}=await e.stat(ve(Ie,a),{details:!0,data:qt()});return Oe(i)}function bs(e,a){const i=yr(),o=Ze([]),c=Ze(null),h=B(!0),u=B(null);async function f(p){const l=ve(a.value,p);await i.createDirectory(ve(Ie,l));const g=await _s(i,l);return o.value=[...o.value,g],g}async function d(){u.value&&u.value.cancel(),h.value=!0,e.value==="favorites"?u.value=Ir(i,a.value):e.value==="recent"?u.value=gs(i):u.value=vs(i,a.value);const p=await u.value;if(p)"folder"in p?(c.value=p.folder,o.value=p.contents):(c.value=null,o.value=p);else return;u.value=null,h.value=!1}return Mt([e,a],()=>d()),we(()=>d()),{isLoading:h,files:o,folder:c,loadFiles:d,createDirectory:f}}function ws(e){const a=O(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const o=i.split("/");return a.value.some(([c,h])=>(o[0]===c||c==="*")&&(o[1]===h||h==="*"))}}}const ys={class:"file-picker__main"},Is={key:1,class:"file-picker__view"},Ts=oe({__name:"FilePicker",props:{buttons:{},name:{},allowPickDirectory:{type:Boolean,default:!1},noMenu:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},filterFn:{type:Function,default:void 0},canPickFn:{type:Function,default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!1},path:{default:void 0}},emits:["close"],setup(e,{emit:a}){const i=e,o=a,c=B(!0),h=B("files"),u=B(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=B(""),d=O({get:()=>h.value==="files"?f.value||i.path||u.value:"/",set:S=>{f.value=S}}),p=Ze([]),{files:l,folder:g,isLoading:v,loadFiles:T,createDirectory:G}=bs(h,d);Mt([f],()=>{i.path===void 0&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),p.value=[]});let b=!1;const H=O(()=>{const S=p.value.length===0&&i.allowPickDirectory&&g.value?[g.value]:p.value;return(typeof i.buttons=="function"?i.buttons(S,d.value,h.value):i.buttons).map(y=>({...y,disabled:y.disabled||v.value,callback:()=>{b=!0,X(y.callback,S)}}))});async function X(S,y){await S(y),o("close",y),b=!1}const J=O(()=>h.value==="favorites"?A("Favorites"):h.value==="recent"?A("Recent"):""),Z=B(""),{isSupportedMimeType:L}=ws(Ut(i,"mimetypeFilter"));we(()=>T());const{showHiddenFiles:F}=ei(),U=O(()=>{let S=l.value;return F.value||(S=S.filter(y=>!y.basename.startsWith("."))),i.mimetypeFilter.length>0&&(S=S.filter(y=>y.type==="folder"||y.mime&&L(y.mime))),Z.value&&(S=S.filter(y=>y.basename.toLowerCase().includes(Z.value.toLowerCase()))),i.filterFn&&(S=S.filter(y=>i.filterFn(y))),S}),D=O(()=>h.value==="files"?A("Upload some content or sync with your devices!"):h.value==="recent"?A("Files and folders you recently modified will show up here."):A("Files and folders you mark as favorite will show up here."));async function te(S){try{const y=await G(S);f.value=y.path,mi("files:node:created",l.value.filter(N=>N.basename===S)[0])}catch(y){_e.warn("Could not create new folder",{name:S,error:y}),tt(A("Could not create the new folder"))}}function n(S){!S&&!b&&o("close")}return(S,y)=>(E(),M(w(Ii),{open:c.value,"onUpdate:open":[y[6]||(y[6]=N=>c.value=N),n],buttons:H.value,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},{navigation:k(({isCollapsed:N})=>[P(Es,{"current-view":h.value,"onUpdate:currentView":y[0]||(y[0]=ie=>h.value=ie),"filter-string":Z.value,"onUpdate:filterString":y[1]||(y[1]=ie=>Z.value=ie),"is-collapsed":N,"disabled-navigation":e.disabledNavigation},null,8,["current-view","filter-string","is-collapsed","disabled-navigation"])]),default:k(()=>[I("div",ys,[h.value==="files"?(E(),M(Ka,{key:0,path:d.value,"onUpdate:path":y[2]||(y[2]=N=>d.value=N),"show-menu":!e.noMenu,onCreateNode:te},null,8,["path","show-menu"])):(E(),_("div",Is,[I("h3",null,x(J.value),1)])),w(v)||U.value.length>0?(E(),M(Pa,{key:2,path:d.value,"onUpdate:path":[y[3]||(y[3]=N=>d.value=N),y[5]||(y[5]=N=>h.value="files")],"selected-files":p.value,"onUpdate:selectedFiles":y[4]||(y[4]=N=>p.value=N),"allow-pick-directory":e.allowPickDirectory,"current-view":h.value,files:U.value,multiselect:e.multiselect,loading:w(v),name:J.value,"can-pick":e.canPickFn},null,8,["path","selected-files","allow-pick-directory","current-view","files","multiselect","loading","name","can-pick"])):Z.value?(E(),M(w(wt),{key:3,name:w(A)("No matching files"),description:w(A)("No files matching your filter were found.")},{icon:k(()=>[P(Ke)]),_:1},8,["name","description"])):(E(),M(w(wt),{key:4,name:w(A)("No files in here"),description:D.value},{icon:k(()=>[P(Ke)]),_:1},8,["name","description"]))])]),_:1},8,["open","buttons","name"]))}}),zs=Q(Ts,[["__scopeId","data-v-303416d3"]]);export{zs as default};
//# sourceMappingURL=FilePicker-W-IYpVkn-BQN_0-wS.chunk.mjs.map
