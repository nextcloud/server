{"version":3,"file":"AppManagement-xpdtPrBe.mjs","sources":["../../apps/settings/src/components/AppList/AppScore.vue","../../apps/settings/src/components/AppList/AppLevelBadge.vue","../../apps/settings/src/mixins/AppManagement.js"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<span role=\"img\"\n\t\t:aria-label=\"title\"\n\t\t:title=\"title\"\n\t\tclass=\"app-score__wrapper\">\n\t\t<NcIconSvgWrapper v-for=\"index in fullStars\"\n\t\t\t:key=\"`full-star-${index}`\"\n\t\t\t:path=\"mdiStar\"\n\t\t\tinline />\n\t\t<NcIconSvgWrapper v-if=\"hasHalfStar\" :path=\"mdiStarHalfFull\" inline />\n\t\t<NcIconSvgWrapper v-for=\"index in emptyStars\"\n\t\t\t:key=\"`empty-star-${index}`\"\n\t\t\t:path=\"mdiStarOutline\"\n\t\t\tinline />\n\t</span>\n</template>\n<script lang=\"ts\">\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\nimport { mdiStar, mdiStarHalfFull, mdiStarOutline } from '@mdi/js'\nimport { translate as t } from '@nextcloud/l10n'\nimport { defineComponent } from 'vue'\n\nexport default defineComponent({\n\tname: 'AppScore',\n\tcomponents: {\n\t\tNcIconSvgWrapper,\n\t},\n\tprops: {\n\t\tscore: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup() {\n\t\treturn {\n\t\t\tmdiStar,\n\t\t\tmdiStarHalfFull,\n\t\t\tmdiStarOutline,\n\t\t}\n\t},\n\tcomputed: {\n\t\ttitle() {\n\t\t\tconst appScore = (this.score * 5).toFixed(1)\n\t\t\treturn t('settings', 'Community rating: {score}/5', { score: appScore })\n\t\t},\n\t\tfullStars() {\n\t\t\treturn Math.floor(this.score * 5 + 0.25)\n\t\t},\n\t\temptyStars() {\n\t\t\treturn Math.min(Math.floor((1 - this.score) * 5 + 0.25), 5 - this.fullStars)\n\t\t},\n\t\thasHalfStar() {\n\t\t\treturn (this.fullStars + this.emptyStars) < 5\n\t\t},\n\t},\n})\n</script>\n<style scoped>\n.app-score__wrapper {\n\tdisplay: inline-flex;\n\tcolor: var(--color-favorite, #a08b00);\n\n\t> * {\n\t\tvertical-align: text-bottom;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<span v-if=\"isSupported || isFeatured\"\n\t\tclass=\"app-level-badge\"\n\t\t:class=\"{ 'app-level-badge--supported': isSupported }\"\n\t\t:title=\"badgeTitle\">\n\t\t<NcIconSvgWrapper :path=\"badgeIcon\" :size=\"20\" inline />\n\t\t{{ badgeText }}\n\t</span>\n</template>\n\n<script setup lang=\"ts\">\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\n\nimport { mdiCheck, mdiStarShooting } from '@mdi/js'\nimport { translate as t } from '@nextcloud/l10n'\nimport { computed } from 'vue'\n\nconst props = defineProps<{\n\t/**\n\t * The app level\n\t */\n\tlevel?: number\n}>()\n\nconst isSupported = computed(() => props.level === 300)\nconst isFeatured = computed(() => props.level === 200)\nconst badgeIcon = computed(() => isSupported.value ? mdiStarShooting : mdiCheck)\nconst badgeText = computed(() => isSupported.value ? t('settings', 'Supported') : t('settings', 'Featured'))\nconst badgeTitle = computed(() => isSupported.value\n\t? t('settings', 'This app is supported via your current Nextcloud subscription.')\n\t: t('settings', 'Featured apps are developed by and within the community. They offer central functionality and are ready for production use.'))\n</script>\n\n<style scoped lang=\"scss\">\n.app-level-badge {\n\tcolor: var(--color-text-maxcontrast);\n\tbackground-color: transparent;\n\tborder: 1px solid var(--color-text-maxcontrast);\n\tborder-radius: var(--border-radius);\n\n\tdisplay: flex;\n\tflex-direction: row;\n\tgap: 6px;\n\tpadding: 3px 6px;\n\twidth: fit-content;\n\n\t&--supported {\n\t\tborder-color: var(--color-success);\n\t\tcolor: var(--color-success);\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { showError } from '@nextcloud/dialogs'\nimport rebuildNavigation from '../service/rebuild-navigation.js'\n\nexport default {\n\tcomputed: {\n\t\tappGroups() {\n\t\t\treturn this.app.groups.map(group => { return { id: group, name: group } })\n\t\t},\n\t\tinstalling() {\n\t\t\treturn this.$store.getters.loading('install')\n\t\t},\n\t\tisLoading() {\n\t\t\treturn this.app && this.$store.getters.loading(this.app.id)\n\t\t},\n\t\tenableButtonText() {\n\t\t\tif (this.app.needsDownload) {\n\t\t\t\treturn t('settings', 'Download and enable')\n\t\t\t}\n\t\t\treturn t('settings', 'Enable')\n\t\t},\n\t\tforceEnableButtonText() {\n\t\t\tif (this.app.needsDownload) {\n\t\t\t\treturn t('settings', 'Allow untested app')\n\t\t\t}\n\t\t\treturn t('settings', 'Allow untested app')\n\t\t},\n\t\tenableButtonTooltip() {\n\t\t\tif (this.app.needsDownload) {\n\t\t\t\treturn t('settings', 'The app will be downloaded from the App Store')\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t\tforceEnableButtonTooltip() {\n\t\t\tconst base = t('settings', 'This app is not marked as compatible with your Nextcloud version. If you continue you will still be able to install the app. Note that the app might not work as expected.')\n\t\t\tif (this.app.needsDownload) {\n\t\t\t\treturn base + ' ' + t('settings', 'The app will be downloaded from the App Store')\n\t\t\t}\n\t\t\treturn base\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tgroupCheckedAppsData: false,\n\t\t}\n\t},\n\n\tmounted() {\n\t\tif (this.app && this.app.groups && this.app.groups.length > 0) {\n\t\t\tthis.groupCheckedAppsData = true\n\t\t}\n\t},\n\n\tmethods: {\n\t\tasyncFindGroup(query) {\n\t\t\treturn this.$store.dispatch('getGroups', { search: query, limit: 5, offset: 0 })\n\t\t},\n\t\tisLimitedToGroups(app) {\n\t\t\tif (this.app.groups.length || this.groupCheckedAppsData) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn false\n\t\t},\n\t\tsetGroupLimit() {\n\t\t\tif (!this.groupCheckedAppsData) {\n\t\t\t\tthis.$store.dispatch('enableApp', { appId: this.app.id, groups: [] })\n\t\t\t}\n\t\t},\n\t\tcanLimitToGroups(app) {\n\t\t\tif ((app.types && app.types.includes('filesystem'))\n\t\t\t\t\t|| app.types.includes('prelogin')\n\t\t\t\t\t|| app.types.includes('authentication')\n\t\t\t\t\t|| app.types.includes('logging')\n\t\t\t\t\t|| app.types.includes('prevent_group_restriction')) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn true\n\t\t},\n\t\taddGroupLimitation(groupArray) {\n\t\t\tconst group = groupArray.pop()\n\t\t\tconst groups = this.app.groups.concat([]).concat([group.id])\n\t\t\tthis.$store.dispatch('enableApp', { appId: this.app.id, groups })\n\t\t},\n\t\tremoveGroupLimitation(group) {\n\t\t\tconst currentGroups = this.app.groups.concat([])\n\t\t\tconst index = currentGroups.indexOf(group.id)\n\t\t\tif (index > -1) {\n\t\t\t\tcurrentGroups.splice(index, 1)\n\t\t\t}\n\t\t\tthis.$store.dispatch('enableApp', { appId: this.app.id, groups: currentGroups })\n\t\t},\n\t\tforceEnable(appId) {\n\t\t\tthis.$store.dispatch('forceEnableApp', { appId, groups: [] })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t\tenable(appId) {\n\t\t\tthis.$store.dispatch('enableApp', { appId, groups: [] })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t\tdisable(appId) {\n\t\t\tthis.$store.dispatch('disableApp', { appId })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t\tremove(appId) {\n\t\t\tthis.$store.dispatch('uninstallApp', { appId })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t\tinstall(appId) {\n\t\t\tthis.$store.dispatch('enableApp', { appId })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t\tupdate(appId) {\n\t\t\tthis.$store.dispatch('updateApp', { appId })\n\t\t\t\t.then((response) => { rebuildNavigation() })\n\t\t\t\t.catch((error) => { showError(error) })\n\t\t},\n\t},\n}\n"],"names":["_sfc_main$1","defineComponent","NcIconSvgWrapper","mdiStar","mdiStarHalfFull","mdiStarOutline","appScore","t","isSupported","computed","props","isFeatured","badgeIcon","mdiStarShooting","mdiCheck","badgeText","badgeTitle","AppManagement","group","base","query","app","groupArray","groups","currentGroups","index","appId","response","rebuildNavigation","error","showError"],"mappings":"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"}