{"version":3,"file":"Markdown-Dm4KOgdr.mjs","sources":["../../apps/updatenotification/src/composables/useMarkdown.ts","../../apps/updatenotification/src/components/Markdown.vue"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport type { Ref } from 'vue'\n\nimport { marked } from 'marked'\nimport { computed } from 'vue'\nimport dompurify from 'dompurify'\n\nexport const useMarkdown = (text: Ref<string|undefined|null>, minHeadingLevel: Ref<number|undefined>) => {\n\tconst minHeading = computed(() => Math.min(Math.max(minHeadingLevel.value ?? 1, 1), 6))\n\tconst renderer = new marked.Renderer()\n\n\trenderer.link = function(href, title, text) {\n\t\tlet out = `<a href=\"${href}\" rel=\"noreferrer noopener\" target=\"_blank\"`\n\t\tif (title) {\n\t\t\tout += ' title=\"' + title + '\"'\n\t\t}\n\t\tout += '>' + text + '</a>'\n\t\treturn out\n\t}\n\n\trenderer.image = function(href, title, text) {\n\t\tif (text) {\n\t\t\treturn text\n\t\t}\n\t\treturn title ?? ''\n\t}\n\n\trenderer.heading = (text: string, level: number) => {\n\t\tconst headingLevel = Math.max(minHeading.value, level)\n\t\treturn `<h${headingLevel}>${text}</h${headingLevel}>`\n\t}\n\n\tconst html = computed(() => dompurify.sanitize(\n\t\tmarked((text.value ?? '').trim(), {\n\t\t\trenderer,\n\t\t\tgfm: false,\n\t\t\tbreaks: false,\n\t\t\tpedantic: false,\n\t\t}),\n\t\t{\n\t\t\tSAFE_FOR_JQUERY: true,\n\t\t\tALLOWED_TAGS: [\n\t\t\t\t'h1',\n\t\t\t\t'h2',\n\t\t\t\t'h3',\n\t\t\t\t'h4',\n\t\t\t\t'h5',\n\t\t\t\t'h6',\n\t\t\t\t'strong',\n\t\t\t\t'p',\n\t\t\t\t'a',\n\t\t\t\t'ul',\n\t\t\t\t'ol',\n\t\t\t\t'li',\n\t\t\t\t'em',\n\t\t\t\t'del',\n\t\t\t\t'blockquote',\n\t\t\t],\n\t\t},\n\t))\n\n\treturn { html }\n}\n","<!--\n  - SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<!-- eslint-disable-next-line vue/no-v-html -->\n\t<div class=\"markdown\" v-html=\"html\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { toRef } from 'vue'\nimport { useMarkdown } from '../composables/useMarkdown'\n\nconst props = withDefaults(\n\tdefineProps<{\n\t\tmarkdown: string\n\t\tminHeadingLevel?: 1|2|3|4|5|6\n\t}>(),\n\t{\n\t\tminHeadingLevel: 2,\n\t},\n)\n\nconst { html } = useMarkdown(toRef(props, 'markdown'), toRef(props, 'minHeadingLevel'))\n</script>\n\n<style scoped lang=\"scss\">\n.markdown {\n\t:deep {\n\t\tul {\n\t\t\tlist-style: disc;\n\t\t\tpadding-inline-start: 20px;\n\t\t}\n\n\t\th3, h4, h5, h6 {\n\t\t\tfont-weight: 600;\n\t\t\tline-height: 1.5;\n\t\t\tmargin-top: 24px;\n\t\t\tmargin-bottom: 12px;\n\t\t\tcolor: var(--color-main-text);\n\t\t}\n\n\t\th3 {\n\t\t\tfont-size: 20px;\n\t\t}\n\n\t\th4 {\n\t\t\tfont-size: 18px;\n\t\t}\n\n\t\th5 {\n\t\t\tfont-size: 17px;\n\t\t}\n\n\t\th6 {\n\t\t\tfont-size: var(--default-font-size);\n\t\t}\n\t}\n}\n</style>\n"],"names":["useMarkdown","text","minHeadingLevel","minHeading","computed","_a","renderer","marked","href","title","out","level","headingLevel","dompurify","html","toRef","props"],"mappings":";uJAUa,MAAAA,EAAc,CAACC,EAAkCC,IAA2C,CAClG,MAAAC,EAAaC,EAAS,IAAG,CAXhC,IAAAC,EAWwC,OAAA,KAAA,IAAI,KAAK,KAAIA,EAAAH,EAAgB,QAAhB,KAAyBG,EAAA,EAAG,CAAC,EAAG,CAAC,CAAA,CAAC,EAChFC,EAAW,IAAIC,EAAO,SAE5B,OAAAD,EAAS,KAAO,SAASE,EAAMC,EAAOR,EAAM,CACvC,IAAAS,EAAM,YAAY,OAAIF,EAAA,6CAAA,EAC1B,OAAIC,IACHC,GAAO,WAAaD,EAAQ,KAE7BC,GAAO,IAAMT,EAAO,OACbS,CAAA,EAGRJ,EAAS,MAAQ,SAASE,EAAMC,EAAOR,EAAM,CAC5C,OAAIA,IAGGQ,GAAAA,KAAAA,EAAS,GAAA,EAGRH,EAAA,QAAU,CAACL,EAAcU,IAAkB,CACnD,MAAMC,EAAe,KAAK,IAAIT,EAAW,MAAOQ,CAAK,EACrD,MAAO,KAAK,OAAYC,EAAA,GAAA,EAAI,OAAAX,EAAI,OAAM,OAAYW,EAAA,GAAA,CAAA,EAgC5C,CAAE,KA7BIR,EAAS,IAAG,CAnC1B,IAAAC,EAmCuC,OAAAQ,EAAA,SACrCN,IAAQF,EAAKJ,EAAA,QAAL,KAAcI,EAAA,IAAI,OAAQ,CACjC,SAAAC,EACA,IAAK,GACL,OAAQ,GACR,SAAU,EAAA,CACV,EACD,CACC,gBAAiB,GACjB,aAAc,CACb,KACA,KACA,KACA,KACA,KACA,KACA,SACA,IACA,IACA,KACA,KACA,KACA,KACA,MACA,YACD,CACD,CAAA,CACD,CAAC,CAEa,CACf,8FC1CM,CAAE,KAAAQ,CAAK,EAAId,EAAYe,EAAMC,EAAO,UAAU,EAAGD,EAAMC,EAAO,iBAAiB,CAAC"}