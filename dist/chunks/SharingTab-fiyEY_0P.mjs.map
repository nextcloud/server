{"version":3,"file":"SharingTab-fiyEY_0P.mjs","sources":["../../node_modules/lodash-es/isObject.js","../../node_modules/lodash-es/_freeGlobal.js","../../node_modules/lodash-es/_root.js","../../node_modules/lodash-es/now.js","../../node_modules/lodash-es/_trimmedEndIndex.js","../../node_modules/lodash-es/_baseTrim.js","../../node_modules/lodash-es/_Symbol.js","../../node_modules/lodash-es/_getRawTag.js","../../node_modules/lodash-es/_objectToString.js","../../node_modules/lodash-es/_baseGetTag.js","../../node_modules/lodash-es/isObjectLike.js","../../node_modules/lodash-es/isSymbol.js","../../node_modules/lodash-es/toNumber.js","../../node_modules/lodash-es/debounce.js","../../node_modules/nextcloud-vue-collections/node_modules/@nextcloud/router/dist/index.js","../../node_modules/nextcloud-vue-collections/dist/index.mjs","../../apps/files_sharing/src/services/ConfigService.js","../../apps/files_sharing/src/utils/SharedWithMe.js","../../apps/files_sharing/src/models/Share.js","../../apps/files_sharing/src/mixins/ShareTypes.js","../../apps/files_sharing/src/components/SharingEntrySimple.vue","../../apps/files_sharing/src/components/SharingEntryInternal.vue","../../apps/files_sharing/src/utils/GeneratePassword.js","../../node_modules/url-search-params-polyfill/index.js","../../apps/files_sharing/src/mixins/ShareRequests.js","../../apps/files_sharing/src/mixins/ShareDetails.js","../../apps/files_sharing/src/components/SharingInput.vue","../../apps/files_sharing/src/lib/SharePermissionsToolBox.js","../../apps/files_sharing/src/mixins/SharesMixin.js","../../apps/files_sharing/src/components/SharingEntryInherited.vue","../../apps/files_sharing/src/views/SharingInherited.vue","../../apps/files_sharing/src/components/SharingEntryQuickShareSelect.vue","../../apps/files_sharing/src/components/ExternalShareAction.vue","../../apps/files_sharing/src/components/SharingEntryLink.vue","../../apps/files_sharing/src/views/SharingLinkList.vue","../../apps/files_sharing/src/components/SharingEntry.vue","../../apps/files_sharing/src/views/SharingList.vue","../../apps/files_sharing/src/views/SharingDetailsTab.vue","../../apps/files_sharing/src/views/SharingTab.vue"],"sourcesContent":["/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.generateUrl = exports.generateRemoteUrl = exports.generateOcsUrl = exports.generateFilePath = void 0;\nexports.getAppRootUrl = getAppRootUrl;\nexports.getRootUrl = getRootUrl;\nexports.linkTo = exports.imagePath = void 0;\nrequire(\"core-js/modules/es.string.replace.js\");\n/**\n * Get an url with webroot to a file in an app\n *\n * @param {string} app the id of the app the file belongs to\n * @param {string} file the file path relative to the app folder\n * @return {string} URL with webroot to a file\n */\nconst linkTo = (app, file) => generateFilePath(app, '', file);\n\n/**\n * Creates a relative url for remote use\n *\n * @param {string} service id\n * @return {string} the url\n */\nexports.linkTo = linkTo;\nconst linkToRemoteBase = service => getRootUrl() + '/remote.php/' + service;\n\n/**\n * @brief Creates an absolute url for remote use\n * @param {string} service id\n * @return {string} the url\n */\nconst generateRemoteUrl = service => window.location.protocol + '//' + window.location.host + linkToRemoteBase(service);\n\n/**\n * Get the base path for the given OCS API service\n *\n * @param {string} url OCS API service url\n * @param {object} params parameters to be replaced into the service url\n * @param {UrlOptions} options options for the parameter replacement\n * @param {boolean} options.escape Set to false if parameters should not be URL encoded (default true)\n * @param {Number} options.ocsVersion OCS version to use (defaults to 2)\n * @return {string} Absolute path for the OCS URL\n */\nexports.generateRemoteUrl = generateRemoteUrl;\nconst generateOcsUrl = (url, params, options) => {\n  const allOptions = Object.assign({\n    ocsVersion: 2\n  }, options || {});\n  const version = allOptions.ocsVersion === 1 ? 1 : 2;\n  return window.location.protocol + '//' + window.location.host + getRootUrl() + '/ocs/v' + version + '.php' + _generateUrlPath(url, params, options);\n};\nexports.generateOcsUrl = generateOcsUrl;\n/**\n * Generate a url path, which can contain parameters\n *\n * Parameters will be URL encoded automatically\n *\n * @param {string} url address (can contain placeholders e.g. /call/{token} would replace {token} with the value of params.token\n * @param {object} params parameters to be replaced into the address\n * @param {UrlOptions} options options for the parameter replacement\n * @return {string} Path part for the given URL\n */\nconst _generateUrlPath = (url, params, options) => {\n  const allOptions = Object.assign({\n    escape: true\n  }, options || {});\n  const _build = function (text, vars) {\n    vars = vars || {};\n    return text.replace(/{([^{}]*)}/g, function (a, b) {\n      var r = vars[b];\n      if (allOptions.escape) {\n        return typeof r === 'string' || typeof r === 'number' ? encodeURIComponent(r.toString()) : encodeURIComponent(a);\n      } else {\n        return typeof r === 'string' || typeof r === 'number' ? r.toString() : a;\n      }\n    });\n  };\n  if (url.charAt(0) !== '/') {\n    url = '/' + url;\n  }\n  return _build(url, params || {});\n};\n\n/**\n * Generate the url with webroot for the given relative url, which can contain parameters\n *\n * Parameters will be URL encoded automatically\n *\n * @param {string} url address (can contain placeholders e.g. /call/{token} would replace {token} with the value of params.token\n * @param {object} params parameters to be replaced into the url\n * @param {UrlOptions} options options for the parameter replacement\n * @param {boolean} options.noRewrite True if you want to force index.php being added\n * @param {boolean} options.escape Set to false if parameters should not be URL encoded (default true)\n * @return {string} URL with webroot for the given relative URL\n */\nconst generateUrl = (url, params, options) => {\n  var _window;\n  const allOptions = Object.assign({\n    noRewrite: false\n  }, options || {});\n  if (((_window = window) === null || _window === void 0 || (_window = _window.OC) === null || _window === void 0 || (_window = _window.config) === null || _window === void 0 ? void 0 : _window.modRewriteWorking) === true && !allOptions.noRewrite) {\n    return getRootUrl() + _generateUrlPath(url, params, options);\n  }\n  return getRootUrl() + '/index.php' + _generateUrlPath(url, params, options);\n};\n\n/**\n * Get the path with webroot to an image file\n * if no extension is given for the image, it will automatically decide\n * between .png and .svg based on what the browser supports\n *\n * @param {string} app the app id to which the image belongs\n * @param {string} file the name of the image file\n * @return {string}\n */\nexports.generateUrl = generateUrl;\nconst imagePath = (app, file) => {\n  if (file.indexOf('.') === -1) {\n    //if no extension is given, use svg\n    return generateFilePath(app, 'img', file + '.svg');\n  }\n  return generateFilePath(app, 'img', file);\n};\n\n/**\n * Get the url with webroot for a file in an app\n *\n * @param {string} app the id of the app\n * @param {string} type the type of the file to link to (e.g. css,img,ajax.template)\n * @param {string} file the filename\n * @return {string} URL with webroot for a file in an app\n */\nexports.imagePath = imagePath;\nconst generateFilePath = (app, type, file) => {\n  var _window2;\n  const isCore = ((_window2 = window) === null || _window2 === void 0 || (_window2 = _window2.OC) === null || _window2 === void 0 || (_window2 = _window2.coreApps) === null || _window2 === void 0 ? void 0 : _window2.indexOf(app)) !== -1;\n  let link = getRootUrl();\n  if (file.substring(file.length - 3) === 'php' && !isCore) {\n    link += '/index.php/apps/' + app;\n    if (file !== 'index.php') {\n      link += '/';\n      if (type) {\n        link += encodeURI(type + '/');\n      }\n      link += file;\n    }\n  } else if (file.substring(file.length - 3) !== 'php' && !isCore) {\n    link = getAppRootUrl(app);\n    if (type) {\n      link += '/' + type + '/';\n    }\n    if (link.substring(link.length - 1) !== '/') {\n      link += '/';\n    }\n    link += file;\n  } else {\n    if ((app === 'settings' || app === 'core' || app === 'search') && type === 'ajax') {\n      link += '/index.php/';\n    } else {\n      link += '/';\n    }\n    if (!isCore) {\n      link += 'apps/';\n    }\n    if (app !== '') {\n      app += '/';\n      link += app;\n    }\n    if (type) {\n      link += type + '/';\n    }\n    link += file;\n  }\n  return link;\n};\n\n/**\n * Return the web root path where this Nextcloud instance\n * is accessible, with a leading slash.\n * For example \"/nextcloud\".\n *\n * @return {string} web root path\n */\nexports.generateFilePath = generateFilePath;\nfunction getRootUrl() {\n  let webroot = window._oc_webroot;\n  if (typeof webroot === 'undefined') {\n    webroot = location.pathname;\n    const pos = webroot.indexOf('/index.php/');\n    if (pos !== -1) {\n      webroot = webroot.substr(0, pos);\n    } else {\n      webroot = webroot.substr(0, webroot.lastIndexOf('/'));\n    }\n  }\n  return webroot;\n}\n\n/**\n * Return the web root path for a given app\n * @param {string} app The ID of the app\n */\nfunction getAppRootUrl(app) {\n  var _window$_oc_appswebro, _webroots$app;\n  const webroots = (_window$_oc_appswebro = window._oc_appswebroots) !== null && _window$_oc_appswebro !== void 0 ? _window$_oc_appswebro : {};\n  return (_webroots$app = webroots[app]) !== null && _webroots$app !== void 0 ? _webroots$app : '';\n}\n//# sourceMappingURL=index.js.map","import './assets/index-Au1Gr_G6.css';\nimport w from \"@nextcloud/vue/dist/Components/NcAvatar.js\";\nimport O from \"@nextcloud/vue/dist/Components/NcSelect.js\";\nimport T from \"lodash-es/debounce.js\";\nimport S from \"@nextcloud/vue/dist/Components/NcActions.js\";\nimport k from \"@nextcloud/vue/dist/Components/NcActionButton.js\";\nimport A, { set as f } from \"vue\";\nimport $ from \"@nextcloud/axios\";\nimport { generateOcsUrl as d } from \"@nextcloud/router\";\n/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nclass D {\n  constructor() {\n    this.http = $;\n  }\n  listCollection(e) {\n    return this.http.get(d(\"collaboration/resources/collections/{collectionId}\", { collectionId: e }));\n  }\n  renameCollection(e, o) {\n    return this.http.put(d(\"collaboration/resources/collections/{collectionId}\", { collectionId: e }), {\n      collectionName: o\n    }).then((n) => n.data.ocs.data);\n  }\n  getCollectionsByResource(e, o) {\n    return this.http.get(d(\"collaboration/resources/{resourceType}/{resourceId}\", { resourceType: e, resourceId: o })).then((n) => n.data.ocs.data);\n  }\n  createCollection(e, o, n) {\n    return this.http.post(d(\"collaboration/resources/{resourceType}/{resourceId}\", { resourceType: e, resourceId: o }), {\n      name: n\n    }).then((r) => r.data.ocs.data);\n  }\n  addResource(e, o, n) {\n    return n = \"\" + n, this.http.post(d(\"collaboration/resources/collections/{collectionId}\", { collectionId: e }), {\n      resourceType: o,\n      resourceId: n\n    }).then((r) => r.data.ocs.data);\n  }\n  removeResource(e, o, n) {\n    return this.http.delete(d(\"collaboration/resources/collections/{collectionId}\", { collectionId: e }), { params: { resourceType: o, resourceId: n } }).then((r) => r.data.ocs.data);\n  }\n  search(e) {\n    return this.http.get(d(\"collaboration/resources/collections/search/{query}\", { query: e })).then((o) => o.data.ocs.data);\n  }\n}\nconst p = new D();\n/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nconst u = A.observable({\n  collections: []\n}), h = {\n  addCollections(s) {\n    f(u, \"collections\", s);\n  },\n  addCollection(s) {\n    u.collections.push(s);\n  },\n  removeCollection(s) {\n    f(u, \"collections\", u.collections.filter((e) => e.id !== s));\n  },\n  updateCollection(s) {\n    const e = u.collections.findIndex((o) => o.id === s.id);\n    e !== -1 ? f(u.collections, e, s) : u.collections.push(s);\n  }\n}, l = {\n  fetchCollectionsByResource({ resourceType: s, resourceId: e }) {\n    return p.getCollectionsByResource(s, e).then((o) => (h.addCollections(o), o));\n  },\n  createCollection({ baseResourceType: s, baseResourceId: e, resourceType: o, resourceId: n, name: r }) {\n    return p.createCollection(s, e, r).then((m) => {\n      h.addCollection(m), l.addResourceToCollection({\n        collectionId: m.id,\n        resourceType: o,\n        resourceId: n\n      });\n    });\n  },\n  renameCollection({ collectionId: s, name: e }) {\n    return p.renameCollection(s, e).then((o) => (h.updateCollection(o), o));\n  },\n  addResourceToCollection({ collectionId: s, resourceType: e, resourceId: o }) {\n    return p.addResource(s, e, o).then((n) => (h.updateCollection(n), n));\n  },\n  removeResource({ collectionId: s, resourceType: e, resourceId: o }) {\n    return p.removeResource(s, e, o).then((n) => {\n      n.resources.length > 0 ? h.updateCollection(n) : h.removeCollection(n);\n    });\n  },\n  search(s) {\n    return p.search(s);\n  }\n};\nfunction R(s, e, o, n, r, m, _, I) {\n  var i = typeof s == \"function\" ? s.options : s;\n  e && (i.render = e, i.staticRenderFns = o, i._compiled = !0), n && (i.functional = !0), m && (i._scopeId = \"data-v-\" + m);\n  var a;\n  if (_ ? (a = function(c) {\n    c = c || // cached call\n    this.$vnode && this.$vnode.ssrContext || // stateful\n    this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext, !c && typeof __VUE_SSR_CONTEXT__ < \"u\" && (c = __VUE_SSR_CONTEXT__), r && r.call(this, c), c && c._registeredComponents && c._registeredComponents.add(_);\n  }, i._ssrRegister = a) : r && (a = I ? function() {\n    r.call(\n      this,\n      (i.functional ? this.parent : this).$root.$options.shadowRoot\n    );\n  } : r), a)\n    if (i.functional) {\n      i._injectStyles = a;\n      var b = i.render;\n      i.render = function(N, v) {\n        return a.call(v), b(N, v);\n      };\n    } else {\n      var C = i.beforeCreate;\n      i.beforeCreate = C ? [].concat(C, a) : [a];\n    }\n  return {\n    exports: s,\n    options: i\n  };\n}\nconst B = {\n  name: \"CollectionListItem\",\n  components: {\n    NcAvatar: w,\n    NcActions: S,\n    NcActionButton: k\n  },\n  props: {\n    collection: {\n      type: Object,\n      default: null\n    }\n  },\n  data() {\n    return {\n      detailsOpen: !1,\n      newName: null,\n      error: {}\n    };\n  },\n  computed: {\n    getIcon() {\n      return (s) => [s.iconClass];\n    },\n    typeClass() {\n      return (s) => \"resource-type-\" + s.type;\n    },\n    limitedResources() {\n      return (s) => s.resources ? s.resources.slice(0, 2) : [];\n    },\n    iconUrl() {\n      return (s) => s.mimetype ? OC.MimeType.getIconUrl(s.mimetype) : s.iconUrl ? s.iconUrl : \"\";\n    }\n  },\n  methods: {\n    toggleDetails() {\n      this.detailsOpen = !this.detailsOpen;\n    },\n    showDetails() {\n      this.detailsOpen = !0;\n    },\n    hideDetails() {\n      this.detailsOpen = !1;\n    },\n    removeResource(s, e) {\n      l.removeResource({\n        collectionId: s.id,\n        resourceType: e.type,\n        resourceId: e.id\n      });\n    },\n    openRename() {\n      this.newName = this.collection.name;\n    },\n    renameCollection() {\n      if (this.newName === \"\") {\n        this.newName = null;\n        return;\n      }\n      l.renameCollection({\n        collectionId: this.collection.id,\n        name: this.newName\n      }).then((s) => {\n        this.newName = null;\n      }).catch((s) => {\n        this.$set(this.error, \"rename\", t(\"core\", \"Failed to rename the project\")), console.error(s), setTimeout(() => {\n          f(this.error, \"rename\", null);\n        }, 3e3);\n      });\n    }\n  }\n};\nvar E = function() {\n  var e = this, o = e._self._c;\n  return o(\"li\", { staticClass: \"collection-list-item\" }, [o(\"NcAvatar\", { staticClass: \"collection-avatar\", attrs: { \"display-name\": e.collection.name, \"allow-placeholder\": \"\" } }), e.newName === null ? o(\"span\", { staticClass: \"collection-item-name\", attrs: { title: \"\" }, on: { click: e.showDetails } }, [e._v(e._s(e.collection.name))]) : o(\"form\", { class: { shouldshake: e.error.rename }, on: { submit: function(n) {\n    return n.preventDefault(), e.renameCollection.apply(null, arguments);\n  } } }, [o(\"input\", { directives: [{ name: \"model\", rawName: \"v-model\", value: e.newName, expression: \"newName\" }], attrs: { type: \"text\", autocomplete: \"off\", autocapitalize: \"off\" }, domProps: { value: e.newName }, on: { input: function(n) {\n    n.target.composing || (e.newName = n.target.value);\n  } } }), o(\"input\", { staticClass: \"icon-confirm\", attrs: { type: \"submit\", value: \"\" } })]), !e.detailsOpen && e.newName === null ? o(\"div\", { staticClass: \"linked-icons\" }, e._l(e.limitedResources(e.collection), function(n) {\n    return o(\"a\", { key: n.type + \"|\" + n.id, class: e.typeClass(n), attrs: { title: n.name, href: n.link } }, [o(\"img\", { attrs: { src: e.iconUrl(n) } })]);\n  }), 0) : e._e(), e.newName === null ? o(\"span\", { staticClass: \"sharingOptionsGroup\" }, [o(\"NcActions\", [o(\"NcActionButton\", { attrs: { icon: \"icon-info\" }, on: { click: function(n) {\n    return n.preventDefault(), e.toggleDetails.apply(null, arguments);\n  } } }, [e._v(\" \" + e._s(e.detailsOpen ? e.t(\"core\", \"Hide details\") : e.t(\"core\", \"Show details\")) + \" \")]), o(\"NcActionButton\", { attrs: { icon: \"icon-rename\" }, on: { click: function(n) {\n    return n.preventDefault(), e.openRename.apply(null, arguments);\n  } } }, [e._v(\" \" + e._s(e.t(\"core\", \"Rename project\")) + \" \")])], 1)], 1) : e._e(), o(\"transition\", { attrs: { name: \"fade\" } }, [e.error.rename ? o(\"div\", { staticClass: \"error\" }, [e._v(\" \" + e._s(e.error.rename) + \" \")]) : e._e()]), o(\"transition\", { attrs: { name: \"fade\" } }, [e.detailsOpen ? o(\"ul\", { staticClass: \"resource-list-details\" }, e._l(e.collection.resources, function(n) {\n    return o(\"li\", { key: n.type + \"|\" + n.id, class: e.typeClass(n) }, [o(\"a\", { attrs: { href: n.link } }, [o(\"img\", { attrs: { src: e.iconUrl(n) } }), o(\"span\", { staticClass: \"resource-name\" }, [e._v(e._s(n.name || \"\"))])]), o(\"span\", { staticClass: \"icon-close\", on: { click: function(r) {\n      return e.removeResource(e.collection, n);\n    } } })]);\n  }), 0) : e._e()])], 1);\n}, L = [], U = /* @__PURE__ */ R(\n  B,\n  E,\n  L,\n  !1,\n  null,\n  \"8e58e0a5\",\n  null,\n  null\n);\nconst j = U.exports, y = 0, g = 1, F = T(\n  function(s, e) {\n    s !== \"\" && (e(!0), l.search(s).then((o) => {\n      this.searchCollections = o;\n    }).catch((o) => {\n      console.error(\"Failed to search for collections\", o);\n    }).finally(() => {\n      e(!1);\n    }));\n  },\n  500,\n  {}\n), P = {\n  name: \"CollectionList\",\n  components: {\n    CollectionListItem: j,\n    NcAvatar: w,\n    NcSelect: O\n  },\n  props: {\n    /**\n     * Resource type identifier\n     */\n    type: {\n      type: String,\n      default: null\n    },\n    /**\n     * Unique id of the resource\n     */\n    id: {\n      type: String,\n      default: null\n    },\n    /**\n     * Name of the resource\n     */\n    name: {\n      type: String,\n      default: \"\"\n    },\n    isActive: {\n      type: Boolean,\n      default: !0\n    }\n  },\n  data() {\n    return {\n      selectIsOpen: !1,\n      generatingCodes: !1,\n      codes: void 0,\n      value: null,\n      model: {},\n      searchCollections: [],\n      error: null,\n      state: u,\n      isSelectOpen: !1\n    };\n  },\n  computed: {\n    collections() {\n      return this.state.collections.filter((s) => typeof s.resources.find((e) => e && e.id === \"\" + this.id && e.type === this.type) < \"u\");\n    },\n    placeholder() {\n      return this.isSelectOpen ? t(\"core\", \"Type to search for existing projects\") : t(\"core\", \"Add to a project\");\n    },\n    options() {\n      const s = [];\n      window.OCP.Collaboration.getTypes().sort().forEach((e) => {\n        s.push({\n          method: y,\n          type: e,\n          title: window.OCP.Collaboration.getLabel(e),\n          class: window.OCP.Collaboration.getIcon(e),\n          action: () => window.OCP.Collaboration.trigger(e)\n        });\n      });\n      for (const e in this.searchCollections)\n        this.collections.findIndex((o) => o.id === this.searchCollections[e].id) === -1 && s.push({\n          method: g,\n          title: this.searchCollections[e].name,\n          collectionId: this.searchCollections[e].id\n        });\n      return s;\n    }\n  },\n  watch: {\n    type() {\n      this.isActive && l.fetchCollectionsByResource({\n        resourceType: this.type,\n        resourceId: this.id\n      });\n    },\n    id() {\n      this.isActive && l.fetchCollectionsByResource({\n        resourceType: this.type,\n        resourceId: this.id\n      });\n    },\n    isActive(s) {\n      s && l.fetchCollectionsByResource({\n        resourceType: this.type,\n        resourceId: this.id\n      });\n    }\n  },\n  mounted() {\n    l.fetchCollectionsByResource({\n      resourceType: this.type,\n      resourceId: this.id\n    });\n  },\n  methods: {\n    select(s, e) {\n      s.method === y && s.action().then((o) => {\n        l.createCollection({\n          baseResourceType: this.type,\n          baseResourceId: this.id,\n          resourceType: s.type,\n          resourceId: o,\n          name: this.name\n        }).catch((n) => {\n          this.setError(t(\"core\", \"Failed to create a project\"), n);\n        });\n      }).catch((o) => {\n        console.error(\"No resource selected\", o);\n      }), s.method === g && l.addResourceToCollection({\n        collectionId: s.collectionId,\n        resourceType: this.type,\n        resourceId: this.id\n      }).catch((o) => {\n        this.setError(t(\"core\", \"Failed to add the item to the project\"), o);\n      });\n    },\n    search(s, e) {\n      F.bind(this)(s, e);\n    },\n    showSelect() {\n      this.selectIsOpen = !0, this.$refs.select.$el.focus();\n    },\n    hideSelect() {\n      this.selectIsOpen = !1;\n    },\n    isVueComponent(s) {\n      return s._isVue;\n    },\n    setError(s, e) {\n      console.error(s, e), this.error = s, setTimeout(() => {\n        this.error = null;\n      }, 5e3);\n    }\n  }\n};\nvar V = function() {\n  var e = this, o = e._self._c;\n  return e.collections && e.type && e.id ? o(\"ul\", { staticClass: \"collection-list\", attrs: { id: \"collection-list\" } }, [o(\"li\", { on: { click: e.showSelect } }, [e._m(0), o(\"div\", { attrs: { id: \"collection-select-container\" } }, [o(\"NcSelect\", { ref: \"select\", attrs: { \"aria-label-combobox\": e.t(\"core\", \"Add to a project\"), options: e.options, placeholder: e.placeholder, label: \"title\", limit: 5 }, on: { close: function(n) {\n    e.isSelectOpen = !1;\n  }, open: function(n) {\n    e.isSelectOpen = !0;\n  }, \"option:selected\": e.select, search: e.search }, scopedSlots: e._u([{ key: \"selected-option\", fn: function(n) {\n    return [o(\"span\", { staticClass: \"option__desc\" }, [o(\"span\", { staticClass: \"option__title\" }, [e._v(e._s(n.title))])])];\n  } }, { key: \"option\", fn: function(n) {\n    return [o(\"span\", { staticClass: \"option__wrapper\" }, [n.class ? o(\"span\", { staticClass: \"avatar\", class: n.class }) : n.method !== 2 ? o(\"NcAvatar\", { attrs: { \"allow-placeholder\": \"\", \"display-name\": n.title } }) : e._e(), o(\"span\", { staticClass: \"option__title\" }, [e._v(e._s(n.title))])], 1)];\n  } }], null, !1, 2397208459), model: { value: e.value, callback: function(n) {\n    e.value = n;\n  }, expression: \"value\" } }, [o(\"p\", { staticClass: \"hint\" }, [e._v(\" \" + e._s(e.t(\"core\", \"Connect items to a project to make them easier to find\")) + \" \")])])], 1)]), o(\"transition\", { attrs: { name: \"fade\" } }, [e.error ? o(\"li\", { staticClass: \"error\" }, [e._v(\" \" + e._s(e.error) + \" \")]) : e._e()]), e._l(e.collections, function(n) {\n    return o(\"CollectionListItem\", { key: n.id, attrs: { collection: n } });\n  })], 2) : e._e();\n}, x = [function() {\n  var s = this, e = s._self._c;\n  return e(\"div\", { staticClass: \"avatar\" }, [e(\"span\", { staticClass: \"icon-projects\" })]);\n}], H = /* @__PURE__ */ R(\n  P,\n  V,\n  x,\n  !1,\n  null,\n  \"75a4370b\",\n  null,\n  null\n);\nconst Q = H.exports;\nexport {\n  Q as CollectionList,\n  j as CollectionListItem\n};\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\nimport { getCapabilities } from '@nextcloud/capabilities'\n\nexport default class Config {\n\n\tconstructor() {\n\t\tthis._capabilities = getCapabilities()\n\t}\n\n\t/**\n\t * Get default share permissions, if any\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\t get defaultPermissions() {\n\t\treturn this._capabilities.files_sharing?.default_permissions\n\t}\n\n\t/**\n\t * Is public upload allowed on link shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isPublicUploadEnabled() {\n\t\treturn this._capabilities.files_sharing?.public.upload\n\t}\n\n\t/**\n\t * Are link share allowed ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isShareWithLinkAllowed() {\n\t\treturn document.getElementById('allowShareWithLink')\n\t\t\t&& document.getElementById('allowShareWithLink').value === 'yes'\n\t}\n\n\t/**\n\t * Get the federated sharing documentation link\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget federatedShareDocLink() {\n\t\treturn OC.appConfig.core.federatedCloudShareDoc\n\t}\n\n\t/**\n\t * Get the default link share expiration date\n\t *\n\t * @return {Date|null}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultExpirationDate() {\n\t\tif (this.isDefaultExpireDateEnabled) {\n\t\t\treturn new Date(new Date().setDate(new Date().getDate() + this.defaultExpireDate))\n\t\t}\n\t\treturn null\n\t}\n\n\t/**\n\t * Get the default internal expiration date\n\t *\n\t * @return {Date|null}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultInternalExpirationDate() {\n\t\tif (this.isDefaultInternalExpireDateEnabled) {\n\t\t\treturn new Date(new Date().setDate(new Date().getDate() + this.defaultInternalExpireDate))\n\t\t}\n\t\treturn null\n\t}\n\n\t/**\n\t * Get the default remote expiration date\n\t *\n\t * @return {Date|null}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultRemoteExpirationDateString() {\n\t\tif (this.isDefaultRemoteExpireDateEnabled) {\n\t\t\treturn new Date(new Date().setDate(new Date().getDate() + this.defaultRemoteExpireDate))\n\t\t}\n\t\treturn null\n\t}\n\n\t/**\n\t * Are link shares password-enforced ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget enforcePasswordForPublicLink() {\n\t\treturn OC.appConfig.core.enforcePasswordForPublicLink === true\n\t}\n\n\t/**\n\t * Is password asked by default on link shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget enableLinkPasswordByDefault() {\n\t\treturn OC.appConfig.core.enableLinkPasswordByDefault === true\n\t}\n\n\t/**\n\t * Is link shares expiration enforced ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultExpireDateEnforced() {\n\t\treturn OC.appConfig.core.defaultExpireDateEnforced === true\n\t}\n\n\t/**\n\t * Is there a default expiration date for new link shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultExpireDateEnabled() {\n\t\treturn OC.appConfig.core.defaultExpireDateEnabled === true\n\t}\n\n\t/**\n\t * Is internal shares expiration enforced ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultInternalExpireDateEnforced() {\n\t\treturn OC.appConfig.core.defaultInternalExpireDateEnforced === true\n\t}\n\n\t/**\n\t * Is remote shares expiration enforced ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultRemoteExpireDateEnforced() {\n\t\treturn OC.appConfig.core.defaultRemoteExpireDateEnforced === true\n\t}\n\n\t/**\n\t * Is there a default expiration date for new internal shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultInternalExpireDateEnabled() {\n\t\treturn OC.appConfig.core.defaultInternalExpireDateEnabled === true\n\t}\n\n\t/**\n\t * Is there a default expiration date for new remote shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isDefaultRemoteExpireDateEnabled() {\n\t\treturn OC.appConfig.core.defaultRemoteExpireDateEnabled === true\n\t}\n\n\t/**\n\t * Are users on this server allowed to send shares to other servers ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isRemoteShareAllowed() {\n\t\treturn OC.appConfig.core.remoteShareAllowed === true\n\t}\n\n\t/**\n\t * Is sharing my mail (link share) enabled ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isMailShareAllowed() {\n\t\t// eslint-disable-next-line camelcase\n\t\treturn this._capabilities?.files_sharing?.sharebymail !== undefined\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\t&& this._capabilities?.files_sharing?.public?.enabled === true\n\t}\n\n\t/**\n\t * Get the default days to link shares expiration\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultExpireDate() {\n\t\treturn OC.appConfig.core.defaultExpireDate\n\t}\n\n\t/**\n\t * Get the default days to internal shares expiration\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultInternalExpireDate() {\n\t\treturn OC.appConfig.core.defaultInternalExpireDate\n\t}\n\n\t/**\n\t * Get the default days to remote shares expiration\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget defaultRemoteExpireDate() {\n\t\treturn OC.appConfig.core.defaultRemoteExpireDate\n\t}\n\n\t/**\n\t * Is resharing allowed ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isResharingAllowed() {\n\t\treturn OC.appConfig.core.resharingAllowed === true\n\t}\n\n\t/**\n\t * Is password enforced for mail shares ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget isPasswordForMailSharesRequired() {\n\t\treturn (this._capabilities.files_sharing.sharebymail === undefined) ? false : this._capabilities.files_sharing.sharebymail.password.enforced\n\t}\n\n\t/**\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget shouldAlwaysShowUnique() {\n\t\treturn (this._capabilities.files_sharing?.sharee?.always_show_unique === true)\n\t}\n\n\t/**\n\t * Is sharing with groups allowed ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget allowGroupSharing() {\n\t\treturn OC.appConfig.core.allowGroupSharing === true\n\t}\n\n\t/**\n\t * Get the maximum results of a share search\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget maxAutocompleteResults() {\n\t\treturn parseInt(OC.config['sharing.maxAutocompleteResults'], 10) || 25\n\t}\n\n\t/**\n\t * Get the minimal string length\n\t * to initiate a share search\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget minSearchStringLength() {\n\t\treturn parseInt(OC.config['sharing.minSearchStringLength'], 10) || 0\n\t}\n\n\t/**\n\t * Get the password policy config\n\t *\n\t * @return {object}\n\t * @readonly\n\t * @memberof Config\n\t */\n\tget passwordPolicy() {\n\t\treturn this._capabilities.password_policy ? this._capabilities.password_policy : {}\n\t}\n\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { Type as ShareTypes } from '@nextcloud/sharing'\n\nconst shareWithTitle = function(share) {\n\tif (share.type === ShareTypes.SHARE_TYPE_GROUP) {\n\t\treturn t(\n\t\t\t'files_sharing',\n\t\t\t'Shared with you and the group {group} by {owner}',\n\t\t\t{\n\t\t\t\tgroup: share.shareWithDisplayName,\n\t\t\t\towner: share.ownerDisplayName,\n\t\t\t},\n\t\t\tundefined,\n\t\t\t{ escape: false },\n\t\t)\n\t} else if (share.type === ShareTypes.SHARE_TYPE_CIRCLE) {\n\t\treturn t(\n\t\t\t'files_sharing',\n\t\t\t'Shared with you and {circle} by {owner}',\n\t\t\t{\n\t\t\t\tcircle: share.shareWithDisplayName,\n\t\t\t\towner: share.ownerDisplayName,\n\t\t\t},\n\t\t\tundefined,\n\t\t\t{ escape: false },\n\t\t)\n\t} else if (share.type === ShareTypes.SHARE_TYPE_ROOM) {\n\t\tif (share.shareWithDisplayName) {\n\t\t\treturn t(\n\t\t\t\t'files_sharing',\n\t\t\t\t'Shared with you and the conversation {conversation} by {owner}',\n\t\t\t\t{\n\t\t\t\t\tconversation: share.shareWithDisplayName,\n\t\t\t\t\towner: share.ownerDisplayName,\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\t{ escape: false },\n\t\t\t)\n\t\t} else {\n\t\t\treturn t(\n\t\t\t\t'files_sharing',\n\t\t\t\t'Shared with you in a conversation by {owner}',\n\t\t\t\t{\n\t\t\t\t\towner: share.ownerDisplayName,\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\t{ escape: false },\n\t\t\t)\n\t\t}\n\t} else {\n\t\treturn t(\n\t\t\t'files_sharing',\n\t\t\t'Shared with you by {owner}',\n\t\t\t{ owner: share.ownerDisplayName },\n\t\t\tundefined,\n\t\t\t{ escape: false },\n\t\t)\n\t}\n}\n\nexport { shareWithTitle }\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nexport default class Share {\n\n\t_share\n\n\t/**\n\t * Create the share object\n\t *\n\t * @param {object} ocsData ocs request response\n\t */\n\tconstructor(ocsData) {\n\t\tif (ocsData.ocs && ocsData.ocs.data && ocsData.ocs.data[0]) {\n\t\t\tocsData = ocsData.ocs.data[0]\n\t\t}\n\n\t\t// convert int into boolean\n\t\tocsData.hide_download = !!ocsData.hide_download\n\t\tocsData.mail_send = !!ocsData.mail_send\n\n\t\tif (ocsData.attributes && typeof ocsData.attributes === 'string') {\n\t\t\ttry {\n\t\t\t\tocsData.attributes = JSON.parse(ocsData.attributes)\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('Could not parse share attributes returned by server', ocsData.attributes)\n\t\t\t}\n\t\t}\n\t\tocsData.attributes = ocsData.attributes ?? []\n\n\t\t// store state\n\t\tthis._share = ocsData\n\t}\n\n\t/**\n\t * Get the share state\n\t * ! used for reactivity purpose\n\t * Do not remove. It allow vuejs to\n\t * inject its watchers into the #share\n\t * state and make the whole class reactive\n\t *\n\t * @return {object} the share raw state\n\t * @readonly\n\t * @memberof Sidebar\n\t */\n\tget state() {\n\t\treturn this._share\n\t}\n\n\t/**\n\t * get the share id\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget id() {\n\t\treturn this._share.id\n\t}\n\n\t/**\n\t * Get the share type\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget type() {\n\t\treturn this._share.share_type\n\t}\n\n\t/**\n\t * Get the share permissions\n\t * See OC.PERMISSION_* variables\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget permissions() {\n\t\treturn this._share.permissions\n\t}\n\n\t/**\n\t * Get the share attributes\n\t *\n\t * @return {Array}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget attributes() {\n\t\treturn this._share.attributes\n\t}\n\n\t/**\n\t * Set the share permissions\n\t * See OC.PERMISSION_* variables\n\t *\n\t * @param {number} permissions valid permission, See OC.PERMISSION_* variables\n\t * @memberof Share\n\t */\n\tset permissions(permissions) {\n\t\tthis._share.permissions = permissions\n\t}\n\n\t// SHARE OWNER --------------------------------------------------\n\t/**\n\t * Get the share owner uid\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget owner() {\n\t\treturn this._share.uid_owner\n\t}\n\n\t/**\n\t * Get the share owner's display name\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget ownerDisplayName() {\n\t\treturn this._share.displayname_owner\n\t}\n\n\t// SHARED WITH --------------------------------------------------\n\t/**\n\t * Get the share with entity uid\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget shareWith() {\n\t\treturn this._share.share_with\n\t}\n\n\t/**\n\t * Get the share with entity display name\n\t * fallback to its uid if none\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget shareWithDisplayName() {\n\t\treturn this._share.share_with_displayname\n\t\t\t|| this._share.share_with\n\t}\n\n\t/**\n\t * Unique display name in case of multiple\n\t * duplicates results with the same name.\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget shareWithDisplayNameUnique() {\n\t\treturn this._share.share_with_displayname_unique\n\t\t\t|| this._share.share_with\n\t}\n\n\t/**\n\t * Get the share with entity link\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget shareWithLink() {\n\t\treturn this._share.share_with_link\n\t}\n\n\t/**\n\t * Get the share with avatar if any\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget shareWithAvatar() {\n\t\treturn this._share.share_with_avatar\n\t}\n\n\t// SHARED FILE OR FOLDER OWNER ----------------------------------\n\t/**\n\t * Get the shared item owner uid\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget uidFileOwner() {\n\t\treturn this._share.uid_file_owner\n\t}\n\n\t/**\n\t * Get the shared item display name\n\t * fallback to its uid if none\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget displaynameFileOwner() {\n\t\treturn this._share.displayname_file_owner\n\t\t\t|| this._share.uid_file_owner\n\t}\n\n\t// TIME DATA ----------------------------------------------------\n\t/**\n\t * Get the share creation timestamp\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget createdTime() {\n\t\treturn this._share.stime\n\t}\n\n\t/**\n\t * Get the expiration date\n\t *\n\t * @return {string} date with YYYY-MM-DD format\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget expireDate() {\n\t\treturn this._share.expiration\n\t}\n\n\t/**\n\t * Set the expiration date\n\t *\n\t * @param {string} date the share expiration date with YYYY-MM-DD format\n\t * @memberof Share\n\t */\n\tset expireDate(date) {\n\t\tthis._share.expiration = date\n\t}\n\n\t// EXTRA DATA ---------------------------------------------------\n\t/**\n\t * Get the public share token\n\t *\n\t * @return {string} the token\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget token() {\n\t\treturn this._share.token\n\t}\n\n\t/**\n\t * Get the share note if any\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget note() {\n\t\treturn this._share.note\n\t}\n\n\t/**\n\t * Set the share note if any\n\t *\n\t * @param {string} note the note\n\t * @memberof Share\n\t */\n\tset note(note) {\n\t\tthis._share.note = note\n\t}\n\n\t/**\n\t * Get the share label if any\n\t * Should only exist on link shares\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget label() {\n\t\treturn this._share.label ?? ''\n\t}\n\n\t/**\n\t * Set the share label if any\n\t * Should only be set on link shares\n\t *\n\t * @param {string} label the label\n\t * @memberof Share\n\t */\n\tset label(label) {\n\t\tthis._share.label = label\n\t}\n\n\t/**\n\t * Have a mail been sent\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget mailSend() {\n\t\treturn this._share.mail_send === true\n\t}\n\n\t/**\n\t * Hide the download button on public page\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hideDownload() {\n\t\treturn this._share.hide_download === true\n\t}\n\n\t/**\n\t * Hide the download button on public page\n\t *\n\t * @param {boolean} state hide the button ?\n\t * @memberof Share\n\t */\n\tset hideDownload(state) {\n\t\tthis._share.hide_download = state === true\n\t}\n\n\t/**\n\t * Password protection of the share\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget password() {\n\t\treturn this._share.password\n\t}\n\n\t/**\n\t * Password protection of the share\n\t *\n\t * @param {string} password the share password\n\t * @memberof Share\n\t */\n\tset password(password) {\n\t\tthis._share.password = password\n\t}\n\n\t/**\n\t * Password expiration time\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget passwordExpirationTime() {\n\t\treturn this._share.password_expiration_time\n\t}\n\n\t/**\n\t * Password expiration time\n\t *\n\t * @param {string} password expiration time\n\t * @memberof Share\n\t */\n\tset passwordExpirationTime(passwordExpirationTime) {\n\t\tthis._share.password_expiration_time = passwordExpirationTime\n\t}\n\n\t/**\n\t * Password protection by Talk of the share\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget sendPasswordByTalk() {\n\t\treturn this._share.send_password_by_talk\n\t}\n\n\t/**\n\t * Password protection by Talk of the share\n\t *\n\t * @param {boolean} sendPasswordByTalk whether to send the password by Talk\n\t *        or not\n\t * @memberof Share\n\t */\n\tset sendPasswordByTalk(sendPasswordByTalk) {\n\t\tthis._share.send_password_by_talk = sendPasswordByTalk\n\t}\n\n\t// SHARED ITEM DATA ---------------------------------------------\n\t/**\n\t * Get the shared item absolute full path\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget path() {\n\t\treturn this._share.path\n\t}\n\n\t/**\n\t * Return the item type: file or folder\n\t *\n\t * @return {string} 'folder' or 'file'\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget itemType() {\n\t\treturn this._share.item_type\n\t}\n\n\t/**\n\t * Get the shared item mimetype\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget mimetype() {\n\t\treturn this._share.mimetype\n\t}\n\n\t/**\n\t * Get the shared item id\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget fileSource() {\n\t\treturn this._share.file_source\n\t}\n\n\t/**\n\t * Get the target path on the receiving end\n\t * e.g the file /xxx/aaa will be shared in\n\t * the receiving root as /aaa, the fileTarget is /aaa\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget fileTarget() {\n\t\treturn this._share.file_target\n\t}\n\n\t/**\n\t * Get the parent folder id if any\n\t *\n\t * @return {number}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget fileParent() {\n\t\treturn this._share.file_parent\n\t}\n\n\t// PERMISSIONS Shortcuts\n\n\t/**\n\t * Does this share have READ permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasReadPermission() {\n\t\treturn !!((this.permissions & OC.PERMISSION_READ))\n\t}\n\n\t/**\n\t * Does this share have CREATE permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasCreatePermission() {\n\t\treturn !!((this.permissions & OC.PERMISSION_CREATE))\n\t}\n\n\t/**\n\t * Does this share have DELETE permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasDeletePermission() {\n\t\treturn !!((this.permissions & OC.PERMISSION_DELETE))\n\t}\n\n\t/**\n\t * Does this share have UPDATE permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasUpdatePermission() {\n\t\treturn !!((this.permissions & OC.PERMISSION_UPDATE))\n\t}\n\n\t/**\n\t * Does this share have SHARE permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasSharePermission() {\n\t\treturn !!((this.permissions & OC.PERMISSION_SHARE))\n\t}\n\n\t/**\n\t * Does this share have download permissions\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget hasDownloadPermission() {\n\t\tfor (const i in this._share.attributes) {\n\t\t\tconst attr = this._share.attributes[i]\n\t\t\tif (attr.scope === 'permissions' && attr.key === 'download') {\n\t\t\t\treturn attr.enabled\n\t\t\t}\n\t\t}\n\n\t\treturn true\n\t}\n\n\tset hasDownloadPermission(enabled) {\n\t\tthis.setAttribute('permissions', 'download', !!enabled)\n\t}\n\n\tsetAttribute(scope, key, enabled) {\n\t\tconst attrUpdate = {\n\t\t\tscope,\n\t\t\tkey,\n\t\t\tenabled,\n\t\t}\n\n\t\t// try and replace existing\n\t\tfor (const i in this._share.attributes) {\n\t\t\tconst attr = this._share.attributes[i]\n\t\t\tif (attr.scope === attrUpdate.scope && attr.key === attrUpdate.key) {\n\t\t\t\tthis._share.attributes.splice(i, 1, attrUpdate)\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tthis._share.attributes.push(attrUpdate)\n\t}\n\n\t// PERMISSIONS Shortcuts for the CURRENT USER\n\t// ! the permissions above are the share settings,\n\t// ! meaning the permissions for the recipient\n\t/**\n\t * Can the current user EDIT this share ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget canEdit() {\n\t\treturn this._share.can_edit === true\n\t}\n\n\t/**\n\t * Can the current user DELETE this share ?\n\t *\n\t * @return {boolean}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget canDelete() {\n\t\treturn this._share.can_delete === true\n\t}\n\n\t/**\n\t * Top level accessible shared folder fileid for the current user\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget viaFileid() {\n\t\treturn this._share.via_fileid\n\t}\n\n\t/**\n\t * Top level accessible shared folder path for the current user\n\t *\n\t * @return {string}\n\t * @readonly\n\t * @memberof Share\n\t */\n\tget viaPath() {\n\t\treturn this._share.via_path\n\t}\n\n\t// TODO: SORT THOSE PROPERTIES\n\n\tget parent() {\n\t\treturn this._share.parent\n\t}\n\n\tget storageId() {\n\t\treturn this._share.storage_id\n\t}\n\n\tget storage() {\n\t\treturn this._share.storage\n\t}\n\n\tget itemSource() {\n\t\treturn this._share.item_source\n\t}\n\n\tget status() {\n\t\treturn this._share.status\n\t}\n\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { Type as ShareTypes } from '@nextcloud/sharing'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tSHARE_TYPES: ShareTypes,\n\t\t}\n\t},\n}\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<li class=\"sharing-entry\">\n\t\t<slot name=\"avatar\" />\n\t\t<div class=\"sharing-entry__desc\">\n\t\t\t<span class=\"sharing-entry__title\">{{ title }}</span>\n\t\t\t<p v-if=\"subtitle\">\n\t\t\t\t{{ subtitle }}\n\t\t\t</p>\n\t\t</div>\n\t\t<NcActions v-if=\"$slots['default']\"\n\t\t\tref=\"actionsComponent\"\n\t\t\tclass=\"sharing-entry__actions\"\n\t\t\tmenu-align=\"right\"\n\t\t\t:aria-expanded=\"ariaExpandedValue\">\n\t\t\t<slot />\n\t\t</NcActions>\n\t</li>\n</template>\n\n<script>\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\n\nexport default {\n\tname: 'SharingEntrySimple',\n\n\tcomponents: {\n\t\tNcActions,\n\t},\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t\trequired: true,\n\t\t},\n\t\tsubtitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tisUnique: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tariaExpanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tariaExpandedValue() {\n\t\t\tif (this.ariaExpanded === null) {\n\t\t\t\treturn this.ariaExpanded\n\t\t\t}\n\t\t\treturn this.ariaExpanded ? 'true' : 'false'\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\tmin-height: 44px;\n\t&__desc {\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tline-height: 1.2em;\n\t\tposition: relative;\n\t\tflex: 1 1;\n\t\tmin-width: 0;\n\t\tp {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\t}\n\t&__title {\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t\toverflow: hidden;\n\t\tmax-width: inherit;\n\t}\n\t&__actions {\n\t\tmargin-left: auto !important;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<ul>\n\t\t<SharingEntrySimple ref=\"shareEntrySimple\"\n\t\t\tclass=\"sharing-entry__internal\"\n\t\t\t:title=\"t('files_sharing', 'Internal link')\"\n\t\t\t:subtitle=\"internalLinkSubtitle\">\n\t\t\t<template #avatar>\n\t\t\t\t<div class=\"avatar-external icon-external-white\" />\n\t\t\t</template>\n\n\t\t\t<NcActionButton :title=\"copyLinkTooltip\"\n\t\t\t\t:aria-label=\"copyLinkTooltip\"\n\t\t\t\t@click=\"copyLink\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<CheckIcon v-if=\"copied && copySuccess\"\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\tclass=\"icon-checkmark-color\" />\n\t\t\t\t\t<ClipboardIcon v-else :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t</NcActionButton>\n\t\t</SharingEntrySimple>\n\t</ul>\n</template>\n\n<script>\nimport { generateUrl } from '@nextcloud/router'\nimport { showSuccess } from '@nextcloud/dialogs'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\n\nimport CheckIcon from 'vue-material-design-icons/CheckBold.vue'\nimport ClipboardIcon from 'vue-material-design-icons/ClipboardFlow.vue'\n\nimport SharingEntrySimple from './SharingEntrySimple.vue'\n\nexport default {\n\tname: 'SharingEntryInternal',\n\n\tcomponents: {\n\t\tNcActionButton,\n\t\tSharingEntrySimple,\n\t\tCheckIcon,\n\t\tClipboardIcon,\n\t},\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tcopied: false,\n\t\t\tcopySuccess: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Get the internal link to this file id\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tinternalLink() {\n\t\t\treturn window.location.protocol + '//' + window.location.host + generateUrl('/f/') + this.fileInfo.id\n\t\t},\n\n\t\t/**\n\t\t * Tooltip message\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tcopyLinkTooltip() {\n\t\t\tif (this.copied) {\n\t\t\t\tif (this.copySuccess) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\treturn t('files_sharing', 'Cannot copy, please copy the link manually')\n\t\t\t}\n\t\t\treturn t('files_sharing', 'Copy internal link to clipboard')\n\t\t},\n\n\t\tinternalLinkSubtitle() {\n\t\t\tif (this.fileInfo.type === 'dir') {\n\t\t\t\treturn t('files_sharing', 'Only works for people with access to this folder')\n\t\t\t}\n\t\t\treturn t('files_sharing', 'Only works for people with access to this file')\n\t\t},\n\t},\n\n\tmethods: {\n\t\tasync copyLink() {\n\t\t\ttry {\n\t\t\t\tawait navigator.clipboard.writeText(this.internalLink)\n\t\t\t\tshowSuccess(t('files_sharing', 'Link copied'))\n\t\t\t\tthis.$refs.shareEntrySimple.$refs.actionsComponent.$el.focus()\n\t\t\t\tthis.copySuccess = true\n\t\t\t\tthis.copied = true\n\t\t\t} catch (error) {\n\t\t\t\tthis.copySuccess = false\n\t\t\t\tthis.copied = true\n\t\t\t\tconsole.error(error)\n\t\t\t} finally {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.copySuccess = false\n\t\t\t\t\tthis.copied = false\n\t\t\t\t}, 4000)\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry__internal {\n\t.avatar-external {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tline-height: 32px;\n\t\tfont-size: 18px;\n\t\tbackground-color: var(--color-text-maxcontrast);\n\t\tborder-radius: 50%;\n\t\tflex-shrink: 0;\n\t}\n\t.icon-checkmark-color {\n\t\topacity: 1;\n\t\tcolor: var(--color-success);\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2020 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport axios from '@nextcloud/axios'\nimport Config from '../services/ConfigService.js'\nimport { showError, showSuccess } from '@nextcloud/dialogs'\n\nconst config = new Config()\n// note: some chars removed on purpose to make them human friendly when read out\nconst passwordSet = 'abcdefgijkmnopqrstwxyzABCDEFGHJKLMNPQRSTWXYZ23456789'\n\n/**\n * Generate a valid policy password or\n * request a valid password if password_policy\n * is enabled\n *\n * @return {string} a valid password\n */\nexport default async function() {\n\t// password policy is enabled, let's request a pass\n\tif (config.passwordPolicy.api && config.passwordPolicy.api.generate) {\n\t\ttry {\n\t\t\tconst request = await axios.get(config.passwordPolicy.api.generate)\n\t\t\tif (request.data.ocs.data.password) {\n\t\t\t\tshowSuccess(t('files_sharing', 'Password created successfully'))\n\t\t\t\treturn request.data.ocs.data.password\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.info('Error generating password from password_policy', error)\n\t\t\tshowError(t('files_sharing', 'Error generating password from password policy'))\n\t\t}\n\t}\n\n\tconst array = new Uint8Array(10)\n\tconst ratio = passwordSet.length / 255\n\tself.crypto.getRandomValues(array)\n\tlet password = ''\n\tfor (let i = 0; i < array.length; i++) {\n\t\tpassword += passwordSet.charAt(array[i] * ratio)\n\t}\n\treturn password\n}\n","/**!\n * url-search-params-polyfill\n *\n * @author Jerry Bendy (https://github.com/jerrybendy)\n * @licence MIT\n */\n(function(self) {\n    'use strict';\n\n    var nativeURLSearchParams = (function() {\n            // #41 Fix issue in RN\n            try {\n                if (self.URLSearchParams && (new self.URLSearchParams('foo=bar')).get('foo') === 'bar') {\n                    return self.URLSearchParams;\n                }\n            } catch (e) {}\n            return null;\n        })(),\n        isSupportObjectConstructor = nativeURLSearchParams && (new nativeURLSearchParams({a: 1})).toString() === 'a=1',\n        // There is a bug in safari 10.1 (and earlier) that incorrectly decodes `%2B` as an empty space and not a plus.\n        decodesPlusesCorrectly = nativeURLSearchParams && (new nativeURLSearchParams('s=%2B').get('s') === '+'),\n        isSupportSize = nativeURLSearchParams && 'size' in nativeURLSearchParams.prototype,\n        __URLSearchParams__ = \"__URLSearchParams__\",\n        // Fix bug in Edge which cannot encode ' &' correctly\n        encodesAmpersandsCorrectly = nativeURLSearchParams ? (function() {\n            var ampersandTest = new nativeURLSearchParams();\n            ampersandTest.append('s', ' &');\n            return ampersandTest.toString() === 's=+%26';\n        })() : true,\n        prototype = URLSearchParamsPolyfill.prototype,\n        iterable = !!(self.Symbol && self.Symbol.iterator);\n\n    if (nativeURLSearchParams && isSupportObjectConstructor && decodesPlusesCorrectly && encodesAmpersandsCorrectly && isSupportSize) {\n        return;\n    }\n\n\n    /**\n     * Make a URLSearchParams instance\n     *\n     * @param {object|string|URLSearchParams} search\n     * @constructor\n     */\n    function URLSearchParamsPolyfill(search) {\n        search = search || \"\";\n\n        // support construct object with another URLSearchParams instance\n        if (search instanceof URLSearchParams || search instanceof URLSearchParamsPolyfill) {\n            search = search.toString();\n        }\n        this [__URLSearchParams__] = parseToDict(search);\n    }\n\n\n    /**\n     * Appends a specified key/value pair as a new search parameter.\n     *\n     * @param {string} name\n     * @param {string} value\n     */\n    prototype.append = function(name, value) {\n        appendTo(this [__URLSearchParams__], name, value);\n    };\n\n    /**\n     * Deletes the given search parameter, and its associated value,\n     * from the list of all search parameters.\n     *\n     * @param {string} name\n     */\n    prototype['delete'] = function(name) {\n        delete this [__URLSearchParams__] [name];\n    };\n\n    /**\n     * Returns the first value associated to the given search parameter.\n     *\n     * @param {string} name\n     * @returns {string|null}\n     */\n    prototype.get = function(name) {\n        var dict = this [__URLSearchParams__];\n        return this.has(name) ? dict[name][0] : null;\n    };\n\n    /**\n     * Returns all the values association with a given search parameter.\n     *\n     * @param {string} name\n     * @returns {Array}\n     */\n    prototype.getAll = function(name) {\n        var dict = this [__URLSearchParams__];\n        return this.has(name) ? dict [name].slice(0) : [];\n    };\n\n    /**\n     * Returns a Boolean indicating if such a search parameter exists.\n     *\n     * @param {string} name\n     * @returns {boolean}\n     */\n    prototype.has = function(name) {\n        return hasOwnProperty(this [__URLSearchParams__], name);\n    };\n\n    /**\n     * Sets the value associated to a given search parameter to\n     * the given value. If there were several values, delete the\n     * others.\n     *\n     * @param {string} name\n     * @param {string} value\n     */\n    prototype.set = function set(name, value) {\n        this [__URLSearchParams__][name] = ['' + value];\n    };\n\n    /**\n     * Returns a string containg a query string suitable for use in a URL.\n     *\n     * @returns {string}\n     */\n    prototype.toString = function() {\n        var dict = this[__URLSearchParams__], query = [], i, key, name, value;\n        for (key in dict) {\n            name = encode(key);\n            for (i = 0, value = dict[key]; i < value.length; i++) {\n                query.push(name + '=' + encode(value[i]));\n            }\n        }\n        return query.join('&');\n    };\n\n    // There is a bug in Safari 10.1 and `Proxy`ing it is not enough.\n    var useProxy = self.Proxy && nativeURLSearchParams && (!decodesPlusesCorrectly || !encodesAmpersandsCorrectly || !isSupportObjectConstructor || !isSupportSize);\n    var propValue;\n    if (useProxy) {\n        // Safari 10.0 doesn't support Proxy, so it won't extend URLSearchParams on safari 10.0\n        propValue = new Proxy(nativeURLSearchParams, {\n            construct: function (target, args) {\n                return new target((new URLSearchParamsPolyfill(args[0]).toString()));\n            }\n        })\n        // Chrome <=60 .toString() on a function proxy got error \"Function.prototype.toString is not generic\"\n        propValue.toString = Function.prototype.toString.bind(URLSearchParamsPolyfill);\n    } else {\n        propValue = URLSearchParamsPolyfill;\n    }\n\n    /*\n     * Apply polyfill to global object and append other prototype into it\n     */\n    Object.defineProperty(self, 'URLSearchParams', {\n        value: propValue\n    });\n\n    var USPProto = self.URLSearchParams.prototype;\n\n    USPProto.polyfill = true;\n\n    // Fix #54, `toString.call(new URLSearchParams)` will return correct value when Proxy not used\n    if (!useProxy && self.Symbol) {\n        USPProto[self.Symbol.toStringTag] = 'URLSearchParams';\n    }\n\n    /**\n     *\n     * @param {function} callback\n     * @param {object} thisArg\n     */\n    if (!('forEach' in USPProto)) {\n        USPProto.forEach = function(callback, thisArg) {\n            var dict = parseToDict(this.toString());\n            Object.getOwnPropertyNames(dict).forEach(function(name) {\n                dict[name].forEach(function(value) {\n                    callback.call(thisArg, value, name, this);\n                }, this);\n            }, this);\n        };\n    }\n\n    /**\n     * Sort all name-value pairs\n     */\n    if (!('sort' in USPProto)) {\n        USPProto.sort = function() {\n            var dict = parseToDict(this.toString()), keys = [], k, i, j;\n            for (k in dict) {\n                keys.push(k);\n            }\n            keys.sort();\n\n            for (i = 0; i < keys.length; i++) {\n                this['delete'](keys[i]);\n            }\n            for (i = 0; i < keys.length; i++) {\n                var key = keys[i], values = dict[key];\n                for (j = 0; j < values.length; j++) {\n                    this.append(key, values[j]);\n                }\n            }\n        };\n    }\n\n    /**\n     * Returns an iterator allowing to go through all keys of\n     * the key/value pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    if (!('keys' in USPProto)) {\n        USPProto.keys = function() {\n            var items = [];\n            this.forEach(function(item, name) {\n                items.push(name);\n            });\n            return makeIterator(items);\n        };\n    }\n\n    /**\n     * Returns an iterator allowing to go through all values of\n     * the key/value pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    if (!('values' in USPProto)) {\n        USPProto.values = function() {\n            var items = [];\n            this.forEach(function(item) {\n                items.push(item);\n            });\n            return makeIterator(items);\n        };\n    }\n\n    /**\n     * Returns an iterator allowing to go through all key/value\n     * pairs contained in this object.\n     *\n     * @returns {function}\n     */\n    if (!('entries' in USPProto)) {\n        USPProto.entries = function() {\n            var items = [];\n            this.forEach(function(item, name) {\n                items.push([name, item]);\n            });\n            return makeIterator(items);\n        };\n    }\n\n    if (iterable) {\n        USPProto[self.Symbol.iterator] = USPProto[self.Symbol.iterator] || USPProto.entries;\n    }\n\n    if (!('size' in USPProto)) {\n        Object.defineProperty(USPProto, 'size', {\n            get: function () {\n                var dict = parseToDict(this.toString())\n                if (USPProto === this) {\n                    throw new TypeError('Illegal invocation at URLSearchParams.invokeGetter')\n                }\n                return Object.keys(dict).reduce(function (prev, cur) {\n                    return prev + dict[cur].length;\n                }, 0);\n            }\n        });\n    }\n\n    function encode(str) {\n        var replace = {\n            '!': '%21',\n            \"'\": '%27',\n            '(': '%28',\n            ')': '%29',\n            '~': '%7E',\n            '%20': '+',\n            '%00': '\\x00'\n        };\n        return encodeURIComponent(str).replace(/[!'\\(\\)~]|%20|%00/g, function(match) {\n            return replace[match];\n        });\n    }\n\n    function decode(str) {\n        return str\n            .replace(/[ +]/g, '%20')\n            .replace(/(%[a-f0-9]{2})+/ig, function(match) {\n                return decodeURIComponent(match);\n            });\n    }\n\n    function makeIterator(arr) {\n        var iterator = {\n            next: function() {\n                var value = arr.shift();\n                return {done: value === undefined, value: value};\n            }\n        };\n\n        if (iterable) {\n            iterator[self.Symbol.iterator] = function() {\n                return iterator;\n            };\n        }\n\n        return iterator;\n    }\n\n    function parseToDict(search) {\n        var dict = {};\n\n        if (typeof search === \"object\") {\n            // if `search` is an array, treat it as a sequence\n            if (isArray(search)) {\n                for (var i = 0; i < search.length; i++) {\n                    var item = search[i];\n                    if (isArray(item) && item.length === 2) {\n                        appendTo(dict, item[0], item[1]);\n                    } else {\n                        throw new TypeError(\"Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements\");\n                    }\n                }\n\n            } else {\n                for (var key in search) {\n                    if (search.hasOwnProperty(key)) {\n                        appendTo(dict, key, search[key]);\n                    }\n                }\n            }\n\n        } else {\n            // remove first '?'\n            if (search.indexOf(\"?\") === 0) {\n                search = search.slice(1);\n            }\n\n            var pairs = search.split(\"&\");\n            for (var j = 0; j < pairs.length; j++) {\n                var value = pairs [j],\n                    index = value.indexOf('=');\n\n                if (-1 < index) {\n                    appendTo(dict, decode(value.slice(0, index)), decode(value.slice(index + 1)));\n\n                } else {\n                    if (value) {\n                        appendTo(dict, decode(value), '');\n                    }\n                }\n            }\n        }\n\n        return dict;\n    }\n\n    function appendTo(dict, name, value) {\n        var val = typeof value === 'string' ? value : (\n            value !== null && value !== undefined && typeof value.toString === 'function' ? value.toString() : JSON.stringify(value)\n        );\n\n        // #47 Prevent using `hasOwnProperty` as a property name\n        if (hasOwnProperty(dict, name)) {\n            dict[name].push(val);\n        } else {\n            dict[name] = [val];\n        }\n    }\n\n    function isArray(val) {\n        return !!val && '[object Array]' === Object.prototype.toString.call(val);\n    }\n\n    function hasOwnProperty(obj, prop) {\n        return Object.prototype.hasOwnProperty.call(obj, prop);\n    }\n\n})(typeof global !== 'undefined' ? global : (typeof window !== 'undefined' ? window : this));\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n// TODO: remove when ie not supported\nimport 'url-search-params-polyfill'\n\nimport { generateOcsUrl } from '@nextcloud/router'\nimport axios from '@nextcloud/axios'\nimport Share from '../models/Share.js'\nimport { emit } from '@nextcloud/event-bus'\n\nconst shareUrl = generateOcsUrl('apps/files_sharing/api/v1/shares')\n\nexport default {\n\tmethods: {\n\t\t/**\n\t\t * Create a new share\n\t\t *\n\t\t * @param {object} data destructuring object\n\t\t * @param {string} data.path  path to the file/folder which should be shared\n\t\t * @param {number} data.shareType  0 = user; 1 = group; 3 = public link; 6 = federated cloud share\n\t\t * @param {string} data.shareWith  user/group id with which the file should be shared (optional for shareType > 1)\n\t\t * @param {boolean} [data.publicUpload]  allow public upload to a public shared folder\n\t\t * @param {string} [data.password]  password to protect public link Share with\n\t\t * @param {number} [data.permissions]  1 = read; 2 = update; 4 = create; 8 = delete; 16 = share; 31 = all (default: 31, for public shares: 1)\n\t\t * @param {boolean} [data.sendPasswordByTalk] send the password via a talk conversation\n\t\t * @param {string} [data.expireDate] expire the shareautomatically after\n\t\t * @param {string} [data.label] custom label\n\t\t * @param {string} [data.attributes] Share attributes encoded as json\n\t\t * @param data.note\n\t\t * @return {Share} the new share\n\t\t * @throws {Error}\n\t\t */\n\t\tasync createShare({ path, permissions, shareType, shareWith, publicUpload, password, sendPasswordByTalk, expireDate, label, note, attributes }) {\n\t\t\ttry {\n\t\t\t\tconst request = await axios.post(shareUrl, { path, permissions, shareType, shareWith, publicUpload, password, sendPasswordByTalk, expireDate, label, note, attributes })\n\t\t\t\tif (!request?.data?.ocs) {\n\t\t\t\t\tthrow request\n\t\t\t\t}\n\t\t\t\tconst share = new Share(request.data.ocs.data)\n\t\t\t\temit('files_sharing:share:created', { share })\n\t\t\t\treturn share\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error while creating share', error)\n\t\t\t\tconst errorMessage = error?.response?.data?.ocs?.meta?.message\n\t\t\t\tOC.Notification.showTemporary(\n\t\t\t\t\terrorMessage ? t('files_sharing', 'Error creating the share: {errorMessage}', { errorMessage }) : t('files_sharing', 'Error creating the share'),\n\t\t\t\t\t{ type: 'error' },\n\t\t\t\t)\n\t\t\t\tthrow error\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Delete a share\n\t\t *\n\t\t * @param {number} id share id\n\t\t * @throws {Error}\n\t\t */\n\t\tasync deleteShare(id) {\n\t\t\ttry {\n\t\t\t\tconst request = await axios.delete(shareUrl + `/${id}`)\n\t\t\t\tif (!request?.data?.ocs) {\n\t\t\t\t\tthrow request\n\t\t\t\t}\n\t\t\t\temit('files_sharing:share:deleted', { id })\n\t\t\t\treturn true\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error while deleting share', error)\n\t\t\t\tconst errorMessage = error?.response?.data?.ocs?.meta?.message\n\t\t\t\tOC.Notification.showTemporary(\n\t\t\t\t\terrorMessage ? t('files_sharing', 'Error deleting the share: {errorMessage}', { errorMessage }) : t('files_sharing', 'Error deleting the share'),\n\t\t\t\t\t{ type: 'error' },\n\t\t\t\t)\n\t\t\t\tthrow error\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Update a share\n\t\t *\n\t\t * @param {number} id share id\n\t\t * @param {object} properties key-value object of the properties to update\n\t\t */\n\t\tasync updateShare(id, properties) {\n\t\t\ttry {\n\t\t\t\tconst request = await axios.put(shareUrl + `/${id}`, properties)\n\t\t\t\temit('files_sharing:share:updated', { id })\n\t\t\t\tif (!request?.data?.ocs) {\n\t\t\t\t\tthrow request\n\t\t\t\t} else {\n\t\t\t\t\treturn request.data.ocs.data\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error while updating share', error)\n\t\t\t\tif (error.response.status !== 400) {\n\t\t\t\t\tconst errorMessage = error?.response?.data?.ocs?.meta?.message\n\t\t\t\t\tOC.Notification.showTemporary(\n\t\t\t\t\t\terrorMessage ? t('files_sharing', 'Error updating the share: {errorMessage}', { errorMessage }) : t('files_sharing', 'Error updating the share'),\n\t\t\t\t\t\t{ type: 'error' },\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tconst message = error.response.data.ocs.meta.message\n\t\t\t\tthrow new Error(message)\n\t\t\t}\n\t\t},\n\t},\n}\n","/**\n * SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n\nimport Share from '../models/Share.js'\nimport Config from '../services/ConfigService.js'\n\nexport default {\n\tmethods: {\n\t\tasync openSharingDetails(shareRequestObject) {\n\t\t\tlet share = {}\n\t\t\t// handle externalResults from OCA.Sharing.ShareSearch\n\t\t\t// TODO : Better name/interface for handler required\n\t\t\t// For example `externalAppCreateShareHook` with proper documentation\n\t\t\tif (shareRequestObject.handler) {\n\t\t\t\tif (this.suggestions) {\n\t\t\t\t\tshareRequestObject.suggestions = this.suggestions\n\t\t\t\t\tshareRequestObject.fileInfo = this.fileInfo\n\t\t\t\t\tshareRequestObject.query = this.query\n\t\t\t\t}\n\t\t\t\tshare = await shareRequestObject.handler(shareRequestObject)\n\t\t\t\tshare = new Share(share)\n\t\t\t} else {\n\t\t\t\tshare = this.mapShareRequestToShareObject(shareRequestObject)\n\t\t\t}\n\n\t\t\tconst shareDetails = {\n\t\t\t\tfileInfo: this.fileInfo,\n\t\t\t\tshare,\n\t\t\t}\n\n\t\t\tthis.$emit('open-sharing-details', shareDetails)\n\t\t},\n\t\topenShareDetailsForCustomSettings(share) {\n\t\t\tshare.setCustomPermissions = true\n\t\t\tthis.openSharingDetails(share)\n\t\t},\n\t\tmapShareRequestToShareObject(shareRequestObject) {\n\n\t\t\tif (shareRequestObject.id) {\n\t\t\t\treturn shareRequestObject\n\t\t\t}\n\n\t\t\tconst share = {\n\t\t\t\tattributes: [\n\t\t\t\t\t{\n\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\tkey: 'download',\n\t\t\t\t\t\tscope: 'permissions',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tshare_type: shareRequestObject.shareType,\n\t\t\t\tshare_with: shareRequestObject.shareWith,\n\t\t\t\tis_no_user: shareRequestObject.isNoUser,\n\t\t\t\tuser: shareRequestObject.shareWith,\n\t\t\t\tshare_with_displayname: shareRequestObject.displayName,\n\t\t\t\tsubtitle: shareRequestObject.subtitle,\n\t\t\t\tpermissions: shareRequestObject.permissions ?? new Config().defaultPermissions,\n\t\t\t\texpiration: '',\n\t\t\t}\n\n\t\t\treturn new Share(share)\n\t\t},\n\t},\n}\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div class=\"sharing-search\">\n\t\t<label for=\"sharing-search-input\">{{ t('files_sharing', 'Search for share recipients') }}</label>\n\t\t<NcSelect ref=\"select\"\n\t\t\tv-model=\"value\"\n\t\t\tinput-id=\"sharing-search-input\"\n\t\t\tclass=\"sharing-search__input\"\n\t\t\t:disabled=\"!canReshare\"\n\t\t\t:loading=\"loading\"\n\t\t\t:filterable=\"false\"\n\t\t\t:placeholder=\"inputPlaceholder\"\n\t\t\t:clear-search-on-blur=\"() => false\"\n\t\t\t:user-select=\"true\"\n\t\t\t:options=\"options\"\n\t\t\t@search=\"asyncFind\"\n\t\t\t@option:selected=\"onSelected\">\n\t\t\t<template #no-options=\"{ search }\">\n\t\t\t\t{{ search ? noResultText : t('files_sharing', 'No recommendations. Start typing.') }}\n\t\t\t</template>\n\t\t</NcSelect>\n\t</div>\n</template>\n\n<script>\nimport { generateOcsUrl } from '@nextcloud/router'\nimport { getCurrentUser } from '@nextcloud/auth'\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport axios from '@nextcloud/axios'\nimport debounce from 'debounce'\nimport NcSelect from '@nextcloud/vue/dist/Components/NcSelect.js'\n\nimport Config from '../services/ConfigService.js'\nimport GeneratePassword from '../utils/GeneratePassword.js'\nimport Share from '../models/Share.js'\nimport ShareRequests from '../mixins/ShareRequests.js'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport ShareDetails from '../mixins/ShareDetails.js'\n\nexport default {\n\tname: 'SharingInput',\n\n\tcomponents: {\n\t\tNcSelect,\n\t},\n\n\tmixins: [ShareTypes, ShareRequests, ShareDetails],\n\n\tprops: {\n\t\tshares: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t\trequired: true,\n\t\t},\n\t\tlinkShares: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t\trequired: true,\n\t\t},\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t\treshare: {\n\t\t\ttype: Share,\n\t\t\tdefault: null,\n\t\t},\n\t\tcanReshare: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tconfig: new Config(),\n\t\t\tloading: false,\n\t\t\tquery: '',\n\t\t\trecommendations: [],\n\t\t\tShareSearch: OCA.Sharing.ShareSearch.state,\n\t\t\tsuggestions: [],\n\t\t\tvalue: null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Implement ShareSearch\n\t\t * allows external appas to inject new\n\t\t * results into the autocomplete dropdown\n\t\t * Used for the guests app\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\texternalResults() {\n\t\t\treturn this.ShareSearch.results\n\t\t},\n\t\tinputPlaceholder() {\n\t\t\tconst allowRemoteSharing = this.config.isRemoteShareAllowed\n\n\t\t\tif (!this.canReshare) {\n\t\t\t\treturn t('files_sharing', 'Resharing is not allowed')\n\t\t\t}\n\t\t\t// We can always search with email addresses for users too\n\t\t\tif (!allowRemoteSharing) {\n\t\t\t\treturn t('files_sharing', 'Name or email …')\n\t\t\t}\n\n\t\t\treturn t('files_sharing', 'Name, email, or Federated Cloud ID …')\n\t\t},\n\n\t\tisValidQuery() {\n\t\t\treturn this.query && this.query.trim() !== '' && this.query.length > this.config.minSearchStringLength\n\t\t},\n\n\t\toptions() {\n\t\t\tif (this.isValidQuery) {\n\t\t\t\treturn this.suggestions\n\t\t\t}\n\t\t\treturn this.recommendations\n\t\t},\n\n\t\tnoResultText() {\n\t\t\tif (this.loading) {\n\t\t\t\treturn t('files_sharing', 'Searching …')\n\t\t\t}\n\t\t\treturn t('files_sharing', 'No elements found.')\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.getRecommendations()\n\t},\n\n\tmethods: {\n\t\tonSelected(option) {\n\t\t\tthis.value = null // Reset selected option\n\t\t\tthis.openSharingDetails(option)\n\t\t},\n\n\t\tasync asyncFind(query) {\n\t\t\t// save current query to check if we display\n\t\t\t// recommendations or search results\n\t\t\tthis.query = query.trim()\n\t\t\tif (this.isValidQuery) {\n\t\t\t\t// start loading now to have proper ux feedback\n\t\t\t\t// during the debounce\n\t\t\t\tthis.loading = true\n\t\t\t\tawait this.debounceGetSuggestions(query)\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get suggestions\n\t\t *\n\t\t * @param {string} search the search query\n\t\t * @param {boolean} [lookup] search on lookup server\n\t\t */\n\t\tasync getSuggestions(search, lookup = false) {\n\t\t\tthis.loading = true\n\n\t\t\tif (getCapabilities().files_sharing.sharee.query_lookup_default === true) {\n\t\t\t\tlookup = true\n\t\t\t}\n\n\t\t\tconst shareType = [\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_USER,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_GROUP,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_REMOTE,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_CIRCLE,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_ROOM,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_GUEST,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_DECK,\n\t\t\t\tthis.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH,\n\t\t\t]\n\n\t\t\tif (getCapabilities().files_sharing.public.enabled === true) {\n\t\t\t\tshareType.push(this.SHARE_TYPES.SHARE_TYPE_EMAIL)\n\t\t\t}\n\n\t\t\tlet request = null\n\t\t\ttry {\n\t\t\t\trequest = await axios.get(generateOcsUrl('apps/files_sharing/api/v1/sharees'), {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tformat: 'json',\n\t\t\t\t\t\titemType: this.fileInfo.type === 'dir' ? 'folder' : 'file',\n\t\t\t\t\t\tsearch,\n\t\t\t\t\t\tlookup,\n\t\t\t\t\t\tperPage: this.config.maxAutocompleteResults,\n\t\t\t\t\t\tshareType,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error fetching suggestions', error)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst data = request.data.ocs.data\n\t\t\tconst exact = request.data.ocs.data.exact\n\t\t\tdata.exact = [] // removing exact from general results\n\n\t\t\t// flatten array of arrays\n\t\t\tconst rawExactSuggestions = Object.values(exact).reduce((arr, elem) => arr.concat(elem), [])\n\t\t\tconst rawSuggestions = Object.values(data).reduce((arr, elem) => arr.concat(elem), [])\n\n\t\t\t// remove invalid data and format to user-select layout\n\t\t\tconst exactSuggestions = this.filterOutExistingShares(rawExactSuggestions)\n\t\t\t\t.map(share => this.formatForMultiselect(share))\n\t\t\t\t// sort by type so we can get user&groups first...\n\t\t\t\t.sort((a, b) => a.shareType - b.shareType)\n\t\t\tconst suggestions = this.filterOutExistingShares(rawSuggestions)\n\t\t\t\t.map(share => this.formatForMultiselect(share))\n\t\t\t\t// sort by type so we can get user&groups first...\n\t\t\t\t.sort((a, b) => a.shareType - b.shareType)\n\n\t\t\t// lookup clickable entry\n\t\t\t// show if enabled and not already requested\n\t\t\tconst lookupEntry = []\n\t\t\tif (data.lookupEnabled && !lookup) {\n\t\t\t\tlookupEntry.push({\n\t\t\t\t\tid: 'global-lookup',\n\t\t\t\t\tisNoUser: true,\n\t\t\t\t\tdisplayName: t('files_sharing', 'Search globally'),\n\t\t\t\t\tlookup: true,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// if there is a condition specified, filter it\n\t\t\tconst externalResults = this.externalResults.filter(result => !result.condition || result.condition(this))\n\n\t\t\tconst allSuggestions = exactSuggestions.concat(suggestions).concat(externalResults).concat(lookupEntry)\n\n\t\t\t// Count occurrences of display names in order to provide a distinguishable description if needed\n\t\t\tconst nameCounts = allSuggestions.reduce((nameCounts, result) => {\n\t\t\t\tif (!result.displayName) {\n\t\t\t\t\treturn nameCounts\n\t\t\t\t}\n\t\t\t\tif (!nameCounts[result.displayName]) {\n\t\t\t\t\tnameCounts[result.displayName] = 0\n\t\t\t\t}\n\t\t\t\tnameCounts[result.displayName]++\n\t\t\t\treturn nameCounts\n\t\t\t}, {})\n\n\t\t\tthis.suggestions = allSuggestions.map(item => {\n\t\t\t\t// Make sure that items with duplicate displayName get the shareWith applied as a description\n\t\t\t\tif (nameCounts[item.displayName] > 1 && !item.desc) {\n\t\t\t\t\treturn { ...item, desc: item.shareWithDisplayNameUnique }\n\t\t\t\t}\n\t\t\t\treturn item\n\t\t\t})\n\n\t\t\tthis.loading = false\n\t\t\tconsole.info('suggestions', this.suggestions)\n\t\t},\n\n\t\t/**\n\t\t * Debounce getSuggestions\n\t\t *\n\t\t * @param {...*} args the arguments\n\t\t */\n\t\tdebounceGetSuggestions: debounce(function(...args) {\n\t\t\tthis.getSuggestions(...args)\n\t\t}, 300),\n\n\t\t/**\n\t\t * Get the sharing recommendations\n\t\t */\n\t\tasync getRecommendations() {\n\t\t\tthis.loading = true\n\n\t\t\tlet request = null\n\t\t\ttry {\n\t\t\t\trequest = await axios.get(generateOcsUrl('apps/files_sharing/api/v1/sharees_recommended'), {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tformat: 'json',\n\t\t\t\t\t\titemType: this.fileInfo.type,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error fetching recommendations', error)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Add external results from the OCA.Sharing.ShareSearch api\n\t\t\tconst externalResults = this.externalResults.filter(result => !result.condition || result.condition(this))\n\n\t\t\t// flatten array of arrays\n\t\t\tconst rawRecommendations = Object.values(request.data.ocs.data.exact)\n\t\t\t\t.reduce((arr, elem) => arr.concat(elem), [])\n\n\t\t\t// remove invalid data and format to user-select layout\n\t\t\tthis.recommendations = this.filterOutExistingShares(rawRecommendations)\n\t\t\t\t.map(share => this.formatForMultiselect(share))\n\t\t\t\t.concat(externalResults)\n\n\t\t\tthis.loading = false\n\t\t\tconsole.info('recommendations', this.recommendations)\n\t\t},\n\n\t\t/**\n\t\t * Filter out existing shares from\n\t\t * the provided shares search results\n\t\t *\n\t\t * @param {object[]} shares the array of shares object\n\t\t * @return {object[]}\n\t\t */\n\t\tfilterOutExistingShares(shares) {\n\t\t\treturn shares.reduce((arr, share) => {\n\t\t\t\t// only check proper objects\n\t\t\t\tif (typeof share !== 'object') {\n\t\t\t\t\treturn arr\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tif (share.value.shareType === this.SHARE_TYPES.SHARE_TYPE_USER) {\n\t\t\t\t\t\t// filter out current user\n\t\t\t\t\t\tif (share.value.shareWith === getCurrentUser().uid) {\n\t\t\t\t\t\t\treturn arr\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// filter out the owner of the share\n\t\t\t\t\t\tif (this.reshare && share.value.shareWith === this.reshare.owner) {\n\t\t\t\t\t\t\treturn arr\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// filter out existing mail shares\n\t\t\t\t\tif (share.value.shareType === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\t\t\tconst emails = this.linkShares.map(elem => elem.shareWith)\n\t\t\t\t\t\tif (emails.indexOf(share.value.shareWith.trim()) !== -1) {\n\t\t\t\t\t\t\treturn arr\n\t\t\t\t\t\t}\n\t\t\t\t\t} else { // filter out existing shares\n\t\t\t\t\t\t// creating an object of uid => type\n\t\t\t\t\t\tconst sharesObj = this.shares.reduce((obj, elem) => {\n\t\t\t\t\t\t\tobj[elem.shareWith] = elem.type\n\t\t\t\t\t\t\treturn obj\n\t\t\t\t\t\t}, {})\n\n\t\t\t\t\t\t// if shareWith is the same and the share type too, ignore it\n\t\t\t\t\t\tconst key = share.value.shareWith.trim()\n\t\t\t\t\t\tif (key in sharesObj\n\t\t\t\t\t\t\t&& sharesObj[key] === share.value.shareType) {\n\t\t\t\t\t\t\treturn arr\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// ALL GOOD\n\t\t\t\t\t// let's add the suggestion\n\t\t\t\t\tarr.push(share)\n\t\t\t\t} catch {\n\t\t\t\t\treturn arr\n\t\t\t\t}\n\t\t\t\treturn arr\n\t\t\t}, [])\n\t\t},\n\n\t\t/**\n\t\t * Get the icon based on the share type\n\t\t *\n\t\t * @param {number} type the share type\n\t\t * @return {string} the icon class\n\t\t */\n\t\tshareTypeToIcon(type) {\n\t\t\tswitch (type) {\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GUEST:\n\t\t\t\t// default is a user, other icons are here to differentiate\n\t\t\t\t// themselves from it, so let's not display the user icon\n\t\t\t\t// case this.SHARE_TYPES.SHARE_TYPE_REMOTE:\n\t\t\t\t// case this.SHARE_TYPES.SHARE_TYPE_USER:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-user',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Guest'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP:\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GROUP:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-group',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Group'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_EMAIL:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-mail',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Email'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_CIRCLE:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-teams',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Team'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_ROOM:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-room',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Talk conversation'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_DECK:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-deck',\n\t\t\t\t\ticonTitle: t('files_sharing', 'Deck board'),\n\t\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH:\n\t\t\t\treturn {\n\t\t\t\t\ticon: 'icon-sciencemesh',\n\t\t\t\t\ticonTitle: t('files_sharing', 'ScienceMesh'),\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn {}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Format shares for the multiselect options\n\t\t *\n\t\t * @param {object} result select entry item\n\t\t * @return {object}\n\t\t */\n\t\tformatForMultiselect(result) {\n\t\t\tlet subtitle\n\t\t\tif (result.value.shareType === this.SHARE_TYPES.SHARE_TYPE_USER && this.config.shouldAlwaysShowUnique) {\n\t\t\t\tsubtitle = result.shareWithDisplayNameUnique ?? ''\n\t\t\t} else if ((result.value.shareType === this.SHARE_TYPES.SHARE_TYPE_REMOTE\n\t\t\t\t\t|| result.value.shareType === this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP\n\t\t\t) && result.value.server) {\n\t\t\t\tsubtitle = t('files_sharing', 'on {server}', { server: result.value.server })\n\t\t\t} else if (result.value.shareType === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\tsubtitle = result.value.shareWith\n\t\t\t} else {\n\t\t\t\tsubtitle = result.shareWithDescription ?? ''\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tshareWith: result.value.shareWith,\n\t\t\t\tshareType: result.value.shareType,\n\t\t\t\tuser: result.uuid || result.value.shareWith,\n\t\t\t\tisNoUser: result.value.shareType !== this.SHARE_TYPES.SHARE_TYPE_USER,\n\t\t\t\tdisplayName: result.name || result.label,\n\t\t\t\tsubtitle,\n\t\t\t\tshareWithDisplayNameUnique: result.shareWithDisplayNameUnique || '',\n\t\t\t\t...this.shareTypeToIcon(result.value.shareType),\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Process the new share request\n\t\t *\n\t\t * @param {object} value the multiselect option\n\t\t */\n\t\tasync addShare(value) {\n\t\t\t// Clear the displayed selection\n\t\t\tthis.value = null\n\n\t\t\tif (value.lookup) {\n\t\t\t\tawait this.getSuggestions(this.query, true)\n\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t// open the dropdown again\n\t\t\t\t\tthis.$refs.select.$children[0].open = true\n\t\t\t\t})\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\t// handle externalResults from OCA.Sharing.ShareSearch\n\t\t\tif (value.handler) {\n\t\t\t\tconst share = await value.handler(this)\n\t\t\t\tthis.$emit('add:share', new Share(share))\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tthis.loading = true\n\t\t\tconsole.debug('Adding a new share from the input for', value)\n\t\t\ttry {\n\t\t\t\tlet password = null\n\n\t\t\t\tif (this.config.enforcePasswordForPublicLink\n\t\t\t\t\t&& value.shareType === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\t\tpassword = await GeneratePassword()\n\t\t\t\t}\n\n\t\t\t\tconst path = (this.fileInfo.path + '/' + this.fileInfo.name).replace('//', '/')\n\t\t\t\tconst share = await this.createShare({\n\t\t\t\t\tpath,\n\t\t\t\t\tshareType: value.shareType,\n\t\t\t\t\tshareWith: value.shareWith,\n\t\t\t\t\tpassword,\n\t\t\t\t\tpermissions: this.fileInfo.sharePermissions & getCapabilities().files_sharing.default_permissions,\n\t\t\t\t\tattributes: JSON.stringify(this.fileInfo.shareAttributes),\n\t\t\t\t})\n\n\t\t\t\t// If we had a password, we need to show it to the user as it was generated\n\t\t\t\tif (password) {\n\t\t\t\t\tshare.newPassword = password\n\t\t\t\t\t// Wait for the newly added share\n\t\t\t\t\tconst component = await new Promise(resolve => {\n\t\t\t\t\t\tthis.$emit('add:share', share, resolve)\n\t\t\t\t\t})\n\n\t\t\t\t\t// open the menu on the\n\t\t\t\t\t// freshly created share component\n\t\t\t\t\tcomponent.open = true\n\t\t\t\t} else {\n\t\t\t\t\t// Else we just add it normally\n\t\t\t\t\tthis.$emit('add:share', share)\n\t\t\t\t}\n\n\t\t\t\tawait this.getRecommendations()\n\t\t\t} catch (error) {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t// open the dropdown again on error\n\t\t\t\t\tthis.$refs.select.$children[0].open = true\n\t\t\t\t})\n\t\t\t\tthis.query = value.shareWith\n\t\t\t\tconsole.error('Error while adding new share', error)\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\">\n.sharing-search {\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin-bottom: 4px;\n\n\tlabel[for=\"sharing-search-input\"] {\n\t\tmargin-bottom: 2px;\n\t}\n\n\t&__input {\n\t\twidth: 100%;\n\t\tmargin: 10px 0;\n\t}\n}\n\n.vs__dropdown-menu {\n\t// properly style the lookup entry\n\tspan[lookup] {\n\t\t.avatardiv {\n\t\t\tbackground-image: var(--icon-search-white);\n\t\t\tbackground-repeat: no-repeat;\n\t\t\tbackground-position: center;\n\t\t\tbackground-color: var(--color-text-maxcontrast) !important;\n\t\t\t.avatardiv__initials-wrapper {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nexport const ATOMIC_PERMISSIONS = {\n\tNONE: 0,\n\tREAD: 1,\n\tUPDATE: 2,\n\tCREATE: 4,\n\tDELETE: 8,\n\tSHARE: 16,\n}\n\nexport const BUNDLED_PERMISSIONS = {\n\tREAD_ONLY: ATOMIC_PERMISSIONS.READ,\n\tUPLOAD_AND_UPDATE: ATOMIC_PERMISSIONS.READ | ATOMIC_PERMISSIONS.UPDATE | ATOMIC_PERMISSIONS.CREATE | ATOMIC_PERMISSIONS.DELETE,\n\tFILE_DROP: ATOMIC_PERMISSIONS.CREATE,\n\tALL: ATOMIC_PERMISSIONS.UPDATE | ATOMIC_PERMISSIONS.CREATE | ATOMIC_PERMISSIONS.READ | ATOMIC_PERMISSIONS.DELETE | ATOMIC_PERMISSIONS.SHARE,\n\tALL_FILE: ATOMIC_PERMISSIONS.UPDATE | ATOMIC_PERMISSIONS.READ | ATOMIC_PERMISSIONS.SHARE,\n}\n\n/**\n * Return whether a given permissions set contains some permissions.\n *\n * @param {number} initialPermissionSet - the permissions set.\n * @param {number} permissionsToCheck - the permissions to check.\n * @return {boolean}\n */\nexport function hasPermissions(initialPermissionSet, permissionsToCheck) {\n\treturn initialPermissionSet !== ATOMIC_PERMISSIONS.NONE && (initialPermissionSet & permissionsToCheck) === permissionsToCheck\n}\n\n/**\n * Return whether a given permissions set is valid.\n *\n * @param {number} permissionsSet - the permissions set.\n *\n * @return {boolean}\n */\nexport function permissionsSetIsValid(permissionsSet) {\n\t// Must have at least READ or CREATE permission.\n\tif (!hasPermissions(permissionsSet, ATOMIC_PERMISSIONS.READ) && !hasPermissions(permissionsSet, ATOMIC_PERMISSIONS.CREATE)) {\n\t\treturn false\n\t}\n\n\t// Must have READ permission if have UPDATE or DELETE.\n\tif (!hasPermissions(permissionsSet, ATOMIC_PERMISSIONS.READ) && (\n\t\thasPermissions(permissionsSet, ATOMIC_PERMISSIONS.UPDATE) || hasPermissions(permissionsSet, ATOMIC_PERMISSIONS.DELETE)\n\t)) {\n\t\treturn false\n\t}\n\n\treturn true\n}\n\n/**\n * Add some permissions to an initial set of permissions.\n *\n * @param {number} initialPermissionSet - the initial permissions.\n * @param {number} permissionsToAdd - the permissions to add.\n *\n * @return {number}\n */\nexport function addPermissions(initialPermissionSet, permissionsToAdd) {\n\treturn initialPermissionSet | permissionsToAdd\n}\n\n/**\n * Remove some permissions from an initial set of permissions.\n *\n * @param {number} initialPermissionSet - the initial permissions.\n * @param {number} permissionsToSubtract - the permissions to remove.\n *\n * @return {number}\n */\nexport function subtractPermissions(initialPermissionSet, permissionsToSubtract) {\n\treturn initialPermissionSet & ~permissionsToSubtract\n}\n\n/**\n * Toggle some permissions from  an initial set of permissions.\n *\n * @param {number} initialPermissionSet - the permissions set.\n * @param {number} permissionsToToggle - the permissions to toggle.\n *\n * @return {number}\n */\nexport function togglePermissions(initialPermissionSet, permissionsToToggle) {\n\tif (hasPermissions(initialPermissionSet, permissionsToToggle)) {\n\t\treturn subtractPermissions(initialPermissionSet, permissionsToToggle)\n\t} else {\n\t\treturn addPermissions(initialPermissionSet, permissionsToToggle)\n\t}\n}\n\n/**\n * Return whether some given permissions can be toggled from a permission set.\n *\n * @param {number} permissionSet - the initial permissions set.\n * @param {number} permissionsToToggle - the permissions to toggle.\n *\n * @return {boolean}\n */\nexport function canTogglePermissions(permissionSet, permissionsToToggle) {\n\treturn permissionsSetIsValid(togglePermissions(permissionSet, permissionsToToggle))\n}\n","/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { getCurrentUser } from '@nextcloud/auth'\n// eslint-disable-next-line import/no-unresolved, n/no-missing-import\nimport PQueue from 'p-queue'\nimport debounce from 'debounce'\n\nimport Share from '../models/Share.js'\nimport SharesRequests from './ShareRequests.js'\nimport ShareTypes from './ShareTypes.js'\nimport Config from '../services/ConfigService.js'\n\nimport {\n\tBUNDLED_PERMISSIONS,\n} from '../lib/SharePermissionsToolBox.js'\n\nexport default {\n\tmixins: [SharesRequests, ShareTypes],\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => { },\n\t\t\trequired: true,\n\t\t},\n\t\tshare: {\n\t\t\ttype: Share,\n\t\t\tdefault: null,\n\t\t},\n\t\tisUnique: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tconfig: new Config(),\n\n\t\t\t// errors helpers\n\t\t\terrors: {},\n\n\t\t\t// component status toggles\n\t\t\tloading: false,\n\t\t\tsaving: false,\n\t\t\topen: false,\n\n\t\t\t// concurrency management queue\n\t\t\t// we want one queue per share\n\t\t\tupdateQueue: new PQueue({ concurrency: 1 }),\n\n\t\t\t/**\n\t\t\t * ! This allow vue to make the Share class state reactive\n\t\t\t * ! do not remove it ot you'll lose all reactivity here\n\t\t\t */\n\t\t\treactiveState: this.share?.state,\n\t\t}\n\t},\n\n\tcomputed: {\n\n\t\t/**\n\t\t * Does the current share have a note\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\thasNote: {\n\t\t\tget() {\n\t\t\t\treturn this.share.note !== ''\n\t\t\t},\n\t\t\tset(enabled) {\n\t\t\t\tthis.share.note = enabled\n\t\t\t\t\t? null // enabled but user did not changed the content yet\n\t\t\t\t\t: '' // empty = no note = disabled\n\t\t\t},\n\t\t},\n\n\t\tdateTomorrow() {\n\t\t\treturn new Date(new Date().setDate(new Date().getDate() + 1))\n\t\t},\n\n\t\t// Datepicker language\n\t\tlang() {\n\t\t\tconst weekdaysShort = window.dayNamesShort\n\t\t\t\t? window.dayNamesShort // provided by nextcloud\n\t\t\t\t: ['Sun.', 'Mon.', 'Tue.', 'Wed.', 'Thu.', 'Fri.', 'Sat.']\n\t\t\tconst monthsShort = window.monthNamesShort\n\t\t\t\t? window.monthNamesShort // provided by nextcloud\n\t\t\t\t: ['Jan.', 'Feb.', 'Mar.', 'Apr.', 'May.', 'Jun.', 'Jul.', 'Aug.', 'Sep.', 'Oct.', 'Nov.', 'Dec.']\n\t\t\tconst firstDayOfWeek = window.firstDay ? window.firstDay : 0\n\n\t\t\treturn {\n\t\t\t\tformatLocale: {\n\t\t\t\t\tfirstDayOfWeek,\n\t\t\t\t\tmonthsShort,\n\t\t\t\t\tweekdaysMin: weekdaysShort,\n\t\t\t\t\tweekdaysShort,\n\t\t\t\t},\n\t\t\t\tmonthFormat: 'MMM',\n\t\t\t}\n\t\t},\n\t\tisFolder() {\n\t\t\treturn this.fileInfo.type === 'dir'\n\t\t},\n\t\tisPublicShare() {\n\t\t\tconst shareType = this.share.shareType ?? this.share.type\n\t\t\treturn [this.SHARE_TYPES.SHARE_TYPE_LINK, this.SHARE_TYPES.SHARE_TYPE_EMAIL].includes(shareType)\n\t\t},\n\t\tisRemoteShare() {\n\t\t\treturn this.share.type === this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP || this.share.type === this.SHARE_TYPES.SHARE_TYPE_REMOTE\n\t\t},\n\t\tisShareOwner() {\n\t\t\treturn this.share && this.share.owner === getCurrentUser().uid\n\t\t},\n\t\tisExpiryDateEnforced() {\n\t\t\tif (this.isPublicShare) {\n\t\t\t\treturn this.config.isDefaultExpireDateEnforced\n\t\t\t}\n\t\t\tif (this.isRemoteShare) {\n\t\t\t    return this.config.isDefaultRemoteExpireDateEnforced\n\t\t\t}\n\t\t\treturn this.config.isDefaultInternalExpireDateEnforced\n\t\t},\n\t\thasCustomPermissions() {\n\t\t\tconst bundledPermissions = [\n\t\t\t\tBUNDLED_PERMISSIONS.ALL,\n\t\t\t\tBUNDLED_PERMISSIONS.READ_ONLY,\n\t\t\t\tBUNDLED_PERMISSIONS.FILE_DROP,\n\t\t\t]\n\t\t\treturn !bundledPermissions.includes(this.share.permissions)\n\t\t},\n\t\tmaxExpirationDateEnforced() {\n\t\t\tif (this.isExpiryDateEnforced) {\n\t\t\t\tif (this.isPublicShare) {\n\t\t\t\t\treturn this.config.defaultExpirationDate\n\t\t\t\t}\n\t\t\t\tif (this.isRemoteShare) {\n\t\t\t\t\treturn this.config.defaultRemoteExpirationDateString\n\t\t\t\t}\n\t\t\t\t// If it get's here then it must be an internal share\n\t\t\t\treturn this.config.defaultInternalExpirationDate\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Check if a share is valid before\n\t\t * firing the request\n\t\t *\n\t\t * @param {Share} share the share to check\n\t\t * @return {boolean}\n\t\t */\n\t\tcheckShare(share) {\n\t\t\tif (share.password) {\n\t\t\t\tif (typeof share.password !== 'string' || share.password.trim() === '') {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (share.expirationDate) {\n\t\t\t\tconst date = share.expirationDate\n\t\t\t\tif (!date.isValid()) {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true\n\t\t},\n\n\t\t/**\n\t\t * @param {string} date a date with YYYY-MM-DD format\n\t\t * @return {Date} date\n\t\t */\n\t\tparseDateString(date) {\n\t\t\tif (!date) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst regex = /([0-9]{4}-[0-9]{2}-[0-9]{2})/i\n\t\t\treturn new Date(date.match(regex)?.pop())\n\t\t},\n\n\t\t/**\n\t\t * @param {Date} date\n\t\t * @return {string} date a date with YYYY-MM-DD format\n\t\t */\n\t\tformatDateToString(date) {\n\t\t\t// Force utc time. Drop time information to be timezone-less\n\t\t\tconst utcDate = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()))\n\t\t\t// Format to YYYY-MM-DD\n\t\t\treturn utcDate.toISOString().split('T')[0]\n\t\t},\n\n\t\t/**\n\t\t * Save given value to expireDate and trigger queueUpdate\n\t\t *\n\t\t * @param {Date} date\n\t\t */\n\t\tonExpirationChange: debounce(function(date) {\n\t\t\tthis.share.expireDate = this.formatDateToString(new Date(date))\n\t\t}, 500),\n\t\t/**\n\t\t * Uncheck expire date\n\t\t * We need this method because @update:checked\n\t\t * is ran simultaneously as @uncheck, so\n\t\t * so we cannot ensure data is up-to-date\n\t\t */\n\t\tonExpirationDisable() {\n\t\t\tthis.share.expireDate = ''\n\t\t},\n\n\t\t/**\n\t\t * Note changed, let's save it to a different key\n\t\t *\n\t\t * @param {string} note the share note\n\t\t */\n\t\tonNoteChange(note) {\n\t\t\tthis.$set(this.share, 'newNote', note.trim())\n\t\t},\n\n\t\t/**\n\t\t * When the note change, we trim, save and dispatch\n\t\t *\n\t\t */\n\t\tonNoteSubmit() {\n\t\t\tif (this.share.newNote) {\n\t\t\t\tthis.share.note = this.share.newNote\n\t\t\t\tthis.$delete(this.share, 'newNote')\n\t\t\t\tthis.queueUpdate('note')\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Delete share button handler\n\t\t */\n\t\tasync onDelete() {\n\t\t\ttry {\n\t\t\t\tthis.loading = true\n\t\t\t\tthis.open = false\n\t\t\t\tawait this.deleteShare(this.share.id)\n\t\t\t\tconsole.debug('Share deleted', this.share.id)\n\t\t\t\tconst message = this.share.itemType === 'file'\n\t\t\t\t\t? t('files_sharing', 'File \"{path}\" has been unshared', { path: this.share.path })\n\t\t\t\t\t: t('files_sharing', 'Folder \"{path}\" has been unshared', { path: this.share.path })\n\t\t\t\tshowSuccess(message)\n\t\t\t\tthis.$emit('remove:share', this.share)\n\t\t\t} catch (error) {\n\t\t\t\t// re-open menu if error\n\t\t\t\tthis.open = true\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Send an update of the share to the queue\n\t\t *\n\t\t * @param {Array<string>} propertyNames the properties to sync\n\t\t */\n\t\tqueueUpdate(...propertyNames) {\n\t\t\tif (propertyNames.length === 0) {\n\t\t\t\t// Nothing to update\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.share.id) {\n\t\t\t\tconst properties = {}\n\t\t\t\t// force value to string because that is what our\n\t\t\t\t// share api controller accepts\n\t\t\t\tpropertyNames.forEach(name => {\n\t\t\t\t\tif ((typeof this.share[name]) === 'object') {\n\t\t\t\t\t\tproperties[name] = JSON.stringify(this.share[name])\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproperties[name] = this.share[name].toString()\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tthis.updateQueue.add(async () => {\n\t\t\t\t\tthis.saving = true\n\t\t\t\t\tthis.errors = {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst updatedShare = await this.updateShare(this.share.id, properties)\n\n\t\t\t\t\t\tif (propertyNames.indexOf('password') >= 0) {\n\t\t\t\t\t\t\t// reset password state after sync\n\t\t\t\t\t\t\tthis.$delete(this.share, 'newPassword')\n\n\t\t\t\t\t\t\t// updates password expiration time after sync\n\t\t\t\t\t\t\tthis.share.passwordExpirationTime = updatedShare.password_expiration_time\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// clear any previous errors\n\t\t\t\t\t\tthis.$delete(this.errors, propertyNames[0])\n\t\t\t\t\t\tshowSuccess(t('files_sharing', 'Share {propertyName} saved', { propertyName: propertyNames[0] }))\n\t\t\t\t\t} catch ({ message }) {\n\t\t\t\t\t\tif (message && message !== '') {\n\t\t\t\t\t\t\tthis.onSyncError(propertyNames[0], message)\n\t\t\t\t\t\t\tshowError(t('files_sharing', message))\n\t\t\t\t\t\t}\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tthis.saving = false\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// This share does not exists on the server yet\n\t\t\tconsole.debug('Updated local share', this.share)\n\t\t},\n\n\t\t/**\n\t\t * Manage sync errors\n\t\t *\n\t\t * @param {string} property the errored property, e.g. 'password'\n\t\t * @param {string} message the error message\n\t\t */\n\t\tonSyncError(property, message) {\n\t\t\t// re-open menu if closed\n\t\t\tthis.open = true\n\t\t\tswitch (property) {\n\t\t\tcase 'password':\n\t\t\tcase 'pending':\n\t\t\tcase 'expireDate':\n\t\t\tcase 'label':\n\t\t\tcase 'note': {\n\t\t\t\t// show error\n\t\t\t\tthis.$set(this.errors, property, message)\n\n\t\t\t\tlet propertyEl = this.$refs[property]\n\t\t\t\tif (propertyEl) {\n\t\t\t\t\tif (propertyEl.$el) {\n\t\t\t\t\t\tpropertyEl = propertyEl.$el\n\t\t\t\t\t}\n\t\t\t\t\t// focus if there is a focusable action element\n\t\t\t\t\tconst focusable = propertyEl.querySelector('.focusable')\n\t\t\t\t\tif (focusable) {\n\t\t\t\t\t\tfocusable.focus()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'sendPasswordByTalk': {\n\t\t\t\t// show error\n\t\t\t\tthis.$set(this.errors, property, message)\n\n\t\t\t\t// Restore previous state\n\t\t\t\tthis.share.sendPasswordByTalk = !this.share.sendPasswordByTalk\n\t\t\t\tbreak\n\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Debounce queueUpdate to avoid requests spamming\n\t\t * more importantly for text data\n\t\t *\n\t\t * @param {string} property the property to sync\n\t\t */\n\t\tdebounceQueueUpdate: debounce(function(property) {\n\t\t\tthis.queueUpdate(property)\n\t\t}, 500),\n\t},\n}\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<SharingEntrySimple :key=\"share.id\"\n\t\tclass=\"sharing-entry__inherited\"\n\t\t:title=\"share.shareWithDisplayName\">\n\t\t<template #avatar>\n\t\t\t<NcAvatar :user=\"share.shareWith\"\n\t\t\t\t:display-name=\"share.shareWithDisplayName\"\n\t\t\t\tclass=\"sharing-entry__avatar\" />\n\t\t</template>\n\t\t<NcActionText icon=\"icon-user\">\n\t\t\t{{ t('files_sharing', 'Added by {initiator}', { initiator: share.ownerDisplayName }) }}\n\t\t</NcActionText>\n\t\t<NcActionLink v-if=\"share.viaPath && share.viaFileid\"\n\t\t\ticon=\"icon-folder\"\n\t\t\t:href=\"viaFileTargetUrl\">\n\t\t\t{{ t('files_sharing', 'Via “{folder}”', {folder: viaFolderName} ) }}\n\t\t</NcActionLink>\n\t\t<NcActionButton v-if=\"share.canDelete\"\n\t\t\ticon=\"icon-close\"\n\t\t\t@click.prevent=\"onDelete\">\n\t\t\t{{ t('files_sharing', 'Unshare') }}\n\t\t</NcActionButton>\n\t</SharingEntrySimple>\n</template>\n\n<script>\nimport { generateUrl } from '@nextcloud/router'\nimport { basename } from '@nextcloud/paths'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport NcActionLink from '@nextcloud/vue/dist/Components/NcActionLink.js'\nimport NcActionText from '@nextcloud/vue/dist/Components/NcActionText.js'\n\n// eslint-disable-next-line no-unused-vars\nimport Share from '../models/Share.js'\nimport SharesMixin from '../mixins/SharesMixin.js'\nimport SharingEntrySimple from '../components/SharingEntrySimple.vue'\n\nexport default {\n\tname: 'SharingEntryInherited',\n\n\tcomponents: {\n\t\tNcActionButton,\n\t\tNcActionLink,\n\t\tNcActionText,\n\t\tNcAvatar,\n\t\tSharingEntrySimple,\n\t},\n\n\tmixins: [SharesMixin],\n\n\tprops: {\n\t\tshare: {\n\t\t\ttype: Share,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tviaFileTargetUrl() {\n\t\t\treturn generateUrl('/f/{fileid}', {\n\t\t\t\tfileid: this.share.viaFileid,\n\t\t\t})\n\t\t},\n\n\t\tviaFolderName() {\n\t\t\treturn basename(this.share.viaPath)\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\theight: 44px;\n\t&__desc {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tline-height: 1.2em;\n\t\tp {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\t}\n\t&__actions {\n\t\tmargin-left: auto;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<ul id=\"sharing-inherited-shares\">\n\t\t<!-- Main collapsible entry -->\n\t\t<SharingEntrySimple class=\"sharing-entry__inherited\"\n\t\t\t:title=\"mainTitle\"\n\t\t\t:subtitle=\"subTitle\"\n\t\t\t:aria-expanded=\"showInheritedShares\">\n\t\t\t<template #avatar>\n\t\t\t\t<div class=\"avatar-shared icon-more-white\" />\n\t\t\t</template>\n\t\t\t<NcActionButton :icon=\"showInheritedSharesIcon\"\n\t\t\t\t:aria-label=\"toggleTooltip\"\n\t\t\t\t:title=\"toggleTooltip\"\n\t\t\t\t@click.prevent.stop=\"toggleInheritedShares\" />\n\t\t</SharingEntrySimple>\n\n\t\t<!-- Inherited shares list -->\n\t\t<SharingEntryInherited v-for=\"share in shares\"\n\t\t\t:key=\"share.id\"\n\t\t\t:file-info=\"fileInfo\"\n\t\t\t:share=\"share\"\n\t\t\t@remove:share=\"removeShare\" />\n\t</ul>\n</template>\n\n<script>\nimport { generateOcsUrl } from '@nextcloud/router'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport axios from '@nextcloud/axios'\n\nimport Share from '../models/Share.js'\nimport SharingEntryInherited from '../components/SharingEntryInherited.vue'\nimport SharingEntrySimple from '../components/SharingEntrySimple.vue'\n\nexport default {\n\tname: 'SharingInherited',\n\n\tcomponents: {\n\t\tNcActionButton,\n\t\tSharingEntryInherited,\n\t\tSharingEntrySimple,\n\t},\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloaded: false,\n\t\t\tloading: false,\n\t\t\tshowInheritedShares: false,\n\t\t\tshares: [],\n\t\t}\n\t},\n\tcomputed: {\n\t\tshowInheritedSharesIcon() {\n\t\t\tif (this.loading) {\n\t\t\t\treturn 'icon-loading-small'\n\t\t\t}\n\t\t\tif (this.showInheritedShares) {\n\t\t\t\treturn 'icon-triangle-n'\n\t\t\t}\n\t\t\treturn 'icon-triangle-s'\n\t\t},\n\t\tmainTitle() {\n\t\t\treturn t('files_sharing', 'Others with access')\n\t\t},\n\t\tsubTitle() {\n\t\t\treturn (this.showInheritedShares && this.shares.length === 0)\n\t\t\t\t? t('files_sharing', 'No other accounts with access found')\n\t\t\t\t: ''\n\t\t},\n\t\ttoggleTooltip() {\n\t\t\treturn this.fileInfo.type === 'dir'\n\t\t\t\t? t('files_sharing', 'Toggle list of others with access to this directory')\n\t\t\t\t: t('files_sharing', 'Toggle list of others with access to this file')\n\t\t},\n\t\tfullPath() {\n\t\t\tconst path = `${this.fileInfo.path}/${this.fileInfo.name}`\n\t\t\treturn path.replace('//', '/')\n\t\t},\n\t},\n\twatch: {\n\t\tfileInfo() {\n\t\t\tthis.resetState()\n\t\t},\n\t},\n\tmethods: {\n\t\t/**\n\t\t * Toggle the list view and fetch/reset the state\n\t\t */\n\t\ttoggleInheritedShares() {\n\t\t\tthis.showInheritedShares = !this.showInheritedShares\n\t\t\tif (this.showInheritedShares) {\n\t\t\t\tthis.fetchInheritedShares()\n\t\t\t} else {\n\t\t\t\tthis.resetState()\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Fetch the Inherited Shares array\n\t\t */\n\t\tasync fetchInheritedShares() {\n\t\t\tthis.loading = true\n\t\t\ttry {\n\t\t\t\tconst url = generateOcsUrl('apps/files_sharing/api/v1/shares/inherited?format=json&path={path}', { path: this.fullPath })\n\t\t\t\tconst shares = await axios.get(url)\n\t\t\t\tthis.shares = shares.data.ocs.data\n\t\t\t\t\t.map(share => new Share(share))\n\t\t\t\t\t.sort((a, b) => b.createdTime - a.createdTime)\n\t\t\t\tconsole.info(this.shares)\n\t\t\t\tthis.loaded = true\n\t\t\t} catch (error) {\n\t\t\t\tOC.Notification.showTemporary(t('files_sharing', 'Unable to fetch inherited shares'), { type: 'error' })\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Reset current component state\n\t\t */\n\t\tresetState() {\n\t\t\tthis.loaded = false\n\t\t\tthis.loading = false\n\t\t\tthis.showInheritedShares = false\n\t\t\tthis.shares = []\n\t\t},\n\t\t/**\n\t\t * Remove a share from the shares list\n\t\t *\n\t\t * @param {Share} share the share to remove\n\t\t */\n\t\tremoveShare(share) {\n\t\t\tconst index = this.shares.findIndex(item => item === share)\n\t\t\t// eslint-disable-next-line vue/no-mutating-props\n\t\t\tthis.shares.splice(index, 1)\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry__inherited {\n\t.avatar-shared {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tline-height: 32px;\n\t\tfont-size: 18px;\n\t\tbackground-color: var(--color-text-maxcontrast);\n\t\tborder-radius: 50%;\n\t\tflex-shrink: 0;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<NcActions ref=\"quickShareActions\"\n\t\tclass=\"share-select\"\n\t\t:menu-name=\"selectedOption\"\n\t\t:aria-label=\"ariaLabel\"\n\t\ttype=\"tertiary-no-background\"\n\t\tforce-name>\n\t\t<template #icon>\n\t\t\t<DropdownIcon :size=\"15\" />\n\t\t</template>\n\t\t<NcActionButton v-for=\"option in options\"\n\t\t\t:key=\"option.label\"\n\t\t\ttype=\"radio\"\n\t\t\t:model-value=\"option.label === selectedOption\"\n\t\t\tclose-after-click\n\t\t\t@click=\"selectOption(option.label)\">\n\t\t\t<template #icon>\n\t\t\t\t<component :is=\"option.icon\" />\n\t\t\t</template>\n\t\t\t{{ option.label }}\n\t\t</NcActionButton>\n\t</NcActions>\n</template>\n\n<script>\nimport DropdownIcon from 'vue-material-design-icons/TriangleSmallDown.vue'\nimport SharesMixin from '../mixins/SharesMixin.js'\nimport ShareDetails from '../mixins/ShareDetails.js'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport IconEyeOutline from 'vue-material-design-icons/EyeOutline.vue'\nimport IconPencil from 'vue-material-design-icons/Pencil.vue'\nimport IconFileUpload from 'vue-material-design-icons/FileUpload.vue'\nimport IconTune from 'vue-material-design-icons/Tune.vue'\n\nimport {\n\tBUNDLED_PERMISSIONS,\n\tATOMIC_PERMISSIONS,\n} from '../lib/SharePermissionsToolBox.js'\n\nexport default {\n\tname: 'SharingEntryQuickShareSelect',\n\n\tcomponents: {\n\t\tDropdownIcon,\n\t\tNcActions,\n\t\tNcActionButton,\n\t},\n\n\tmixins: [SharesMixin, ShareDetails, ShareTypes],\n\n\tprops: {\n\t\tshare: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['open-sharing-details'],\n\n\tdata() {\n\t\treturn {\n\t\t\tselectedOption: '',\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tariaLabel() {\n\t\t\treturn t('files_sharing', 'Quick share options, the current selected is \"{selectedOption}\"', { selectedOption: this.selectedOption })\n\t\t},\n\t\tcanViewText() {\n\t\t\treturn t('files_sharing', 'View only')\n\t\t},\n\t\tcanEditText() {\n\t\t\treturn t('files_sharing', 'Can edit')\n\t\t},\n\t\tfileDropText() {\n\t\t\treturn t('files_sharing', 'File drop')\n\t\t},\n\t\tcustomPermissionsText() {\n\t\t\treturn t('files_sharing', 'Custom permissions')\n\t\t},\n\t\tpreSelectedOption() {\n\t\t\t// We remove the share permission for the comparison as it is not relevant for bundled permissions.\n\t\t\tif ((this.share.permissions & ~ATOMIC_PERMISSIONS.SHARE) === BUNDLED_PERMISSIONS.READ_ONLY) {\n\t\t\t\treturn this.canViewText\n\t\t\t} else if (this.share.permissions === BUNDLED_PERMISSIONS.ALL || this.share.permissions === BUNDLED_PERMISSIONS.ALL_FILE) {\n\t\t\t\treturn this.canEditText\n\t\t\t} else if ((this.share.permissions & ~ATOMIC_PERMISSIONS.SHARE) === BUNDLED_PERMISSIONS.FILE_DROP) {\n\t\t\t\treturn this.fileDropText\n\t\t\t}\n\n\t\t\treturn this.customPermissionsText\n\n\t\t},\n\t\toptions() {\n\t\t\tconst options = [{\n\t\t\t\tlabel: this.canViewText,\n\t\t\t\ticon: IconEyeOutline,\n\t\t\t}, {\n\t\t\t\tlabel: this.canEditText,\n\t\t\t\ticon: IconPencil,\n\t\t\t}]\n\t\t\tif (this.supportsFileDrop) {\n\t\t\t\toptions.push({\n\t\t\t\t\tlabel: this.fileDropText,\n\t\t\t\t\ticon: IconFileUpload,\n\t\t\t\t})\n\t\t\t}\n\t\t\toptions.push({\n\t\t\t\tlabel: this.customPermissionsText,\n\t\t\t\ticon: IconTune,\n\t\t\t})\n\n\t\t\treturn options\n\t\t},\n\t\tsupportsFileDrop() {\n\t\t\tif (this.isFolder && this.config.isPublicUploadEnabled) {\n\t\t\t\tconst shareType = this.share.type ?? this.share.shareType\n\t\t\t\treturn [this.SHARE_TYPES.SHARE_TYPE_LINK, this.SHARE_TYPES.SHARE_TYPE_EMAIL].includes(shareType)\n\t\t\t}\n\t\t\treturn false\n\t\t},\n\t\tdropDownPermissionValue() {\n\t\t\tswitch (this.selectedOption) {\n\t\t\tcase this.canEditText:\n\t\t\t\treturn this.isFolder ? BUNDLED_PERMISSIONS.ALL : BUNDLED_PERMISSIONS.ALL_FILE\n\t\t\tcase this.fileDropText:\n\t\t\t\treturn BUNDLED_PERMISSIONS.FILE_DROP\n\t\t\tcase this.customPermissionsText:\n\t\t\t\treturn 'custom'\n\t\t\tcase this.canViewText:\n\t\t\tdefault:\n\t\t\t\treturn BUNDLED_PERMISSIONS.READ_ONLY\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated() {\n\t\tthis.selectedOption = this.preSelectedOption\n\t},\n\n\tmethods: {\n\t\tselectOption(optionLabel) {\n\t\t\tthis.selectedOption = optionLabel\n\t\t\tif (optionLabel === this.customPermissionsText) {\n\t\t\t\tthis.$emit('open-sharing-details')\n\t\t\t} else {\n\t\t\t\tthis.share.permissions = this.dropDownPermissionValue\n\t\t\t\tthis.queueUpdate('permissions')\n\t\t\t\t// TODO: Add a focus method to NcActions or configurable returnFocus enabling to NcActionButton with closeAfterClick\n\t\t\t\tthis.$refs.quickShareActions.$refs.menuButton.$el.focus()\n\t\t\t}\n\t\t},\n\t},\n\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.share-select {\n\tdisplay: block;\n\n\t// TODO: NcActions should have a slot for custom trigger button like NcPopover\n\t// Overrider NcActionms button to make it small\n\t:deep(.action-item__menutoggle) {\n\t\tcolor: var(--color-primary-element) !important;\n\t\tfont-size: 12.5px !important;\n\t\theight: auto !important;\n\t\tmin-height: auto !important;\n\n\t\t.button-vue__text {\n\t\t\tfont-weight: normal !important;\n\t\t}\n\n\t\t.button-vue__icon {\n\t\t\theight: 24px !important;\n\t\t\tmin-height: 24px !important;\n\t\t\twidth: 24px !important;\n\t\t\tmin-width: 24px !important;\n\t\t}\n\n\t\t.button-vue__wrapper {\n\t\t\t// Emulate NcButton's alignment=center-reverse\n\t\t\tflex-direction: row-reverse !important;\n\t\t}\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2021 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<Component :is=\"data.is\"\n\t\tv-bind=\"data\"\n\t\tv-on=\"action.handlers\">\n\t\t{{ data.text }}\n\t</Component>\n</template>\n\n<script>\nimport Share from '../models/Share.js'\n\nexport default {\n\tname: 'ExternalShareAction',\n\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\taction: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t\tshare: {\n\t\t\ttype: Share,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tdata() {\n\t\t\treturn this.action.data(this)\n\t\t},\n\t},\n}\n</script>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<li :class=\"{ 'sharing-entry--share': share }\"\n\t\tclass=\"sharing-entry sharing-entry__link\">\n\t\t<NcAvatar :is-no-user=\"true\"\n\t\t\t:icon-class=\"isEmailShareType ? 'avatar-link-share icon-mail-white' : 'avatar-link-share icon-public-white'\"\n\t\t\tclass=\"sharing-entry__avatar\" />\n\n\t\t<div class=\"sharing-entry__summary\">\n\t\t\t<div class=\"sharing-entry__desc\">\n\t\t\t\t<span class=\"sharing-entry__title\" :title=\"title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</span>\n\t\t\t\t<p v-if=\"subtitle\">\n\t\t\t\t\t{{ subtitle }}\n\t\t\t\t</p>\n\t\t\t\t<SharingEntryQuickShareSelect v-if=\"share && share.permissions !== undefined\"\n\t\t\t\t\t:share=\"share\"\n\t\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t\t@open-sharing-details=\"openShareDetailsForCustomSettings(share)\" />\n\t\t\t</div>\n\n\t\t\t<!-- clipboard -->\n\t\t\t<NcActions v-if=\"share && !isEmailShareType && share.token\" ref=\"copyButton\" class=\"sharing-entry__copy\">\n\t\t\t\t<NcActionButton\t:title=\"copyLinkTooltip\"\n\t\t\t\t\t:aria-label=\"copyLinkTooltip\"\n\t\t\t\t\t@click.prevent=\"copyLink\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<CheckIcon v-if=\"copied && copySuccess\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tclass=\"icon-checkmark-color\" />\n\t\t\t\t\t\t<ClipboardIcon v-else :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t</NcActionButton>\n\t\t\t</NcActions>\n\t\t</div>\n\n\t\t<!-- pending actions -->\n\t\t<NcActions v-if=\"!pending && (pendingPassword || pendingEnforcedPassword || pendingExpirationDate)\"\n\t\t\tclass=\"sharing-entry__actions\"\n\t\t\t:aria-label=\"actionsTooltip\"\n\t\t\tmenu-align=\"right\"\n\t\t\t:open.sync=\"open\"\n\t\t\t@close=\"onCancel\">\n\t\t\t<!-- pending data menu -->\n\t\t\t<NcActionText v-if=\"errors.pending\"\n\t\t\t\tclass=\"error\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ErrorIcon :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ errors.pending }}\n\t\t\t</NcActionText>\n\t\t\t<NcActionText v-else icon=\"icon-info\">\n\t\t\t\t{{ t('files_sharing', 'Please enter the following required information before creating the share') }}\n\t\t\t</NcActionText>\n\n\t\t\t<!-- password -->\n\t\t\t<NcActionText v-if=\"pendingEnforcedPassword\">\n\t\t\t\t<LockIcon :size=\"20\" />\n\t\t\t\t{{ t('files_sharing', 'Password protection (enforced)') }}\n\t\t\t</NcActionText>\n\t\t\t<NcActionCheckbox v-else-if=\"pendingPassword\"\n\t\t\t\t:checked.sync=\"isPasswordProtected\"\n\t\t\t\t:disabled=\"config.enforcePasswordForPublicLink || saving\"\n\t\t\t\tclass=\"share-link-password-checkbox\"\n\t\t\t\t@uncheck=\"onPasswordDisable\">\n\t\t\t\t{{ t('files_sharing', 'Password protection') }}\n\t\t\t</NcActionCheckbox>\n\n\t\t\t<NcActionInput v-if=\"pendingEnforcedPassword || share.password\"\n\t\t\t\tclass=\"share-link-password\"\n\t\t\t\t:value.sync=\"share.password\"\n\t\t\t\t:disabled=\"saving\"\n\t\t\t\t:required=\"config.enableLinkPasswordByDefault || config.enforcePasswordForPublicLink\"\n\t\t\t\t:minlength=\"isPasswordPolicyEnabled && config.passwordPolicy.minLength\"\n\t\t\t\ticon=\"\"\n\t\t\t\tautocomplete=\"new-password\"\n\t\t\t\t@submit=\"onNewLinkShare\">\n\t\t\t\t{{ t('files_sharing', 'Enter a password') }}\n\t\t\t</NcActionInput>\n\n\t\t\t<!-- expiration date -->\n\t\t\t<NcActionText v-if=\"pendingExpirationDate\" icon=\"icon-calendar-dark\">\n\t\t\t\t{{ t('files_sharing', 'Expiration date (enforced)') }}\n\t\t\t</NcActionText>\n\t\t\t<NcActionInput v-if=\"pendingExpirationDate\"\n\t\t\t\tclass=\"share-link-expire-date\"\n\t\t\t\t:disabled=\"saving\"\n\t\t\t\t:is-native-picker=\"true\"\n\t\t\t\t:hide-label=\"true\"\n\t\t\t\t:value=\"new Date(share.expireDate)\"\n\t\t\t\ttype=\"date\"\n\t\t\t\t:min=\"dateTomorrow\"\n\t\t\t\t:max=\"maxExpirationDateEnforced\"\n\t\t\t\t@input=\"onExpirationChange\">\n\t\t\t\t<!-- let's not submit when picked, the user\n\t\t\t\t\tmight want to still edit or copy the password -->\n\t\t\t\t{{ t('files_sharing', 'Enter a date') }}\n\t\t\t</NcActionInput>\n\n\t\t\t<NcActionButton @click.prevent.stop=\"onNewLinkShare\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<CheckIcon :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ t('files_sharing', 'Create share') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton @click.prevent.stop=\"onCancel\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<CloseIcon :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t\t{{ t('files_sharing', 'Cancel') }}\n\t\t\t</NcActionButton>\n\t\t</NcActions>\n\n\t\t<!-- actions -->\n\t\t<NcActions v-else-if=\"!loading\"\n\t\t\tclass=\"sharing-entry__actions\"\n\t\t\t:aria-label=\"actionsTooltip\"\n\t\t\tmenu-align=\"right\"\n\t\t\t:open.sync=\"open\"\n\t\t\t@close=\"onMenuClose\">\n\t\t\t<template v-if=\"share\">\n\t\t\t\t<template v-if=\"share.canEdit && canReshare\">\n\t\t\t\t\t<NcActionButton :disabled=\"saving\"\n\t\t\t\t\t\t:close-after-click=\"true\"\n\t\t\t\t\t\t@click.prevent=\"openSharingDetails\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<Tune :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('files_sharing', 'Customize link') }}\n\t\t\t\t\t</NcActionButton>\n\t\t\t\t</template>\n\t\t\t\t\n\t\t\t\t<NcActionButton :close-after-click=\"true\"\n\t\t\t\t\t@click.prevent=\"showQRCode = true\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<IconQr :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('files_sharing', 'Generate QR code') }}\n\t\t\t\t</NcActionButton>\n\n\t\t\t\t<NcActionSeparator />\n\n\t\t\t\t<!-- external actions -->\n\t\t\t\t<ExternalShareAction v-for=\"action in externalLinkActions\"\n\t\t\t\t\t:id=\"action.id\"\n\t\t\t\t\t:key=\"action.id\"\n\t\t\t\t\t:action=\"action\"\n\t\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t\t:share=\"share\" />\n\n\t\t\t\t<!-- external legacy sharing via url (social...) -->\n\t\t\t\t<NcActionLink v-for=\"({ icon, url, name }, index) in externalLegacyLinkActions\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:href=\"url(shareLink)\"\n\t\t\t\t\t:icon=\"icon\"\n\t\t\t\t\ttarget=\"_blank\">\n\t\t\t\t\t{{ name }}\n\t\t\t\t</NcActionLink>\n\n\t\t\t\t<NcActionButton v-if=\"!isEmailShareType && canReshare\"\n\t\t\t\t\tclass=\"new-share-link\"\n\t\t\t\t\t@click.prevent.stop=\"onNewLinkShare\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PlusIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('files_sharing', 'Add another link') }}\n\t\t\t\t</NcActionButton>\n\n\t\t\t\t<NcActionButton v-if=\"share.canDelete\"\n\t\t\t\t\t:disabled=\"saving\"\n\t\t\t\t\t@click.prevent=\"onDelete\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<CloseIcon :size=\"20\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('files_sharing', 'Unshare') }}\n\t\t\t\t</NcActionButton>\n\t\t\t</template>\n\n\t\t\t<!-- Create new share -->\n\t\t\t<NcActionButton v-else-if=\"canReshare\"\n\t\t\t\tclass=\"new-share-link\"\n\t\t\t\t:title=\"t('files_sharing', 'Create a new share link')\"\n\t\t\t\t:aria-label=\"t('files_sharing', 'Create a new share link')\"\n\t\t\t\t:icon=\"loading ? 'icon-loading-small' : 'icon-add'\"\n\t\t\t\t@click.prevent.stop=\"onNewLinkShare\" />\n\t\t</NcActions>\n\n\t\t<!-- loading indicator to replace the menu -->\n\t\t<div v-else class=\"icon-loading-small sharing-entry__loading\" />\n\n\t\t<!-- Modal to open whenever we have a QR code -->\n\t\t<NcDialog v-if=\"showQRCode\"\n\t\t\tsize=\"normal\"\n\t\t\t:open.sync=\"showQRCode\"\n\t\t\t:name=\"title\"\n\t\t\t:close-on-click-outside=\"true\"\n\t\t\t@close=\"showQRCode = false\">\n\t\t\t<div class=\"qr-code-dialog\">\n\t\t\t\t<VueQrcode tag=\"img\"\n\t\t\t\t\t:value=\"shareLink\"\n\t\t\t\t\tclass=\"qr-code-dialog__img\" />\n\t\t\t</div>\n\t\t</NcDialog>\n\t</li>\n</template>\n\n<script>\nimport { generateUrl } from '@nextcloud/router'\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { Type as ShareTypes } from '@nextcloud/sharing'\nimport Vue from 'vue'\nimport VueQrcode from '@chenfengyuan/vue-qrcode';\n\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport NcActionInput from '@nextcloud/vue/dist/Components/NcActionInput.js'\nimport NcActionLink from '@nextcloud/vue/dist/Components/NcActionLink.js'\nimport NcActionText from '@nextcloud/vue/dist/Components/NcActionText.js'\nimport NcActionSeparator from '@nextcloud/vue/dist/Components/NcActionSeparator.js'\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport NcDialog from '@nextcloud/vue/dist/Components/NcDialog.js'\n\nimport Tune from 'vue-material-design-icons/Tune.vue'\nimport IconQr from 'vue-material-design-icons/Qrcode.vue'\nimport ErrorIcon from 'vue-material-design-icons/Exclamation.vue'\nimport LockIcon from 'vue-material-design-icons/Lock.vue'\nimport CheckIcon from 'vue-material-design-icons/CheckBold.vue'\nimport ClipboardIcon from 'vue-material-design-icons/ClipboardFlow.vue'\nimport CloseIcon from 'vue-material-design-icons/Close.vue'\nimport PlusIcon from 'vue-material-design-icons/Plus.vue'\n\nimport SharingEntryQuickShareSelect from './SharingEntryQuickShareSelect.vue'\n\nimport ExternalShareAction from './ExternalShareAction.vue'\nimport GeneratePassword from '../utils/GeneratePassword.js'\nimport Share from '../models/Share.js'\nimport SharesMixin from '../mixins/SharesMixin.js'\nimport ShareDetails from '../mixins/ShareDetails.js'\nimport { getLoggerBuilder } from '@nextcloud/logger'\n\nexport default {\n\tname: 'SharingEntryLink',\n\n\tcomponents: {\n\t\tExternalShareAction,\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcActionInput,\n\t\tNcActionLink,\n\t\tNcActionText,\n\t\tNcActionSeparator,\n\t\tNcAvatar,\n\t\tNcDialog,\n\t\tVueQrcode,\n\t\tTune,\n\t\tIconQr,\n\t\tErrorIcon,\n\t\tLockIcon,\n\t\tCheckIcon,\n\t\tClipboardIcon,\n\t\tCloseIcon,\n\t\tPlusIcon,\n\t\tSharingEntryQuickShareSelect,\n\t},\n\n\tmixins: [SharesMixin, ShareDetails],\n\n\tprops: {\n\t\tcanReshare: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tindex: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tshareCreationComplete: false,\n\t\t\tcopySuccess: true,\n\t\t\tcopied: false,\n\n\t\t\t// Are we waiting for password/expiration date\n\t\t\tpending: false,\n\n\t\t\tExternalLegacyLinkActions: OCA.Sharing.ExternalLinkActions.state,\n\t\t\tExternalShareActions: OCA.Sharing.ExternalShareActions.state,\n\t\t\tlogger: getLoggerBuilder()\n\t\t\t\t.setApp('files_sharing')\n\t\t\t\t.detectUser()\n\t\t\t\t.build(),\n\n\t\t\t// tracks whether modal should be opened or not\n\t\t\tshowQRCode: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Link share label\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\ttitle() {\n\t\t\t// if we have a valid existing share (not pending)\n\t\t\tif (this.share && this.share.id) {\n\t\t\t\tif (!this.isShareOwner && this.share.ownerDisplayName) {\n\t\t\t\t\tif (this.isEmailShareType) {\n\t\t\t\t\t\treturn t('files_sharing', '{shareWith} by {initiator}', {\n\t\t\t\t\t\t\tshareWith: this.share.shareWith,\n\t\t\t\t\t\t\tinitiator: this.share.ownerDisplayName,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\treturn t('files_sharing', 'Shared via link by {initiator}', {\n\t\t\t\t\t\tinitiator: this.share.ownerDisplayName,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (this.share.label && this.share.label.trim() !== '') {\n\t\t\t\t\tif (this.isEmailShareType) {\n\t\t\t\t\t\treturn t('files_sharing', 'Mail share ({label})', {\n\t\t\t\t\t\t\tlabel: this.share.label.trim(),\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\treturn t('files_sharing', 'Share link ({label})', {\n\t\t\t\t\t\tlabel: this.share.label.trim(),\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (this.isEmailShareType) {\n\t\t\t\t\treturn this.share.shareWith\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.index > 1) {\n\t\t\t\treturn t('files_sharing', 'Share link ({index})', { index: this.index })\n\t\t\t}\n\t\t\treturn t('files_sharing', 'Share link')\n\t\t},\n\n\t\t/**\n\t\t * Show the email on a second line if a label is set for mail shares\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tsubtitle() {\n\t\t\tif (this.isEmailShareType\n\t\t\t\t&& this.title !== this.share.shareWith) {\n\t\t\t\treturn this.share.shareWith\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t\t/**\n\t\t * Is the current share password protected ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtected: {\n\t\t\tget() {\n\t\t\t\treturn this.config.enforcePasswordForPublicLink\n\t\t\t\t\t|| !!this.share.password\n\t\t\t},\n\t\t\tasync set(enabled) {\n\t\t\t\t// TODO: directly save after generation to make sure the share is always protected\n\t\t\t\tVue.set(this.share, 'password', enabled ? await GeneratePassword() : '')\n\t\t\t\tVue.set(this.share, 'newPassword', this.share.password)\n\t\t\t},\n\t\t},\n\n\t\tpasswordExpirationTime() {\n\t\t\tif (this.share.passwordExpirationTime === null) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\tconst expirationTime = moment(this.share.passwordExpirationTime)\n\n\t\t\tif (expirationTime.diff(moment()) < 0) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn expirationTime.fromNow()\n\t\t},\n\n\t\t/**\n\t\t * Is Talk enabled?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisTalkEnabled() {\n\t\t\treturn OC.appswebroots.spreed !== undefined\n\t\t},\n\n\t\t/**\n\t\t * Is it possible to protect the password by Talk?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtectedByTalkAvailable() {\n\t\t\treturn this.isPasswordProtected && this.isTalkEnabled\n\t\t},\n\n\t\t/**\n\t\t * Is the current share password protected by Talk?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtectedByTalk: {\n\t\t\tget() {\n\t\t\t\treturn this.share.sendPasswordByTalk\n\t\t\t},\n\t\t\tasync set(enabled) {\n\t\t\t\tthis.share.sendPasswordByTalk = enabled\n\t\t\t},\n\t\t},\n\n\t\t/**\n\t\t * Is the current share an email share ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisEmailShareType() {\n\t\t\treturn this.share\n\t\t\t\t? this.share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL\n\t\t\t\t: false\n\t\t},\n\n\t\tcanTogglePasswordProtectedByTalkAvailable() {\n\t\t\tif (!this.isPasswordProtected) {\n\t\t\t\t// Makes no sense\n\t\t\t\treturn false\n\t\t\t} else if (this.isEmailShareType && !this.hasUnsavedPassword) {\n\t\t\t\t// For email shares we need a new password in order to enable or\n\t\t\t\t// disable\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\t// Anything else should be fine\n\t\t\treturn true\n\t\t},\n\n\t\t/**\n\t\t * Pending data.\n\t\t * If the share still doesn't have an id, it is not synced\n\t\t * Therefore this is still not valid and requires user input\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tpendingPassword() {\n\t\t\treturn this.config.enableLinkPasswordByDefault && this.share && !this.share.id\n\t\t},\n\t\tpendingEnforcedPassword() {\n\t\t\treturn this.config.enforcePasswordForPublicLink && this.share && !this.share.id\n\t\t},\n\t\tpendingExpirationDate() {\n\t\t\treturn this.config.isDefaultExpireDateEnforced && this.share && !this.share.id\n\t\t},\n\n\t\tsharePolicyHasRequiredProperties() {\n\t\t\treturn this.config.enforcePasswordForPublicLink || this.config.isDefaultExpireDateEnforced\n\t\t},\n\n\t\trequiredPropertiesMissing() {\n\t\t\t// Ensure share exist and the share policy has required properties\n\t\t\tif (!this.sharePolicyHasRequiredProperties) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (!this.share) {\n\t\t\t\t// if no share, we can't tell if properties are missing or not so we assume properties are missing\n\t\t\t    return true\n\t\t\t}\n\n\t\t\t// If share has ID, then this is an incoming link share created from the existing link share\n\t\t\t// Hence assume required properties\n\t\t\tif (this.share.id) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\t// Check if either password or expiration date is missing and enforced\n\t\t\tconst isPasswordMissing = this.config.enforcePasswordForPublicLink && !this.share.password\n\t\t\tconst isExpireDateMissing = this.config.isDefaultExpireDateEnforced && !this.share.expireDate\n\n\t\t\treturn isPasswordMissing || isExpireDateMissing\n\t\t},\n\t\t// if newPassword exists, but is empty, it means\n\t\t// the user deleted the original password\n\t\thasUnsavedPassword() {\n\t\t\treturn this.share.newPassword !== undefined\n\t\t},\n\n\t\t/**\n\t\t * Return the public share link\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tshareLink() {\n\t\t\treturn window.location.protocol + '//' + window.location.host + generateUrl('/s/') + this.share.token\n\t\t},\n\n\t\t/**\n\t\t * Tooltip message for actions button\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tactionsTooltip() {\n\t\t\treturn t('files_sharing', 'Actions for \"{title}\"', { title: this.title })\n\t\t},\n\n\t\t/**\n\t\t * Tooltip message for copy button\n\t\t *\n\t\t * @return {string}\n\t\t */\n\t\tcopyLinkTooltip() {\n\t\t\tif (this.copied) {\n\t\t\t\tif (this.copySuccess) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\treturn t('files_sharing', 'Cannot copy, please copy the link manually')\n\t\t\t}\n\t\t\treturn t('files_sharing', 'Copy public link of \"{title}\" to clipboard', { title: this.title })\n\t\t},\n\n\t\t/**\n\t\t * External additionnai actions for the menu\n\t\t *\n\t\t * @deprecated use OCA.Sharing.ExternalShareActions\n\t\t * @return {Array}\n\t\t */\n\t\texternalLegacyLinkActions() {\n\t\t\treturn this.ExternalLegacyLinkActions.actions\n\t\t},\n\n\t\t/**\n\t\t * Additional actions for the menu\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\texternalLinkActions() {\n\t\t\tconst filterValidAction = (action) => (action.shareType.includes(ShareTypes.SHARE_TYPE_LINK) || action.shareType.includes(ShareTypes.SHARE_TYPE_EMAIL)) && !action.advanced\n\t\t\t// filter only the registered actions for said link\n\t\t\treturn this.ExternalShareActions.actions\n\t\t\t\t.filter(filterValidAction)\n\t\t},\n\n\t\tisPasswordPolicyEnabled() {\n\t\t\treturn typeof this.config.passwordPolicy === 'object'\n\t\t},\n\n\t\tcanChangeHideDownload() {\n\t\t\tconst hasDisabledDownload = (shareAttribute) => shareAttribute.key === 'download' && shareAttribute.scope === 'permissions' && shareAttribute.enabled === false\n\t\t\treturn this.fileInfo.shareAttributes.some(hasDisabledDownload)\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Create a new share link and append it to the list\n\t\t */\n\t\tasync onNewLinkShare() {\n\t\t\tthis.logger.debug('onNewLinkShare called (with this.share)', this.share)\n\t\t\t// do not run again if already loading\n\t\t\tif (this.loading) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst shareDefaults = {\n\t\t\t\tshare_type: ShareTypes.SHARE_TYPE_LINK,\n\t\t\t}\n\t\t\tif (this.config.isDefaultExpireDateEnforced) {\n\t\t\t\t// default is empty string if not set\n\t\t\t\t// expiration is the share object key, not expireDate\n\t\t\t\tshareDefaults.expiration = this.formatDateToString(this.config.defaultExpirationDate)\n\t\t\t}\n\n\t\t\tthis.logger.debug('Missing required properties?', this.requiredPropertiesMissing)\n\t\t\t// do not push yet if we need a password or an expiration date: show pending menu\n\t\t\tif (this.sharePolicyHasRequiredProperties && this.requiredPropertiesMissing) {\n\t\t\t\tthis.pending = true\n\t\t\t\tthis.shareCreationComplete = false\n\n\t\t\t\tthis.logger.info('Share policy requires mandated properties (password)...')\n\n\t\t\t\t// ELSE, show the pending popovermenu\n\t\t\t\t// if password default or enforced, pre-fill with random one\n\t\t\t\tif (this.config.enableLinkPasswordByDefault || this.config.enforcePasswordForPublicLink) {\n\t\t\t\t\tshareDefaults.password = await GeneratePassword()\n\t\t\t\t}\n\n\t\t\t\t// create share & close menu\n\t\t\t\tconst share = new Share(shareDefaults)\n\t\t\t\tconst component = await new Promise(resolve => {\n\t\t\t\t\tthis.$emit('add:share', share, resolve)\n\t\t\t\t})\n\n\t\t\t\t// open the menu on the\n\t\t\t\t// freshly created share component\n\t\t\t\tthis.open = false\n\t\t\t\tthis.pending = false\n\t\t\t\tcomponent.open = true\n\n\t\t\t\t// Nothing is enforced, creating share directly\n\t\t\t} else {\n\n\t\t\t\t// if a share already exists, pushing it\n\t\t\t\tif (this.share && !this.share.id) {\n\t\t\t\t\t// if the share is valid, create it on the server\n\t\t\t\t\tif (this.checkShare(this.share)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.logger.info('Sending existing share to server', this.share)\n\t\t\t\t\t\t\tawait this.pushNewLinkShare(this.share, true)\n\t\t\t\t\t\t\tthis.shareCreationComplete = true\n\t\t\t\t\t\t\tthis.logger.info('Share created on server', this.share)\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tthis.pending = false\n\t\t\t\t\t\t\tthis.logger.error('Error creating share', e)\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.open = true\n\t\t\t\t\t\tshowError(t('files_sharing', 'Error, please enter proper password and/or expiration date'))\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst share = new Share(shareDefaults)\n\t\t\t\tawait this.pushNewLinkShare(share)\n\t\t\t\tthis.shareCreationComplete = true\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Push a new link share to the server\n\t\t * And update or append to the list\n\t\t * accordingly\n\t\t *\n\t\t * @param {Share} share the new share\n\t\t * @param {boolean} [update] do we update the current share ?\n\t\t */\n\t\tasync pushNewLinkShare(share, update) {\n\t\t\ttry {\n\t\t\t\t// do nothing if we're already pending creation\n\t\t\t\tif (this.loading) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\n\t\t\t\tthis.loading = true\n\t\t\t\tthis.errors = {}\n\n\t\t\t\tconst path = (this.fileInfo.path + '/' + this.fileInfo.name).replace('//', '/')\n\t\t\t\tconst options = {\n\t\t\t\t\tpath,\n\t\t\t\t\tshareType: ShareTypes.SHARE_TYPE_LINK,\n\t\t\t\t\tpassword: share.password,\n\t\t\t\t\texpireDate: share.expireDate,\n\t\t\t\t\tattributes: JSON.stringify(this.fileInfo.shareAttributes),\n\t\t\t\t\t// we do not allow setting the publicUpload\n\t\t\t\t\t// before the share creation.\n\t\t\t\t\t// Todo: We also need to fix the createShare method in\n\t\t\t\t\t// lib/Controller/ShareAPIController.php to allow file drop\n\t\t\t\t\t// (currently not supported on create, only update)\n\t\t\t\t}\n\n\t\t\t\tconsole.debug('Creating link share with options', options)\n\t\t\t\tconst newShare = await this.createShare(options)\n\n\t\t\t\tthis.open = false\n\t\t\t\tthis.shareCreationComplete = true\n\t\t\t\tconsole.debug('Link share created', newShare)\n\t\t\t\t// if share already exists, copy link directly on next tick\n\t\t\t\tlet component\n\t\t\t\tif (update) {\n\t\t\t\t\tcomponent = await new Promise(resolve => {\n\t\t\t\t\t\tthis.$emit('update:share', newShare, resolve)\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\t// adding new share to the array and copying link to clipboard\n\t\t\t\t\t// using promise so that we can copy link in the same click function\n\t\t\t\t\t// and avoid firefox copy permissions issue\n\t\t\t\t\tcomponent = await new Promise(resolve => {\n\t\t\t\t\t\tthis.$emit('add:share', newShare, resolve)\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// Execute the copy link method\n\t\t\t\t// freshly created share component\n\t\t\t\t// ! somehow does not works on firefox !\n\t\t\t\tif (!this.config.enforcePasswordForPublicLink) {\n\t\t\t\t\t// Only copy the link when the password was not forced,\n\t\t\t\t\t// otherwise the user needs to copy/paste the password before finishing the share.\n\t\t\t\t\tcomponent.copyLink()\n\t\t\t\t}\n\t\t\t\tshowSuccess(t('files_sharing', 'Link share created'))\n\n\t\t\t} catch (data) {\n\t\t\t\tconst message = data?.response?.data?.ocs?.meta?.message\n\t\t\t\tif (!message) {\n\t\t\t\t\tshowError(t('files_sharing', 'Error while creating the share'))\n\t\t\t\t\tconsole.error(data)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (message.match(/password/i)) {\n\t\t\t\t\tthis.onSyncError('password', message)\n\t\t\t\t} else if (message.match(/date/i)) {\n\t\t\t\t\tthis.onSyncError('expireDate', message)\n\t\t\t\t} else {\n\t\t\t\t\tthis.onSyncError('pending', message)\n\t\t\t\t}\n\t\t\t\tthrow data\n\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t\tthis.shareCreationComplete = true\n\t\t\t}\n\t\t},\n\t\tasync copyLink() {\n\t\t\ttry {\n\t\t\t\tawait navigator.clipboard.writeText(this.shareLink)\n\t\t\t\tshowSuccess(t('files_sharing', 'Link copied'))\n\t\t\t\t// focus and show the tooltip\n\t\t\t\tthis.$refs.copyButton.$el.focus()\n\t\t\t\tthis.copySuccess = true\n\t\t\t\tthis.copied = true\n\t\t\t} catch (error) {\n\t\t\t\tthis.copySuccess = false\n\t\t\t\tthis.copied = true\n\t\t\t\tconsole.error(error)\n\t\t\t} finally {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.copySuccess = false\n\t\t\t\t\tthis.copied = false\n\t\t\t\t}, 4000)\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Update newPassword values\n\t\t * of share. If password is set but not newPassword\n\t\t * then the user did not changed the password\n\t\t * If both co-exists, the password have changed and\n\t\t * we show it in plain text.\n\t\t * Then on submit (or menu close), we sync it.\n\t\t *\n\t\t * @param {string} password the changed password\n\t\t */\n\t\tonPasswordChange(password) {\n\t\t\tthis.$set(this.share, 'newPassword', password)\n\t\t},\n\n\t\t/**\n\t\t * Uncheck password protection\n\t\t * We need this method because @update:checked\n\t\t * is ran simultaneously as @uncheck, so we\n\t\t * cannot ensure data is up-to-date\n\t\t */\n\t\tonPasswordDisable() {\n\t\t\tthis.share.password = ''\n\n\t\t\t// reset password state after sync\n\t\t\tthis.$delete(this.share, 'newPassword')\n\n\t\t\t// only update if valid share.\n\t\t\tif (this.share.id) {\n\t\t\t\tthis.queueUpdate('password')\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Menu have been closed or password has been submitted.\n\t\t * The only property that does not get\n\t\t * synced automatically is the password\n\t\t * So let's check if we have an unsaved\n\t\t * password.\n\t\t * expireDate is saved on datepicker pick\n\t\t * or close.\n\t\t */\n\t\tonPasswordSubmit() {\n\t\t\tif (this.hasUnsavedPassword) {\n\t\t\t\tthis.share.password = this.share.newPassword.trim()\n\t\t\t\tthis.queueUpdate('password')\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Update the password along with \"sendPasswordByTalk\".\n\t\t *\n\t\t * If the password was modified the new password is sent; otherwise\n\t\t * updating a mail share would fail, as in that case it is required that\n\t\t * a new password is set when enabling or disabling\n\t\t * \"sendPasswordByTalk\".\n\t\t */\n\t\tonPasswordProtectedByTalkChange() {\n\t\t\tif (this.hasUnsavedPassword) {\n\t\t\t\tthis.share.password = this.share.newPassword.trim()\n\t\t\t}\n\n\t\t\tthis.queueUpdate('sendPasswordByTalk', 'password')\n\t\t},\n\n\t\t/**\n\t\t * Save potential changed data on menu close\n\t\t */\n\t\tonMenuClose() {\n\t\t\tthis.onPasswordSubmit()\n\t\t\tthis.onNoteSubmit()\n\t\t},\n\n\t\t/**\n\t\t * Cancel the share creation\n\t\t * Used in the pending popover\n\t\t */\n\t\tonCancel() {\n\t\t\t// this.share already exists at this point,\n\t\t\t// but is incomplete as not pushed to server\n\t\t\t// YET. We can safely delete the share :)\n\t\t\tif (!this.shareCreationComplete) {\n\t\t\t\tthis.$emit('remove:share', this.share)\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\tmin-height: 44px;\n\n\t&__summary {\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tflex: 1 0;\n\t\tmin-width: 0;\n\t}\n\n\t\t&__desc {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\tline-height: 1.2em;\n\n\t\t\tp {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\n\t\t\t&__title {\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\toverflow: hidden;\n\t\t\t\twhite-space: nowrap;\n\t\t\t}\n\t\t}\n\n\t&:not(.sharing-entry--share) &__actions {\n\t\t.new-share-link {\n\t\t\tborder-top: 1px solid var(--color-border);\n\t\t}\n\t}\n\n\t::v-deep .avatar-link-share {\n\t\tbackground-color: var(--color-primary-element);\n\t}\n\n\t.sharing-entry__action--public-upload {\n\t\tborder-bottom: 1px solid var(--color-border);\n\t}\n\n\t&__loading {\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tmargin: 0;\n\t\tpadding: 14px;\n\t\tmargin-left: auto;\n\t}\n\n\t// put menus to the left\n\t// but only the first one\n\t.action-item {\n\n\t\t~.action-item,\n\t\t~.sharing-entry__loading {\n\t\t\tmargin-left: 0;\n\t\t}\n\t}\n\n\t.icon-checkmark-color {\n\t\topacity: 1;\n\t\tcolor: var(--color-success);\n\t}\n}\n\n// styling for the qr-code container\n.qr-code-dialog {\n\tdisplay: flex;\n\twidth: 100%;\n\tjustify-content: center;\n\n\t&__img {\n\t\twidth: 100%;\n\t\theight: auto;\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<ul v-if=\"canLinkShare\" class=\"sharing-link-list\">\n\t\t<!-- If no link shares, show the add link default entry -->\n\t\t<SharingEntryLink v-if=\"!hasLinkShares && canReshare\"\n\t\t\t:can-reshare=\"canReshare\"\n\t\t\t:file-info=\"fileInfo\"\n\t\t\t@add:share=\"addShare\" />\n\n\t\t<!-- Else we display the list -->\n\t\t<template v-if=\"hasShares\">\n\t\t\t<!-- using shares[index] to work with .sync -->\n\t\t\t<SharingEntryLink v-for=\"(share, index) in shares\"\n\t\t\t\t:key=\"share.id\"\n\t\t\t\t:index=\"shares.length > 1 ? index + 1 : null\"\n\t\t\t\t:can-reshare=\"canReshare\"\n\t\t\t\t:share.sync=\"shares[index]\"\n\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t@add:share=\"addShare(...arguments)\"\n\t\t\t\t@update:share=\"awaitForShare(...arguments)\"\n\t\t\t\t@remove:share=\"removeShare\"\n\t\t\t\t@open-sharing-details=\"openSharingDetails(share)\" />\n\t\t</template>\n\t</ul>\n</template>\n\n<script>\nimport { getCapabilities } from '@nextcloud/capabilities'\n\n// eslint-disable-next-line no-unused-vars\nimport Share from '../models/Share.js'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport SharingEntryLink from '../components/SharingEntryLink.vue'\nimport ShareDetails from '../mixins/ShareDetails.js'\n\nexport default {\n\tname: 'SharingLinkList',\n\n\tcomponents: {\n\t\tSharingEntryLink,\n\t},\n\n\tmixins: [ShareTypes, ShareDetails],\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => {},\n\t\t\trequired: true,\n\t\t},\n\t\tshares: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t\trequired: true,\n\t\t},\n\t\tcanReshare: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tcanLinkShare: getCapabilities().files_sharing.public.enabled,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Do we have link shares?\n\t\t * Using this to still show the `new link share`\n\t\t * button regardless of mail shares\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\thasLinkShares() {\n\t\t\treturn this.shares.filter(share => share.type === this.SHARE_TYPES.SHARE_TYPE_LINK).length > 0\n\t\t},\n\n\t\t/**\n\t\t * Do we have any link or email shares?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\thasShares() {\n\t\t\treturn this.shares.length > 0\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Add a new share into the link shares list\n\t\t * and return the newly created share component\n\t\t *\n\t\t * @param {Share} share the share to add to the array\n\t\t * @param {Function} resolve a function to run after the share is added and its component initialized\n\t\t */\n\t\taddShare(share, resolve) {\n\t\t\t// eslint-disable-next-line vue/no-mutating-props\n\t\t\tthis.shares.unshift(share)\n\t\t\tthis.awaitForShare(share, resolve)\n\t\t},\n\n\t\t/**\n\t\t * Await for next tick and render after the list updated\n\t\t * Then resolve with the matched vue component of the\n\t\t * provided share object\n\t\t *\n\t\t * @param {Share} share newly created share\n\t\t * @param {Function} resolve a function to execute after\n\t\t */\n\t\tawaitForShare(share, resolve) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst newShare = this.$children.find(component => component.share === share)\n\t\t\t\tif (newShare) {\n\t\t\t\t\tresolve(newShare)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * Remove a share from the shares list\n\t\t *\n\t\t * @param {Share} share the share to remove\n\t\t */\n\t\tremoveShare(share) {\n\t\t\tconst index = this.shares.findIndex(item => item === share)\n\t\t\t// eslint-disable-next-line vue/no-mutating-props\n\t\t\tthis.shares.splice(index, 1)\n\t\t},\n\t},\n}\n</script>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<li class=\"sharing-entry\">\n\t\t<NcAvatar class=\"sharing-entry__avatar\"\n\t\t\t:is-no-user=\"share.type !== SHARE_TYPES.SHARE_TYPE_USER\"\n\t\t\t:user=\"share.shareWith\"\n\t\t\t:display-name=\"share.shareWithDisplayName\"\n\t\t\t:menu-position=\"'left'\"\n\t\t\t:url=\"share.shareWithAvatar\" />\n\n\t\t<div class=\"sharing-entry__summary\">\n\t\t\t<component :is=\"share.shareWithLink ? 'a' : 'div'\"\n\t\t\t\t:title=\"tooltip\"\n\t\t\t\t:aria-label=\"tooltip\"\n\t\t\t\t:href=\"share.shareWithLink\"\n\t\t\t\tclass=\"sharing-entry__summary__desc\">\n\t\t\t\t<span>{{ title }}\n\t\t\t\t\t<span v-if=\"!isUnique\" class=\"sharing-entry__summary__desc-unique\"> ({{\n\t\t\t\t\t\tshare.shareWithDisplayNameUnique }})</span>\n\t\t\t\t\t<small v-if=\"hasStatus && share.status.message\">({{ share.status.message }})</small>\n\t\t\t\t</span>\n\t\t\t</component>\n\t\t\t<SharingEntryQuickShareSelect :share=\"share\"\n\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t@open-sharing-details=\"openShareDetailsForCustomSettings(share)\" />\n\t\t</div>\n\t\t<NcButton class=\"sharing-entry__action\"\n\t\t\tdata-cy-files-sharing-share-actions\n\t\t\t:aria-label=\"t('files_sharing', 'Open Sharing Details')\"\n\t\t\ttype=\"tertiary\"\n\t\t\t@click=\"openSharingDetails(share)\">\n\t\t\t<template #icon>\n\t\t\t\t<DotsHorizontalIcon :size=\"20\" />\n\t\t\t</template>\n\t\t</NcButton>\n\t</li>\n</template>\n\n<script>\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcSelect from '@nextcloud/vue/dist/Components/NcSelect.js'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport DotsHorizontalIcon from 'vue-material-design-icons/DotsHorizontal.vue'\n\nimport SharingEntryQuickShareSelect from './SharingEntryQuickShareSelect.vue'\n\nimport SharesMixin from '../mixins/SharesMixin.js'\nimport ShareDetails from '../mixins/ShareDetails.js'\n\nexport default {\n\tname: 'SharingEntry',\n\n\tcomponents: {\n\t\tNcButton,\n\t\tNcAvatar,\n\t\tDotsHorizontalIcon,\n\t\tNcSelect,\n\t\tSharingEntryQuickShareSelect,\n\t},\n\n\tmixins: [SharesMixin, ShareDetails],\n\n\tcomputed: {\n\t\ttitle() {\n\t\t\tlet title = this.share.shareWithDisplayName\n\t\t\tif (this.share.type === this.SHARE_TYPES.SHARE_TYPE_GROUP) {\n\t\t\t\ttitle += ` (${t('files_sharing', 'group')})`\n\t\t\t} else if (this.share.type === this.SHARE_TYPES.SHARE_TYPE_ROOM) {\n\t\t\t\ttitle += ` (${t('files_sharing', 'conversation')})`\n\t\t\t} else if (this.share.type === this.SHARE_TYPES.SHARE_TYPE_REMOTE) {\n\t\t\t\ttitle += ` (${t('files_sharing', 'remote')})`\n\t\t\t} else if (this.share.type === this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP) {\n\t\t\t\ttitle += ` (${t('files_sharing', 'remote group')})`\n\t\t\t} else if (this.share.type === this.SHARE_TYPES.SHARE_TYPE_GUEST) {\n\t\t\t\ttitle += ` (${t('files_sharing', 'guest')})`\n\t\t\t}\n\t\t\treturn title\n\t\t},\n\t\ttooltip() {\n\t\t\tif (this.share.owner !== this.share.uidFileOwner) {\n\t\t\t\tconst data = {\n\t\t\t\t\t// todo: strong or italic?\n\t\t\t\t\t// but the t function escape any html from the data :/\n\t\t\t\t\tuser: this.share.shareWithDisplayName,\n\t\t\t\t\towner: this.share.ownerDisplayName,\n\t\t\t\t}\n\t\t\t\tif (this.share.type === this.SHARE_TYPES.SHARE_TYPE_GROUP) {\n\t\t\t\t\treturn t('files_sharing', 'Shared with the group {user} by {owner}', data)\n\t\t\t\t} else if (this.share.type === this.SHARE_TYPES.SHARE_TYPE_ROOM) {\n\t\t\t\t\treturn t('files_sharing', 'Shared with the conversation {user} by {owner}', data)\n\t\t\t\t}\n\n\t\t\t\treturn t('files_sharing', 'Shared with {user} by {owner}', data)\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\n\t\t/**\n\t\t * @return {boolean}\n\t\t */\n\t\thasStatus() {\n\t\t\tif (this.share.type !== this.SHARE_TYPES.SHARE_TYPE_USER) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn (typeof this.share.status === 'object' && !Array.isArray(this.share.status))\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Save potential changed data on menu close\n\t\t */\n\t\tonMenuClose() {\n\t\t\tthis.onNoteSubmit()\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharing-entry {\n\tdisplay: flex;\n\talign-items: center;\n\theight: 44px;\n\t&__summary {\n\t\tpadding: 8px;\n\t\tpadding-left: 10px;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: flex-start;\n\t\tflex: 1 0;\n\t\tmin-width: 0;\n\n\t\t&__desc {\n\t\t\tdisplay: inline-block;\n\t\t\tpadding-bottom: 0;\n\t\t\tline-height: 1.2em;\n\t\t\twhite-space: nowrap;\n\t\t\toverflow: hidden;\n\t\t\ttext-overflow: ellipsis;\n\n\t\t\tp,\n\t\t\tsmall {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\n\t\t\t&-unique {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t}\n\t\t}\n\t}\n\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<ul class=\"sharing-sharee-list\">\n\t\t<SharingEntry v-for=\"share in shares\"\n\t\t\t:key=\"share.id\"\n\t\t\t:file-info=\"fileInfo\"\n\t\t\t:share=\"share\"\n\t\t\t:is-unique=\"isUnique(share)\"\n\t\t\t@open-sharing-details=\"openSharingDetails(share)\" />\n\t</ul>\n</template>\n\n<script>\n// eslint-disable-next-line no-unused-vars\nimport SharingEntry from '../components/SharingEntry.vue'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport ShareDetails from '../mixins/ShareDetails.js'\n\nexport default {\n\tname: 'SharingList',\n\n\tcomponents: {\n\t\tSharingEntry,\n\t},\n\n\tmixins: [ShareTypes, ShareDetails],\n\n\tprops: {\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => { },\n\t\t\trequired: true,\n\t\t},\n\t\tshares: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\thasShares() {\n\t\t\treturn this.shares.length === 0\n\t\t},\n\t\tisUnique() {\n\t\t\treturn (share) => {\n\t\t\t\treturn [...this.shares].filter((item) => {\n\t\t\t\t\treturn share.type === this.SHARE_TYPES.SHARE_TYPE_USER && share.shareWithDisplayName === item.shareWithDisplayName\n\t\t\t\t}).length <= 1\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n","<!--\n  - SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<div class=\"sharingTabDetailsView\">\n\t\t<div class=\"sharingTabDetailsView__header\">\n\t\t\t<span>\n\t\t\t\t<NcAvatar v-if=\"isUserShare\"\n\t\t\t\t\tclass=\"sharing-entry__avatar\"\n\t\t\t\t\t:is-no-user=\"share.shareType !== SHARE_TYPES.SHARE_TYPE_USER\"\n\t\t\t\t\t:user=\"share.shareWith\"\n\t\t\t\t\t:display-name=\"share.shareWithDisplayName\"\n\t\t\t\t\t:menu-position=\"'left'\"\n\t\t\t\t\t:url=\"share.shareWithAvatar\" />\n\t\t\t\t<component :is=\"getShareTypeIcon(share.type)\" :size=\"32\" />\n\t\t\t</span>\n\t\t\t<span>\n\t\t\t\t<h1>{{ title }}</h1>\n\t\t\t</span>\n\t\t</div>\n\t\t<div class=\"sharingTabDetailsView__wrapper\">\n\t\t\t<div ref=\"quickPermissions\" class=\"sharingTabDetailsView__quick-permissions\">\n\t\t\t\t<div>\n\t\t\t\t\t<NcCheckboxRadioSwitch :button-variant=\"true\"\n\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-bundle=\"read-only\"\n\t\t\t\t\t\t:checked.sync=\"sharingPermission\"\n\t\t\t\t\t\t:value=\"bundledPermissions.READ_ONLY.toString()\"\n\t\t\t\t\t\tname=\"sharing_permission_radio\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tbutton-variant-grouped=\"vertical\"\n\t\t\t\t\t\t@update:checked=\"toggleCustomPermissions\">\n\t\t\t\t\t\t{{ t('files_sharing', 'View only') }}\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<ViewIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch :button-variant=\"true\"\n\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-bundle=\"upload-edit\"\n\t\t\t\t\t\t:checked.sync=\"sharingPermission\"\n\t\t\t\t\t\t:value=\"bundledPermissions.ALL.toString()\"\n\t\t\t\t\t\tname=\"sharing_permission_radio\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tbutton-variant-grouped=\"vertical\"\n\t\t\t\t\t\t@update:checked=\"toggleCustomPermissions\">\n\t\t\t\t\t\t<template v-if=\"allowsFileDrop\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Allow upload and editing') }}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Allow editing') }}\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<EditIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"allowsFileDrop\"\n\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-bundle=\"file-drop\"\n\t\t\t\t\t\t:button-variant=\"true\"\n\t\t\t\t\t\t:checked.sync=\"sharingPermission\"\n\t\t\t\t\t\t:value=\"bundledPermissions.FILE_DROP.toString()\"\n\t\t\t\t\t\tname=\"sharing_permission_radio\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tbutton-variant-grouped=\"vertical\"\n\t\t\t\t\t\t@update:checked=\"toggleCustomPermissions\">\n\t\t\t\t\t\t{{ t('files_sharing', 'File drop') }}\n\t\t\t\t\t\t<small class=\"subline\">{{ t('files_sharing', 'Upload only') }}</small>\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<UploadIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch :button-variant=\"true\"\n\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-bundle=\"custom\"\n\t\t\t\t\t\t:checked.sync=\"sharingPermission\"\n\t\t\t\t\t\t:value=\"'custom'\"\n\t\t\t\t\t\tname=\"sharing_permission_radio\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tbutton-variant-grouped=\"vertical\"\n\t\t\t\t\t\t@update:checked=\"expandCustomPermissions\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Custom permissions') }}\n\t\t\t\t\t\t<small class=\"subline\">{{ customPermissionsList }}</small>\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<DotsHorizontalIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"sharingTabDetailsView__advanced-control\">\n\t\t\t\t<NcButton id=\"advancedSectionAccordionAdvancedControl\"\n\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\talignment=\"end-reverse\"\n\t\t\t\t\taria-controls=\"advancedSectionAccordionAdvanced\"\n\t\t\t\t\t:aria-expanded=\"advancedControlExpandedValue\"\n\t\t\t\t\t@click=\"advancedSectionAccordionExpanded = !advancedSectionAccordionExpanded\">\n\t\t\t\t\t{{ t('files_sharing', 'Advanced settings') }}\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<MenuDownIcon v-if=\"!advancedSectionAccordionExpanded\" />\n\t\t\t\t\t\t<MenuUpIcon v-else />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t\t<div v-if=\"advancedSectionAccordionExpanded\"\n\t\t\t\tid=\"advancedSectionAccordionAdvanced\"\n\t\t\t\tclass=\"sharingTabDetailsView__advanced\"\n\t\t\t\taria-labelledby=\"advancedSectionAccordionAdvancedControl\"\n\t\t\t\trole=\"region\">\n\t\t\t\t<section>\n\t\t\t\t\t<NcInputField v-if=\"isPublicShare\"\n\t\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\t\t:label=\"t('files_sharing', 'Share label')\"\n\t\t\t\t\t\t:value.sync=\"share.label\" />\n\t\t\t\t\t<template v-if=\"isPublicShare\">\n\t\t\t\t\t\t<NcCheckboxRadioSwitch :checked.sync=\"isPasswordProtected\" :disabled=\"isPasswordEnforced\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Set password') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<NcPasswordField v-if=\"isPasswordProtected\"\n\t\t\t\t\t\t\tautocomplete=\"new-password\"\n\t\t\t\t\t\t\t:value=\"hasUnsavedPassword ? share.newPassword : ''\"\n\t\t\t\t\t\t\t:error=\"passwordError\"\n\t\t\t\t\t\t\t:helper-text=\"errorPasswordLabel\"\n\t\t\t\t\t\t\t:required=\"isPasswordEnforced\"\n\t\t\t\t\t\t\t:label=\"t('files_sharing', 'Password')\"\n\t\t\t\t\t\t\t@update:value=\"onPasswordChange\" />\n\n\t\t\t\t\t\t<!-- Migrate icons and remote -> icon=\"icon-info\"-->\n\t\t\t\t\t\t<span v-if=\"isEmailShareType && passwordExpirationTime\" icon=\"icon-info\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Password expires {passwordExpirationTime}', { passwordExpirationTime }) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span v-else-if=\"isEmailShareType && passwordExpirationTime !== null\" icon=\"icon-error\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Password expired') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"canTogglePasswordProtectedByTalkAvailable\"\n\t\t\t\t\t\t:checked.sync=\"isPasswordProtectedByTalk\"\n\t\t\t\t\t\t@update:checked=\"onPasswordProtectedByTalkChange\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Video verification') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch :checked.sync=\"hasExpirationDate\" :disabled=\"isExpiryDateEnforced\">\n\t\t\t\t\t\t{{ isExpiryDateEnforced\n\t\t\t\t\t\t\t? t('files_sharing', 'Expiration date (enforced)')\n\t\t\t\t\t\t\t: t('files_sharing', 'Set expiration date') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcDateTimePickerNative v-if=\"hasExpirationDate\"\n\t\t\t\t\t\tid=\"share-date-picker\"\n\t\t\t\t\t\t:value=\"new Date(share.expireDate ?? dateTomorrow)\"\n\t\t\t\t\t\t:min=\"dateTomorrow\"\n\t\t\t\t\t\t:max=\"maxExpirationDateEnforced\"\n\t\t\t\t\t\t:hide-label=\"true\"\n\t\t\t\t\t\t:placeholder=\"t('files_sharing', 'Expiration date')\"\n\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t@input=\"onExpirationChange\" />\n\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"isPublicShare\"\n\t\t\t\t\t\t:disabled=\"canChangeHideDownload\"\n\t\t\t\t\t\t:checked.sync=\"share.hideDownload\"\n\t\t\t\t\t\t@update:checked=\"queueUpdate('hideDownload')\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Hide download') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"!isPublicShare\"\n\t\t\t\t\t\t:disabled=\"!canSetDownload\"\n\t\t\t\t\t\t:checked.sync=\"canDownload\"\n\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"download\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Allow download') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<NcCheckboxRadioSwitch :checked.sync=\"writeNoteToRecipientIsChecked\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Note to recipient') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<template v-if=\"writeNoteToRecipientIsChecked\">\n\t\t\t\t\t\t<label for=\"share-note-textarea\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Enter a note for the share recipient') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<textarea id=\"share-note-textarea\" :value=\"share.note\" @input=\"share.note = $event.target.value\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t<ExternalShareAction v-for=\"action in externalLinkActions\"\n\t\t\t\t\t\t:id=\"action.id\"\n\t\t\t\t\t\tref=\"externalLinkActions\"\n\t\t\t\t\t\t:key=\"action.id\"\n\t\t\t\t\t\t:action=\"action\"\n\t\t\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t\t\t:share=\"share\" />\n\t\t\t\t\t<NcCheckboxRadioSwitch :checked.sync=\"setCustomPermissions\">\n\t\t\t\t\t\t{{ t('files_sharing', 'Custom permissions') }}\n\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t<section v-if=\"setCustomPermissions\" class=\"custom-permissions-group\">\n\t\t\t\t\t\t<NcCheckboxRadioSwitch :disabled=\"!allowsFileDrop && share.type === SHARE_TYPES.SHARE_TYPE_LINK\"\n\t\t\t\t\t\t\t:checked.sync=\"hasRead\"\n\t\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"read\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Read') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"isFolder\"\n\t\t\t\t\t\t\t:disabled=\"!canSetCreate\"\n\t\t\t\t\t\t\t:checked.sync=\"canCreate\"\n\t\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"create\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Create') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch :disabled=\"!canSetEdit\"\n\t\t\t\t\t\t\t:checked.sync=\"canEdit\"\n\t\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"update\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Edit') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch v-if=\"config.isResharingAllowed && share.type !== SHARE_TYPES.SHARE_TYPE_LINK\"\n\t\t\t\t\t\t\t:disabled=\"!canSetReshare\"\n\t\t\t\t\t\t\t:checked.sync=\"canReshare\"\n\t\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"share\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Share') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t\t<NcCheckboxRadioSwitch :disabled=\"!canSetDelete\"\n\t\t\t\t\t\t\t:checked.sync=\"canDelete\"\n\t\t\t\t\t\t\tdata-cy-files-sharing-share-permissions-checkbox=\"delete\">\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Delete') }}\n\t\t\t\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t\t\t</section>\n\t\t\t\t\t<div class=\"sharingTabDetailsView__delete\">\n\t\t\t\t\t\t<NcButton v-if=\"!isNewShare\"\n\t\t\t\t\t\t\t:aria-label=\"t('files_sharing', 'Delete share')\"\n\t\t\t\t\t\t\t:disabled=\"false\"\n\t\t\t\t\t\t\t:readonly=\"false\"\n\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t@click.prevent=\"removeShare\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<CloseIcon :size=\"16\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ t('files_sharing', 'Delete share') }}\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"sharingTabDetailsView__footer\">\n\t\t\t<div class=\"button-group\">\n\t\t\t\t<NcButton data-cy-files-sharing-share-editor-action=\"cancel\"\n\t\t\t\t\t@click=\"$emit('close-sharing-details')\">\n\t\t\t\t\t{{ t('files_sharing', 'Cancel') }}\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton type=\"primary\"\n\t\t\t\t\tdata-cy-files-sharing-share-editor-action=\"save\"\n\t\t\t\t\t@click=\"saveShare\">\n\t\t\t\t\t{{ shareButtonText }}\n\t\t\t\t\t<template v-if=\"creating\" #icon>\n\t\t\t\t\t\t<NcLoadingIcon />\n\t\t\t\t\t</template>\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getLanguage } from '@nextcloud/l10n'\nimport { Type as ShareType } from '@nextcloud/sharing'\n\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcInputField from '@nextcloud/vue/dist/Components/NcInputField.js'\nimport NcPasswordField from '@nextcloud/vue/dist/Components/NcPasswordField.js'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport NcDateTimePickerNative from '@nextcloud/vue/dist/Components/NcDateTimePickerNative.js'\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\nimport CircleIcon from 'vue-material-design-icons/CircleOutline.vue'\nimport CloseIcon from 'vue-material-design-icons/Close.vue'\nimport EditIcon from 'vue-material-design-icons/Pencil.vue'\nimport EmailIcon from 'vue-material-design-icons/Email.vue'\nimport LinkIcon from 'vue-material-design-icons/Link.vue'\nimport GroupIcon from 'vue-material-design-icons/AccountGroup.vue'\nimport ShareIcon from 'vue-material-design-icons/ShareCircle.vue'\nimport UserIcon from 'vue-material-design-icons/AccountCircleOutline.vue'\nimport ViewIcon from 'vue-material-design-icons/Eye.vue'\nimport UploadIcon from 'vue-material-design-icons/Upload.vue'\nimport MenuDownIcon from 'vue-material-design-icons/MenuDown.vue'\nimport MenuUpIcon from 'vue-material-design-icons/MenuUp.vue'\nimport DotsHorizontalIcon from 'vue-material-design-icons/DotsHorizontal.vue'\n\nimport ExternalShareAction from '../components/ExternalShareAction.vue'\n\nimport GeneratePassword from '../utils/GeneratePassword.js'\nimport Share from '../models/Share.js'\nimport ShareRequests from '../mixins/ShareRequests.js'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport SharesMixin from '../mixins/SharesMixin.js'\n\nimport {\n\tATOMIC_PERMISSIONS,\n\tBUNDLED_PERMISSIONS,\n\thasPermissions,\n} from '../lib/SharePermissionsToolBox.js'\n\nexport default {\n\tname: 'SharingDetailsTab',\n\tcomponents: {\n\t\tNcAvatar,\n\t\tNcButton,\n\t\tNcInputField,\n\t\tNcPasswordField,\n\t\tNcDateTimePickerNative,\n\t\tNcCheckboxRadioSwitch,\n\t\tNcLoadingIcon,\n\t\tCloseIcon,\n\t\tCircleIcon,\n\t\tEditIcon,\n\t\tExternalShareAction,\n\t\tLinkIcon,\n\t\tGroupIcon,\n\t\tShareIcon,\n\t\tUserIcon,\n\t\tUploadIcon,\n\t\tViewIcon,\n\t\tMenuDownIcon,\n\t\tMenuUpIcon,\n\t\tDotsHorizontalIcon,\n\t},\n\tmixins: [ShareTypes, ShareRequests, SharesMixin],\n\tprops: {\n\t\tshareRequestValue: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tfileInfo: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tshare: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\twriteNoteToRecipientIsChecked: false,\n\t\t\tsharingPermission: BUNDLED_PERMISSIONS.ALL.toString(),\n\t\t\trevertSharingPermission: BUNDLED_PERMISSIONS.ALL.toString(),\n\t\t\tsetCustomPermissions: false,\n\t\t\tpasswordError: false,\n\t\t\tadvancedSectionAccordionExpanded: false,\n\t\t\tbundledPermissions: BUNDLED_PERMISSIONS,\n\t\t\tisFirstComponentLoad: true,\n\t\t\ttest: false,\n\t\t\tcreating: false,\n\n\t\t\tExternalShareActions: OCA.Sharing.ExternalShareActions.state,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\ttitle() {\n\t\t\tswitch (this.share.type) {\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_USER:\n\t\t\t\treturn t('files_sharing', 'Share with {userName}', { userName: this.share.shareWithDisplayName })\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_EMAIL:\n\t\t\t    return t('files_sharing', 'Share with email {email}', { email: this.share.shareWith })\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_LINK:\n\t\t\t\treturn t('files_sharing', 'Share link')\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GROUP:\n\t\t\t\treturn t('files_sharing', 'Share with group')\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_ROOM:\n\t\t\t\treturn t('files_sharing', 'Share in conversation')\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_REMOTE: {\n\t\t\t\tconst [user, server] = this.share.shareWith.split('@')\n\t\t\t\treturn t('files_sharing', 'Share with {user} on remote server {server}', { user, server })\n\t\t\t}\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP:\n\t\t\t\treturn t('files_sharing', 'Share with remote group')\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GUEST:\n\t\t\t\treturn t('files_sharing', 'Share with guest')\n\t\t\tdefault: {\n\t\t\t        if (this.share.id) {\n\t\t\t\t\t    // Share already exists\n\t\t\t\t\t    return t('files_sharing', 'Update share')\n\t\t\t\t    } else {\n\t\t\t\t\t    return t('files_sharing', 'Create share')\n\t\t\t\t    }\n\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Can the sharee edit the shared file ?\n\t\t */\n\t\tcanEdit: {\n\t\t\tget() {\n\t\t\t\treturn this.share.hasUpdatePermission\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\tthis.updateAtomicPermissions({ isEditChecked: checked })\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Can the sharee create the shared file ?\n\t\t */\n\t\tcanCreate: {\n\t\t\tget() {\n\t\t\t\treturn this.share.hasCreatePermission\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\tthis.updateAtomicPermissions({ isCreateChecked: checked })\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Can the sharee delete the shared file ?\n\t\t */\n\t\tcanDelete: {\n\t\t\tget() {\n\t\t\t\treturn this.share.hasDeletePermission\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\tthis.updateAtomicPermissions({ isDeleteChecked: checked })\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Can the sharee reshare the file ?\n\t\t */\n\t\tcanReshare: {\n\t\t\tget() {\n\t\t\t\treturn this.share.hasSharePermission\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\tthis.updateAtomicPermissions({ isReshareChecked: checked })\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Can the sharee download files or only view them ?\n\t\t */\n\t\tcanDownload: {\n\t\t\tget() {\n\t\t\t\treturn this.share.attributes.find(attr => attr.key === 'download')?.enabled || false\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\t// Find the 'download' attribute and update its value\n\t\t\t\tconst downloadAttr = this.share.attributes.find(attr => attr.key === 'download')\n\t\t\t\tif (downloadAttr) {\n\t\t\t\t\tdownloadAttr.enabled = checked\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Is this share readable\n\t\t * Needed for some federated shares that might have been added from file drop links\n\t\t */\n\t\thasRead: {\n\t\t\tget() {\n\t\t\t\treturn this.share.hasReadPermission\n\t\t\t},\n\t\t\tset(checked) {\n\t\t\t\tthis.updateAtomicPermissions({ isReadChecked: checked })\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Does the current share have an expiration date\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\thasExpirationDate: {\n\t\t\tget() {\n\t\t\t\treturn this.isValidShareAttribute(this.share.expireDate)\n\t\t\t},\n\t\t\tset(enabled) {\n\t\t\t\tthis.share.expireDate = enabled\n\t\t\t\t\t? this.formatDateToString(this.defaultExpiryDate)\n\t\t\t\t\t: ''\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Is the current share password protected ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtected: {\n\t\t\tget() {\n\t\t\t\treturn this.config.enforcePasswordForPublicLink\n\t\t\t\t\t|| !!this.share.password\n\t\t\t},\n\t\t\tasync set(enabled) {\n\t\t\t\tif (enabled) {\n\t\t\t\t\tthis.share.password = await GeneratePassword()\n\t\t\t\t\tthis.$set(this.share, 'newPassword', this.share.password)\n\t\t\t\t} else {\n\t\t\t\t\tthis.share.password = ''\n\t\t\t\t\tthis.$delete(this.share, 'newPassword')\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Is the current share a folder ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisFolder() {\n\t\t\treturn this.fileInfo.type === 'dir'\n\t\t},\n\t\t/**\n\t\t * @return {boolean}\n\t\t */\n\t\tisSetDownloadButtonVisible() {\n\t\t\tconst allowedMimetypes = [\n\t\t\t\t// Office documents\n\t\t\t\t'application/msword',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t\t\t'application/vnd.ms-powerpoint',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n\t\t\t\t'application/vnd.ms-excel',\n\t\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t\t\t'application/vnd.oasis.opendocument.text',\n\t\t\t\t'application/vnd.oasis.opendocument.spreadsheet',\n\t\t\t\t'application/vnd.oasis.opendocument.presentation',\n\t\t\t]\n\n\t\t\treturn this.isFolder || allowedMimetypes.includes(this.fileInfo.mimetype)\n\t\t},\n\t\tisPasswordEnforced() {\n\t\t\treturn this.isPublicShare && this.config.enforcePasswordForPublicLink\n\t\t},\n\t\tdefaultExpiryDate() {\n\t\t\tif ((this.isGroupShare || this.isUserShare) && this.config.isDefaultInternalExpireDateEnabled) {\n\t\t\t\treturn new Date(this.config.defaultInternalExpirationDate)\n\t\t\t} else if (this.isRemoteShare && this.config.isDefaultRemoteExpireDateEnabled) {\n\t\t\t\treturn new Date(this.config.defaultRemoteExpireDateEnabled)\n\t\t\t} else if (this.isPublicShare && this.config.isDefaultExpireDateEnabled) {\n\t\t\t\treturn new Date(this.config.defaultExpirationDate)\n\t\t\t}\n\t\t\treturn new Date(new Date().setDate(new Date().getDate() + 1))\n\t\t},\n\t\tisUserShare() {\n\t\t\treturn this.share.type === this.SHARE_TYPES.SHARE_TYPE_USER\n\t\t},\n\t\tisGroupShare() {\n\t\t\treturn this.share.type === this.SHARE_TYPES.SHARE_TYPE_GROUP\n\t\t},\n\t\tisNewShare() {\n\t\t\treturn !this.share.id\n\t\t},\n\t\tallowsFileDrop() {\n\t\t\tif (this.isFolder && this.config.isPublicUploadEnabled) {\n\t\t\t\tif (this.share.type === this.SHARE_TYPES.SHARE_TYPE_LINK || this.share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false\n\t\t},\n\t\thasFileDropPermissions() {\n\t\t\treturn this.share.permissions === this.bundledPermissions.FILE_DROP\n\t\t},\n\t\tshareButtonText() {\n\t\t\tif (this.isNewShare) {\n\t\t\t\treturn t('files_sharing', 'Save share')\n\t\t\t}\n\t\t\treturn t('files_sharing', 'Update share')\n\n\t\t},\n\t\t/**\n\t\t * Can the sharer set whether the sharee can edit the file ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tcanSetEdit() {\n\t\t\t// If the owner revoked the permission after the resharer granted it\n\t\t\t// the share still has the permission, and the resharer is still\n\t\t\t// allowed to revoke it too (but not to grant it again).\n\t\t\treturn (this.fileInfo.sharePermissions & OC.PERMISSION_UPDATE) || this.canEdit\n\t\t},\n\n\t\t/**\n\t\t * Can the sharer set whether the sharee can create the file ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tcanSetCreate() {\n\t\t\t// If the owner revoked the permission after the resharer granted it\n\t\t\t// the share still has the permission, and the resharer is still\n\t\t\t// allowed to revoke it too (but not to grant it again).\n\t\t\treturn (this.fileInfo.sharePermissions & OC.PERMISSION_CREATE) || this.canCreate\n\t\t},\n\n\t\t/**\n\t\t * Can the sharer set whether the sharee can delete the file ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tcanSetDelete() {\n\t\t\t// If the owner revoked the permission after the resharer granted it\n\t\t\t// the share still has the permission, and the resharer is still\n\t\t\t// allowed to revoke it too (but not to grant it again).\n\t\t\treturn (this.fileInfo.sharePermissions & OC.PERMISSION_DELETE) || this.canDelete\n\t\t},\n\t\t/**\n\t\t * Can the sharer set whether the sharee can reshare the file ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tcanSetReshare() {\n\t\t\t// If the owner revoked the permission after the resharer granted it\n\t\t\t// the share still has the permission, and the resharer is still\n\t\t\t// allowed to revoke it too (but not to grant it again).\n\t\t\treturn (this.fileInfo.sharePermissions & OC.PERMISSION_SHARE) || this.canReshare\n\t\t},\n\t\t/**\n\t\t * Can the sharer set whether the sharee can download the file ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tcanSetDownload() {\n\t\t\t// If the owner revoked the permission after the resharer granted it\n\t\t\t// the share still has the permission, and the resharer is still\n\t\t\t// allowed to revoke it too (but not to grant it again).\n\t\t\treturn (this.fileInfo.canDownload() || this.canDownload)\n\t\t},\n\t\t// if newPassword exists, but is empty, it means\n\t\t// the user deleted the original password\n\t\thasUnsavedPassword() {\n\t\t\treturn this.share.newPassword !== undefined\n\t\t},\n\t\tpasswordExpirationTime() {\n\t\t\tif (!this.isValidShareAttribute(this.share.passwordExpirationTime)) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\tconst expirationTime = moment(this.share.passwordExpirationTime)\n\n\t\t\tif (expirationTime.diff(moment()) < 0) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn expirationTime.fromNow()\n\t\t},\n\n\t\t/**\n\t\t * Is Talk enabled?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisTalkEnabled() {\n\t\t\treturn OC.appswebroots.spreed !== undefined\n\t\t},\n\n\t\t/**\n\t\t * Is it possible to protect the password by Talk?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtectedByTalkAvailable() {\n\t\t\treturn this.isPasswordProtected && this.isTalkEnabled\n\t\t},\n\t\t/**\n\t\t * Is the current share password protected by Talk?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisPasswordProtectedByTalk: {\n\t\t\tget() {\n\t\t\t\treturn this.share.sendPasswordByTalk\n\t\t\t},\n\t\t\tasync set(enabled) {\n\t\t\t\tthis.share.sendPasswordByTalk = enabled\n\t\t\t},\n\t\t},\n\t\t/**\n\t\t * Is the current share an email share ?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisEmailShareType() {\n\t\t\treturn this.share\n\t\t\t\t? this.share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL\n\t\t\t\t: false\n\t\t},\n\t\tcanTogglePasswordProtectedByTalkAvailable() {\n\t\t\tif (!this.isPublicShare || !this.isPasswordProtected) {\n\t\t\t\t// Makes no sense\n\t\t\t\treturn false\n\t\t\t} else if (this.isEmailShareType && !this.hasUnsavedPassword) {\n\t\t\t\t// For email shares we need a new password in order to enable or\n\t\t\t\t// disable\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\t// Is Talk enabled?\n\t\t\treturn OC.appswebroots.spreed !== undefined\n\t\t},\n\t\tcanChangeHideDownload() {\n\t\t\tconst hasDisabledDownload = (shareAttribute) => shareAttribute.key === 'download' && shareAttribute.scope === 'permissions' && shareAttribute.enabled === false\n\t\t\treturn this.fileInfo.shareAttributes.some(hasDisabledDownload)\n\t\t},\n\t\tcustomPermissionsList() {\n\t\t\t// Key order will be different, because ATOMIC_PERMISSIONS are numbers\n\t\t\tconst translatedPermissions = {\n\t\t\t\t[ATOMIC_PERMISSIONS.READ]: this.t('files_sharing', 'Read'),\n\t\t\t\t[ATOMIC_PERMISSIONS.CREATE]: this.t('files_sharing', 'Create'),\n\t\t\t\t[ATOMIC_PERMISSIONS.UPDATE]: this.t('files_sharing', 'Edit'),\n\t\t\t\t[ATOMIC_PERMISSIONS.SHARE]: this.t('files_sharing', 'Share'),\n\t\t\t\t[ATOMIC_PERMISSIONS.DELETE]: this.t('files_sharing', 'Delete'),\n\t\t\t}\n\n\t\t\treturn [ATOMIC_PERMISSIONS.READ, ATOMIC_PERMISSIONS.CREATE, ATOMIC_PERMISSIONS.UPDATE, ATOMIC_PERMISSIONS.SHARE, ATOMIC_PERMISSIONS.DELETE]\n\t\t\t\t.filter((permission) => hasPermissions(this.share.permissions, permission))\n\t\t\t\t.map((permission, index) => index === 0\n\t\t\t\t\t? translatedPermissions[permission]\n\t\t\t\t\t: translatedPermissions[permission].toLocaleLowerCase(getLanguage()))\n\t\t\t\t.join(', ')\n\t\t},\n\t\tadvancedControlExpandedValue() {\n\t\t\treturn this.advancedSectionAccordionExpanded ? 'true' : 'false'\n\t\t},\n\t\terrorPasswordLabel() {\n\t\t\tif (this.passwordError) {\n\t\t\t\treturn t('files_sharing', \"Password field can't be empty\")\n\t\t\t}\n\t\t\treturn undefined\n\t\t},\n\n\t\t/**\n\t\t * Additional actions for the menu\n\t\t *\n\t\t * @return {Array}\n\t\t */\n\t\texternalLinkActions() {\n\t\t\tconst filterValidAction = (action) => (action.shareType.includes(ShareType.SHARE_TYPE_LINK) || action.shareType.includes(ShareType.SHARE_TYPE_EMAIL)) && action.advanced\n\t\t\t// filter only the advanced registered actions for said link\n\t\t\treturn this.ExternalShareActions.actions\n\t\t\t\t.filter(filterValidAction)\n\t\t},\n\t},\n\twatch: {\n\t\tsetCustomPermissions(isChecked) {\n\t\t\tif (isChecked) {\n\t\t\t\tthis.sharingPermission = 'custom'\n\t\t\t} else {\n\t\t\t\tthis.sharingPermission = this.revertSharingPermission\n\t\t\t}\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.initializePermissions()\n\t\tthis.initializeAttributes()\n\t\tconsole.debug('shareSentIn', this.share)\n\t\tconsole.debug('config', this.config)\n\t},\n\n\tmounted() {\n\t\tthis.$refs.quickPermissions?.querySelector('input:checked')?.focus()\n\t},\n\n\tmethods: {\n\t\tupdateAtomicPermissions({\n\t\t\tisReadChecked = this.hasRead,\n\t\t\tisEditChecked = this.canEdit,\n\t\t\tisCreateChecked = this.canCreate,\n\t\t\tisDeleteChecked = this.canDelete,\n\t\t\tisReshareChecked = this.canReshare,\n\t\t} = {}) {\n\t\t\t// calc permissions if checked\n\t\t\tconst permissions = 0\n\t\t\t\t| (isReadChecked ? ATOMIC_PERMISSIONS.READ : 0)\n\t\t\t\t| (isCreateChecked ? ATOMIC_PERMISSIONS.CREATE : 0)\n\t\t\t\t| (isDeleteChecked ? ATOMIC_PERMISSIONS.DELETE : 0)\n\t\t\t\t| (isEditChecked ? ATOMIC_PERMISSIONS.UPDATE : 0)\n\t\t\t\t| (isReshareChecked ? ATOMIC_PERMISSIONS.SHARE : 0)\n\t\t\tthis.share.permissions = permissions\n\t\t},\n\t\texpandCustomPermissions() {\n\t\t\tif (!this.advancedSectionAccordionExpanded) {\n\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t}\n\t\t\tthis.toggleCustomPermissions()\n\t\t},\n\t\ttoggleCustomPermissions(selectedPermission) {\n\t\t\tconst isCustomPermissions = this.sharingPermission === 'custom'\n\t\t\tthis.revertSharingPermission = !isCustomPermissions ? selectedPermission : 'custom'\n\t\t\tthis.setCustomPermissions = isCustomPermissions\n\t\t},\n\t\tasync initializeAttributes() {\n\n\t\t\tif (this.isNewShare) {\n\t\t\t\tif (this.isPasswordEnforced && this.isPublicShare) {\n\t\t\t\t\tthis.$set(this.share, 'newPassword', await GeneratePassword())\n\t\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t\t}\n\t\t\t\t/* Set default expiration dates if configured */\n\t\t\t\tif (this.isPublicShare && this.config.isDefaultExpireDateEnabled) {\n\t\t\t\t\tthis.share.expireDate = this.config.defaultExpirationDate.toDateString()\n\t\t\t\t} else if (this.isRemoteShare && this.config.isDefaultRemoteExpireDateEnabled) {\n\t\t\t\t\tthis.share.expireDate = this.config.defaultRemoteExpirationDateString.toDateString()\n\t\t\t\t} else if (this.config.isDefaultInternalExpireDateEnabled) {\n\t\t\t\t\tthis.share.expireDate = this.config.defaultInternalExpirationDate.toDateString()\n\t\t\t\t}\n\n\t\t\t\tif (this.isValidShareAttribute(this.share.expireDate)) {\n\t\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t\t}\n\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If there is an enforced expiry date, then existing shares created before enforcement\n\t\t\t// have no expiry date, hence we set it here.\n\t\t\tif (!this.isValidShareAttribute(this.share.expireDate) && this.isExpiryDateEnforced) {\n\t\t\t\tthis.hasExpirationDate = true\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.isValidShareAttribute(this.share.password)\n\t\t\t\t|| this.isValidShareAttribute(this.share.expireDate)\n\t\t\t\t|| this.isValidShareAttribute(this.share.label)\n\t\t\t) {\n\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t}\n\n\t\t},\n\t\thandleShareType() {\n\t\t\tif ('shareType' in this.share) {\n\t\t\t\tthis.share.type = this.share.shareType\n\t\t\t} else if (this.share.share_type) {\n\t\t\t\tthis.share.type = this.share.share_type\n\t\t\t}\n\t\t},\n\t\thandleDefaultPermissions() {\n\t\t\tif (this.isNewShare) {\n\t\t\t\tconst defaultPermissions = this.config.defaultPermissions\n\t\t\t\tif (defaultPermissions === BUNDLED_PERMISSIONS.READ_ONLY || defaultPermissions === BUNDLED_PERMISSIONS.ALL) {\n\t\t\t\t\tthis.sharingPermission = defaultPermissions.toString()\n\t\t\t\t} else {\n\t\t\t\t\tthis.sharingPermission = 'custom'\n\t\t\t\t\tthis.share.permissions = defaultPermissions\n\t\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t\t\tthis.setCustomPermissions = true\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleCustomPermissions() {\n\t\t\tif (!this.isNewShare && (this.hasCustomPermissions || this.share.setCustomPermissions)) {\n\t\t\t\tthis.sharingPermission = 'custom'\n\t\t\t\tthis.advancedSectionAccordionExpanded = true\n\t\t\t\tthis.setCustomPermissions = true\n\t\t\t} else if (this.share.permissions) {\n\t\t\t\tthis.sharingPermission = this.share.permissions.toString()\n\t\t\t}\n\t\t},\n\t\tinitializePermissions() {\n\t\t\tthis.handleShareType()\n\t\t\tthis.handleDefaultPermissions()\n\t\t\tthis.handleCustomPermissions()\n\t\t},\n\t\tasync saveShare() {\n\t\t\tconst permissionsAndAttributes = ['permissions', 'attributes', 'note', 'expireDate']\n\t\t\tconst publicShareAttributes = ['label', 'password', 'hideDownload']\n\t\t\tif (this.isPublicShare) {\n\t\t\t\tpermissionsAndAttributes.push(...publicShareAttributes)\n\t\t\t}\n\t\t\tconst sharePermissionsSet = parseInt(this.sharingPermission)\n\t\t\tif (this.setCustomPermissions) {\n\t\t\t\tthis.updateAtomicPermissions()\n\t\t\t} else {\n\t\t\t\tthis.share.permissions = sharePermissionsSet\n\t\t\t}\n\n\t\t\tif (!this.isFolder && this.share.permissions === BUNDLED_PERMISSIONS.ALL) {\n\t\t\t\t// It's not possible to create an existing file.\n\t\t\t\tthis.share.permissions = BUNDLED_PERMISSIONS.ALL_FILE\n\t\t\t}\n\t\t\tif (!this.writeNoteToRecipientIsChecked) {\n\t\t\t\tthis.share.note = ''\n\t\t\t}\n\t\t\tif (this.isPasswordProtected) {\n\t\t\t\tif (this.hasUnsavedPassword && this.isValidShareAttribute(this.share.newPassword)) {\n\t\t\t\t\tthis.share.password = this.share.newPassword\n\t\t\t\t\tthis.$delete(this.share, 'newPassword')\n\t\t\t\t} else if (this.isPasswordEnforced && !this.isValidShareAttribute(this.share.password)) {\n\t\t\t\t\tthis.passwordError = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.share.password = ''\n\t\t\t}\n\n\t\t\tif (!this.hasExpirationDate) {\n\t\t\t\tthis.share.expireDate = ''\n\t\t\t}\n\n\t\t\tif (this.isNewShare) {\n\t\t\t\tconst incomingShare = {\n\t\t\t\t\tpermissions: this.share.permissions,\n\t\t\t\t\tshareType: this.share.type,\n\t\t\t\t\tshareWith: this.share.shareWith,\n\t\t\t\t\tattributes: this.share.attributes,\n\t\t\t\t\tnote: this.share.note,\n\t\t\t\t\tfileInfo: this.fileInfo,\n\t\t\t\t}\n\n\t\t\t\tincomingShare.expireDate = this.hasExpirationDate ? this.share.expireDate : ''\n\n\t\t\t\tif (this.isPasswordProtected) {\n\t\t\t\t\tincomingShare.password = this.share.password\n\t\t\t\t}\n\n\t\t\t\tthis.creating = true\n\t\t\t\tconst share = await this.addShare(incomingShare, this.fileInfo)\n\t\t\t\tthis.creating = false\n\t\t\t\tthis.share = share\n\t\t\t\tthis.$emit('add:share', this.share)\n\t\t\t} else {\n\t\t\t\tthis.$emit('update:share', this.share)\n\t\t\t\tthis.queueUpdate(...permissionsAndAttributes)\n\t\t\t}\n\n\t\t\tif (this.$refs.externalLinkActions?.length > 0) {\n\t\t\t\tawait Promise.allSettled(this.$refs.externalLinkActions.map((action) => {\n\t\t\t\t\tif (typeof action.$children.at(0)?.onSave !== 'function') {\n\t\t\t\t\t\treturn Promise.resolve()\n\t\t\t\t\t}\n\t\t\t\t\treturn action.$children.at(0)?.onSave?.()\n\t\t\t\t}))\n\t\t\t}\n\n\t\t\tthis.$emit('close-sharing-details')\n\t\t},\n\t\t/**\n\t\t * Process the new share request\n\t\t *\n\t\t * @param {Share} share incoming share object\n\t\t * @param {object} fileInfo file data\n\t\t */\n\t\tasync addShare(share, fileInfo) {\n\t\t\tconsole.debug('Adding a new share from the input for', share)\n\t\t\ttry {\n\t\t\t\tconst path = (fileInfo.path + '/' + fileInfo.name).replace('//', '/')\n\t\t\t\tconst resultingShare = await this.createShare({\n\t\t\t\t\tpath,\n\t\t\t\t\tshareType: share.shareType,\n\t\t\t\t\tshareWith: share.shareWith,\n\t\t\t\t\tpermissions: share.permissions,\n\t\t\t\t\texpireDate: share.expireDate,\n\t\t\t\t\tattributes: JSON.stringify(share.attributes),\n\t\t\t\t\t...(share.note ? { note: share.note } : {}),\n\t\t\t\t\t...(share.password ? { password: share.password } : {}),\n\t\t\t\t})\n\t\t\t\treturn resultingShare\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('Error while adding new share', error)\n\t\t\t} finally {\n\t\t\t\t// this.loading = false // No loader here yet\n\t\t\t}\n\t\t},\n\t\tasync removeShare() {\n\t\t\tawait this.onDelete()\n\t\t\tthis.$emit('close-sharing-details')\n\t\t},\n\t\t/**\n\t\t * Update newPassword values\n\t\t * of share. If password is set but not newPassword\n\t\t * then the user did not changed the password\n\t\t * If both co-exists, the password have changed and\n\t\t * we show it in plain text.\n\t\t * Then on submit (or menu close), we sync it.\n\t\t *\n\t\t * @param {string} password the changed password\n\t\t */\n\t\tonPasswordChange(password) {\n\t\t\tthis.passwordError = !this.isValidShareAttribute(password)\n\t\t\tthis.$set(this.share, 'newPassword', password)\n\t\t},\n\t\t/**\n\t\t * Update the password along with \"sendPasswordByTalk\".\n\t\t *\n\t\t * If the password was modified the new password is sent; otherwise\n\t\t * updating a mail share would fail, as in that case it is required that\n\t\t * a new password is set when enabling or disabling\n\t\t * \"sendPasswordByTalk\".\n\t\t */\n\t\tonPasswordProtectedByTalkChange() {\n\t\t\tif (this.hasUnsavedPassword) {\n\t\t\t\tthis.share.password = this.share.newPassword.trim()\n\t\t\t}\n\n\t\t\tthis.queueUpdate('sendPasswordByTalk', 'password')\n\t\t},\n\t\tisValidShareAttribute(value) {\n\t\t\tif ([null, undefined].includes(value)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (!(value.trim().length > 0)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn true\n\t\t},\n\t\tgetShareTypeIcon(type) {\n\t\t\tswitch (type) {\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_LINK:\n\t\t\t\treturn LinkIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GUEST:\n\t\t\t\treturn UserIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_REMOTE_GROUP:\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_GROUP:\n\t\t\t\treturn GroupIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_EMAIL:\n\t\t\t\treturn EmailIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_CIRCLE:\n\t\t\t\treturn CircleIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_ROOM:\n\t\t\t\treturn ShareIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_DECK:\n\t\t\t\treturn ShareIcon\n\t\t\tcase this.SHARE_TYPES.SHARE_TYPE_SCIENCEMESH:\n\t\t\t\treturn ShareIcon\n\t\t\tdefault:\n\t\t\t\treturn null // Or a default icon component if needed\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sharingTabDetailsView {\n\tdisplay: flex;\n\tflex-direction: column;\n\twidth: 100%;\n\tmargin: 0 auto;\n\tposition: relative;\n\theight: 100%;\n\toverflow: hidden;\n\n\t&__header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tbox-sizing: border-box;\n\t\tmargin: 0.2em;\n\n\t\tspan {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\n\t\t\th1 {\n\t\t\t\tfont-size: 15px;\n\t\t\t\tpadding-left: 0.3em;\n\t\t\t}\n\n\t\t}\n\t}\n\n\t&__wrapper {\n\t\tposition: relative;\n\t\toverflow: scroll;\n\t\tflex-shrink: 1;\n\t\tpadding: 4px;\n\t\tpadding-right: 12px;\n\t}\n\n\t&__quick-permissions {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\twidth: 100%;\n\t\tmargin: 0 auto;\n\t\tborder-radius: 0;\n\n\t\tdiv {\n\t\t\twidth: 100%;\n\n\t\t\tspan {\n\t\t\t\twidth: 100%;\n\n\t\t\t\tspan:nth-child(1) {\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 0.1em;\n\t\t\t\t}\n\n\t\t\t\t::v-deep label {\n\n\t\t\t\t\tspan {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* Target component based style in NcCheckboxRadioSwitch slot content*/\n\t\t\t\t:deep(span.checkbox-content__text.checkbox-radio-switch__text) {\n\t\t\t\t\tflex-wrap: wrap;\n\n\t\t\t\t\t.subline {\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t\tflex-basis: 100%;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\t&__advanced-control {\n\t\twidth: 100%;\n\n\t\tbutton {\n\t\t\tmargin-top: 0.5em;\n\t\t}\n\n\t}\n\n\t&__advanced {\n\t\twidth: 100%;\n\t\tmargin-bottom: 0.5em;\n\t\ttext-align: left;\n\t\tpadding-left: 0;\n\n\t\tsection {\n\n\t\t\ttextarea,\n\t\t\tdiv.mx-datepicker {\n\t\t\t\twidth: 100%;\n\t\t\t}\n\n\t\t\ttextarea {\n\t\t\t\theight: 80px;\n\t\t\t\tmargin: 0;\n\t\t\t}\n\n\t\t\t/*\n              The following style is applied out of the component's scope\n              to remove padding from the label.checkbox-radio-switch__label,\n              which is used to group radio checkbox items. The use of ::v-deep\n              ensures that the padding is modified without being affected by\n              the component's scoping.\n              Without this achieving left alignment for the checkboxes would not\n              be possible.\n            */\n\t\t\tspan {\n\t\t\t\t::v-deep label {\n\t\t\t\t\tpadding-left: 0 !important;\n\t\t\t\t\tbackground-color: initial !important;\n\t\t\t\t\tborder: none !important;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsection.custom-permissions-group {\n\t\t\t\tpadding-left: 1.5em;\n\t\t\t}\n\t\t}\n\t}\n\n\t&__delete {\n\t\t>button:first-child {\n\t\t\tcolor: rgb(223, 7, 7);\n\t\t}\n\t}\n\n\t&__footer {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tposition: sticky;\n\t\tbottom: 0;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tbackground: linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));\n\n\t\t.button-group {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\twidth: 100%;\n\t\t\tmargin-top: 16px;\n\n\t\t\tbutton {\n\t\t\t\tmargin-left: 16px;\n\n\t\t\t\t&:first-child {\n\t\t\t\t\tmargin-left: 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<template>\n\t<div class=\"sharingTab\" :class=\"{ 'icon-loading': loading }\">\n\t\t<!-- error message -->\n\t\t<div v-if=\"error\" class=\"emptycontent\" :class=\"{ emptyContentWithSections: sections.length > 0 }\">\n\t\t\t<div class=\"icon icon-error\" />\n\t\t\t<h2>{{ error }}</h2>\n\t\t</div>\n\n\t\t<!-- shares content -->\n\t\t<div v-show=\"!showSharingDetailsView\"\n\t\t\tclass=\"sharingTab__content\">\n\t\t\t<!-- shared with me information -->\n\t\t\t<ul>\n\t\t\t\t<SharingEntrySimple v-if=\"isSharedWithMe\" v-bind=\"sharedWithMe\" class=\"sharing-entry__reshare\">\n\t\t\t\t\t<template #avatar>\n\t\t\t\t\t\t<NcAvatar :user=\"sharedWithMe.user\"\n\t\t\t\t\t\t\t:display-name=\"sharedWithMe.displayName\"\n\t\t\t\t\t\t\tclass=\"sharing-entry__avatar\" />\n\t\t\t\t\t</template>\n\t\t\t\t</SharingEntrySimple>\n\t\t\t</ul>\n\n\t\t\t<!-- add new share input -->\n\t\t\t<SharingInput v-if=\"!loading\"\n\t\t\t\t:can-reshare=\"canReshare\"\n\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t:link-shares=\"linkShares\"\n\t\t\t\t:reshare=\"reshare\"\n\t\t\t\t:shares=\"shares\"\n\t\t\t\t@open-sharing-details=\"toggleShareDetailsView\" />\n\n\t\t\t<!-- link shares list -->\n\t\t\t<SharingLinkList v-if=\"!loading\"\n\t\t\t\tref=\"linkShareList\"\n\t\t\t\t:can-reshare=\"canReshare\"\n\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t:shares=\"linkShares\"\n\t\t\t\t@open-sharing-details=\"toggleShareDetailsView\" />\n\n\t\t\t<!-- other shares list -->\n\t\t\t<SharingList v-if=\"!loading\"\n\t\t\t\tref=\"shareList\"\n\t\t\t\t:shares=\"shares\"\n\t\t\t\t:file-info=\"fileInfo\"\n\t\t\t\t@open-sharing-details=\"toggleShareDetailsView\" />\n\n\t\t\t<!-- inherited shares -->\n\t\t\t<SharingInherited v-if=\"canReshare && !loading\" :file-info=\"fileInfo\" />\n\n\t\t\t<!-- internal link copy -->\n\t\t\t<SharingEntryInternal :file-info=\"fileInfo\" />\n\n\t\t\t<!-- projects -->\n\t\t\t<CollectionList v-if=\"projectsEnabled && fileInfo\"\n\t\t\t\t:id=\"`${fileInfo.id}`\"\n\t\t\t\ttype=\"file\"\n\t\t\t\t:name=\"fileInfo.name\" />\n\t\t</div>\n\n\t\t<!-- additional entries, use it with cautious -->\n\t\t<div v-for=\"(section, index) in sections\"\n\t\t\tv-show=\"!showSharingDetailsView\"\n\t\t\t:ref=\"'section-' + index\"\n\t\t\t:key=\"index\"\n\t\t\tclass=\"sharingTab__additionalContent\">\n\t\t\t<component :is=\"section($refs['section-'+index], fileInfo)\" :file-info=\"fileInfo\" />\n\t\t</div>\n\n\t\t<!-- share details -->\n\t\t<SharingDetailsTab v-if=\"showSharingDetailsView\"\n\t\t\t:file-info=\"shareDetailsData.fileInfo\"\n\t\t\t:share=\"shareDetailsData.share\"\n\t\t\t@close-sharing-details=\"toggleShareDetailsView\"\n\t\t\t@add:share=\"addShare\"\n\t\t\t@remove:share=\"removeShare\" />\n\t</div>\n</template>\n\n<script>\nimport { CollectionList } from 'nextcloud-vue-collections'\nimport { generateOcsUrl } from '@nextcloud/router'\nimport NcAvatar from '@nextcloud/vue/dist/Components/NcAvatar.js'\nimport axios from '@nextcloud/axios'\nimport { loadState } from '@nextcloud/initial-state'\n\nimport Config from '../services/ConfigService.js'\nimport { shareWithTitle } from '../utils/SharedWithMe.js'\nimport Share from '../models/Share.js'\nimport ShareTypes from '../mixins/ShareTypes.js'\nimport SharingEntryInternal from '../components/SharingEntryInternal.vue'\nimport SharingEntrySimple from '../components/SharingEntrySimple.vue'\nimport SharingInput from '../components/SharingInput.vue'\n\nimport SharingInherited from './SharingInherited.vue'\nimport SharingLinkList from './SharingLinkList.vue'\nimport SharingList from './SharingList.vue'\nimport SharingDetailsTab from './SharingDetailsTab.vue'\n\nexport default {\n\tname: 'SharingTab',\n\n\tcomponents: {\n\t\tNcAvatar,\n\t\tCollectionList,\n\t\tSharingEntryInternal,\n\t\tSharingEntrySimple,\n\t\tSharingInherited,\n\t\tSharingInput,\n\t\tSharingLinkList,\n\t\tSharingList,\n\t\tSharingDetailsTab,\n\t},\n\n\tmixins: [ShareTypes],\n\n\tdata() {\n\t\treturn {\n\t\t\tconfig: new Config(),\n\t\t\tdeleteEvent: null,\n\t\t\terror: '',\n\t\t\texpirationInterval: null,\n\t\t\tloading: true,\n\n\t\t\tfileInfo: null,\n\n\t\t\t// reshare Share object\n\t\t\treshare: null,\n\t\t\tsharedWithMe: {},\n\t\t\tshares: [],\n\t\t\tlinkShares: [],\n\n\t\t\tsections: OCA.Sharing.ShareTabSections.getSections(),\n\t\t\tprojectsEnabled: loadState('core', 'projects_enabled', false),\n\t\t\tshowSharingDetailsView: false,\n\t\t\tshareDetailsData: {},\n\t\t\treturnFocusElement: null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Is this share shared with me?\n\t\t *\n\t\t * @return {boolean}\n\t\t */\n\t\tisSharedWithMe() {\n\t\t\treturn Object.keys(this.sharedWithMe).length > 0\n\t\t},\n\n\t\tcanReshare() {\n\t\t\treturn !!(this.fileInfo.permissions & OC.PERMISSION_SHARE)\n\t\t\t\t|| !!(this.reshare && this.reshare.hasSharePermission && this.config.isResharingAllowed)\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Update current fileInfo and fetch new data\n\t\t *\n\t\t * @param {object} fileInfo the current file FileInfo\n\t\t */\n\t\tasync update(fileInfo) {\n\t\t\tthis.fileInfo = fileInfo\n\t\t\tthis.resetState()\n\t\t\tthis.getShares()\n\t\t},\n\n\t\t/**\n\t\t * Get the existing shares infos\n\t\t */\n\t\tasync getShares() {\n\t\t\ttry {\n\t\t\t\tthis.loading = true\n\n\t\t\t\t// init params\n\t\t\t\tconst shareUrl = generateOcsUrl('apps/files_sharing/api/v1/shares')\n\t\t\t\tconst format = 'json'\n\t\t\t\t// TODO: replace with proper getFUllpath implementation of our own FileInfo model\n\t\t\t\tconst path = (this.fileInfo.path + '/' + this.fileInfo.name).replace('//', '/')\n\n\t\t\t\t// fetch shares\n\t\t\t\tconst fetchShares = axios.get(shareUrl, {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tformat,\n\t\t\t\t\t\tpath,\n\t\t\t\t\t\treshares: true,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tconst fetchSharedWithMe = axios.get(shareUrl, {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tformat,\n\t\t\t\t\t\tpath,\n\t\t\t\t\t\tshared_with_me: true,\n\t\t\t\t\t},\n\t\t\t\t})\n\n\t\t\t\t// wait for data\n\t\t\t\tconst [shares, sharedWithMe] = await Promise.all([fetchShares, fetchSharedWithMe])\n\t\t\t\tthis.loading = false\n\n\t\t\t\t// process results\n\t\t\t\tthis.processSharedWithMe(sharedWithMe)\n\t\t\t\tthis.processShares(shares)\n\t\t\t} catch (error) {\n\t\t\t\tif (error.response.data?.ocs?.meta?.message) {\n\t\t\t\t\tthis.error = error.response.data.ocs.meta.message\n\t\t\t\t} else {\n\t\t\t\t\tthis.error = t('files_sharing', 'Unable to load the shares list')\n\t\t\t\t}\n\t\t\t\tthis.loading = false\n\t\t\t\tconsole.error('Error loading the shares list', error)\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Reset the current view to its default state\n\t\t */\n\t\tresetState() {\n\t\t\tclearInterval(this.expirationInterval)\n\t\t\tthis.loading = true\n\t\t\tthis.error = ''\n\t\t\tthis.sharedWithMe = {}\n\t\t\tthis.shares = []\n\t\t\tthis.linkShares = []\n\t\t\tthis.showSharingDetailsView = false\n\t\t\tthis.shareDetailsData = {}\n\t\t},\n\n\t\t/**\n\t\t * Update sharedWithMe.subtitle with the appropriate\n\t\t * expiration time left\n\t\t *\n\t\t * @param {Share} share the sharedWith Share object\n\t\t */\n\t\tupdateExpirationSubtitle(share) {\n\t\t\tconst expiration = moment(share.expireDate).unix()\n\t\t\tthis.$set(this.sharedWithMe, 'subtitle', t('files_sharing', 'Expires {relativetime}', {\n\t\t\t\trelativetime: OC.Util.relativeModifiedDate(expiration * 1000),\n\t\t\t}))\n\n\t\t\t// share have expired\n\t\t\tif (moment().unix() > expiration) {\n\t\t\t\tclearInterval(this.expirationInterval)\n\t\t\t\t// TODO: clear ui if share is expired\n\t\t\t\tthis.$set(this.sharedWithMe, 'subtitle', t('files_sharing', 'this share just expired.'))\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Process the current shares data\n\t\t * and init shares[]\n\t\t *\n\t\t * @param {object} share the share ocs api request data\n\t\t * @param {object} share.data the request data\n\t\t */\n\t\tprocessShares({ data }) {\n\t\t\tif (data.ocs && data.ocs.data && data.ocs.data.length > 0) {\n\t\t\t\t// create Share objects and sort by newest\n\t\t\t\tconst shares = data.ocs.data\n\t\t\t\t\t.map(share => new Share(share))\n\t\t\t\t\t.sort((a, b) => b.createdTime - a.createdTime)\n\n\t\t\t\tthis.linkShares = shares.filter(share => share.type === this.SHARE_TYPES.SHARE_TYPE_LINK || share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL)\n\t\t\t\tthis.shares = shares.filter(share => share.type !== this.SHARE_TYPES.SHARE_TYPE_LINK && share.type !== this.SHARE_TYPES.SHARE_TYPE_EMAIL)\n\n\t\t\t\tconsole.debug('Processed', this.linkShares.length, 'link share(s)')\n\t\t\t\tconsole.debug('Processed', this.shares.length, 'share(s)')\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Process the sharedWithMe share data\n\t\t * and init sharedWithMe\n\t\t *\n\t\t * @param {object} share the share ocs api request data\n\t\t * @param {object} share.data the request data\n\t\t */\n\t\tprocessSharedWithMe({ data }) {\n\t\t\tif (data.ocs && data.ocs.data && data.ocs.data[0]) {\n\t\t\t\tconst share = new Share(data)\n\t\t\t\tconst title = shareWithTitle(share)\n\t\t\t\tconst displayName = share.ownerDisplayName\n\t\t\t\tconst user = share.owner\n\n\t\t\t\tthis.sharedWithMe = {\n\t\t\t\t\tdisplayName,\n\t\t\t\t\ttitle,\n\t\t\t\t\tuser,\n\t\t\t\t}\n\t\t\t\tthis.reshare = share\n\n\t\t\t\t// If we have an expiration date, use it as subtitle\n\t\t\t\t// Refresh the status every 10s and clear if expired\n\t\t\t\tif (share.expireDate && moment(share.expireDate).unix() > moment().unix()) {\n\t\t\t\t\t// first update\n\t\t\t\t\tthis.updateExpirationSubtitle(share)\n\t\t\t\t\t// interval update\n\t\t\t\t\tthis.expirationInterval = setInterval(this.updateExpirationSubtitle, 10000, share)\n\t\t\t\t}\n\t\t\t} else if (this.fileInfo && this.fileInfo.shareOwnerId !== undefined ? this.fileInfo.shareOwnerId !== OC.currentUser : false) {\n\t\t\t\t// Fallback to compare owner and current user.\n\t\t\t\tthis.sharedWithMe = {\n\t\t\t\t\tdisplayName: this.fileInfo.shareOwner,\n\t\t\t\t\ttitle: t(\n\t\t\t\t\t\t'files_sharing',\n\t\t\t\t\t\t'Shared with you by {owner}',\n\t\t\t\t\t\t{ owner: this.fileInfo.shareOwner },\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t{ escape: false },\n\t\t\t\t\t),\n\t\t\t\t\tuser: this.fileInfo.shareOwnerId,\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Add a new share into the shares list\n\t\t * and return the newly created share component\n\t\t *\n\t\t * @param {Share} share the share to add to the array\n\t\t * @param {Function} [resolve] a function to run after the share is added and its component initialized\n\t\t */\n\t\taddShare(share, resolve = () => { }) {\n\t\t\t// only catching share type MAIL as link shares are added differently\n\t\t\t// meaning: not from the ShareInput\n\t\t\tif (share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\tthis.linkShares.unshift(share)\n\t\t\t} else {\n\t\t\t\tthis.shares.unshift(share)\n\t\t\t}\n\t\t\tthis.awaitForShare(share, resolve)\n\t\t},\n\t\t/**\n\t\t * Remove a share from the shares list\n\t\t *\n\t\t * @param {Share} share the share to remove\n\t\t */\n\t\tremoveShare(share) {\n\t\t\t// Get reference for this.linkShares or this.shares\n\t\t\tconst shareList\n\t\t\t\t= share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL\n\t\t\t\t\t|| share.type === this.SHARE_TYPES.SHARE_TYPE_LINK\n\t\t\t\t\t? this.linkShares\n\t\t\t\t\t: this.shares\n\t\t\tconst index = shareList.findIndex(item => item.id === share.id)\n\t\t\tif (index !== -1) {\n\t\t\t\tshareList.splice(index, 1)\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Await for next tick and render after the list updated\n\t\t * Then resolve with the matched vue component of the\n\t\t * provided share object\n\t\t *\n\t\t * @param {Share} share newly created share\n\t\t * @param {Function} resolve a function to execute after\n\t\t */\n\t\tawaitForShare(share, resolve) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tlet listComponent = this.$refs.shareList\n\t\t\t\t// Only mail shares comes from the input, link shares\n\t\t\t\t// are managed internally in the SharingLinkList component\n\t\t\t\tif (share.type === this.SHARE_TYPES.SHARE_TYPE_EMAIL) {\n\t\t\t\t\tlistComponent = this.$refs.linkShareList\n\t\t\t\t}\n\t\t\t\tconst newShare = listComponent.$children.find(component => component.share === share)\n\t\t\t\tif (newShare) {\n\t\t\t\t\tresolve(newShare)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\ttoggleShareDetailsView(eventData) {\n\t\t\tif (!this.showSharingDetailsView) {\n\t\t\t\tconst isAction = Array.from(document.activeElement.classList)\n\t\t\t\t\t.some(className => className.startsWith('action-'))\n\t\t\t\tif (isAction) {\n\t\t\t\t\tconst menuId = document.activeElement.closest('[role=\"menu\"]')?.id\n\t\t\t\t\tthis.returnFocusElement = document.querySelector(`[aria-controls=\"${menuId}\"]`)\n\t\t\t\t} else {\n\t\t\t\t\tthis.returnFocusElement = document.activeElement\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (eventData) {\n\t\t\t\tthis.shareDetailsData = eventData\n\t\t\t}\n\n\t\t\tthis.showSharingDetailsView = !this.showSharingDetailsView\n\n\t\t\tif (!this.showSharingDetailsView) {\n\t\t\t\tthis.$nextTick(() => { // Wait for next tick as the element must be visible to be focused\n\t\t\t\t\tthis.returnFocusElement?.focus()\n\t\t\t\t\tthis.returnFocusElement = null\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.emptyContentWithSections {\n\tmargin: 1rem auto;\n}\n\n.sharingTab {\n\tposition: relative;\n\theight: 100%;\n\n\t&__content {\n\t\tpadding: 0 6px;\n\t}\n\n\t&__additionalContent {\n\t\tmargin: 44px 0;\n\t}\n}\n</style>\n"],"names":["isObject","value","type","freeGlobal","global","freeSelf","root","now","reWhitespace","trimmedEndIndex","string","index","reTrimStart","baseTrim","Symbol","objectProto","hasOwnProperty","nativeObjectToString","symToStringTag","getRawTag","isOwn","tag","unmasked","result","objectToString","nullTag","undefinedTag","baseGetTag","isObjectLike","symbolTag","isSymbol","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","toNumber","other","isBinary","FUNC_ERROR_TEXT","nativeMax","nativeMin","debounce","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","args","thisArg","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","flush","debounced","isInvoking","dist","generateOcsUrl_1","getAppRootUrl","getRootUrl","linkTo","app","file","generateFilePath","linkToRemoteBase","service","generateRemoteUrl","generateOcsUrl","url","params","version","_generateUrlPath","allOptions","_build","text","vars","a","b","r","generateUrl","_window","imagePath","_window2","isCore","link","webroot","pos","_window$_oc_appswebro","_webroots$app","D","$","e","d","o","n","p","u","A","h","s","f","l","m","R","_","I","i","B","w","S","k","E","L","U","j","y","g","F","T","P","O","V","x","H","Q","Config","getCapabilities","_a","_b","_e","_d","_c","shareWithTitle","share","ShareTypes","Share","ocsData","__publicField","permissions","date","note","label","state","password","passwordExpirationTime","sendPasswordByTalk","attr","enabled","scope","key","attrUpdate","_sfc_main","NcActions","NcActionButton","SharingEntrySimple","CheckIcon","ClipboardIcon","showSuccess","error","config","passwordSet","GeneratePassword","request","axios","showError","array","ratio","self","nativeURLSearchParams","isSupportObjectConstructor","decodesPlusesCorrectly","isSupportSize","__URLSearchParams__","encodesAmpersandsCorrectly","ampersandTest","prototype","URLSearchParamsPolyfill","iterable","search","parseToDict","name","appendTo","dict","query","encode","useProxy","propValue","target","USPProto","callback","keys","values","items","item","makeIterator","prev","cur","str","replace","match","decode","arr","iterator","isArray","pairs","val","obj","prop","this","shareUrl","ShareRequests","path","shareType","shareWith","publicUpload","expireDate","attributes","emit","errorMessage","id","properties","message","ShareDetails","shareRequestObject","shareDetails","NcSelect","allowRemoteSharing","option","lookup","data","exact","rawExactSuggestions","elem","rawSuggestions","exactSuggestions","suggestions","lookupEntry","externalResults","allSuggestions","nameCounts","rawRecommendations","shares","getCurrentUser","sharesObj","subtitle","component","resolve","ATOMIC_PERMISSIONS","BUNDLED_PERMISSIONS","hasPermissions","initialPermissionSet","permissionsToCheck","SharesMixin","SharesRequests","PQueue","weekdaysShort","monthsShort","regex","propertyNames","updatedShare","property","propertyEl","focusable","NcActionLink","NcActionText","NcAvatar","basename","SharingEntryInherited","DropdownIcon","IconEyeOutline","IconPencil","IconFileUpload","IconTune","optionLabel","ExternalShareAction","NcActionInput","NcActionSeparator","NcDialog","VueQrcode","Tune","IconQr","ErrorIcon","LockIcon","CloseIcon","PlusIcon","SharingEntryQuickShareSelect","getLoggerBuilder","Vue","expirationTime","isPasswordMissing","isExpireDateMissing","filterValidAction","action","hasDisabledDownload","shareAttribute","shareDefaults","update","newShare","SharingEntryLink","NcButton","DotsHorizontalIcon","title","SharingEntry","NcInputField","NcPasswordField","NcDateTimePickerNative","NcCheckboxRadioSwitch","NcLoadingIcon","CircleIcon","EditIcon","LinkIcon","GroupIcon","ShareIcon","UserIcon","UploadIcon","ViewIcon","MenuDownIcon","MenuUpIcon","user","server","checked","downloadAttr","allowedMimetypes","translatedPermissions","permission","getLanguage","ShareType","isChecked","isReadChecked","isEditChecked","isCreateChecked","isDeleteChecked","isReshareChecked","selectedPermission","isCustomPermissions","defaultPermissions","permissionsAndAttributes","publicShareAttributes","sharePermissionsSet","incomingShare","fileInfo","EmailIcon","CollectionList","SharingEntryInternal","SharingInherited","SharingInput","SharingLinkList","SharingList","SharingDetailsTab","loadState","format","fetchShares","fetchSharedWithMe","sharedWithMe","expiration","displayName","shareList","listComponent","eventData","className","menuId"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,23]}