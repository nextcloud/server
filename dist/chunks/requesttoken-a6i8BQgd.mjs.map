{"version":3,"file":"requesttoken-a6i8BQgd.mjs","sources":["../../core/src/OC/requesttoken.js"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { emit } from '@nextcloud/event-bus'\n\n/**\n * @private\n * @param {Document} global the document to read the initial value from\n * @param {Function} emit the function to invoke for every new token\n * @return {object}\n */\nexport const manageToken = (global, emit) => {\n\tlet token = global.getElementsByTagName('head')[0].getAttribute('data-requesttoken')\n\n\treturn {\n\t\tgetToken: () => token,\n\t\tsetToken: newToken => {\n\t\t\ttoken = newToken\n\n\t\t\temit('csrf-token-update', {\n\t\t\t\ttoken,\n\t\t\t})\n\t\t},\n\t}\n}\n\nconst manageFromDocument = manageToken(document, emit)\n\n/**\n * @return {string}\n */\nexport const getToken = manageFromDocument.getToken\n\n/**\n * @param {string} newToken new token\n */\nexport const setToken = manageFromDocument.setToken\n"],"names":["manageToken","global","emit","token","newToken","manageFromDocument","getToken","setToken"],"mappings":";wCAaO,MAAMA,EAAc,CAACC,EAAQC,IAAS,CAC5C,IAAIC,EAAQF,EAAO,qBAAqB,MAAM,EAAE,CAAC,EAAE,aAAa,mBAAmB,EAEnF,MAAO,CACN,SAAU,IAAME,EAChB,SAAUC,GAAY,CACrBD,EAAQC,EAERF,EAAK,oBAAqB,CACzB,MAAAC,CACJ,CAAI,CACD,CACD,CACF,EAEME,EAAqBL,EAAY,SAAUE,CAAI,EAKxCI,EAAWD,EAAmB,SAK9BE,EAAWF,EAAmB"}