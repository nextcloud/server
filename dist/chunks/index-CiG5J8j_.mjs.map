{"version":3,"file":"index-CiG5J8j_.mjs","sources":["../../node_modules/@nextcloud/logger/dist/index.mjs"],"sourcesContent":["import { getCurrentUser } from \"@nextcloud/auth\";\nvar LogLevel = /* @__PURE__ */ ((LogLevel2) => {\n  LogLevel2[LogLevel2[\"Debug\"] = 0] = \"Debug\";\n  LogLevel2[LogLevel2[\"Info\"] = 1] = \"Info\";\n  LogLevel2[LogLevel2[\"Warn\"] = 2] = \"Warn\";\n  LogLevel2[LogLevel2[\"Error\"] = 3] = \"Error\";\n  LogLevel2[LogLevel2[\"Fatal\"] = 4] = \"Fatal\";\n  return LogLevel2;\n})(LogLevel || {});\nvar __defProp$1 = Object.defineProperty;\nvar __defNormalProp$1 = (obj, key, value) => key in obj ? __defProp$1(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField$1 = (obj, key, value) => {\n  __defNormalProp$1(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nclass ConsoleLogger {\n  constructor(context) {\n    __publicField$1(this, \"context\");\n    this.context = context || {};\n  }\n  formatMessage(message, level, context) {\n    let msg = \"[\" + LogLevel[level].toUpperCase() + \"] \";\n    if (context && context.app) {\n      msg += context.app + \": \";\n    }\n    if (typeof message === \"string\")\n      return msg + message;\n    msg += \"Unexpected \".concat(message.name);\n    if (message.message)\n      msg += ' \"'.concat(message.message, '\"');\n    if (level === LogLevel.Debug && message.stack)\n      msg += \"\\n\\nStack trace:\\n\".concat(message.stack);\n    return msg;\n  }\n  log(level, message, context) {\n    var _a, _b;\n    if (typeof ((_a = this.context) == null ? void 0 : _a.level) === \"number\" && level < ((_b = this.context) == null ? void 0 : _b.level)) {\n      return;\n    }\n    if (typeof message === \"object\" && (context == null ? void 0 : context.error) === void 0) {\n      context.error = message;\n    }\n    switch (level) {\n      case LogLevel.Debug:\n        console.debug(this.formatMessage(message, LogLevel.Debug, context), context);\n        break;\n      case LogLevel.Info:\n        console.info(this.formatMessage(message, LogLevel.Info, context), context);\n        break;\n      case LogLevel.Warn:\n        console.warn(this.formatMessage(message, LogLevel.Warn, context), context);\n        break;\n      case LogLevel.Error:\n        console.error(this.formatMessage(message, LogLevel.Error, context), context);\n        break;\n      case LogLevel.Fatal:\n      default:\n        console.error(this.formatMessage(message, LogLevel.Fatal, context), context);\n        break;\n    }\n  }\n  debug(message, context) {\n    this.log(LogLevel.Debug, message, Object.assign({}, this.context, context));\n  }\n  info(message, context) {\n    this.log(LogLevel.Info, message, Object.assign({}, this.context, context));\n  }\n  warn(message, context) {\n    this.log(LogLevel.Warn, message, Object.assign({}, this.context, context));\n  }\n  error(message, context) {\n    this.log(LogLevel.Error, message, Object.assign({}, this.context, context));\n  }\n  fatal(message, context) {\n    this.log(LogLevel.Fatal, message, Object.assign({}, this.context, context));\n  }\n}\nfunction buildConsoleLogger(context) {\n  return new ConsoleLogger(context);\n}\nvar __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\nclass LoggerBuilder {\n  constructor(factory) {\n    __publicField(this, \"context\");\n    __publicField(this, \"factory\");\n    this.context = {};\n    this.factory = factory;\n  }\n  /**\n   * Set the app name within the logging context\n   *\n   * @param appId App name\n   */\n  setApp(appId) {\n    this.context.app = appId;\n    return this;\n  }\n  /**\n   * Set the logging level within the logging context\n   *\n   * @param level Logging level\n   */\n  setLogLevel(level) {\n    this.context.level = level;\n    return this;\n  }\n  /* eslint-disable jsdoc/no-undefined-types */\n  /**\n   * Set the user id within the logging context\n   * @param uid User ID\n   * @see {@link detectUser}\n   */\n  /* eslint-enable jsdoc/no-undefined-types */\n  setUid(uid) {\n    this.context.uid = uid;\n    return this;\n  }\n  /**\n   * Detect the currently logged in user and set the user id within the logging context\n   */\n  detectUser() {\n    const user = getCurrentUser();\n    if (user !== null) {\n      this.context.uid = user.uid;\n    }\n    return this;\n  }\n  /**\n   * Detect and use logging level configured in nextcloud config\n   */\n  detectLogLevel() {\n    const self = this;\n    const onLoaded = () => {\n      var _a, _b;\n      if (document.readyState === \"complete\" || document.readyState === \"interactive\") {\n        self.context.level = (_b = (_a = window._oc_config) == null ? void 0 : _a.loglevel) != null ? _b : LogLevel.Warn;\n        if (window._oc_debug) {\n          self.context.level = LogLevel.Debug;\n        }\n        document.removeEventListener(\"readystatechange\", onLoaded);\n      } else {\n        document.addEventListener(\"readystatechange\", onLoaded);\n      }\n    };\n    onLoaded();\n    return this;\n  }\n  /** Build a logger using the logging context and factory */\n  build() {\n    if (this.context.level === void 0) {\n      this.detectLogLevel();\n    }\n    return this.factory(this.context);\n  }\n}\nfunction getLoggerBuilder() {\n  return new LoggerBuilder(buildConsoleLogger);\n}\nfunction getLogger() {\n  return getLoggerBuilder().build();\n}\nexport {\n  LogLevel,\n  getLogger,\n  getLoggerBuilder\n};\n"],"names":["LogLevel","LogLevel2","__defProp$1","__defNormalProp$1","obj","key","value","__publicField$1","ConsoleLogger","context","message","level","msg","_a","_b","buildConsoleLogger","__defProp","__defNormalProp","__publicField","LoggerBuilder","factory","appId","uid","user","getCurrentUser","self","onLoaded","getLoggerBuilder"],"mappings":"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","x_google_ignoreList":[0]}