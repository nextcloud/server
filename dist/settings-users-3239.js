"use strict";(self.webpackChunknextcloud=self.webpackChunknextcloud||[]).push([[3239],{46984:(e,t,s)=>{s.d(t,{FF:()=>d,Iu:()=>l,N_:()=>o});var a=s(65043),i=s(63814),n=s(36117);const r=e=>({id:e.id,name:e.displayname,usercount:e.usercount,disabled:e.disabled,canAdd:e.canAdd,canRemove:e.canRemove}),o=e=>{let{search:t,offset:s,limit:o}=e;const l=new AbortController;return new n.CancelablePromise((async(e,n,d)=>{d((()=>l.abort()));try{const{data:n}=await a.Ay.get((0,i.KT)("/cloud/groups/details?search={search}&offset={offset}&limit={limit}",{search:t,offset:s,limit:o}),{signal:l.signal});e((n.ocs?.data?.groups??[]).map(r))}catch(e){n(e)}}))},l=async e=>{let{userId:t}=e;const s=(0,i.KT)("/cloud/users/{userId}/groups/details",{userId:t}),{data:n}=await a.Ay.get(s);return(n.ocs?.data?.groups??[]).map(r)},d=async e=>{let{userId:t}=e;const s=(0,i.KT)("/cloud/users/{userId}/subadmins/details",{userId:t}),{data:n}=await a.Ay.get(s);return(n.ocs?.data?.groups??[]).map(r)}},95668:(e,t,s)=>{s.d(t,{HK:()=>r,MY:()=>n,SA:()=>i});var a=s(53334);const i={id:"none",label:(0,a.Tl)("settings","Unlimited")},n={id:"default",label:(0,a.Tl)("settings","Default quota")},r=e=>{const t=Object.keys(e);return 1===t.length&&"id"===t.at(0)}},79496:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".modal__header[data-v-161509be]{margin:0}.modal__content[data-v-161509be]{display:flex;flex-direction:column;align-items:center;padding:20px;gap:4px 0}.modal__button-row[data-v-161509be]{display:flex;width:100%;justify-content:space-between}","",{version:3,sources:["webpack://./apps/settings/src/components/GroupListItem.vue"],names:[],mappings:"AAEC,gCACC,QAAA,CAGD,iCACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,YAAA,CACA,SAAA,CAGD,oCACC,YAAA,CACA,UAAA,CACA,6BAAA",sourceRoot:""}]);const o=r},38242:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".empty[data-v-76ab0312] .icon-vue{width:64px;height:64px}.empty[data-v-76ab0312] .icon-vue svg{max-width:64px;max-height:64px}","",{version:3,sources:["webpack://./apps/settings/src/components/UserList.vue"],names:[],mappings:"AAKE,kCACC,UAAA,CACA,WAAA,CAEA,sCACC,cAAA,CACA,eAAA",sourceRoot:""}]);const o=r},27910:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".dialog__form[data-v-0b6b2bc6]{display:flex;flex-direction:column;align-items:center;padding:0 8px;gap:4px 0}.dialog__item[data-v-0b6b2bc6]{width:100%}.dialog__item[data-v-0b6b2bc6]:not(:focus):not(:active){border-color:var(--color-border-dark)}.dialog__hint[data-v-0b6b2bc6]{color:var(--color-text-maxcontrast);margin-top:8px;align-self:flex-start}.dialog__label[data-v-0b6b2bc6]{display:block;padding:4px 0}.dialog__select[data-v-0b6b2bc6]{width:100%}.dialog__managers[data-v-0b6b2bc6]{margin-bottom:12px}.dialog__submit[data-v-0b6b2bc6]{margin-top:4px;margin-bottom:8px}.dialog[data-v-0b6b2bc6] .dialog__actions{margin:auto}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/NewUserDialog.vue"],names:[],mappings:"AAEC,+BACC,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,aAAA,CACA,SAAA,CAGD,+BACC,UAAA,CAEA,wDACC,qCAAA,CAIF,+BACC,mCAAA,CACA,cAAA,CACA,qBAAA,CAGD,gCACC,aAAA,CACA,aAAA,CAGD,iCACC,UAAA,CAGD,mCACC,kBAAA,CAGD,iCACC,cAAA,CACA,iBAAA,CAIA,0CACC,WAAA",sourceRoot:""}]);const o=r},95066:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".footer[data-v-db2a7c4e]{position:relative;display:flex;min-width:100%;width:fit-content;height:var(--row-height);background-color:var(--color-main-background)}.footer__cell[data-v-db2a7c4e]{display:flex;flex-direction:column;justify-content:center;padding:0 var(--cell-padding);min-width:var(--cell-width);width:var(--cell-width);color:var(--color-main-text)}.footer__cell strong[data-v-db2a7c4e],.footer__cell span[data-v-db2a7c4e],.footer__cell label[data-v-db2a7c4e]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:anywhere}@media(min-width: 670px){.footer__cell--avatar[data-v-db2a7c4e],.footer__cell--displayname[data-v-db2a7c4e]{position:sticky;z-index:var(--sticky-column-z-index);background-color:var(--color-main-background)}.footer__cell--avatar[data-v-db2a7c4e]{inset-inline-start:0}.footer__cell--displayname[data-v-db2a7c4e]{inset-inline-start:var(--avatar-cell-width);border-inline-end:1px solid var(--color-border)}}.footer__cell--username[data-v-db2a7c4e]{padding-inline-start:calc(var(--default-grid-baseline)*3)}.footer__cell--avatar[data-v-db2a7c4e]{min-width:var(--avatar-cell-width);width:var(--avatar-cell-width);align-items:center;padding:0;user-select:none}.footer__cell--multiline span[data-v-db2a7c4e]{line-height:1.3em;white-space:unset}@supports(-webkit-line-clamp: 2){.footer__cell--multiline span[data-v-db2a7c4e]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.footer__cell--large[data-v-db2a7c4e]{min-width:var(--cell-width-large);width:var(--cell-width-large)}.footer__cell--obfuscated[data-v-db2a7c4e]{min-width:400px;width:400px}.footer__cell--fill[data-v-db2a7c4e]{min-width:var(--cell-width-large);width:100%}.footer__cell--actions[data-v-db2a7c4e]{position:sticky;inset-inline-end:0;z-index:var(--sticky-column-z-index);display:flex;flex-direction:row;align-items:center;min-width:110px;width:110px;background-color:var(--color-main-background);border-inline-start:1px solid var(--color-border)}.footer__subtitle[data-v-db2a7c4e]{color:var(--color-text-maxcontrast)}.footer__cell[data-v-db2a7c4e]{position:sticky;color:var(--color-text-maxcontrast)}.footer__cell--loading[data-v-db2a7c4e]{inset-inline-start:0;min-width:var(--avatar-cell-width);width:var(--avatar-cell-width);align-items:center;padding:0}.footer__cell--count[data-v-db2a7c4e]{inset-inline-start:var(--avatar-cell-width);min-width:var(--cell-width);width:var(--cell-width)}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/UserListFooter.vue","webpack://./apps/settings/src/components/Users/shared/styles.scss"],names:[],mappings:"AAGA,yBCGC,iBAAA,CACA,YAAA,CACA,cAAA,CACA,iBAAA,CACA,wBAAA,CACA,6CAAA,CAIA,+BACC,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,6BAAA,CACA,2BAAA,CACA,uBAAA,CACA,4BAAA,CAEA,+GAGC,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,sBAAA,CAGD,yBACC,mFAEC,eAAA,CACA,oCAAA,CACA,6CAAA,CAGD,uCACC,oBAAA,CAGD,4CACC,2CAAA,CACA,+CAAA,CAAA,CAIF,yCACC,yDAAA,CAGD,uCACC,kCAAA,CACA,8BAAA,CACA,kBAAA,CACA,SAAA,CACA,gBAAA,CAIA,+CACC,iBAAA,CACA,iBAAA,CAEA,iCAJD,+CAKE,mBAAA,CACA,oBAAA,CACA,2BAAA,CAAA,CAKH,sCACC,iCAAA,CACA,6BAAA,CAGD,2CACC,eAAA,CACA,WAAA,CAID,qCACC,iCAAA,CACA,UAAA,CAGD,wCACC,eAAA,CACA,kBAAA,CACA,oCAAA,CACA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,eAAA,CACA,WAAA,CACA,6CAAA,CACA,iDAAA,CAIF,mCACC,mCAAA,CDpGD,+BACC,eAAA,CACA,mCAAA,CAEA,wCACC,oBAAA,CACA,kCAAA,CACA,8BAAA,CACA,kBAAA,CACA,SAAA,CAGD,sCACC,2CAAA,CACA,2BAAA,CACA,uBAAA",sourceRoot:""}]);const o=r},24882:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".header[data-v-5c0f8828]{border-bottom:1px solid var(--color-border);position:relative;display:flex;min-width:100%;width:fit-content;height:var(--row-height);background-color:var(--color-main-background)}.header__cell[data-v-5c0f8828]{display:flex;flex-direction:column;justify-content:center;padding:0 var(--cell-padding);min-width:var(--cell-width);width:var(--cell-width);color:var(--color-main-text)}.header__cell strong[data-v-5c0f8828],.header__cell span[data-v-5c0f8828],.header__cell label[data-v-5c0f8828]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:anywhere}@media(min-width: 670px){.header__cell--avatar[data-v-5c0f8828],.header__cell--displayname[data-v-5c0f8828]{position:sticky;z-index:var(--sticky-column-z-index);background-color:var(--color-main-background)}.header__cell--avatar[data-v-5c0f8828]{inset-inline-start:0}.header__cell--displayname[data-v-5c0f8828]{inset-inline-start:var(--avatar-cell-width);border-inline-end:1px solid var(--color-border)}}.header__cell--username[data-v-5c0f8828]{padding-inline-start:calc(var(--default-grid-baseline)*3)}.header__cell--avatar[data-v-5c0f8828]{min-width:var(--avatar-cell-width);width:var(--avatar-cell-width);align-items:center;padding:0;user-select:none}.header__cell--multiline span[data-v-5c0f8828]{line-height:1.3em;white-space:unset}@supports(-webkit-line-clamp: 2){.header__cell--multiline span[data-v-5c0f8828]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.header__cell--large[data-v-5c0f8828]{min-width:var(--cell-width-large);width:var(--cell-width-large)}.header__cell--obfuscated[data-v-5c0f8828]{min-width:400px;width:400px}.header__cell--fill[data-v-5c0f8828]{min-width:var(--cell-width-large);width:100%}.header__cell--actions[data-v-5c0f8828]{position:sticky;inset-inline-end:0;z-index:var(--sticky-column-z-index);display:flex;flex-direction:row;align-items:center;min-width:110px;width:110px;background-color:var(--color-main-background);border-inline-start:1px solid var(--color-border)}.header__subtitle[data-v-5c0f8828]{color:var(--color-text-maxcontrast)}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/UserListHeader.vue","webpack://./apps/settings/src/components/Users/shared/styles.scss"],names:[],mappings:"AAGA,yBACC,2CAAA,CCEA,iBAAA,CACA,YAAA,CACA,cAAA,CACA,iBAAA,CACA,wBAAA,CACA,6CAAA,CAIA,+BACC,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,6BAAA,CACA,2BAAA,CACA,uBAAA,CACA,4BAAA,CAEA,+GAGC,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,sBAAA,CAGD,yBACC,mFAEC,eAAA,CACA,oCAAA,CACA,6CAAA,CAGD,uCACC,oBAAA,CAGD,4CACC,2CAAA,CACA,+CAAA,CAAA,CAIF,yCACC,yDAAA,CAGD,uCACC,kCAAA,CACA,8BAAA,CACA,kBAAA,CACA,SAAA,CACA,gBAAA,CAIA,+CACC,iBAAA,CACA,iBAAA,CAEA,iCAJD,+CAKE,mBAAA,CACA,oBAAA,CACA,2BAAA,CAAA,CAKH,sCACC,iCAAA,CACA,6BAAA,CAGD,2CACC,eAAA,CACA,WAAA,CAID,qCACC,iCAAA,CACA,UAAA,CAGD,wCACC,eAAA,CACA,kBAAA,CACA,oCAAA,CACA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,eAAA,CACA,WAAA,CACA,6CAAA,CACA,iDAAA,CAIF,mCACC,mCAAA",sourceRoot:""}]);const o=r},50085:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".user-list__row[data-v-e966b116]{position:relative;display:flex;min-width:100%;width:fit-content;height:var(--row-height);background-color:var(--color-main-background)}.user-list__row[data-v-e966b116]:hover{background-color:var(--color-background-hover)}.user-list__row:hover .row__cell[data-v-e966b116]:not(.row__cell--actions){background-color:var(--color-background-hover)}.user-list__row .select--fill[data-v-e966b116]{max-width:calc(var(--cell-width-large) - 2*var(--cell-padding))}.row__cell[data-v-e966b116]{display:flex;flex-direction:column;justify-content:center;padding:0 var(--cell-padding);min-width:var(--cell-width);width:var(--cell-width);color:var(--color-main-text)}.row__cell strong[data-v-e966b116],.row__cell span[data-v-e966b116],.row__cell label[data-v-e966b116]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-wrap:anywhere}@media(min-width: 670px){.row__cell--avatar[data-v-e966b116],.row__cell--displayname[data-v-e966b116]{position:sticky;z-index:var(--sticky-column-z-index);background-color:var(--color-main-background)}.row__cell--avatar[data-v-e966b116]{inset-inline-start:0}.row__cell--displayname[data-v-e966b116]{inset-inline-start:var(--avatar-cell-width);border-inline-end:1px solid var(--color-border)}}.row__cell--username[data-v-e966b116]{padding-inline-start:calc(var(--default-grid-baseline)*3)}.row__cell--avatar[data-v-e966b116]{min-width:var(--avatar-cell-width);width:var(--avatar-cell-width);align-items:center;padding:0;user-select:none}.row__cell--multiline span[data-v-e966b116]{line-height:1.3em;white-space:unset}@supports(-webkit-line-clamp: 2){.row__cell--multiline span[data-v-e966b116]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.row__cell--large[data-v-e966b116]{min-width:var(--cell-width-large);width:var(--cell-width-large)}.row__cell--obfuscated[data-v-e966b116]{min-width:400px;width:400px}.row__cell--fill[data-v-e966b116]{min-width:var(--cell-width-large);width:100%}.row__cell--actions[data-v-e966b116]{position:sticky;inset-inline-end:0;z-index:var(--sticky-column-z-index);display:flex;flex-direction:row;align-items:center;min-width:110px;width:110px;background-color:var(--color-main-background);border-inline-start:1px solid var(--color-border)}.row__subtitle[data-v-e966b116]{color:var(--color-text-maxcontrast)}.row__cell[data-v-e966b116]{border-bottom:1px solid var(--color-border)}.row__cell[data-v-e966b116] .v-select.select{min-width:var(--cell-min-width)}.row__progress[data-v-e966b116]{margin-top:4px}.row__progress--warn[data-v-e966b116]::-moz-progress-bar{background:var(--color-warning) !important}.row__progress--warn[data-v-e966b116]::-webkit-progress-value{background:var(--color-warning) !important}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/UserRow.vue","webpack://./apps/settings/src/components/Users/shared/styles.scss"],names:[],mappings:"AAGA,iCCGC,iBAAA,CACA,YAAA,CACA,cAAA,CACA,iBAAA,CACA,wBAAA,CACA,6CAAA,CDLA,uCACC,8CAAA,CAEA,2EACC,8CAAA,CAKF,+CACC,+DAAA,CCDD,4BACC,YAAA,CACA,qBAAA,CACA,sBAAA,CACA,6BAAA,CACA,2BAAA,CACA,uBAAA,CACA,4BAAA,CAEA,sGAGC,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,sBAAA,CAGD,yBACC,6EAEC,eAAA,CACA,oCAAA,CACA,6CAAA,CAGD,oCACC,oBAAA,CAGD,yCACC,2CAAA,CACA,+CAAA,CAAA,CAIF,sCACC,yDAAA,CAGD,oCACC,kCAAA,CACA,8BAAA,CACA,kBAAA,CACA,SAAA,CACA,gBAAA,CAIA,4CACC,iBAAA,CACA,iBAAA,CAEA,iCAJD,4CAKE,mBAAA,CACA,oBAAA,CACA,2BAAA,CAAA,CAKH,mCACC,iCAAA,CACA,6BAAA,CAGD,wCACC,eAAA,CACA,WAAA,CAID,kCACC,iCAAA,CACA,UAAA,CAGD,qCACC,eAAA,CACA,kBAAA,CACA,oCAAA,CACA,YAAA,CACA,kBAAA,CACA,kBAAA,CACA,eAAA,CACA,WAAA,CACA,6CAAA,CACA,iDAAA,CAIF,gCACC,mCAAA,CDpFD,4BACC,2CAAA,CAGC,6CACC,+BAAA,CAKH,gCACC,cAAA,CAGC,yDACC,0CAAA,CAED,8DACC,0CAAA",sourceRoot:""}]);const o=r},6817:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".dialog__note[data-v-9f7a355c]{font-weight:normal}fieldset[data-v-9f7a355c]{font-weight:bold}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/UserSettingsDialog.vue"],names:[],mappings:"AAEC,+BACC,kBAAA,CAIF,0BACC,gBAAA",sourceRoot:""}]);const o=r},12795:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".user-list[data-v-21942da5]{--avatar-cell-width: 48px;--cell-padding: 7px;--cell-width: 200px;--cell-width-large: 300px;--cell-min-width: calc(var(--cell-width) - (2 * var(--cell-padding)));--sticky-column-z-index: calc(var(--vs-dropdown-z-index) + 1);display:block;overflow:auto;height:100%;will-change:scroll-position}.user-list__header[data-v-21942da5],.user-list__footer[data-v-21942da5]{position:sticky;display:block}.user-list__header[data-v-21942da5]{top:0;z-index:calc(var(--sticky-column-z-index) + 1)}.user-list__footer[data-v-21942da5]{inset-inline-start:0}.user-list__body[data-v-21942da5]{display:flex;flex-direction:column;width:100%}","",{version:3,sources:["webpack://./apps/settings/src/components/Users/VirtualList.vue"],names:[],mappings:"AACA,4BACC,yBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,qEAAA,CACA,6DAAA,CAGA,aAAA,CACA,aAAA,CACA,WAAA,CACA,2BAAA,CAEA,wEAEC,eAAA,CAEA,aAAA,CAGD,oCACC,KAAA,CACA,8CAAA,CAGD,oCACC,oBAAA,CAGD,kCACC,YAAA,CACA,qBAAA,CACA,UAAA",sourceRoot:""}]);const o=r},82009:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".app-content[data-v-253f9eec]{display:flex;overflow:hidden;flex-direction:column;max-height:100%}","",{version:3,sources:["webpack://./apps/settings/src/views/UserManagement.vue"],names:[],mappings:"AACA,8BAEC,YAAA,CACA,eAAA,CACA,qBAAA,CACA,eAAA",sourceRoot:""}]);const o=r},49977:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(71354),i=s.n(a),n=s(76314),r=s.n(n)()(i());r.push([e.id,".account-management__navigation[data-v-edf83404] .app-navigation__body{will-change:scroll-position}.account-management__system-list[data-v-edf83404]{height:auto !important;overflow:visible !important}.account-management__group-list[data-v-edf83404]{height:100% !important}.account-management__settings-toggle[data-v-edf83404]{margin-bottom:12px}","",{version:3,sources:["webpack://./apps/settings/src/views/UserManagementNavigation.vue"],names:[],mappings:"AAGE,uEACC,2BAAA,CAGF,kDACC,sBAAA,CACA,2BAAA,CAGD,iDACC,sBAAA,CAGD,sDACC,kBAAA",sourceRoot:""}]);const o=r},31795:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Ue});var i=a(53334),n=a(61338),r=a(85471),o=a(18195),l=a(9165),d=a(85168),c=a(54914),u=a(35779),A=a(6695),g=a(59892),p=a(55042),h=a(17334),m=a.n(h),C=a(36620);r.Ay.directive("elementVisibility",p.Zx);const v=r.Ay.extend({name:"VirtualList",props:{dataComponent:{type:[Object,Function],required:!0},dataKey:{type:String,required:!0},dataSources:{type:Array,required:!0},itemHeight:{type:Number,required:!0},extraProps:{type:Object,default:()=>({})}},data:()=>({bufferItems:3,index:0,headerHeight:0,tableHeight:0,resizeObserver:null}),computed:{startIndex(){return Math.max(0,this.index-3)},shownItems(){return Math.ceil((this.tableHeight-this.headerHeight)/this.itemHeight)+6},renderedItems(){return this.dataSources.slice(this.startIndex,this.startIndex+this.shownItems)},tbodyStyle(){const e=this.startIndex+this.shownItems>this.dataSources.length,t=this.dataSources.length-this.startIndex-this.shownItems,s=Math.min(this.dataSources.length-this.startIndex,t);return{paddingTop:this.startIndex*this.itemHeight+"px",paddingBottom:e?0:s*this.itemHeight+"px"}}},mounted(){const e=this.$el,t=this.$refs?.tfoot,s=this.$refs?.thead;this.resizeObserver=new ResizeObserver(m()((()=>{this.headerHeight=s?.clientHeight??0,this.tableHeight=e?.clientHeight??0,C.A.debug("VirtualList resizeObserver updated"),this.onScroll()}),100,!1)),this.resizeObserver.observe(e),this.resizeObserver.observe(t),this.resizeObserver.observe(s),this.$el.addEventListener("scroll",this.onScroll)},beforeDestroy(){this.resizeObserver&&this.resizeObserver.disconnect()},methods:{handleFooterVisibility(e){e&&this.$emit("scroll-end")},onScroll(){this.index=Math.max(0,Math.round(this.$el.scrollTop/this.itemHeight))}}});var _=a(85072),w=a.n(_),b=a(97825),f=a.n(b),y=a(77659),N=a.n(y),G=a(55056),S=a.n(G),x=a(10540),U=a.n(x),k=a(41113),L=a.n(k),D=a(12795),B={};B.styleTagTransform=L(),B.setAttributes=S(),B.insert=N().bind(null,"head"),B.domAPI=f(),B.insertStyleElement=U(),w()(D.A,B),D.A&&D.A.locals&&D.A.locals;var I=a(14486);const q=(0,I.A)(v,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("table",{staticClass:"user-list"},[e._t("before"),e._v(" "),t("thead",{ref:"thead",staticClass:"user-list__header",attrs:{role:"rowgroup"}},[e._t("header")],2),e._v(" "),t("tbody",{staticClass:"user-list__body",style:e.tbodyStyle},e._l(e.renderedItems,(function(s,a){return t(e.dataComponent,e._b({key:s[e.dataKey],tag:"component",attrs:{user:s,visible:(a>=e.bufferItems||e.index<=e.bufferItems)&&a<e.shownItems-e.bufferItems}},"component",e.extraProps,!1))})),1),e._v(" "),t("tfoot",{directives:[{name:"element-visibility",rawName:"v-element-visibility",value:e.handleFooterVisibility,expression:"handleFooterVisibility"}],ref:"tfoot",staticClass:"user-list__footer",attrs:{role:"rowgroup"}},[e._t("footer")],2)],2)}),[],!1,null,"21942da5",null).exports;var O=a(35810),M=a(97012),$=a(94219),E=a(16044),F=a(67607),T=a(82182),P=a(46984);const R={name:"NewUserDialog",components:{NcButton:M.A,NcDialog:$.A,NcPasswordField:E.A,NcSelect:F.A,NcTextField:T.A},props:{loading:{type:Object,required:!0},newUser:{type:Object,required:!0},quotaOptions:{type:Array,required:!0}},data(){return{availableGroups:this.$store.getters.getSortedGroups.filter((e=>"__nc_internal_recent"!==e.id&&"disabled"!==e.id)),possibleManagers:[],managerInputLabel:t("settings","Manager"),managerLabel:t("settings","Set line manager"),promise:null}},computed:{showConfig(){return this.$store.getters.getShowConfig},settings(){return this.$store.getters.getServerData},usernameLabel(){return this.settings.newUserGenerateUserID?t("settings","Account name will be autogenerated"):t("settings","Account name (required)")},minPasswordLength(){return this.$store.getters.getPasswordPolicyMinLength},subAdminsGroups(){return this.availableGroups.filter((e=>"admin"!==e.id&&"__nc_internal_recent"!==e.id&&"disabled"!==e.id))},languages(){return[{name:t("settings","Common languages"),languages:this.settings.languages.commonLanguages},...this.settings.languages.commonLanguages,{name:t("settings","Other languages"),languages:this.settings.languages.otherLanguages},...this.settings.languages.otherLanguages]}},async beforeMount(){await this.searchUserManager()},mounted(){this.$refs.username?.focus?.()},methods:{async createUser(){this.loading.all=!0;try{await this.$store.dispatch("addUser",{userid:this.newUser.id,password:this.newUser.password,displayName:this.newUser.displayName,email:this.newUser.mailAddress,groups:this.newUser.groups.map((e=>e.id)),subadmin:this.newUser.subAdminsGroups.map((e=>e.id)),quota:this.newUser.quota.id,language:this.newUser.language.code,manager:this.newUser.manager.id}),this.$emit("reset"),this.$refs.username?.focus?.(),this.$emit("closing")}catch(e){if(this.loading.all=!1,e.response&&e.response.data&&e.response.data.ocs&&e.response.data.ocs.meta){const t=e.response.data.ocs.meta.statuscode;102===t?this.$refs.username?.focus?.():107===t&&this.$refs.password?.focus?.()}}},async searchGroups(e,s){this.promise&&this.promise.cancel(),s(!0);try{this.promise=(0,P.N_)({search:e,offset:0,limit:25});const t=await this.promise;this.availableGroups=t}catch(e){C.A.error(t("settings","Failed to search groups"),{error:e})}this.promise=null,s(!1)},async createGroup(e){let{name:s}=e;this.loading.groups=!0;try{await this.$store.dispatch("addGroup",s),this.availableGroups.push({id:s,name:s}),this.newUser.groups.push({id:s,name:s})}catch(e){C.A.error(t("settings","Failed to create group"),{error:e})}this.loading.groups=!1},async addGroup(e){e.isCreating||!1!==e.canAdd&&this.newUser.groups.push(e)},validateQuota(e){const t=OC.Util.computerFileSize(e);return null!==t&&t>=0?(e=(0,O.v7)((0,O.lT)(e)),this.newUser.quota={id:e,label:e},this.newUser.quota):(this.newUser.quota=this.quotaOptions[0],this.quotaOptions[0])},languageFilterBy:(e,t,s)=>e.languages?e.languages.some((e=>{let{name:t}=e;return t.toLocaleLowerCase().includes(s.toLocaleLowerCase())})):(t||"").toLocaleLowerCase().includes(s.toLocaleLowerCase()),async searchUserManager(e){await this.$store.dispatch("searchUsers",{offset:0,limit:10,search:e}).then((e=>{const t=e?.data?Object.values(e?.data.ocs.data.users):[];t.length>0&&(this.possibleManagers=t)}))}}};var Q=a(27910),z={};z.styleTagTransform=L(),z.setAttributes=S(),z.insert=N().bind(null,"head"),z.domAPI=f(),z.insertStyleElement=U(),w()(Q.A,z),Q.A&&Q.A.locals&&Q.A.locals;var W=(0,I.A)(R,(function(){var e=this,t=e._self._c;return t("NcDialog",e._g({staticClass:"dialog",attrs:{size:"small",name:e.t("settings","New account"),"out-transition":""},scopedSlots:e._u([{key:"actions",fn:function(){return[t("NcButton",{staticClass:"dialog__submit",attrs:{"data-test":"submit",form:"new-user-form",type:"primary","native-type":"submit"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Add new account"))+"\n\t\t")])]},proxy:!0}])},e.$listeners),[t("form",{staticClass:"dialog__form",attrs:{id:"new-user-form","data-test":"form",disabled:e.loading.all},on:{submit:function(t){return t.preventDefault(),e.createUser.apply(null,arguments)}}},[t("NcTextField",{ref:"username",staticClass:"dialog__item",attrs:{"data-test":"username",value:e.newUser.id,disabled:e.settings.newUserGenerateUserID,label:e.usernameLabel,autocapitalize:"none",autocomplete:"off",spellcheck:"false",pattern:"[a-zA-Z0-9 _\\.@\\-']+",required:""},on:{"update:value":function(t){return e.$set(e.newUser,"id",t)}}}),e._v(" "),t("NcTextField",{staticClass:"dialog__item",attrs:{"data-test":"displayName",value:e.newUser.displayName,label:e.t("settings","Display name"),autocapitalize:"none",autocomplete:"off",spellcheck:"false"},on:{"update:value":function(t){return e.$set(e.newUser,"displayName",t)}}}),e._v(" "),e.settings.newUserRequireEmail?e._e():t("span",{staticClass:"dialog__hint",attrs:{id:"password-email-hint"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Either password or email is required"))+"\n\t\t")]),e._v(" "),t("NcPasswordField",{ref:"password",staticClass:"dialog__item",attrs:{"data-test":"password",value:e.newUser.password,minlength:e.minPasswordLength,maxlength:469,"aria-describedby":"password-email-hint",label:""===e.newUser.mailAddress?e.t("settings","Password (required)"):e.t("settings","Password"),autocapitalize:"none",autocomplete:"new-password",spellcheck:"false",required:""===e.newUser.mailAddress},on:{"update:value":function(t){return e.$set(e.newUser,"password",t)}}}),e._v(" "),t("NcTextField",{staticClass:"dialog__item",attrs:{"data-test":"email",type:"email",value:e.newUser.mailAddress,"aria-describedby":"password-email-hint",label:""===e.newUser.password||e.settings.newUserRequireEmail?e.t("settings","Email (required)"):e.t("settings","Email"),autocapitalize:"none",autocomplete:"off",spellcheck:"false",required:""===e.newUser.password||e.settings.newUserRequireEmail},on:{"update:value":function(t){return e.$set(e.newUser,"mailAddress",t)}}}),e._v(" "),t("div",{staticClass:"dialog__item"},[t("NcSelect",{staticClass:"dialog__select",attrs:{"input-label":e.settings.isAdmin||e.settings.isDelegatedAdmin?e.t("settings","Member of the following groups"):e.t("settings","Member of the following groups (required)"),placeholder:e.t("settings","Set account groups"),disabled:e.loading.groups||e.loading.all,options:e.availableGroups,value:e.newUser.groups,label:"name","close-on-select":!1,multiple:!0,taggable:!0,required:!e.settings.isAdmin&&!e.settings.isDelegatedAdmin,"create-option":e=>({id:e,name:e,isCreating:!0})},on:{search:e.searchGroups,"option:created":e.createGroup,"option:selected":t=>e.addGroup(t.at(-1))}})],1),e._v(" "),t("div",{staticClass:"dialog__item"},[t("NcSelect",{staticClass:"dialog__select",attrs:{"input-label":e.t("settings","Admin of the following groups"),placeholder:e.t("settings","Set account as admin for …"),disabled:e.loading.groups||e.loading.all,options:e.subAdminsGroups,"close-on-select":!1,multiple:!0,label:"name"},on:{search:e.searchGroups},model:{value:e.newUser.subAdminsGroups,callback:function(t){e.$set(e.newUser,"subAdminsGroups",t)},expression:"newUser.subAdminsGroups"}})],1),e._v(" "),t("div",{staticClass:"dialog__item"},[t("NcSelect",{staticClass:"dialog__select",attrs:{"input-label":e.t("settings","Quota"),placeholder:e.t("settings","Set account quota"),options:e.quotaOptions,clearable:!1,taggable:!0,"create-option":e.validateQuota},model:{value:e.newUser.quota,callback:function(t){e.$set(e.newUser,"quota",t)},expression:"newUser.quota"}})],1),e._v(" "),e.showConfig.showLanguages?t("div",{staticClass:"dialog__item"},[t("NcSelect",{staticClass:"dialog__select",attrs:{"input-label":e.t("settings","Language"),placeholder:e.t("settings","Set default language"),clearable:!1,selectable:e=>!e.languages,"filter-by":e.languageFilterBy,options:e.languages,label:"name"},model:{value:e.newUser.language,callback:function(t){e.$set(e.newUser,"language",t)},expression:"newUser.language"}})],1):e._e(),e._v(" "),t("div",{class:["dialog__item dialog__managers",{"icon-loading-small":e.loading.manager}]},[t("NcSelect",{staticClass:"dialog__select",attrs:{"input-label":e.managerInputLabel,placeholder:e.managerLabel,options:e.possibleManagers,"user-select":!0,label:"displayname"},on:{search:e.searchUserManager},model:{value:e.newUser.manager,callback:function(t){e.$set(e.newUser,"manager",t)},expression:"newUser.manager"}})],1)],1)])}),[],!1,null,"0b6b2bc6",null);const H=W.exports,K=r.Ay.extend({name:"UserListFooter",components:{NcLoadingIcon:g.A},props:{loading:{type:Boolean,required:!0},filteredUsers:{type:Array,required:!0}},computed:{userCount(){return this.loading?this.n("settings","{userCount} account …","{userCount} accounts …",this.filteredUsers.length,{userCount:this.filteredUsers.length}):this.n("settings","{userCount} account","{userCount} accounts",this.filteredUsers.length,{userCount:this.filteredUsers.length})}},methods:{t:i.Tl,n:i.zw}});var j=a(95066),Y={};Y.styleTagTransform=L(),Y.setAttributes=S(),Y.insert=N().bind(null,"head"),Y.domAPI=f(),Y.insertStyleElement=U(),w()(j.A,Y),j.A&&j.A.locals&&j.A.locals;const V=(0,I.A)(K,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("tr",{staticClass:"footer"},[t("th",{attrs:{scope:"row"}},[t("span",{staticClass:"hidden-visually"},[e._v(e._s(e.t("settings","Total rows summary")))])]),e._v(" "),t("td",{staticClass:"footer__cell footer__cell--loading"},[e.loading?t("NcLoadingIcon",{attrs:{title:e.t("settings","Loading accounts …"),size:32}}):e._e()],1),e._v(" "),t("td",{staticClass:"footer__cell footer__cell--count footer__cell--multiline"},[t("span",{attrs:{"aria-describedby":"user-count-desc"}},[e._v(e._s(e.userCount))]),e._v(" "),t("span",{staticClass:"hidden-visually",attrs:{id:"user-count-desc"}},[e._v("\n\t\t\t"+e._s(e.t("settings","Scroll to load more rows"))+"\n\t\t")])])])}),[],!1,null,"db2a7c4e",null).exports,X=r.Ay.extend({name:"UserListHeader",props:{hasObfuscated:{type:Boolean,required:!0}},computed:{showConfig(){return this.$store.getters.getShowConfig},settings(){return this.$store.getters.getServerData},passwordLabel(){return this.hasObfuscated?(0,i.Tl)("settings","Password or insufficient permissions message"):(0,i.Tl)("settings","Password")}},methods:{t:i.Tl}});var J=a(24882),Z={};Z.styleTagTransform=L(),Z.setAttributes=S(),Z.insert=N().bind(null,"head"),Z.domAPI=f(),Z.insertStyleElement=U(),w()(J.A,Z),J.A&&J.A.locals&&J.A.locals;const ee=(0,I.A)(X,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("tr",{staticClass:"header"},[t("th",{staticClass:"header__cell header__cell--avatar",attrs:{"data-cy-user-list-header-avatar":"",scope:"col"}},[t("span",{staticClass:"hidden-visually"},[e._v("\n\t\t\t"+e._s(e.t("settings","Avatar"))+"\n\t\t")])]),e._v(" "),t("th",{staticClass:"header__cell header__cell--displayname",attrs:{"data-cy-user-list-header-displayname":"",scope:"col"}},[t("strong",[e._v("\n\t\t\t"+e._s(e.t("settings","Display name"))+"\n\t\t")])]),e._v(" "),t("th",{staticClass:"header__cell header__cell--username",attrs:{"data-cy-user-list-header-username":"",scope:"col"}},[t("span",[e._v("\n\t\t\t"+e._s(e.t("settings","Account name"))+"\n\t\t")])]),e._v(" "),t("th",{staticClass:"header__cell",class:{"header__cell--obfuscated":e.hasObfuscated},attrs:{"data-cy-user-list-header-password":"",scope:"col"}},[t("span",[e._v(e._s(e.passwordLabel))])]),e._v(" "),t("th",{staticClass:"header__cell",attrs:{"data-cy-user-list-header-email":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Email")))])]),e._v(" "),t("th",{staticClass:"header__cell header__cell--large",attrs:{"data-cy-user-list-header-groups":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Groups")))])]),e._v(" "),e.settings.isAdmin||e.settings.isDelegatedAdmin?t("th",{staticClass:"header__cell header__cell--large",attrs:{"data-cy-user-list-header-subadmins":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Group admin for")))])]):e._e(),e._v(" "),t("th",{staticClass:"header__cell",attrs:{"data-cy-user-list-header-quota":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Quota")))])]),e._v(" "),e.showConfig.showLanguages?t("th",{staticClass:"header__cell header__cell--large",attrs:{"data-cy-user-list-header-languages":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Language")))])]):e._e(),e._v(" "),e.showConfig.showUserBackend||e.showConfig.showStoragePath?t("th",{staticClass:"header__cell header__cell--large",attrs:{"data-cy-user-list-header-storage-location":"",scope:"col"}},[e.showConfig.showUserBackend?t("span",[e._v("\n\t\t\t"+e._s(e.t("settings","Account backend"))+"\n\t\t")]):e._e(),e._v(" "),e.showConfig.showStoragePath?t("span",{staticClass:"header__subtitle"},[e._v("\n\t\t\t"+e._s(e.t("settings","Storage location"))+"\n\t\t")]):e._e()]):e._e(),e._v(" "),e.showConfig.showFirstLogin?t("th",{staticClass:"header__cell",attrs:{"data-cy-user-list-header-first-login":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","First login")))])]):e._e(),e._v(" "),e.showConfig.showLastLogin?t("th",{staticClass:"header__cell",attrs:{"data-cy-user-list-header-last-login":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Last login")))])]):e._e(),e._v(" "),t("th",{staticClass:"header__cell header__cell--large header__cell--fill",attrs:{"data-cy-user-list-header-manager":"",scope:"col"}},[t("span",[e._v(e._s(e.t("settings","Manager")))])]),e._v(" "),t("th",{staticClass:"header__cell header__cell--actions",attrs:{"data-cy-user-list-header-actions":"",scope:"col"}},[t("span",{staticClass:"hidden-visually"},[e._v("\n\t\t\t"+e._s(e.t("settings","Account actions"))+"\n\t\t")])])])}),[],!1,null,"5c0f8828",null).exports;var te=a(21777),se=a(56760),ae=a(41944),ie=a(95101),ne=a(86454),re=a(57505),oe=a(24764),le=a(65659),de=a(19664);const ce=(0,r.pM)({components:{NcActionButton:re.A,NcActions:oe.A,NcIconSvgWrapper:A.A},props:{actions:{type:Array,required:!0},disabled:{type:Boolean,required:!0},edit:{type:Boolean,required:!0},user:{type:Object,required:!0}},computed:{editSvg(){return this.edit?le:de},enabledActions(){return this.actions.filter((e=>"function"!=typeof e.enabled||e.enabled(this.user)))}},methods:{isSvg:function(e){if("string"!=typeof e)throw new TypeError(`Expected a \`string\`, got \`${typeof e}\``);if(0===(e=e.trim()).length)return!1;if(!0!==ne.XMLValidator.validate(e))return!1;let t;const s=new ne.XMLParser;try{t=s.parse(e)}catch{return!1}return!!t&&!!Object.keys(t).some((e=>"svg"===e.toLowerCase()))},toggleEdit(){this.$emit("update:edit",!this.edit)}}}),ue=(0,I.A)(ce,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("NcActions",{attrs:{"aria-label":e.t("settings","Toggle account actions menu"),disabled:e.disabled,inline:1}},[t("NcActionButton",{attrs:{"data-cy-user-list-action-toggle-edit":`${e.edit}`,disabled:e.disabled},on:{click:e.toggleEdit},scopedSlots:e._u([{key:"icon",fn:function(){return[t("NcIconSvgWrapper",{key:e.editSvg,attrs:{svg:e.editSvg,"aria-hidden":"true"}})]},proxy:!0}])},[e._v("\n\t\t"+e._s(e.edit?e.t("settings","Done"):e.t("settings","Edit"))+"\n\t\t")]),e._v(" "),e._l(e.enabledActions,(function(s,a){let{action:i,icon:n,text:r}=s;return t("NcActionButton",{key:a,attrs:{disabled:e.disabled,"aria-label":r,icon:n,"close-after-click":""},on:{click:t=>i(t,{...e.user})},scopedSlots:e._u([e.isSvg(n)?{key:"icon",fn:function(){return[t("NcIconSvgWrapper",{attrs:{svg:n,"aria-hidden":"true"}})]},proxy:!0}:null],null,!0)},[e._v("\n\t\t"+e._s(r)+"\n\t\t")])}))],2)}),[],!1,null,null,null).exports;var Ae=a(76333);const ge={props:{user:{type:Object,required:!0},settings:{type:Object,default:()=>({})},quotaOptions:{type:Array,default:()=>[]},languages:{type:Array,required:!0},externalActions:{type:Array,default:()=>[]}},setup(e){const{formattedFullTime:t}=(0,Ae.m7)(1e3*e.user.firstLoginTimestamp,{relativeTime:!1,format:{timeStyle:"short",dateStyle:"short"}});return{formattedFullTime:t}},data(){return{availableGroups:this.user.groups.map((e=>({id:e,name:e}))),availableSubAdminGroups:this.user.subadmin.map((e=>({id:e,name:e}))),userGroups:this.user.groups.map((e=>({id:e,name:e}))),userSubAdminGroups:this.user.subadmin.map((e=>({id:e,name:e})))}},computed:{showConfig(){return this.$store.getters.getShowConfig},usedSpace(){const e=this.user.quota.used>0?this.user.quota.used:0;return t("settings","{size} used",{size:(0,O.v7)(e,!0)})},usedQuota(){let e=this.user.quota.quota;return e=e>0?Math.min(100,Math.round(this.user.quota.used/e*100)):95*(1-1/(this.user.quota.used/(10*Math.pow(2,30))+1)),isNaN(e)?0:e},userQuota(){if(this.user.quota.quota>=0){const e=(0,O.v7)(this.user.quota.quota);return this.quotaOptions.find((t=>t.id===e))||{id:e,label:e}}return"default"===this.user.quota.quota?this.quotaOptions[0]:this.quotaOptions[1]},minPasswordLength(){return this.$store.getters.getPasswordPolicyMinLength},userLanguage(){const e=this.languages[0].languages.concat(this.languages[1].languages).find((e=>e.code===this.user.language));return"object"!=typeof e&&""!==this.user.language?{code:this.user.language,name:this.user.language}:""!==this.user.language&&e},userFirstLogin(){return this.user.firstLoginTimestamp>0?this.formattedFullTime:this.user.firstLoginTimestamp<0?t("settings","Unknown"):t("settings","Never")},userLastLoginTooltip(){return this.user.lastLoginTimestamp>0?OC.Util.formatDate(1e3*this.user.lastLoginTimestamp):""},userLastLogin(){return this.user.lastLoginTimestamp>0?OC.Util.relativeModifiedDate(1e3*this.user.lastLoginTimestamp):t("settings","Never")}}};var pe=a(95668);const he={name:"UserRow",components:{NcAvatar:ae.A,NcLoadingIcon:g.A,NcProgressBar:ie.A,NcSelect:F.A,NcTextField:T.A,UserRowActions:ue},mixins:[ge],props:{user:{type:Object,required:!0},visible:{type:Boolean,required:!0},users:{type:Array,required:!0},hasObfuscated:{type:Boolean,required:!0},quotaOptions:{type:Array,required:!0},languages:{type:Array,required:!0},settings:{type:Object,required:!0},externalActions:{type:Array,default:()=>[]}},data(){return{selectedQuota:!1,rand:Math.random().toString(36).substring(2),loadingPossibleManagers:!1,possibleManagers:[],currentManager:"",editing:!1,loading:{all:!1,displayName:!1,password:!1,mailAddress:!1,groups:!1,groupsDetails:!1,subAdminGroupsDetails:!1,subadmins:!1,quota:!1,delete:!1,disable:!1,languages:!1,wipe:!1,manager:!1},editedDisplayName:this.user.displayname,editedPassword:"",editedMail:this.user.email??"",promise:null}},computed:{managerLabel:()=>t("settings","Set line manager"),isObfuscated(){return(0,pe.HK)(this.user)},showConfig(){return this.$store.getters.getShowConfig},isLoadingUser(){return this.loading.delete||this.loading.disable||this.loading.wipe},isLoadingField(){return this.loading.delete||this.loading.disable||this.loading.all},uniqueId(){return encodeURIComponent(this.user.id+this.rand)},userGroupsLabels(){return this.userGroups.map((e=>e.name??e.id)).join(", ")},userSubAdminGroupsLabels(){return this.userSubAdminGroups.map((e=>e.name??e.id)).join(", ")},usedSpace(){return this.user.quota?.used?t("settings","{size} used",{size:(0,O.v7)(this.user.quota?.used)}):t("settings","{size} used",{size:(0,O.v7)(0)})},canEdit(){return(0,te.HW)().uid!==this.user.id||this.settings.isAdmin||this.settings.isDelegatedAdmin},userQuota(){let e=this.user.quota?.quota;return"default"===e&&(e=this.settings.defaultQuota,"none"!==e&&(e=(0,O.lT)(e,!0))),"none"===e||-3===e?t("settings","Unlimited"):e>=0?(0,O.v7)(e):(0,O.v7)(0)},userActions(){const e=[{icon:"icon-delete",text:t("settings","Delete account"),action:this.deleteUser},{icon:"icon-delete",text:t("settings","Disconnect all devices and delete local data"),action:this.wipeUserDevices},{icon:this.user.enabled?"icon-close":"icon-add",text:this.user.enabled?t("settings","Disable account"):t("settings","Enable account"),action:this.enableDisableUser}];return null!==this.user.email&&""!==this.user.email&&e.push({icon:"icon-mail",text:t("settings","Resend welcome email"),action:this.sendWelcomeMail}),e.concat(this.externalActions)},editedUserQuota:{get(){return!1!==this.selectedQuota?this.selectedQuota:this.settings.defaultQuota!==pe.SA.id&&(0,O.lT)(this.settings.defaultQuota,!0)>=0?{id:this.settings.defaultQuota,label:this.settings.defaultQuota}:pe.SA},set(e){this.selectedQuota=e}},availableLanguages(){return this.languages[0].languages.concat(this.languages[1].languages)}},async beforeMount(){this.user.manager&&await this.initManager(this.user.manager)},methods:{async wipeUserDevices(){const e=this.user.id;await(0,se.C5)(),OC.dialogs.confirmDestructive(t("settings","In case of lost device or exiting the organization, this can remotely wipe the Nextcloud data from all devices associated with {userid}. Only works if the devices are connected to the internet.",{userid:e}),t("settings","Remote wipe of devices"),{type:OC.dialogs.YES_NO_BUTTONS,confirm:t("settings","Wipe {userid}'s devices",{userid:e}),confirmClasses:"error",cancel:t("settings","Cancel")},(s=>{s&&(this.loading.wipe=!0,this.loading.all=!0,this.$store.dispatch("wipeUserDevices",e).then((()=>(0,d.Te)(t("settings","Wiped {userid}'s devices",{userid:e}))),{timeout:2e3}).finally((()=>{this.loading.wipe=!1,this.loading.all=!1})))}),!0)},filterManagers(e){return e.filter((e=>e.id!==this.user.id))},async initManager(e){await this.$store.dispatch("getUser",e).then((e=>{this.currentManager=e?.data.ocs.data}))},async searchInitialUserManager(){this.loadingPossibleManagers=!0,await this.searchUserManager(),this.loadingPossibleManagers=!1},async loadGroupsDetails(){this.loading.groups=!0,this.loading.groupsDetails=!0;try{const e=await(0,P.Iu)({userId:this.user.id});this.availableGroups=this.availableGroups.map((t=>e.find((e=>e.id===t.id))??t))}catch(e){C.A.error(t("settings","Failed to load groups with details"),{error:e})}this.loading.groups=!1,this.loading.groupsDetails=!1},async loadSubAdminGroupsDetails(){this.loading.subadmins=!0,this.loading.subAdminGroupsDetails=!0;try{const e=await(0,P.FF)({userId:this.user.id});this.availableSubAdminGroups=this.availableSubAdminGroups.map((t=>e.find((e=>e.id===t.id))??t))}catch(e){C.A.error(t("settings","Failed to load sub admin groups with details"),{error:e})}this.loading.subadmins=!1,this.loading.subAdminGroupsDetails=!1},async searchGroups(e,s){if(""!==e){this.promise&&this.promise.cancel(),s(!0);try{this.promise=await(0,P.N_)({search:e,offset:0,limit:25});const t=await this.promise;this.availableGroups=t,this.availableSubAdminGroups=t.filter((e=>"admin"!==e.id))}catch(e){C.A.error(t("settings","Failed to search groups"),{error:e})}this.promise=null,s(!1)}},async searchUserManager(e){await this.$store.dispatch("searchUsers",{offset:0,limit:10,search:e}).then((e=>{const t=e?.data?this.filterManagers(Object.values(e?.data.ocs.data.users)):[];t.length>0&&(this.possibleManagers=t)}))},async updateUserManager(e){null===e&&(this.currentManager=""),this.loading.manager=!0;try{await this.$store.dispatch("setUserData",{userid:this.user.id,key:"manager",value:this.currentManager?this.currentManager.id:""})}catch(e){(0,d.Qg)(t("settings","Failed to update line manager")),console.error(e)}finally{this.loading.manager=!1}},async deleteUser(){const e=this.user.id;await(0,se.C5)(),OC.dialogs.confirmDestructive(t("settings","Fully delete {userid}'s account including all their personal files, app data, etc.",{userid:e}),t("settings","Account deletion"),{type:OC.dialogs.YES_NO_BUTTONS,confirm:t("settings","Delete {userid}'s account",{userid:e}),confirmClasses:"error",cancel:t("settings","Cancel")},(t=>{if(t)return this.loading.delete=!0,this.loading.all=!0,this.$store.dispatch("deleteUser",e).then((()=>{this.loading.delete=!1,this.loading.all=!1}))}),!0)},enableDisableUser(){this.loading.delete=!0,this.loading.all=!0;const e=this.user.id,t=!this.user.enabled;return this.$store.dispatch("enableDisableUser",{userid:e,enabled:t}).then((()=>{this.loading.delete=!1,this.loading.all=!1}))},async updateDisplayName(){this.loading.displayName=!0;try{await this.$store.dispatch("setUserData",{userid:this.user.id,key:"displayname",value:this.editedDisplayName}),this.editedDisplayName===this.user.displayname&&(0,d.Te)(t("settings","Display name was successfully changed"))}finally{this.loading.displayName=!1}},async updatePassword(){if(this.loading.password=!0,0===this.editedPassword.length)(0,d.Qg)(t("settings","Password can't be empty")),this.loading.password=!1;else try{await this.$store.dispatch("setUserData",{userid:this.user.id,key:"password",value:this.editedPassword}),this.editedPassword="",(0,d.Te)(t("settings","Password was successfully changed"))}finally{this.loading.password=!1}},async updateEmail(){if(this.loading.mailAddress=!0,""===this.editedMail)(0,d.Qg)(t("settings","Email can't be empty")),this.loading.mailAddress=!1,this.editedMail=this.user.email;else try{await this.$store.dispatch("setUserData",{userid:this.user.id,key:"email",value:this.editedMail}),this.editedMail===this.user.email&&(0,d.Te)(t("settings","Email was successfully changed"))}finally{this.loading.mailAddress=!1}},async createGroup(e){let{name:s}=e;this.loading.groups=!0;try{await this.$store.dispatch("addGroup",s),this.availableGroups.push({id:s,name:s}),this.availableSubAdminGroups.push({id:s,name:s});const e=this.user.id;await this.$store.dispatch("addUserGroup",{userid:e,gid:s}),this.userGroups.push({id:s,name:s})}catch(e){C.A.error(t("settings","Failed to create group"),{error:e})}this.loading.groups=!1},async addUserGroup(e){if(e.isCreating)return;const t=this.user.id,s=e.id;if(!1!==e.canAdd){this.loading.groups=!0;try{await this.$store.dispatch("addUserGroup",{userid:t,gid:s}),this.userGroups.push(e)}catch(e){console.error(e)}this.loading.groups=!1}},async removeUserGroup(e){if(!1===e.canRemove)return!1;this.loading.groups=!0;const t=this.user.id,s=e.id;try{await this.$store.dispatch("removeUserGroup",{userid:t,gid:s}),this.userGroups=this.userGroups.filter((e=>e.id!==s)),this.loading.groups=!1,this.$route.params.selectedGroup===s&&this.$store.commit("deleteUser",t)}catch{this.loading.groups=!1}},async addUserSubAdmin(e){this.loading.subadmins=!0;const t=this.user.id,s=e.id;try{await this.$store.dispatch("addUserSubAdmin",{userid:t,gid:s}),this.userSubAdminGroups.push(e)}catch(e){console.error(e)}this.loading.subadmins=!1},async removeUserSubAdmin(e){this.loading.subadmins=!0;const t=this.user.id,s=e.id;try{await this.$store.dispatch("removeUserSubAdmin",{userid:t,gid:s}),this.userSubAdminGroups=this.userSubAdminGroups.filter((e=>e.id!==s))}catch(e){console.error(e)}finally{this.loading.subadmins=!1}},async setUserQuota(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none";"none"===e&&(e=pe.SA),this.loading.quota=!0,e=e.id?e.id:e;try{const t=((0,O.lT)(e,!0)||e).toString();await this.$store.dispatch("setUserData",{userid:this.user.id,key:"quota",value:t})}catch(e){console.error(e)}finally{this.loading.quota=!1}return e},validateQuota:e=>("object"==typeof e&&(e=e?.id||e.label),null===(0,O.lT)(e,!0)?pe.SA:{id:e=(0,O.v7)((0,O.lT)(e,!0)),label:e}),async setUserLanguage(e){this.loading.languages=!0;try{await this.$store.dispatch("setUserData",{userid:this.user.id,key:"language",value:e.code}),this.loading.languages=!1}catch(e){console.error(e)}return e},sendWelcomeMail(){this.loading.all=!0,this.$store.dispatch("sendWelcomeMail",this.user.id).then((()=>(0,d.Te)(t("settings","Welcome mail sent!"),{timeout:2e3}))).finally((()=>{this.loading.all=!1}))},async toggleEdit(){this.editing=!this.editing,this.editing&&(await this.$nextTick(),this.$refs.displayNameField?.$refs?.inputField?.$refs?.input?.focus(),this.loadGroupsDetails(),this.loadSubAdminGroupsDetails()),this.editedDisplayName!==this.user.displayname?this.editedDisplayName=this.user.displayname:this.editedMail!==this.user.email&&(this.editedMail=this.user.email??"")}}};var me=a(50085),Ce={};Ce.styleTagTransform=L(),Ce.setAttributes=S(),Ce.insert=N().bind(null,"head"),Ce.domAPI=f(),Ce.insertStyleElement=U(),w()(me.A,Ce),me.A&&me.A.locals&&me.A.locals;var ve=(0,I.A)(he,(function(){var e=this,t=e._self._c;return t("tr",{staticClass:"user-list__row",attrs:{"data-cy-user-row":e.user.id}},[t("td",{staticClass:"row__cell row__cell--avatar",attrs:{"data-cy-user-list-cell-avatar":""}},[e.isLoadingUser?t("NcLoadingIcon",{attrs:{name:e.t("settings","Loading account …"),size:32}}):e.visible?t("NcAvatar",{attrs:{"disable-menu":"","show-user-status":!1,user:e.user.id}}):e._e()],1),e._v(" "),t("td",{staticClass:"row__cell row__cell--displayname",attrs:{"data-cy-user-list-cell-displayname":""}},[e.editing&&e.user.backendCapabilities.setDisplayName?[t("NcTextField",{ref:"displayNameField",staticClass:"user-row-text-field",class:{"icon-loading-small":e.loading.displayName},attrs:{"data-cy-user-list-input-displayname":"","data-loading":e.loading.displayName||void 0,"trailing-button-label":e.t("settings","Submit"),"show-trailing-button":!0,disabled:e.loading.displayName||e.isLoadingField,label:e.t("settings","Change display name"),"trailing-button-icon":"arrowRight",value:e.editedDisplayName,autocapitalize:"off",autocomplete:"off",spellcheck:"false"},on:{"update:value":function(t){e.editedDisplayName=t},"trailing-button-click":e.updateDisplayName}})]:e.isObfuscated?e._e():t("strong",{attrs:{title:e.user.displayname?.length>20?e.user.displayname:null}},[e._v("\n\t\t\t"+e._s(e.user.displayname)+"\n\t\t")])],2),e._v(" "),t("td",{staticClass:"row__cell row__cell--username",attrs:{"data-cy-user-list-cell-username":""}},[t("span",{staticClass:"row__subtitle"},[e._v(e._s(e.user.id))])]),e._v(" "),t("td",{staticClass:"row__cell",class:{"row__cell--obfuscated":e.hasObfuscated},attrs:{"data-cy-user-list-cell-password":""}},[e.editing&&e.settings.canChangePassword&&e.user.backendCapabilities.setPassword?[t("NcTextField",{staticClass:"user-row-text-field",class:{"icon-loading-small":e.loading.password},attrs:{"data-cy-user-list-input-password":"","data-loading":e.loading.password||void 0,"trailing-button-label":e.t("settings","Submit"),"show-trailing-button":!0,disabled:e.loading.password||e.isLoadingField,minlength:e.minPasswordLength,maxlength:"469",label:e.t("settings","Set new password"),"trailing-button-icon":"arrowRight",value:e.editedPassword,autocapitalize:"off",autocomplete:"new-password",required:"",spellcheck:"false",type:"password"},on:{"update:value":function(t){e.editedPassword=t},"trailing-button-click":e.updatePassword}})]:e.isObfuscated?t("span",[e._v("\n\t\t\t"+e._s(e.t("settings","You do not have permissions to see the details of this account"))+"\n\t\t")]):e._e()],2),e._v(" "),t("td",{staticClass:"row__cell",attrs:{"data-cy-user-list-cell-email":""}},[e.editing?[t("NcTextField",{staticClass:"user-row-text-field",class:{"icon-loading-small":e.loading.mailAddress},attrs:{"data-cy-user-list-input-email":"","data-loading":e.loading.mailAddress||void 0,"show-trailing-button":!0,"trailing-button-label":e.t("settings","Submit"),label:e.t("settings","Set new email address"),disabled:e.loading.mailAddress||e.isLoadingField,"trailing-button-icon":"arrowRight",value:e.editedMail,autocapitalize:"off",autocomplete:"email",spellcheck:"false",type:"email"},on:{"update:value":function(t){e.editedMail=t},"trailing-button-click":e.updateEmail}})]:e.isObfuscated?e._e():t("span",{attrs:{title:e.user.email?.length>20?e.user.email:null}},[e._v("\n\t\t\t"+e._s(e.user.email)+"\n\t\t")])],2),e._v(" "),t("td",{staticClass:"row__cell row__cell--large row__cell--multiline",attrs:{"data-cy-user-list-cell-groups":""}},[e.editing?[t("label",{staticClass:"hidden-visually",attrs:{for:"groups"+e.uniqueId}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Add account to group"))+"\n\t\t\t")]),e._v(" "),t("NcSelect",{attrs:{"data-cy-user-list-input-groups":"","data-loading":e.loading.groups||void 0,"input-id":"groups"+e.uniqueId,"close-on-select":!1,disabled:e.isLoadingField||e.loading.groupsDetails,loading:e.loading.groups,multiple:!0,"append-to-body":!1,options:e.availableGroups,placeholder:e.t("settings","Add account to group"),taggable:e.settings.isAdmin||e.settings.isDelegatedAdmin,value:e.userGroups,label:"name","no-wrap":!0,"create-option":e=>({id:e,name:e,isCreating:!0})},on:{search:e.searchGroups,"option:created":e.createGroup,"option:selected":t=>e.addUserGroup(t.at(-1)),"option:deselected":e.removeUserGroup}})]:e.isObfuscated?e._e():t("span",{attrs:{title:e.userGroupsLabels?.length>40?e.userGroupsLabels:null}},[e._v("\n\t\t\t"+e._s(e.userGroupsLabels)+"\n\t\t")])],2),e._v(" "),e.settings.isAdmin||e.settings.isDelegatedAdmin?t("td",{staticClass:"row__cell row__cell--large row__cell--multiline",attrs:{"data-cy-user-list-cell-subadmins":""}},[e.editing&&(e.settings.isAdmin||e.settings.isDelegatedAdmin)?[t("label",{staticClass:"hidden-visually",attrs:{for:"subadmins"+e.uniqueId}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Set account as admin for"))+"\n\t\t\t")]),e._v(" "),t("NcSelect",{attrs:{"data-cy-user-list-input-subadmins":"","data-loading":e.loading.subadmins||void 0,"input-id":"subadmins"+e.uniqueId,"close-on-select":!1,disabled:e.isLoadingField||e.loading.subAdminGroupsDetails,loading:e.loading.subadmins,label:"name","append-to-body":!1,multiple:!0,"no-wrap":!0,options:e.availableSubAdminGroups,placeholder:e.t("settings","Set account as admin for"),value:e.userSubAdminGroups},on:{search:e.searchGroups,"option:deselected":e.removeUserSubAdmin,"option:selected":t=>e.addUserSubAdmin(t.at(-1))}})]:e.isObfuscated?e._e():t("span",{attrs:{title:e.userSubAdminGroupsLabels?.length>40?e.userSubAdminGroupsLabels:null}},[e._v("\n\t\t\t"+e._s(e.userSubAdminGroupsLabels)+"\n\t\t")])],2):e._e(),e._v(" "),t("td",{staticClass:"row__cell",attrs:{"data-cy-user-list-cell-quota":""}},[e.editing?[t("label",{staticClass:"hidden-visually",attrs:{for:"quota"+e.uniqueId}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Select account quota"))+"\n\t\t\t")]),e._v(" "),t("NcSelect",{attrs:{"close-on-select":!0,"create-option":e.validateQuota,"data-cy-user-list-input-quota":"","data-loading":e.loading.quota||void 0,disabled:e.isLoadingField,loading:e.loading.quota,"append-to-body":!1,clearable:!1,"input-id":"quota"+e.uniqueId,options:e.quotaOptions,placeholder:e.t("settings","Select account quota"),taggable:!0},on:{"option:selected":e.setUserQuota},model:{value:e.editedUserQuota,callback:function(t){e.editedUserQuota=t},expression:"editedUserQuota"}})]:e.isObfuscated?e._e():[t("span",{attrs:{id:"quota-progress"+e.uniqueId}},[e._v(e._s(e.userQuota)+" ("+e._s(e.usedSpace)+")")]),e._v(" "),t("NcProgressBar",{staticClass:"row__progress",class:{"row__progress--warn":e.usedQuota>80},attrs:{"aria-labelledby":"quota-progress"+e.uniqueId,value:e.usedQuota}})]],2),e._v(" "),e.showConfig.showLanguages?t("td",{staticClass:"row__cell row__cell--large",attrs:{"data-cy-user-list-cell-language":""}},[e.editing?[t("label",{staticClass:"hidden-visually",attrs:{for:"language"+e.uniqueId}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Set the language"))+"\n\t\t\t")]),e._v(" "),t("NcSelect",{attrs:{id:"language"+e.uniqueId,"data-cy-user-list-input-language":"","data-loading":e.loading.languages||void 0,"allow-empty":!1,disabled:e.isLoadingField,loading:e.loading.languages,clearable:!1,"append-to-body":!1,options:e.availableLanguages,placeholder:e.t("settings","No language set"),value:e.userLanguage,label:"name"},on:{input:e.setUserLanguage}})]:e.isObfuscated?e._e():t("span",[e._v("\n\t\t\t"+e._s(e.userLanguage.name)+"\n\t\t")])],2):e._e(),e._v(" "),e.showConfig.showUserBackend||e.showConfig.showStoragePath?t("td",{staticClass:"row__cell row__cell--large",attrs:{"data-cy-user-list-cell-storage-location":""}},[e.isObfuscated?e._e():[e.showConfig.showUserBackend?t("span",[e._v(e._s(e.user.backend))]):e._e(),e._v(" "),e.showConfig.showStoragePath?t("span",{staticClass:"row__subtitle",attrs:{title:e.user.storageLocation}},[e._v("\n\t\t\t\t"+e._s(e.user.storageLocation)+"\n\t\t\t")]):e._e()]],2):e._e(),e._v(" "),e.showConfig.showFirstLogin?t("td",{staticClass:"row__cell",attrs:{"data-cy-user-list-cell-first-login":""}},[e.isObfuscated?e._e():t("span",[e._v(e._s(e.userFirstLogin))])]):e._e(),e._v(" "),e.showConfig.showLastLogin?t("td",{staticClass:"row__cell",attrs:{title:e.userLastLoginTooltip,"data-cy-user-list-cell-last-login":""}},[e.isObfuscated?e._e():t("span",[e._v(e._s(e.userLastLogin))])]):e._e(),e._v(" "),t("td",{staticClass:"row__cell row__cell--large row__cell--fill",attrs:{"data-cy-user-list-cell-manager":""}},[e.editing?[t("label",{staticClass:"hidden-visually",attrs:{for:"manager"+e.uniqueId}},[e._v("\n\t\t\t\t"+e._s(e.managerLabel)+"\n\t\t\t")]),e._v(" "),t("NcSelect",{staticClass:"select--fill",attrs:{"data-cy-user-list-input-manager":"","data-loading":e.loading.manager||void 0,"input-id":"manager"+e.uniqueId,"close-on-select":!0,disabled:e.isLoadingField,"append-to-body":!1,loading:e.loadingPossibleManagers||e.loading.manager,label:"displayname",options:e.possibleManagers,placeholder:e.managerLabel},on:{open:e.searchInitialUserManager,search:e.searchUserManager,"option:selected":e.updateUserManager},model:{value:e.currentManager,callback:function(t){e.currentManager=t},expression:"currentManager"}})]:e.isObfuscated?e._e():t("span",[e._v("\n\t\t\t"+e._s(e.user.manager)+"\n\t\t")])],2),e._v(" "),t("td",{staticClass:"row__cell row__cell--actions",attrs:{"data-cy-user-list-cell-actions":""}},[e.visible&&!e.isObfuscated&&e.canEdit&&!e.loading.all?t("UserRowActions",{attrs:{actions:e.userActions,disabled:e.isLoadingField,edit:e.editing,user:e.user},on:{"update:edit":e.toggleEdit}}):e._e()],1)])}),[],!1,null,"e966b116",null);const _e=ve.exports,we=Object.freeze({id:"",displayName:"",password:"",mailAddress:"",groups:[],manager:"",subAdminsGroups:[],quota:pe.MY,language:{code:"en",name:t("settings","Default language")}}),be={name:"UserList",components:{Fragment:c.F,NcEmptyContent:u.A,NcIconSvgWrapper:A.A,NcLoadingIcon:g.A,NewUserDialog:H,UserListFooter:V,UserListHeader:ee,VirtualList:q},props:{selectedGroup:{type:String,default:null},externalActions:{type:Array,default:()=>[]}},setup:()=>({mdiAccountGroup:l.n7C,rowHeight:55,UserRow:_e}),data:()=>({loading:{all:!1,groups:!1,users:!1},newUser:{...we},isInitialLoad:!0,searchQuery:""}),computed:{showConfig(){return this.$store.getters.getShowConfig},settings(){return this.$store.getters.getServerData},style(){return{"--row-height":`${this.rowHeight}px`}},hasObfuscated(){return this.filteredUsers.some((e=>(0,pe.HK)(e)))},users(){return this.$store.getters.getUsers},filteredUsers(){return"disabled"===this.selectedGroup?this.users.filter((e=>!1===e.enabled)):this.users.filter((e=>!1!==e.enabled))},groups(){return this.$store.getters.getSortedGroups.filter((e=>"__nc_internal_recent"!==e.id&&"disabled"!==e.id))},quotaOptions(){const e=this.settings.quotaPreset.reduce(((e,t)=>e.concat({id:t,label:t})),[]);return this.settings.allowUnlimitedQuota&&e.unshift(pe.SA),e.unshift(pe.MY),e},usersOffset(){return this.$store.getters.getUsersOffset},usersLimit(){return this.$store.getters.getUsersLimit},disabledUsersOffset(){return this.$store.getters.getDisabledUsersOffset},disabledUsersLimit(){return this.$store.getters.getDisabledUsersLimit},usersCount(){return this.users.length},languages(){return[{label:t("settings","Common languages"),languages:this.settings.languages.commonLanguages},{label:t("settings","Other languages"),languages:this.settings.languages.otherLanguages}]}},watch:{async selectedGroup(e){this.isInitialLoad=!0,await this.redirectIfDisabled(),this.$store.commit("resetUsers"),await this.loadUsers(),this.setNewUserDefaultGroup(e)},filteredUsers(e){C.A.debug(`${e.length} filtered user(s)`)}},async created(){await this.loadUsers()},async mounted(){this.settings.canChangePassword||OC.Notification.showTemporary(t("settings","Password change is disabled because the master key is disabled")),this.resetForm(),(0,n.B1)("nextcloud:unified-search.search",this.search),(0,n.B1)("nextcloud:unified-search.reset",this.resetSearch),await this.redirectIfDisabled()},beforeDestroy(){(0,n.al)("nextcloud:unified-search.search",this.search),(0,n.al)("nextcloud:unified-search.reset",this.resetSearch)},methods:{async handleScrollEnd(){await this.loadUsers()},async loadUsers(){this.loading.users=!0;try{"disabled"===this.selectedGroup?await this.$store.dispatch("getDisabledUsers",{offset:this.disabledUsersOffset,limit:this.disabledUsersLimit,search:this.searchQuery}):"__nc_internal_recent"===this.selectedGroup?await this.$store.dispatch("getRecentUsers",{offset:this.usersOffset,limit:this.usersLimit,search:this.searchQuery}):await this.$store.dispatch("getUsers",{offset:this.usersOffset,limit:this.usersLimit,group:this.selectedGroup,search:this.searchQuery}),C.A.debug(`${this.users.length} total user(s) loaded`)}catch(e){C.A.error("Failed to load accounts",{error:e}),(0,d.Qg)("Failed to load accounts")}this.loading.users=!1,this.isInitialLoad=!1},closeDialog(){this.$store.commit("setShowConfig",{key:"showNewUserForm",value:!1})},async search(e){let{query:t}=e;this.searchQuery=t,this.$store.commit("resetUsers"),await this.loadUsers()},resetSearch(){this.search({query:""})},resetForm(){this.newUser=Object.assign({},we),this.settings.defaultLanguage&&r.Ay.set(this.newUser.language,"code",this.settings.defaultLanguage),this.setNewUserDefaultGroup(this.selectedGroup),this.loading.all=!1},setNewUserDefaultGroup(e){if(e||this.settings.isAdmin||this.settings.isDelegatedAdmin||1===this.groups.length&&(e=this.groups[0].id),e){const t=this.groups.find((t=>t.id===e));if(t)return void(this.newUser.groups=[t])}this.newUser.groups=[]},async redirectIfDisabled(){const e=this.$store.getters.getGroups;"disabled"===this.selectedGroup&&e.findIndex((e=>"disabled"===e.id&&0===e.usercount))>-1&&(this.$router.push({name:"users"}),await this.loadUsers())}}};var fe=a(38242),ye={};ye.styleTagTransform=L(),ye.setAttributes=S(),ye.insert=N().bind(null,"head"),ye.domAPI=f(),ye.insertStyleElement=U(),w()(fe.A,ye),fe.A&&fe.A.locals&&fe.A.locals;const Ne=(0,I.A)(be,(function(){var e=this,t=e._self._c;return t("Fragment",[e.showConfig.showNewUserForm?t("NewUserDialog",{attrs:{loading:e.loading,"new-user":e.newUser,"quota-options":e.quotaOptions},on:{reset:e.resetForm,closing:e.closeDialog}}):e._e(),e._v(" "),0===e.filteredUsers.length?t("NcEmptyContent",{staticClass:"empty",attrs:{name:e.isInitialLoad&&e.loading.users?null:e.t("settings","No accounts")},scopedSlots:e._u([{key:"icon",fn:function(){return[e.isInitialLoad&&e.loading.users?t("NcLoadingIcon",{attrs:{name:e.t("settings","Loading accounts …"),size:64}}):t("NcIconSvgWrapper",{attrs:{path:e.mdiAccountGroup,size:64}})]},proxy:!0}],null,!1,226056511)}):t("VirtualList",{style:e.style,attrs:{"data-component":e.UserRow,"data-sources":e.filteredUsers,"data-key":"id","data-cy-user-list":"","item-height":e.rowHeight,"extra-props":{users:e.users,settings:e.settings,hasObfuscated:e.hasObfuscated,quotaOptions:e.quotaOptions,languages:e.languages,externalActions:e.externalActions}},on:{"scroll-end":e.handleScrollEnd},scopedSlots:e._u([{key:"before",fn:function(){return[t("caption",{staticClass:"hidden-visually"},[e._v("\n\t\t\t\t"+e._s(e.t("settings","List of accounts. This list is not fully rendered for performance reasons. The accounts will be rendered as you navigate through the list."))+"\n\t\t\t")])]},proxy:!0},{key:"header",fn:function(){return[t("UserListHeader",{attrs:{"has-obfuscated":e.hasObfuscated}})]},proxy:!0},{key:"footer",fn:function(){return[t("UserListFooter",{attrs:{loading:e.loading.users,"filtered-users":e.filteredUsers}})]},proxy:!0}])})],1)}),[],!1,null,"76ab0312",null).exports,Ge=(0,r.pM)({name:"UserManagement",components:{NcAppContent:o.A,UserList:Ne},data:()=>({externalActions:[]}),computed:{pageHeading(){return null===this.selectedGroupDecoded?(0,i.Tl)("settings","All accounts"):{admin:(0,i.Tl)("settings","Admins"),disabled:(0,i.Tl)("settings","Disabled accounts")}[this.selectedGroupDecoded]??(0,i.Tl)("settings","Account group: {group}",{group:this.selectedGroupDecoded})},selectedGroup(){return this.$route.params.selectedGroup},selectedGroupDecoded(){return this.selectedGroup?decodeURIComponent(this.selectedGroup):null}},beforeMount(){this.$store.dispatch("getPasswordPolicyMinLength")},created(){window.OCA=window.OCA??{},window.OCA.Settings=window.OCA.Settings??{},window.OCA.Settings.UserList=window.OCA.Settings.UserList??{},window.OCA.Settings.UserList.registerAction=this.registerAction,(0,n.Ic)("settings:user-management:loaded")},methods:{t:i.Tl,registerAction(e,t,s,a){return this.externalActions.push({icon:e,text:t,action:s,enabled:a}),this.externalActions}}});var Se=a(82009),xe={};xe.styleTagTransform=L(),xe.setAttributes=S(),xe.insert=N().bind(null,"head"),xe.domAPI=f(),xe.insertStyleElement=U(),w()(Se.A,xe),Se.A&&Se.A.locals&&Se.A.locals;const Ue=(0,I.A)(Ge,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("NcAppContent",{attrs:{"page-heading":e.pageHeading}},[t("UserList",{attrs:{"selected-group":e.selectedGroupDecoded,"external-actions":e.externalActions}})],1)}),[],!1,null,"253f9eec",null).exports},21437:(e,s,a)=>{a.r(s),a.d(s,{default:()=>he});var i=a(85471),n=a(9165),r=a(53334),o=a(42530),l=a(52439),d=a(27345),c=a(85865),u=a(97012),A=a(85947),g=a(6695),p=a(35810),h=a(63814),m=a(65043),C=a(58630),v=a(14727),_=a(32073),w=a(40083),b=a(67607),f=a(15916),y=a(95668),N=a(36620);const G={name:"UserSettingsDialog",components:{NcAppSettingsDialog:C.N,NcAppSettingsSection:v.A,NcCheckboxRadioSwitch:_.A,NcNoteCard:w.A,NcSelect:b.A},props:{open:{type:Boolean,required:!0}},data:()=>({selectedQuota:!1,loadingSendMail:!1}),computed:{groupSorting:{get(){return this.$store.getters.getGroupSorting===f.q.GroupName?"name":"member-count"},set(e){this.$store.commit("setGroupSorting","name"===e?f.q.GroupName:f.q.UserCount)}},isGroupSortingEnforced(){return this.$store.getters.getServerData.forceSortGroupByName},isModalOpen:{get(){return this.open},set(e){this.$emit("update:open",e)}},showConfig(){return this.$store.getters.getShowConfig},settings(){return this.$store.getters.getServerData},showLanguages:{get(){return this.showConfig.showLanguages},set(e){this.setShowConfig("showLanguages",e)}},showFirstLogin:{get(){return this.showConfig.showFirstLogin},set(e){this.setShowConfig("showFirstLogin",e)}},showLastLogin:{get(){return this.showConfig.showLastLogin},set(e){this.setShowConfig("showLastLogin",e)}},showUserBackend:{get(){return this.showConfig.showUserBackend},set(e){this.setShowConfig("showUserBackend",e)}},showStoragePath:{get(){return this.showConfig.showStoragePath},set(e){this.setShowConfig("showStoragePath",e)}},quotaOptions(){const e=this.settings.quotaPreset.reduce(((e,t)=>e.concat({id:t,label:t})),[]);return this.settings.allowUnlimitedQuota&&e.unshift(y.SA),e},defaultQuota:{get(){return!1!==this.selectedQuota?this.selectedQuota:this.settings.defaultQuota!==y.SA.id&&OC.Util.computerFileSize(this.settings.defaultQuota)>=0?{id:this.settings.defaultQuota,label:this.settings.defaultQuota}:y.SA},set(e){this.selectedQuota=e}},sendWelcomeMail:{get(){return this.settings.newUserSendEmail},async set(e){try{this.loadingSendMail=!0,this.$store.commit("setServerData",{...this.settings,newUserSendEmail:e}),await m.Ay.post((0,h.Jv)("/settings/users/preferences/newUser.sendEmail"),{value:e?"yes":"no"})}catch(e){N.A.error("Could not update newUser.sendEmail preference",{error:e})}finally{this.loadingSendMail=!1}}}},methods:{filterQuotas(e,t,s){const a=s.toLocaleLowerCase().replaceAll(/\s/g,"");return(t||"").toLocaleLowerCase().replaceAll(/\s/g,"").indexOf(a)>-1},setShowConfig(e,t){this.$store.commit("setShowConfig",{key:e,value:t})},validateQuota(e){"object"==typeof e&&(e=e?.id||e.label);const t=(0,p.lT)(e,!0);return null===t?y.SA:{id:e=(0,p.v7)(t),label:e}},setDefaultQuota(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none";"none"===e&&(e=y.SA),this.$store.dispatch("setAppConfig",{app:"files",key:"default_quota",value:e.id?e.id:e}).then((()=>{"object"!=typeof e&&(e={id:e,label:e}),this.defaultQuota=e}))}}};var S=a(85072),x=a.n(S),U=a(97825),k=a.n(U),L=a(77659),D=a.n(L),B=a(55056),I=a.n(B),q=a(10540),O=a.n(q),M=a(41113),$=a.n(M),E=a(6817),F={};F.styleTagTransform=$(),F.setAttributes=I(),F.insert=D().bind(null,"head"),F.domAPI=k(),F.insertStyleElement=O(),x()(E.A,F),E.A&&E.A.locals&&E.A.locals;var T=a(14486);const P=(0,T.A)(G,(function(){var e=this,t=e._self._c;return t("NcAppSettingsDialog",{attrs:{open:e.isModalOpen,"show-navigation":!0,name:e.t("settings","Account management settings")},on:{"update:open":function(t){e.isModalOpen=t}}},[t("NcAppSettingsSection",{attrs:{id:"visibility-settings",name:e.t("settings","Visibility")}},[t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"showLanguages",checked:e.showLanguages},on:{"update:checked":function(t){e.showLanguages=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Show language"))+"\n\t\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"showUserBackend",checked:e.showUserBackend},on:{"update:checked":function(t){e.showUserBackend=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Show account backend"))+"\n\t\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"showStoragePath",checked:e.showStoragePath},on:{"update:checked":function(t){e.showStoragePath=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Show storage path"))+"\n\t\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"showFirstLogin",checked:e.showFirstLogin},on:{"update:checked":function(t){e.showFirstLogin=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Show first login"))+"\n\t\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"showLastLogin",checked:e.showLastLogin},on:{"update:checked":function(t){e.showLastLogin=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Show last login"))+"\n\t\t")])],1),e._v(" "),t("NcAppSettingsSection",{attrs:{id:"groups-sorting",name:e.t("settings","Sorting")}},[e.isGroupSortingEnforced?t("NcNoteCard",{attrs:{type:"warning"}},[e._v("\n\t\t\t"+e._s(e.t("settings","The system config enforces sorting the groups by name. This also disables showing the member count."))+"\n\t\t")]):e._e(),e._v(" "),t("fieldset",[t("legend",[e._v(e._s(e.t("settings","Group list sorting")))]),e._v(" "),t("NcNoteCard",{staticClass:"dialog__note",attrs:{type:"info",text:e.t("settings","Sorting only applies to the currently loaded groups for performance reasons. Groups will be loaded as you navigate or search through the list.")}}),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"radio",checked:e.groupSorting,"data-test":"sortGroupsByMemberCount",disabled:e.isGroupSortingEnforced,name:"group-sorting-mode",value:"member-count"},on:{"update:checked":function(t){e.groupSorting=t}}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","By member count"))+"\n\t\t\t")]),e._v(" "),t("NcCheckboxRadioSwitch",{attrs:{type:"radio",checked:e.groupSorting,"data-test":"sortGroupsByName",disabled:e.isGroupSortingEnforced,name:"group-sorting-mode",value:"name"},on:{"update:checked":function(t){e.groupSorting=t}}},[e._v("\n\t\t\t\t"+e._s(e.t("settings","By name"))+"\n\t\t\t")])],1)],1),e._v(" "),t("NcAppSettingsSection",{attrs:{id:"email-settings",name:e.t("settings","Send email")}},[t("NcCheckboxRadioSwitch",{attrs:{type:"switch","data-test":"sendWelcomeMail",checked:e.sendWelcomeMail,disabled:e.loadingSendMail},on:{"update:checked":function(t){e.sendWelcomeMail=t}}},[e._v("\n\t\t\t"+e._s(e.t("settings","Send welcome email to new accounts"))+"\n\t\t")])],1),e._v(" "),t("NcAppSettingsSection",{attrs:{id:"default-settings",name:e.t("settings","Defaults")}},[t("NcSelect",{attrs:{clearable:!1,"create-option":e.validateQuota,"filter-by":e.filterQuotas,"input-label":e.t("settings","Default quota"),options:e.quotaOptions,placement:"top",placeholder:e.t("settings","Select default quota"),taggable:""},on:{"option:selected":e.setDefaultQuota},model:{value:e.defaultQuota,callback:function(t){e.defaultQuota=t},expression:"defaultQuota"}})],1)],1)}),[],!1,null,"9f7a355c",null).exports;var R=a(54914),Q=a(24387),z=a(13073),W=a(85168),H=a(44131),K=a(71418),j=a(64554),Y=a(96425),V=a(59892),X=a(57505),J=a(3886),Z=a(43261),ee=a(79759),te=a(2413);const se={name:"GroupListItem",components:{AccountGroup:Z.A,Delete:ee.A,Fragment:R.F,NcActionButton:X.A,NcActionInput:H.A,NcAppNavigationItem:l.A,NcButton:u.A,NcCounterBubble:A.A,NcModal:J.A,NcNoteCard:w.A,Pencil:te.A},props:{active:{type:Boolean,required:!0},count:{type:Number,default:null},id:{type:String,required:!0},name:{type:String,required:!0}},data:()=>({loadingRenameGroup:!1,openGroupMenu:!1,showRemoveGroupModal:!1}),computed:{settings(){return this.$store.getters.getServerData}},methods:{handleGroupMenuOpen(){this.openGroupMenu=!0},async renameGroup(e){if(""===e.trim())return;const t=this.$refs.displayNameInput.$el.querySelector('input[type="text"]').value;if(""!==t.trim())try{this.openGroupMenu=!1,this.loadingRenameGroup=!0,await this.$store.dispatch("renameGroup",{groupid:e.trim(),displayName:t.trim()}),this.loadingRenameGroup=!1}catch{this.openGroupMenu=!0,this.loadingRenameGroup=!1}},async removeGroup(){try{await this.$store.dispatch("removeGroup",this.id),this.showRemoveGroupModal=!1}catch(e){(0,W.Qg)(t("settings",'Failed to remove group "{group}"',{group:this.name}))}}}};var ae=a(79496),ie={};ie.styleTagTransform=$(),ie.setAttributes=I(),ie.insert=D().bind(null,"head"),ie.domAPI=k(),ie.insertStyleElement=O(),x()(ae.A,ie),ae.A&&ae.A.locals&&ae.A.locals;const ne=(0,T.A)(se,(function(){var e=this,t=e._self._c;return t("Fragment",[e.showRemoveGroupModal?t("NcModal",{on:{close:function(t){e.showRemoveGroupModal=!1}}},[t("div",{staticClass:"modal__content"},[t("h2",{staticClass:"modal__header"},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Please confirm the group removal"))+"\n\t\t\t")]),e._v(" "),t("NcNoteCard",{attrs:{type:"warning","show-alert":""}},[e._v("\n\t\t\t\t"+e._s(e.t("settings",'You are about to remove the group "{group}". The accounts will NOT be deleted.',{group:e.name}))+"\n\t\t\t")]),e._v(" "),t("div",{staticClass:"modal__button-row"},[t("NcButton",{attrs:{type:"secondary"},on:{click:function(t){e.showRemoveGroupModal=!1}}},[e._v("\n\t\t\t\t\t"+e._s(e.t("settings","Cancel"))+"\n\t\t\t\t")]),e._v(" "),t("NcButton",{attrs:{type:"primary"},on:{click:e.removeGroup}},[e._v("\n\t\t\t\t\t"+e._s(e.t("settings","Confirm"))+"\n\t\t\t\t")])],1)],1)]):e._e(),e._v(" "),t("NcAppNavigationItem",{key:e.id,ref:"listItem",attrs:{exact:!0,name:e.name,to:{name:"group",params:{selectedGroup:encodeURIComponent(e.id)}},loading:e.loadingRenameGroup,"menu-open":e.openGroupMenu},on:{"update:menuOpen":e.handleGroupMenuOpen},scopedSlots:e._u([{key:"icon",fn:function(){return[t("AccountGroup",{attrs:{size:20}})]},proxy:!0},{key:"counter",fn:function(){return[e.count?t("NcCounterBubble",{attrs:{type:e.active?"highlighted":void 0}},[e._v("\n\t\t\t\t"+e._s(e.count)+"\n\t\t\t")]):e._e()]},proxy:!0},{key:"actions",fn:function(){return["admin"!==e.id&&"disabled"!==e.id&&(e.settings.isAdmin||e.settings.isDelegatedAdmin)?t("NcActionInput",{ref:"displayNameInput",attrs:{"trailing-button-label":e.t("settings","Submit"),type:"text",value:e.name,label:e.t("settings","Rename group")},on:{submit:function(t){return e.renameGroup(e.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Pencil",{attrs:{size:20}})]},proxy:!0}],null,!1,580569589)}):e._e(),e._v(" "),"admin"!==e.id&&"disabled"!==e.id&&(e.settings.isAdmin||e.settings.isDelegatedAdmin)?t("NcActionButton",{on:{click:function(t){e.showRemoveGroupModal=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[t("Delete",{attrs:{size:20}})]},proxy:!0}],null,!1,2705356561)},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Remove group"))+"\n\t\t\t")]):e._e()]},proxy:!0}])})],1)}),[],!1,null,"161509be",null).exports;function re(e){return void 0===e?null:{id:e.id,title:e.name,usercount:e.usercount,count:Math.max(0,e.usercount-e.disabled)}}const oe=e=>{const t=(0,i.EW)((()=>e.value.filter((e=>"disabled"!==e.id&&"__nc_internal_recent"!==e.id&&"admin"!==e.id)).map((e=>re(e))).filter((e=>null!==e)))),s=(0,i.EW)((()=>re(e.value.find((e=>"admin"===e.id))))),a=(0,i.EW)((()=>re(e.value.find((e=>"disabled"===e.id)))));return{adminGroup:s,recentGroup:(0,i.EW)((()=>re(e.value.find((e=>"__nc_internal_recent"===e.id))))),disabledGroup:a,userGroups:t}};var le=a(14744),de=a(46984);const ce=(0,i.pM)({__name:"AppNavigationGroupList",setup(e){const s=(0,le.P)(),a=(0,Q.lq)(),r=(0,Q.rd)();(0,i.KC)((async()=>{await x()}));const o=(0,i.EW)((()=>a.params?.selectedGroup)),l=(0,i.EW)((()=>o.value?decodeURIComponent(o.value):null)),c=(0,i.EW)((()=>s.getters.getSortedGroups)),{userGroups:u}=oe(c),A=(0,i.EW)((()=>s.getters.getServerData)),p=(0,i.EW)((()=>A.value.isAdmin||A.value.isDelegatedAdmin)),h=(0,i.KR)(!1),m=(0,i.KR)(!1),C=(0,i.KR)(!1),v=(0,i.KR)(""),_=(0,i.KR)(!1),w=(0,i.KR)(0),b=(0,i.KR)(""),f=(0,i.KR)([]),y=(0,i.EW)((()=>f.value.findLast((e=>e?.$vnode?.key===u.value?.at(-1)?.id))?.$refs?.listItem?.$el)),G=(0,z.ITo)(y);(0,i.wB)(G,(async()=>{G.value&&await x()})),(0,i.wB)(b,(async()=>{s.commit("resetGroups"),w.value=0,await x()}));const S=(0,i.KR)(null);async function x(){S.value&&S.value.cancel(),_.value=!0;try{S.value=(0,de.N_)({search:b.value,offset:w.value,limit:25});const e=await S.value;e.length>0&&(w.value+=25);for(const t of e)s.commit("addGroup",t)}catch(e){N.A.error(t("settings","Failed to load groups"),{error:e})}S.value=null,_.value=!1}return{__sfc:!0,store:s,route:a,router:r,selectedGroup:o,selectedGroupDecoded:l,groups:c,userGroups:u,settings:A,isAdminOrDelegatedAdmin:p,isAddGroupOpen:h,loadingAddGroup:m,hasAddGroupError:C,newGroupName:v,loadingGroups:_,offset:w,groupsSearchQuery:b,groupListItems:f,lastGroupListItem:y,isLastGroupVisible:G,promise:S,loadGroups:x,createGroup:async function(){C.value=!1;const e=v.value.trim();if(""!==e){h.value=!1,m.value=!0;try{await s.dispatch("addGroup",e),await r.push({name:"group",params:{selectedGroup:encodeURIComponent(e)}});const t=f.value.findLast((t=>t?.$vnode?.key===e));t?.$refs?.listItem?.$el?.scrollIntoView({behavior:"smooth",block:"nearest"}),v.value=""}catch{(0,W.Qg)(t("settings","Failed to create group"))}m.value=!1}else C.value=!0},Fragment:R.F,mdiAccountGroup:n.n7C,mdiPlus:n.biz,NcActionInput:H.A,NcActionText:K.A,NcAppNavigationCaption:j.N,NcAppNavigationList:d.A,NcAppNavigationSearch:Y.N,NcIconSvgWrapper:g.A,NcLoadingIcon:V.A,GroupListItem:ne}}}),ue=(0,T.A)(ce,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t(s.Fragment,[t(s.NcAppNavigationCaption,{attrs:{name:e.t("settings","Groups"),disabled:s.loadingAddGroup,"aria-label":s.loadingAddGroup?e.t("settings","Creating group…"):e.t("settings","Create group"),"force-menu":"","is-heading":"",open:s.isAddGroupOpen},on:{"update:open":function(e){s.isAddGroupOpen=e}},scopedSlots:e._u([s.isAdminOrDelegatedAdmin?{key:"actionsTriggerIcon",fn:function(){return[s.loadingAddGroup?t(s.NcLoadingIcon):t(s.NcIconSvgWrapper,{attrs:{path:s.mdiPlus}})]},proxy:!0}:null,s.isAdminOrDelegatedAdmin?{key:"actions",fn:function(){return[t(s.NcActionText,{scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiAccountGroup}})]},proxy:!0}],null,!1,3607647275)},[e._v("\n\t\t\t\t"+e._s(e.t("settings","Create group"))+"\n\t\t\t")]),e._v(" "),t(s.NcActionInput,{attrs:{label:e.t("settings","Group name"),"data-cy-users-settings-new-group-name":"","label-outside":!1,disabled:s.loadingAddGroup,value:s.newGroupName,error:s.hasAddGroupError,"helper-text":s.hasAddGroupError?e.t("settings","Please enter a valid group name"):""},on:{"update:value":function(e){s.newGroupName=e},submit:s.createGroup}})]},proxy:!0}:null],null,!0)}),e._v(" "),t(s.NcAppNavigationSearch,{attrs:{label:e.t("settings","Search groups…")},model:{value:s.groupsSearchQuery,callback:function(e){s.groupsSearchQuery=e},expression:"groupsSearchQuery"}}),e._v(" "),t("p",{staticClass:"hidden-visually",attrs:{id:"group-list-desc"}},[e._v("\n\t\t"+e._s(e.t("settings","List of groups. This list is not fully populated for performance reasons. The groups will be loaded as you navigate or search through the list."))+"\n\t")]),e._v(" "),t(s.NcAppNavigationList,{staticClass:"account-management__group-list",attrs:{"aria-describedby":"group-list-desc","data-cy-users-settings-navigation-groups":"custom"}},[e._l(s.userGroups,(function(e){return t(s.GroupListItem,{key:e.id,ref:"groupListItems",refInFor:!0,attrs:{id:e.id,active:s.selectedGroupDecoded===e.id,name:e.title,count:e.count}})})),e._v(" "),s.loadingGroups?t("div",{attrs:{role:"note"}},[t(s.NcLoadingIcon,{attrs:{name:e.t("settings","Loading groups…")}})],1):e._e()],2)],1)}),[],!1,null,null,null).exports,Ae=(0,i.pM)({__name:"UserManagementNavigation",setup(e){const t=(0,Q.lq)(),s=(0,le.P)(),a=(0,i.KR)(!1),p=(0,i.EW)((()=>t.params?.selectedGroup)),h=(0,i.EW)((()=>p.value?decodeURIComponent(p.value):null)),m=(0,i.EW)((()=>s.getters.getUserCount)),C=(0,i.EW)((()=>s.getters.getSortedGroups)),{adminGroup:v,recentGroup:_,disabledGroup:w}=oe(C),b=(0,i.EW)((()=>s.getters.getServerData)),f=(0,i.EW)((()=>b.value.isAdmin||b.value.isDelegatedAdmin));return{__sfc:!0,route:t,store:s,isDialogOpen:a,selectedGroup:p,selectedGroupDecoded:h,userCount:m,groups:C,adminGroup:v,recentGroup:_,disabledGroup:w,settings:b,isAdminOrDelegatedAdmin:f,showNewUserMenu:function(){s.commit("setShowConfig",{key:"showNewUserForm",value:!0})},mdiAccount:n.Gbn,mdiAccountOff:n.lBC,mdiCog:n.CZ3,mdiPlus:n.biz,mdiShieldAccount:n.Jey,mdiHistory:n.LP2,t:r.Tl,NcAppNavigation:o.A,NcAppNavigationItem:l.A,NcAppNavigationList:d.A,NcAppNavigationNew:c.A,NcButton:u.A,NcCounterBubble:A.A,NcIconSvgWrapper:g.A,UserSettingsDialog:P,AppNavigationGroupList:ue}}});var ge=a(49977),pe={};pe.styleTagTransform=$(),pe.setAttributes=I(),pe.insert=D().bind(null,"head"),pe.domAPI=k(),pe.insertStyleElement=O(),x()(ge.A,pe),ge.A&&ge.A.locals&&ge.A.locals;const he=(0,T.A)(Ae,(function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t(s.NcAppNavigation,{staticClass:"account-management__navigation",attrs:{"aria-label":s.t("settings","Account management")},scopedSlots:e._u([{key:"footer",fn:function(){return[t(s.NcButton,{staticClass:"account-management__settings-toggle",attrs:{type:"tertiary"},on:{click:function(e){s.isDialogOpen=!0}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiCog}})]},proxy:!0}])},[e._v("\n\t\t\t"+e._s(s.t("settings","Account management settings"))+"\n\t\t")]),e._v(" "),t(s.UserSettingsDialog,{attrs:{open:s.isDialogOpen},on:{"update:open":function(e){s.isDialogOpen=e}}})]},proxy:!0}])},[t(s.NcAppNavigationNew,{attrs:{"button-id":"new-user-button",text:s.t("settings","New account")},on:{click:s.showNewUserMenu,keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:s.showNewUserMenu.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:s.showNewUserMenu.apply(null,arguments)}]},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiPlus}})]},proxy:!0}])}),e._v(" "),t(s.NcAppNavigationList,{staticClass:"account-management__system-list",attrs:{"data-cy-users-settings-navigation-groups":"system"}},[t(s.NcAppNavigationItem,{attrs:{id:"everyone",exact:!0,name:s.t("settings","All accounts"),to:{name:"users"}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiAccount}})]},proxy:!0},{key:"counter",fn:function(){return[s.userCount?t(s.NcCounterBubble,{attrs:{type:s.selectedGroupDecoded?void 0:"highlighted"}},[e._v("\n\t\t\t\t\t"+e._s(s.userCount)+"\n\t\t\t\t")]):e._e()]},proxy:!0}])}),e._v(" "),s.settings.isAdmin?t(s.NcAppNavigationItem,{attrs:{id:"admin",exact:!0,name:s.t("settings","Admins"),to:{name:"group",params:{selectedGroup:"admin"}}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiShieldAccount}})]},proxy:!0},{key:"counter",fn:function(){return[s.adminGroup&&s.adminGroup.count>0?t(s.NcCounterBubble,{attrs:{type:"admin"===s.selectedGroupDecoded?"highlighted":void 0}},[e._v("\n\t\t\t\t\t"+e._s(s.adminGroup.count)+"\n\t\t\t\t")]):e._e()]},proxy:!0}],null,!1,2218088905)}):e._e(),e._v(" "),s.isAdminOrDelegatedAdmin?t(s.NcAppNavigationItem,{attrs:{id:"recent",exact:!0,name:s.t("settings","Recently active"),to:{name:"group",params:{selectedGroup:"__nc_internal_recent"}}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiHistory}})]},proxy:!0},{key:"counter",fn:function(){return[s.recentGroup?.usercount?t(s.NcCounterBubble,{attrs:{type:"__nc_internal_recent"===s.selectedGroupDecoded?"highlighted":void 0}},[e._v("\n\t\t\t\t\t"+e._s(s.recentGroup.usercount)+"\n\t\t\t\t")]):e._e()]},proxy:!0}],null,!1,2299424282)}):e._e(),e._v(" "),s.disabledGroup&&(s.disabledGroup.usercount>0||-1===s.disabledGroup.usercount)?t(s.NcAppNavigationItem,{attrs:{id:"disabled",exact:!0,name:s.t("settings","Disabled accounts"),to:{name:"group",params:{selectedGroup:"disabled"}}},scopedSlots:e._u([{key:"icon",fn:function(){return[t(s.NcIconSvgWrapper,{attrs:{path:s.mdiAccountOff}})]},proxy:!0},s.disabledGroup.usercount>0?{key:"counter",fn:function(){return[t(s.NcCounterBubble,{attrs:{type:"disabled"===s.selectedGroupDecoded?"highlighted":void 0}},[e._v("\n\t\t\t\t\t"+e._s(s.disabledGroup.usercount)+"\n\t\t\t\t")])]},proxy:!0}:null],null,!0)}):e._e()],1),e._v(" "),t(s.AppNavigationGroupList)],1)}),[],!1,null,"edf83404",null).exports},27518:e=>{e.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M15.4%2016.6L10.8%2012l4.6-4.6L14%206l-6%206%206%206%201.4-1.4z%27/%3e%3c/svg%3e"},27514:e=>{e.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M18.4%207.4L17%206l-6%206%206%206%201.4-1.4-4.6-4.6%204.6-4.6m-6%200L11%206l-6%206%206%206%201.4-1.4L7.8%2012l4.6-4.6z%27/%3e%3c/svg%3e"},79722:e=>{e.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M5.6%207.4L7%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6m6%200L13%206l6%206-6%206-1.4-1.4%204.6-4.6-4.6-4.6z%27/%3e%3c/svg%3e"},86886:e=>{e.exports="data:image/svg+xml,%3c%21--%20-%20SPDX-FileCopyrightText:%202020%20Google%20Inc.%20-%20SPDX-License-Identifier:%20Apache-2.0%20--%3e%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20width=%2724%27%20height=%2724%27%20fill=%27%23222%27%3e%3cpath%20d=%27M8.6%2016.6l4.6-4.6-4.6-4.6L10%206l6%206-6%206-1.4-1.4z%27/%3e%3c/svg%3e"},76333:(e,t,s)=>{s.d(t,{AO:()=>$.N,Az:()=>o.N,B6:()=>u.N,EQ:()=>me.N,K1:()=>se.N,Qz:()=>O.N,R1:()=>q.N,i$:()=>K.N,lT:()=>z.N,m7:()=>z.u,v:()=>Ce.N,x1:()=>M.A,yI:()=>X.A});var a=s(83819),i=s(74555),n=s(61744),r=s(97691),o=s(77650),l=s(74479),d=s(73346),c=s(26873),u=s(57854),A=s(15502),g=s(71418),p=s(51005),h=s(9562),m=s(47611),C=s(10363),v=s(35855),_=s(64554),w=s(25535),b=s(21288),f=s(27345),y=s(85865),N=s(75308),G=s(96425),S=s(10133),x=s(542),U=s(58630),k=s(14727),L=s(9691),D=s(18608),B=s(93884),I=s(92089),q=s(17996),O=s(80790),M=s(97012),$=s(31365),E=s(7349),F=s(68841),T=s(24906),P=s(75971),R=s(5966),Q=s(95936),z=s(80703),W=s(61860),H=s(48046),K=s(69070),j=s(66160),Y=s(25521),V=s(21818),X=s(35779),J=s(94427),Z=s(27403),ee=s(48679),te=s(26517),se=s(14490),ae=s(56849),ie=s(69697),ne=s(27976),re=s(59892),oe=s(3886),le=s(40083),de=s(62029),ce=s(30912),ue=s(74484),Ae=s(22042),ge=s(23573),pe=s(54986),he=s(64341),me=(s(58322),s(59042),s(65043),s(21777),s(83658)),Ce=s(10154),ve=(s(61338),s(94632)),_e=s(88589),we=s(31030),be=s(94825),fe=s(31478),ye=s(30709),Ne=s(6079),Ge=s(31774),Se=s(78603),xe=s(23610),Ue=(s(23020),s(53429),s(94205),s(95462),s(23739),s(16343),s(29928),s(12311),s(5324),s(42892)),ke=s(15074),Le=(s(94849),s(75105),s(92471),s(16406),s(2508));a.N,i.N,n.A,r.N,o.N,l.A,d.N,c.A,A.A,g.A,p.N,u.N,h.N,m.A,C.A,v.N,_.N,w.A,b.N,f.A,y.A,N.N,G.N,S.N,x.A,U.N,k.A,L.N,D.A,pe.N,B.N,I.N,q.N,O.N,M.A,$.N,E.N,F.N,T.N,P.N,R.N,Q.N,z.N,W.A,H.A,K.N,j.N,Y.A,V.N,X.A,J.A,Z.A,ee.N,te.N,se.N,ae.N,ie.N,ne.N,re.A,ge.N,oe.A,le.A,de.N,ce.N,ue.N,Ae.N,pe.a,he.N,ve.N,me.N,_e.N,we.N,be.N,fe.N,ye.N,Ce.N,Ne.N,Ge.N,Se.N,xe.A,Symbol.toStringTag,Ue.u,ke.u,Le.yw,Symbol.toStringTag}}]);
//# sourceMappingURL=settings-users-3239.js.map?v=6739562f3c0c433c7b85