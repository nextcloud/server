/*! third party licenses: dist/vendor.LICENSE.txt */
import{b_ as i,al as _,bR as o,bZ as l,aV as d}from"./core-common.mjs";import{a as m}from"./chunks/index-PaKKd09k.mjs";import{z as f}from"./chunks/_plugin-vue2_normalizer-VrK6B12S-BQkexw0P.mjs";import{R as y}from"./chunks/index-D0hy_tCT.mjs";import{n as h}from"./chunks/icons-TElqpmA8.mjs";import"./chunks/preload-helper-BG02UnR2.mjs";const g=i("files_sharing","default_share_folder","/"),v=i("files_sharing","share_folder",g),b={name:"SelectShareFolderDialogue",components:{NcTextField:_},data(){return{directory:v,defaultDirectory:g}},computed:{readableDirectory(){return this.directory?this.directory:"/"}},methods:{async pickFolder(){const e=y(t("files","Choose a default folder for accepted shares")).startAt(this.readableDirectory).setMultiSelect(!1).setType(1).setMimeTypeFilter(["httpd/unix-directory"]).allowDirectories().build();try{const r=await e.pick()||"/";if(!r.startsWith("/"))throw new Error(t("files","Invalid path selected"));this.directory=m.normalize(r),await o.put(l("/apps/files_sharing/settings/shareFolder"),{shareFolder:this.directory})}catch(r){f(r.message||t("files","Unknown error"))}},resetFolder(){this.directory=this.defaultDirectory,o.delete(l("/apps/files_sharing/settings/shareFolder"))}}};var D=function(){var e=this,r=e._self._c;return r("div",{staticClass:"share-folder"},[r("form",{staticClass:"share-folder__form",on:{reset:function(s){return s.preventDefault(),s.stopPropagation(),e.resetFolder.apply(null,arguments)}}},[r("NcTextField",{staticClass:"share-folder__picker",attrs:{type:"text",label:e.t("files_sharing","Set default folder for accepted shares"),value:e.readableDirectory},on:{click:function(s){return s.preventDefault(),e.pickFolder.apply(null,arguments)}}}),e.readableDirectory!==e.defaultDirectory?r("input",{staticClass:"share-folder__reset",attrs:{type:"reset","aria-label":e.t("files_sharing","Reset folder to system default")},domProps:{value:e.t("files_sharing","Reset")}}):e._e()],1)])},w=[],F=h(b,D,w,!1,null,"c6dc5c60");const S=F.exports,k={name:"PersonalSettings",components:{SelectShareFolderDialogue:S},data(){return{accepting:i("files_sharing","accept_default"),enforceAcceptShares:i("files_sharing","enforce_accept"),allowCustomDirectory:i("files_sharing","allow_custom_share_folder")}},methods:{async toggleEnabled(){try{await o.put(l("/apps/files_sharing/settings/defaultAccept"),{accept:this.accepting})}catch(e){f(t("files_sharing","Error while toggling options")),console.error(e)}}}};var x=function(){var e=this,r=e._self._c;return!e.enforceAcceptShares||e.allowCustomDirectory?r("div",{staticClass:"section",attrs:{id:"files-sharing-personal-settings"}},[r("h2",[e._v(e._s(e.t("files_sharing","Sharing")))]),e.enforceAcceptShares?e._e():r("p",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.accepting,expression:"accepting"}],staticClass:"checkbox",attrs:{id:"files-sharing-personal-settings-accept",type:"checkbox"},domProps:{checked:Array.isArray(e.accepting)?e._i(e.accepting,null)>-1:e.accepting},on:{change:[function(s){var a=e.accepting,n=s.target,u=!!n.checked;if(Array.isArray(a)){var p=null,c=e._i(a,p);n.checked?c<0&&(e.accepting=a.concat([p])):c>-1&&(e.accepting=a.slice(0,c).concat(a.slice(c+1)))}else e.accepting=u},e.toggleEnabled]}}),r("label",{attrs:{for:"files-sharing-personal-settings-accept"}},[e._v(e._s(e.t("files_sharing","Accept shares from other accounts and groups by default")))])]),e.allowCustomDirectory?r("p",[r("SelectShareFolderDialogue")],1):e._e()]):e._e()},A=[],C=h(k,x,A,!1,null,"1c891d20");const E=C.exports;d.prototype.t=t;const P=d.extend(E);new P().$mount("#files-sharing-personal-settings");
