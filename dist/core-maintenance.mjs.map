{"version":3,"file":"core-maintenance.mjs","sources":["../core/src/maintenance.js"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2019 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport Axios from '@nextcloud/axios'\nimport { getRootUrl } from '@nextcloud/router'\n\nconst url = getRootUrl() + '/status.php'\n\nconst check = () => {\n\tconsole.info('checking the Nextcloud maintenance status')\n\tAxios.get(url)\n\t\t.then(resp => resp.data)\n\t\t.then(status => {\n\t\t\tif (status.maintenance === false) {\n\t\t\t\tconsole.info('Nextcloud is not in maintenance mode anymore -> reloading')\n\n\t\t\t\twindow.location.reload()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconsole.info('Nextcloud is still in maintenance mode')\n\n\t\t\t// Wait 20sec before the next request\n\t\t\tsetTimeout(check, 20 * 1000)\n\t\t})\n\t\t.catch(console.error.bind(this))\n}\n\n// Off we go!\ncheck()\n"],"names":["url","getRootUrl","check","Axios","resp","status","this"],"mappings":";+CAQA,MAAMA,EAAMC,EAAU,EAAK,cAErBC,EAAQ,IAAM,CACnB,QAAQ,KAAK,2CAA2C,EACxDC,EAAM,IAAIH,CAAG,EACX,KAAKI,GAAQA,EAAK,IAAI,EACtB,KAAKC,GAAU,CACf,GAAIA,EAAO,cAAgB,GAAO,CACjC,QAAQ,KAAK,2DAA2D,EAExE,OAAO,SAAS,OAAQ,EACxB,MACA,CAED,QAAQ,KAAK,wCAAwC,EAGrD,WAAWH,EAAO,GAAK,GAAI,CAC9B,CAAG,EACA,MAAM,QAAQ,MAAM,KAAKI,MAAI,CAAC,CACjC,EAGAJ,EAAK"}