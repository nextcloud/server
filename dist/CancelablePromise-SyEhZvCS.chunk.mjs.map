{"version":3,"file":"CancelablePromise-SyEhZvCS.chunk.mjs","sources":["../node_modules/@nextcloud/sharing/dist/public.js","../node_modules/cancelable-promise/esm/CancelablePromise.mjs"],"sourcesContent":["/*!\n * SPDX-FileCopyrightText: 2024 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: GPL-3.0-or-later\n */\n/**\n * @module public\n */\nimport { loadState } from '@nextcloud/initial-state';\n/**\n * Check if the current page is on a public share\n */\nexport function isPublicShare() {\n    // check both the new initial state version and fallback to legacy input\n    return (loadState('files_sharing', 'isPublic', null)\n        ?? document.querySelector('input#isPublic[type=\"hidden\"][name=\"isPublic\"][value=\"1\"]') !== null);\n}\n/**\n * Get the sharing token for the current public share\n */\nexport function getSharingToken() {\n    return (loadState('files_sharing', 'sharingToken', null)\n        ?? document.querySelector('input#sharingToken[type=\"hidden\"]')?.value\n        ?? null);\n}\n","function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\n\nfunction _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\nfunction _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\n\nfunction _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n\nfunction _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\n\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\n\nfunction _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\n\nvar toStringTag = typeof Symbol !== 'undefined' ? Symbol.toStringTag : '@@toStringTag';\n\nvar _internals = /*#__PURE__*/new WeakMap();\n\nvar _promise = /*#__PURE__*/new WeakMap();\n\nclass CancelablePromiseInternal {\n  constructor(_ref) {\n    var {\n      executor = () => {},\n      internals = defaultInternals(),\n      promise = new Promise((resolve, reject) => executor(resolve, reject, onCancel => {\n        internals.onCancelList.push(onCancel);\n      }))\n    } = _ref;\n\n    _classPrivateFieldInitSpec(this, _internals, {\n      writable: true,\n      value: void 0\n    });\n\n    _classPrivateFieldInitSpec(this, _promise, {\n      writable: true,\n      value: void 0\n    });\n\n    _defineProperty(this, toStringTag, 'CancelablePromise');\n\n    this.cancel = this.cancel.bind(this);\n\n    _classPrivateFieldSet(this, _internals, internals);\n\n    _classPrivateFieldSet(this, _promise, promise || new Promise((resolve, reject) => executor(resolve, reject, onCancel => {\n      internals.onCancelList.push(onCancel);\n    })));\n  }\n\n  then(onfulfilled, onrejected) {\n    return makeCancelable(_classPrivateFieldGet(this, _promise).then(createCallback(onfulfilled, _classPrivateFieldGet(this, _internals)), createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  catch(onrejected) {\n    return makeCancelable(_classPrivateFieldGet(this, _promise).catch(createCallback(onrejected, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  finally(onfinally, runWhenCanceled) {\n    if (runWhenCanceled) {\n      _classPrivateFieldGet(this, _internals).onCancelList.push(onfinally);\n    }\n\n    return makeCancelable(_classPrivateFieldGet(this, _promise).finally(createCallback(() => {\n      if (onfinally) {\n        if (runWhenCanceled) {\n          _classPrivateFieldGet(this, _internals).onCancelList = _classPrivateFieldGet(this, _internals).onCancelList.filter(callback => callback !== onfinally);\n        }\n\n        return onfinally();\n      }\n    }, _classPrivateFieldGet(this, _internals))), _classPrivateFieldGet(this, _internals));\n  }\n\n  cancel() {\n    _classPrivateFieldGet(this, _internals).isCanceled = true;\n\n    var callbacks = _classPrivateFieldGet(this, _internals).onCancelList;\n\n    _classPrivateFieldGet(this, _internals).onCancelList = [];\n\n    for (var callback of callbacks) {\n      if (typeof callback === 'function') {\n        try {\n          callback();\n        } catch (err) {\n          console.error(err);\n        }\n      }\n    }\n  }\n\n  isCanceled() {\n    return _classPrivateFieldGet(this, _internals).isCanceled === true;\n  }\n\n}\n\nexport class CancelablePromise extends CancelablePromiseInternal {\n  constructor(executor) {\n    super({\n      executor\n    });\n  }\n\n}\n\n_defineProperty(CancelablePromise, \"all\", function all(iterable) {\n  return makeAllCancelable(iterable, Promise.all(iterable));\n});\n\n_defineProperty(CancelablePromise, \"allSettled\", function allSettled(iterable) {\n  return makeAllCancelable(iterable, Promise.allSettled(iterable));\n});\n\n_defineProperty(CancelablePromise, \"any\", function any(iterable) {\n  return makeAllCancelable(iterable, Promise.any(iterable));\n});\n\n_defineProperty(CancelablePromise, \"race\", function race(iterable) {\n  return makeAllCancelable(iterable, Promise.race(iterable));\n});\n\n_defineProperty(CancelablePromise, \"resolve\", function resolve(value) {\n  return cancelable(Promise.resolve(value));\n});\n\n_defineProperty(CancelablePromise, \"reject\", function reject(reason) {\n  return cancelable(Promise.reject(reason));\n});\n\n_defineProperty(CancelablePromise, \"isCancelable\", isCancelablePromise);\n\nexport default CancelablePromise;\nexport function cancelable(promise) {\n  return makeCancelable(promise, defaultInternals());\n}\nexport function isCancelablePromise(promise) {\n  return promise instanceof CancelablePromise || promise instanceof CancelablePromiseInternal;\n}\n\nfunction createCallback(onResult, internals) {\n  if (onResult) {\n    return arg => {\n      if (!internals.isCanceled) {\n        var result = onResult(arg);\n\n        if (isCancelablePromise(result)) {\n          internals.onCancelList.push(result.cancel);\n        }\n\n        return result;\n      }\n\n      return arg;\n    };\n  }\n}\n\nfunction makeCancelable(promise, internals) {\n  return new CancelablePromiseInternal({\n    internals,\n    promise\n  });\n}\n\nfunction makeAllCancelable(iterable, promise) {\n  var internals = defaultInternals();\n  internals.onCancelList.push(() => {\n    for (var resolvable of iterable) {\n      if (isCancelablePromise(resolvable)) {\n        resolvable.cancel();\n      }\n    }\n  });\n  return new CancelablePromiseInternal({\n    internals,\n    promise\n  });\n}\n\nfunction defaultInternals() {\n  return {\n    isCanceled: false,\n    onCancelList: []\n  };\n}\n//# sourceMappingURL=CancelablePromise.mjs.map"],"names":["isPublicShare","loadState","getSharingToken","_defineProperty","obj","key","value","_classPrivateFieldInitSpec","privateMap","_checkPrivateRedeclaration","privateCollection","_classPrivateFieldGet","receiver","descriptor","_classExtractFieldDescriptor","_classApplyDescriptorGet","_classPrivateFieldSet","_classApplyDescriptorSet","action","toStringTag","_internals","_promise","CancelablePromiseInternal","_ref","executor","internals","defaultInternals","promise","resolve","reject","onCancel","onfulfilled","onrejected","makeCancelable","createCallback","onfinally","runWhenCanceled","callback","callbacks","err","CancelablePromise","iterable","makeAllCancelable","cancelable","reason","isCancelablePromise","onResult","arg","result","resolvable"],"mappings":"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","x_google_ignoreList":[0,1]}