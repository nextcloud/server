{"version":3,"file":"node_modules_nextcloud_upload_dist_chunks_ConflictPicker-Bif6rCp6_mjs-node_modules_nextcloud_upload_dist_chunks_ConflictPicker-Bif6rCp6_mjs.js?v=16643b171a2f787f7569","mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA","sources":["webpack:///nextcloud/node_modules/@nextcloud/upload/dist/assets/ConflictPicker-BVcoqXxT.css","webpack://nextcloud/./node_modules/@nextcloud/upload/dist/assets/ConflictPicker-BVcoqXxT.css?116c","webpack:///nextcloud/node_modules/@nextcloud/upload/dist/chunks/ConflictPicker-Bif6rCp6.mjs"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.node-picker__wrapper[data-v-f85db9fe]:not(:last-of-type) {\n  border-bottom: 1px solid var(--color-border);\n}\n.node-picker[data-v-f85db9fe] {\n  display: flex;\n  align-items: center;\n  height: 64px;\n}\n.node-picker__icon[data-v-f85db9fe],\n.node-picker__preview[data-v-f85db9fe] {\n  height: 64px;\n  width: 64px;\n  margin: 0 var(--secondary-margin);\n  display: block;\n  flex: 0 0 64px;\n}\n.node-picker__icon[data-v-f85db9fe] {\n  color: var(--color-text-maxcontrast);\n}\n.node-picker__icon.folder-icon[data-v-f85db9fe] {\n  color: var(--color-primary-element);\n}\n.node-picker__preview[data-v-f85db9fe] {\n  overflow: hidden;\n  border-radius: calc(var(--border-radius) * 2);\n  background-position: center;\n  background-size: cover;\n}\n.node-picker__desc[data-v-f85db9fe] {\n  display: flex;\n  flex-direction: column;\n}\n.node-picker__desc span[data-v-f85db9fe] {\n  white-space: nowrap;\n}\n[data-v-12c4204f] .modal-container__content {\n  display: flex;\n  overflow: visible;\n  flex-direction: column;\n}\n.conflict-picker[data-v-12c4204f] {\n  --margin: 36px;\n  --secondary-margin: 18px;\n}\n.conflict-picker__header[data-v-12c4204f] {\n  position: sticky;\n  z-index: 10;\n  top: 0;\n  padding: 0 var(--margin);\n  padding-bottom: var(--secondary-margin);\n}\n.conflict-picker__form[data-v-12c4204f] {\n  position: relative;\n  overflow: auto;\n  padding: 0 var(--margin);\n  margin-top: calc(-1 * var(--secondary-margin));\n}\n.conflict-picker fieldset[data-v-12c4204f] {\n  display: grid;\n  width: 100%;\n  margin-top: calc(var(--secondary-margin) * 1.5);\n  padding-bottom: var(--secondary-margin);\n  grid-template-columns: 1fr 1fr;\n}\n.conflict-picker fieldset[data-v-12c4204f] legend {\n  display: flex;\n  align-items: center;\n  width: 100%;\n  margin-bottom: calc(var(--secondary-margin) / 2);\n}\n.conflict-picker fieldset.conflict-picker__all[data-v-12c4204f] {\n  position: sticky;\n  top: 0;\n  margin: 0;\n  padding: var(--secondary-margin) 0;\n  background-image:\n    linear-gradient(\n      to top,\n      transparent,\n      var(--color-main-background-blur) 10%,\n      var(--color-main-background) 15%);\n}\n.conflict-picker fieldset.conflict-picker__all + fieldset[data-v-12c4204f] {\n  margin-top: 0;\n}\n.conflict-picker fieldset.conflict-picker__all[data-v-12c4204f] label {\n  font-weight: 700;\n}\n.conflict-picker .button-vue--disabled[data-v-12c4204f] {\n  cursor: default;\n  opacity: .5;\n  filter: saturate(.7);\n}\n.conflict-picker[data-v-12c4204f] .dialog__actions {\n  width: auto;\n  margin-inline: 12px;\n}\n.conflict-picker[data-v-12c4204f] .dialog__actions span.dialog__actions-separator {\n  margin-left: auto;\n}\n@media screen and (max-width: 768px) {\n  .conflict-picker[data-v-12c4204f] {\n    --margin: var(--secondary-margin) !important;\n  }\n  .conflict-picker__description[data-v-12c4204f] {\n    display: none !important;\n  }\n  .conflict-picker fieldset[data-v-12c4204f] {\n    grid-template-columns: 1fr !important;\n  }\n  .conflict-picker fieldset.conflict-picker__all[data-v-12c4204f] {\n    position: static;\n  }\n}\n@media screen and (max-width: 512px) {\n  .conflict-picker[data-v-12c4204f] .dialog__actions {\n    flex-wrap: wrap;\n  }\n  .conflict-picker[data-v-12c4204f] .dialog__actions span.dialog__actions-separator {\n    width: 100%;\n  }\n}\n`, \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../css-loader/dist/cjs.js!./ConflictPicker-BVcoqXxT.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../css-loader/dist/cjs.js!./ConflictPicker-BVcoqXxT.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import '../assets/ConflictPicker-BVcoqXxT.css';\nimport { extname as _, basename as g } from \"path\";\nimport { defineComponent as m } from \"vue\";\nimport { formatFileSize as S, FileType as f } from \"@nextcloud/files\";\nimport { showError as k } from \"@nextcloud/dialogs\";\nimport { n as o, t as a, a as d, l as r } from \"./index-DM2X1kc6.mjs\";\nimport p from \"@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js\";\nimport v from \"@nextcloud/vue/dist/Components/NcDialog.js\";\nimport w from \"@nextcloud/vue/dist/Components/NcButton.js\";\nimport { generateUrl as y } from \"@nextcloud/router\";\nimport C from \"@nextcloud/vue/dist/Components/NcDateTime.js\";\nconst b = {\n  name: \"ArrowRightIcon\",\n  emits: [\"click\"],\n  props: {\n    title: {\n      type: String\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n};\nvar x = function() {\n  var e = this, t = e._self._c;\n  return t(\"span\", e._b({ staticClass: \"material-design-icon arrow-right-icon\", attrs: { \"aria-hidden\": e.title ? null : !0, \"aria-label\": e.title, role: \"img\" }, on: { click: function(s) {\n    return e.$emit(\"click\", s);\n  } } }, \"span\", e.$attrs, !1), [t(\"svg\", { staticClass: \"material-design-icon__svg\", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: \"0 0 24 24\" } }, [t(\"path\", { attrs: { d: \"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z\" } }, [e.title ? t(\"title\", [e._v(e._s(e.title))]) : e._e()])])]);\n}, N = [], $ = /* @__PURE__ */ o(\n  b,\n  x,\n  N,\n  !1,\n  null,\n  null,\n  null,\n  null\n);\nconst L = $.exports, z = {\n  name: \"CloseIcon\",\n  emits: [\"click\"],\n  props: {\n    title: {\n      type: String\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n};\nvar F = function() {\n  var e = this, t = e._self._c;\n  return t(\"span\", e._b({ staticClass: \"material-design-icon close-icon\", attrs: { \"aria-hidden\": e.title ? null : !0, \"aria-label\": e.title, role: \"img\" }, on: { click: function(s) {\n    return e.$emit(\"click\", s);\n  } } }, \"span\", e.$attrs, !1), [t(\"svg\", { staticClass: \"material-design-icon__svg\", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: \"0 0 24 24\" } }, [t(\"path\", { attrs: { d: \"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" } }, [e.title ? t(\"title\", [e._v(e._s(e.title))]) : e._e()])])]);\n}, P = [], A = /* @__PURE__ */ o(\n  z,\n  F,\n  P,\n  !1,\n  null,\n  null,\n  null,\n  null\n);\nconst R = A.exports, I = {\n  name: \"FileIcon\",\n  emits: [\"click\"],\n  props: {\n    title: {\n      type: String\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n};\nvar B = function() {\n  var e = this, t = e._self._c;\n  return t(\"span\", e._b({ staticClass: \"material-design-icon file-icon\", attrs: { \"aria-hidden\": e.title ? null : !0, \"aria-label\": e.title, role: \"img\" }, on: { click: function(s) {\n    return e.$emit(\"click\", s);\n  } } }, \"span\", e.$attrs, !1), [t(\"svg\", { staticClass: \"material-design-icon__svg\", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: \"0 0 24 24\" } }, [t(\"path\", { attrs: { d: \"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z\" } }, [e.title ? t(\"title\", [e._v(e._s(e.title))]) : e._e()])])]);\n}, E = [], O = /* @__PURE__ */ o(\n  I,\n  B,\n  E,\n  !1,\n  null,\n  null,\n  null,\n  null\n);\nconst M = O.exports, U = {\n  name: \"FolderIcon\",\n  emits: [\"click\"],\n  props: {\n    title: {\n      type: String\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n};\nvar V = function() {\n  var e = this, t = e._self._c;\n  return t(\"span\", e._b({ staticClass: \"material-design-icon folder-icon\", attrs: { \"aria-hidden\": e.title ? null : !0, \"aria-label\": e.title, role: \"img\" }, on: { click: function(s) {\n    return e.$emit(\"click\", s);\n  } } }, \"span\", e.$attrs, !1), [t(\"svg\", { staticClass: \"material-design-icon__svg\", attrs: { fill: e.fillColor, width: e.size, height: e.size, viewBox: \"0 0 24 24\" } }, [t(\"path\", { attrs: { d: \"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z\" } }, [e.title ? t(\"title\", [e._v(e._s(e.title))]) : e._e()])])]);\n}, q = [], D = /* @__PURE__ */ o(\n  U,\n  V,\n  q,\n  !1,\n  null,\n  null,\n  null,\n  null\n);\nconst T = D.exports, h = 64, H = m({\n  name: \"NodesPicker\",\n  components: {\n    FileSvg: M,\n    FolderSvg: T,\n    NcCheckboxRadioSwitch: p,\n    NcDateTime: C\n  },\n  props: {\n    incoming: {\n      type: [File, Object],\n      required: !0\n    },\n    existing: {\n      type: Object,\n      required: !0\n    },\n    newSelected: {\n      type: Array,\n      required: !0\n    },\n    oldSelected: {\n      type: Array,\n      required: !0\n    }\n  },\n  data() {\n    return {\n      asyncPreview: null\n    };\n  },\n  computed: {\n    /**\n     * Whether the incoming or existing file is selected.\n     * This is used by the parent component to ensure\n     * that the user has selected at least one of the two files.\n     */\n    isEnoughSelected() {\n      return this.isChecked(this.incoming, this.newSelected) || this.isChecked(this.existing, this.oldSelected);\n    },\n    incomingPreview() {\n      return this.asyncPreview ? this.asyncPreview : this.previewUrl(this.incoming);\n    },\n    existingPreview() {\n      return this.previewUrl(this.existing);\n    },\n    incomingLastModified() {\n      return this.lastModified(this.incoming);\n    },\n    existingLastModified() {\n      return this.lastModified(this.existing);\n    }\n  },\n  methods: {\n    lastModified(i) {\n      return (i instanceof File ? new Date(i.lastModified) : i.mtime) ?? null;\n    },\n    size(i) {\n      return i.size ? S(i.size, !0) : a(\"Unknown size\");\n    },\n    previewUrl(i) {\n      if (i instanceof File) {\n        this.previewImage(i).then((e) => {\n          this.asyncPreview = e;\n        });\n        return;\n      }\n      if (i.type === f.Folder)\n        return null;\n      try {\n        const e = i.attributes.previewUrl || y(\"/core/preview?fileId={fileid}\", {\n          fileid: i.fileid\n        }), t = new URL(window.location.origin + e);\n        return t.searchParams.set(\"x\", h.toString()), t.searchParams.set(\"y\", h.toString()), t.searchParams.set(\"mimeFallback\", \"true\"), t.href;\n      } catch {\n        return null;\n      }\n    },\n    isFolder(i) {\n      return i.type === f.Folder || i.type === \"httpd/unix-directory\";\n    },\n    isChecked(i, e) {\n      return e.includes(i);\n    },\n    onUpdateIncomingChecked(i) {\n      i ? this.$emit(\"update:newSelected\", [this.incoming, ...this.newSelected]) : this.$emit(\"update:newSelected\", this.newSelected.filter((e) => e !== this.incoming));\n    },\n    onUpdateExistingChecked(i) {\n      i ? this.$emit(\"update:oldSelected\", [this.existing, ...this.oldSelected]) : this.$emit(\"update:oldSelected\", this.oldSelected.filter((e) => e !== this.existing));\n    },\n    /**\n     * Get the preview Image of a file\n     * @param file the soon-to-be-uploaded File\n     */\n    async previewImage(i) {\n      return new Promise((e) => {\n        if (i.type.startsWith(\"image/\")) {\n          const t = new FileReader();\n          t.onload = async (s) => {\n            const l = s?.target?.result;\n            if (l instanceof ArrayBuffer) {\n              const n = new Blob([l], { type: i.type }), c = URL.createObjectURL(n);\n              e(c);\n              return;\n            }\n            e(null);\n          }, t.readAsArrayBuffer(i);\n        }\n      });\n    },\n    t: a\n  }\n});\nvar Z = function() {\n  var e = this, t = e._self._c;\n  return e._self._setupProxy, t(\"fieldset\", { staticClass: \"node-picker__wrapper\", attrs: { \"data-cy-conflict-picker-fieldset\": e.existing.basename } }, [t(\"legend\", [e._v(e._s(e.existing.basename))]), t(\"NcCheckboxRadioSwitch\", { attrs: { checked: e.isChecked(e.incoming, e.newSelected), required: !e.isEnoughSelected, \"data-cy-conflict-picker-input-incoming\": e.existing.basename }, on: { \"update:checked\": e.onUpdateIncomingChecked } }, [t(\"span\", { staticClass: \"node-picker node-picker--incoming\" }, [e.incomingPreview ? t(\"img\", { staticClass: \"node-picker__preview\", attrs: { src: e.incomingPreview, alt: e.t(\"Preview image\"), loading: \"lazy\" } }) : [e.isFolder(e.existing) ? t(\"FolderSvg\", { staticClass: \"node-picker__icon\", attrs: { size: 48 } }) : t(\"FileSvg\", { staticClass: \"node-picker__icon\", attrs: { size: 48 } })], t(\"span\", { staticClass: \"node-picker__desc\" }, [t(\"span\", { staticClass: \"node-picker__name\" }, [e._v(e._s(e.t(\"New version\")))]), e.incomingLastModified ? t(\"NcDateTime\", { staticClass: \"node-picker__mtime\", attrs: { timestamp: e.incomingLastModified, \"relative-time\": !1, format: { timeStyle: \"short\", dateStyle: \"medium\" } } }) : t(\"span\", { staticClass: \"node-picker__mtime\" }, [e._v(\" \" + e._s(e.t(\"Last modified date unknown\")) + \" \")]), t(\"span\", { staticClass: \"node-picker__size\" }, [e._v(e._s(e.size(e.incoming)))])], 1)], 2)]), t(\"NcCheckboxRadioSwitch\", { attrs: { checked: e.isChecked(e.existing, e.oldSelected), required: !e.isEnoughSelected, \"data-cy-conflict-picker-input-existing\": e.existing.basename }, on: { \"update:checked\": e.onUpdateExistingChecked } }, [t(\"span\", { staticClass: \"node-picker node-picker--existing\" }, [e.existingPreview ? t(\"img\", { staticClass: \"node-picker__preview\", attrs: { src: e.existingPreview, alt: e.t(\"Preview image\"), loading: \"lazy\" } }) : [e.isFolder(e.existing) ? t(\"FolderSvg\", { staticClass: \"node-picker__icon\", attrs: { size: 48 } }) : t(\"FileSvg\", { staticClass: \"node-picker__icon\", attrs: { size: 48 } })], t(\"span\", { staticClass: \"node-picker__desc\" }, [t(\"span\", { staticClass: \"node-picker__name\" }, [e._v(e._s(e.t(\"Existing version\")))]), e.existingLastModified ? t(\"NcDateTime\", { staticClass: \"node-picker__mtime\", attrs: { timestamp: e.existingLastModified, \"relative-time\": !1, format: { timeStyle: \"short\", dateStyle: \"medium\" } } }) : t(\"span\", { staticClass: \"node-picker__mtime\" }, [e._v(\" \" + e._s(e.t(\"Last modified date unknown\")) + \" \")]), t(\"span\", { staticClass: \"node-picker__size\" }, [e._v(e._s(e.size(e.existing)))])], 1)], 2)])], 1);\n}, j = [], W = /* @__PURE__ */ o(\n  H,\n  Z,\n  j,\n  !1,\n  null,\n  \"f85db9fe\",\n  null,\n  null\n);\nconst Y = W.exports, G = m({\n  name: \"ConflictPicker\",\n  components: {\n    ArrowRight: L,\n    Close: R,\n    NcButton: w,\n    NcCheckboxRadioSwitch: p,\n    NcDialog: v,\n    NodesPicker: Y\n  },\n  props: {\n    /** Directory/context file name */\n    dirname: {\n      type: String,\n      default: \"\"\n    },\n    /** All the existing files in the current directory */\n    content: {\n      type: Array,\n      required: !0\n    },\n    /** New files being moved/uploaded */\n    conflicts: {\n      type: Array,\n      required: !0\n    }\n  },\n  emits: [\"cancel\", \"submit\"],\n  data() {\n    return {\n      // computed list of conflicting files already present in the directory\n      files: [],\n      opened: !0,\n      blockedTitle: a(\"You need to select at least one version of each file to continue.\"),\n      newSelected: [],\n      oldSelected: []\n    };\n  },\n  computed: {\n    name() {\n      return this?.dirname?.trim?.() !== \"\" ? d(\"{count} file conflict in {dirname}\", \"{count} file conflicts in {dirname}\", this.conflicts.length, {\n        count: this.conflicts.length,\n        dirname: this.dirname\n      }) : d(\"{count} file conflict\", \"{count} files conflict\", this.conflicts.length, { count: this.conflicts.length });\n    },\n    skipButtonLabel() {\n      return d(\"Skip this file\", \"Skip {count} files\", this.conflicts.length, { count: this.conflicts.length });\n    },\n    // Select all incoming files\n    selectAllNewBind() {\n      const i = this.isNoneNewSelected || this.isSomeNewSelected ? this.t(\"Select all\") : this.t(\"Unselect all\");\n      return {\n        \"aria-label\": i,\n        checked: this.isAllNewSelected,\n        indeterminate: this.isSomeNewSelected,\n        title: i\n      };\n    },\n    isAllNewSelected() {\n      return this.newSelected.length === this.conflicts.length;\n    },\n    isNoneNewSelected() {\n      return this.newSelected.length === 0;\n    },\n    isSomeNewSelected() {\n      return !this.isAllNewSelected && !this.isNoneNewSelected;\n    },\n    // Select all existing files\n    selectAllOldBind() {\n      const i = this.isNoneOldSelected || this.isSomeOldSelected ? this.t(\"Select all\") : this.t(\"Unselect all\");\n      return {\n        \"aria-label\": i,\n        checked: this.isAllOldSelected,\n        indeterminate: this.isSomeOldSelected,\n        title: i\n      };\n    },\n    isAllOldSelected() {\n      return this.oldSelected.length === this.files.length;\n    },\n    isNoneOldSelected() {\n      return this.oldSelected.length === 0;\n    },\n    isSomeOldSelected() {\n      return !this.isAllOldSelected && !this.isNoneOldSelected;\n    },\n    // Global handlings\n    isEnoughSelected() {\n      return this.isAllOldSelected || this.isAllNewSelected ? !0 : this.$refs?.nodesPicker?.every?.((i) => i.isEnoughSelected);\n    }\n  },\n  mounted() {\n    if (this.files = this.conflicts.map((i) => {\n      const e = i instanceof File ? i.name : i.basename;\n      return this.content.find((t) => t.basename === e);\n    }).filter(Boolean), this.conflicts.length === 0 || this.files.length === 0) {\n      const i = new Error(\"ConflictPicker: files and conflicts must not be empty\");\n      throw this.onCancel(i), i;\n    }\n    if (this.conflicts.length !== this.files.length) {\n      const i = new Error(\"ConflictPicker: files and conflicts must have the same length. Make sure you filter out non conflicting files from the conflicts array.\");\n      throw this.onCancel(i), i;\n    }\n    r.debug(\"ConflictPicker initialised\", { files: this.files, conflicts: this.conflicts, content: this.content });\n  },\n  methods: {\n    onCancel(i) {\n      this.opened = !1, this.$emit(\"cancel\", i);\n    },\n    onSkip() {\n      r.debug(\"Conflict skipped. Ignoring all conflicting files\"), this.opened = !1, this.$emit(\"submit\", {\n        selected: [],\n        renamed: []\n      });\n    },\n    onSubmit() {\n      if (!this.isEnoughSelected) {\n        this.scrollValidityInputIntoView(), this.$refs.form.reportValidity(), k(this.blockedTitle);\n        return;\n      }\n      const i = this.oldSelected.map((n) => n.basename), e = this.content.map((n) => n.basename), t = [], s = this.newSelected.filter((n) => {\n        const c = n instanceof File ? n.name : n.basename;\n        return i.includes(c);\n      });\n      s.length > 0 && s.forEach((n) => {\n        const c = n instanceof File ? n.name : n.basename, u = this.getUniqueName(c, e);\n        if (n instanceof File) {\n          Object.defineProperty(n, \"name\", { value: u }), t.push(n);\n          return;\n        }\n        n.rename(u), t.push(n);\n      });\n      const l = this.newSelected.filter((n) => {\n        const c = n instanceof File ? n.name : n.basename;\n        return !i.includes(c) && !s.includes(n);\n      });\n      r.debug(\"Conflict resolved\", { selected: l, renamed: t }), this.opened = !1, this.$emit(\"submit\", {\n        selected: l,\n        renamed: t\n      });\n    },\n    /**\n     * Get a unique name for a file based\n     * on the existing directory content.\n     * @param {string} name The original file name with extension\n     * @param {string} names The existing directory content names\n     * @return {string} A unique name\n     * TODO: migrate to @nextcloud/files\n     */\n    getUniqueName(i, e) {\n      let t = i, s = 1;\n      for (; e.includes(t); ) {\n        const l = _(i);\n        t = `${g(i, l)} (${s++})${l}`;\n      }\n      return t;\n    },\n    /**\n     * Scroll the first invalid input into view.\n     * This is needed because the browser uses behavior: \"nearest\" by default.\n     */\n    scrollValidityInputIntoView() {\n      const i = '.checkbox-radio-switch input[type=\"checkbox\"]';\n      [...this.$el.querySelectorAll(i)].forEach((s) => s?.setCustomValidity?.(\"\"));\n      const t = this.$el.querySelector(i + \":invalid\");\n      t && (t.setCustomValidity(this.blockedTitle), t.scrollIntoView({ behavior: \"instant\", block: \"center\" }));\n    },\n    onSelectAllNew(i) {\n      i ? (r.debug(\"Selected all new files\"), this.newSelected = this.conflicts) : (r.debug(\"Cleared new selection\"), this.newSelected = []);\n    },\n    onSelectAllOld(i) {\n      i ? (r.debug(\"Selected all existing files\"), this.oldSelected = this.files) : (r.debug(\"Cleared old selection\"), this.oldSelected = []);\n    },\n    t: a\n  }\n});\nvar J = function() {\n  var e = this, t = e._self._c;\n  return e._self._setupProxy, t(\"NcDialog\", { staticClass: \"conflict-picker\", attrs: { \"data-cy-conflict-picker\": \"\", \"close-on-click-outside\": !1, \"can-close\": !0, show: e.opened, name: e.name, size: \"large\" }, on: { closing: e.onCancel }, scopedSlots: e._u([{ key: \"actions\", fn: function() {\n    return [t(\"NcButton\", { attrs: { \"aria-label\": e.t(\"Cancel\"), title: e.t(\"Cancel the entire operation\"), \"data-cy-conflict-picker-cancel\": \"\", type: \"tertiary\" }, on: { click: e.onCancel }, scopedSlots: e._u([{ key: \"icon\", fn: function() {\n      return [t(\"Close\", { attrs: { size: 20 } })];\n    }, proxy: !0 }]) }, [e._v(\" \" + e._s(e.t(\"Cancel\")) + \" \")]), t(\"span\", { staticClass: \"dialog__actions-separator\" }), t(\"NcButton\", { attrs: { \"aria-label\": e.skipButtonLabel, \"data-cy-conflict-picker-skip\": \"\" }, on: { click: e.onSkip }, scopedSlots: e._u([{ key: \"icon\", fn: function() {\n      return [t(\"Close\", { attrs: { size: 20 } })];\n    }, proxy: !0 }]) }, [e._v(\" \" + e._s(e.skipButtonLabel) + \" \")]), t(\"NcButton\", { class: { \"button-vue--disabled\": !e.isEnoughSelected }, attrs: { \"aria-label\": e.t(\"Continue\"), title: e.isEnoughSelected ? \"\" : e.blockedTitle, \"data-cy-conflict-picker-submit\": \"\", \"native-type\": \"submit\", type: \"primary\" }, on: { click: function(s) {\n      return s.stopPropagation(), s.preventDefault(), e.onSubmit.apply(null, arguments);\n    } }, scopedSlots: e._u([{ key: \"icon\", fn: function() {\n      return [t(\"ArrowRight\", { attrs: { size: 20 } })];\n    }, proxy: !0 }]) }, [e._v(\" \" + e._s(e.t(\"Continue\")) + \" \")])];\n  }, proxy: !0 }]) }, [t(\"div\", { staticClass: \"conflict-picker__header\" }, [t(\"p\", { staticClass: \"conflict-picker__description\", attrs: { id: \"conflict-picker-description\" } }, [e._v(\" \" + e._s(e.t(\"Which files do you want to keep?\"))), t(\"br\"), e._v(\" \" + e._s(e.t(\"If you select both versions, the copied file will have a number added to its name.\"))), t(\"br\"), e._v(\" \" + e._s(e.t(\"When an incoming folder is selected, any conflicting files within it will also be overwritten.\")) + \" \")])]), t(\"form\", { ref: \"form\", staticClass: \"conflict-picker__form\", attrs: { \"aria-labelledby\": \"conflict-picker-description\", \"data-cy-conflict-picker-form\": \"\" }, on: { submit: function(s) {\n    return s.preventDefault(), s.stopPropagation(), e.onSubmit.apply(null, arguments);\n  } } }, [t(\"fieldset\", { staticClass: \"conflict-picker__all\", attrs: { \"data-cy-conflict-picker-fieldset\": \"all\" } }, [t(\"legend\", { staticClass: \"hidden-visually\" }, [e._v(\" \" + e._s(e.t(\"Select all checkboxes\")) + \" \")]), t(\"NcCheckboxRadioSwitch\", e._b({ attrs: { \"data-cy-conflict-picker-input-incoming\": \"all\" }, on: { \"update:checked\": e.onSelectAllNew } }, \"NcCheckboxRadioSwitch\", e.selectAllNewBind, !1), [e._v(\" \" + e._s(e.t(\"Select all new files\")) + \" \")]), t(\"NcCheckboxRadioSwitch\", e._b({ attrs: { \"data-cy-conflict-picker-input-existing\": \"all\" }, on: { \"update:checked\": e.onSelectAllOld } }, \"NcCheckboxRadioSwitch\", e.selectAllOldBind, !1), [e._v(\" \" + e._s(e.t(\"Select all existing files\")) + \" \")])], 1), e._l(e.files, function(s, l) {\n    return t(\"NodesPicker\", { key: s.fileid, ref: \"nodesPicker\", refInFor: !0, attrs: { incoming: e.conflicts[l], existing: e.files[l], \"new-selected\": e.newSelected, \"old-selected\": e.oldSelected }, on: { \"update:newSelected\": function(n) {\n      e.newSelected = n;\n    }, \"update:new-selected\": function(n) {\n      e.newSelected = n;\n    }, \"update:oldSelected\": function(n) {\n      e.oldSelected = n;\n    }, \"update:old-selected\": function(n) {\n      e.oldSelected = n;\n    } } });\n  })], 2)]);\n}, K = [], Q = /* @__PURE__ */ o(\n  G,\n  J,\n  K,\n  !1,\n  null,\n  \"12c4204f\",\n  null,\n  null\n);\nconst ae = Q.exports;\nexport {\n  ae as default\n};\n"],"names":[],"sourceRoot":""}