{"version":3,"file":"node_modules_nextcloud_dialogs_dist_chunks_ConflictPicker-D11j2xek_mjs-node_modules_nextcloud_dialogs_dist_chunks_ConflictPicker-D11j2xek_mjs.js?v=a3486f5ddaa1fa6b24ee","mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;;;;;;;;;;;;;;;;;;;;ACtdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;;;;;;;;;;;;;;;;AC3DA;AAGA;AACA;;;;;;;;;;;;;;;;ACJA;AAGA;AACA;;;;;;;;;;;;;;;;ACJA;AAGA;AACA;;;;;;;;;;;;;;;;ACJA;AAGA;AACA","sources":["webpack:///nextcloud/node_modules/@nextcloud/dialogs/dist/chunks/ConflictPicker-D11j2xek.mjs","webpack:///nextcloud/node_modules/@nextcloud/dialogs/dist/chunks/preview-BIbJGxXF.mjs","webpack:///nextcloud/node_modules/@nextcloud/dialogs/node_modules/@nextcloud/vue/dist/components/NcButton/index.mjs","webpack:///nextcloud/node_modules/@nextcloud/dialogs/node_modules/@nextcloud/vue/dist/components/NcCheckboxRadioSwitch/index.mjs","webpack:///nextcloud/node_modules/@nextcloud/dialogs/node_modules/@nextcloud/vue/dist/components/NcDateTime/index.mjs","webpack:///nextcloud/node_modules/@nextcloud/dialogs/node_modules/@nextcloud/vue/dist/components/NcIconSvgWrapper/index.mjs"],"sourcesContent":["import { defineComponent, mergeModels, useModel, ref, computed, watch, createElementBlock, openBlock, normalizeClass, createElementVNode, createVNode, toDisplayString, unref, withCtx, createBlock, useTemplateRef, shallowRef, createTextVNode, Fragment, withModifiers, renderList, createCommentVNode } from \"vue\";\nimport { mdiFolder, mdiFile, mdiClose, mdiArrowRight } from \"@mdi/js\";\nimport NcButton from \"@nextcloud/vue/components/NcButton\";\nimport NcCheckboxRadioSwitch from \"@nextcloud/vue/components/NcCheckboxRadioSwitch\";\nimport NcDialog from \"@nextcloud/vue/components/NcDialog\";\nimport NcIconSvgWrapper from \"@nextcloud/vue/components/NcIconSvgWrapper\";\nimport { FileType } from \"@nextcloud/files\";\nimport NcDateTime from \"@nextcloud/vue/components/NcDateTime\";\nimport { g as getPreviewURL } from \"./preview-BIbJGxXF.mjs\";\nimport { t, n, l as logger, s as showError } from \"./index-hZPKu-D6.mjs\";\nimport { _ as _export_sfc } from \"./_plugin-vue_export-helper-1tPrXgE0.mjs\";\nconst _hoisted_1$1 = [\"src\"];\nconst _hoisted_2$1 = { key: 1 };\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = { key: 1 };\nconst PREVIEW_SIZE = 64;\nconst _sfc_main$1 = /* @__PURE__ */ defineComponent({\n  __name: \"ConflictPickerEntry\",\n  props: /* @__PURE__ */ mergeModels({\n    existing: {},\n    incoming: {}\n  }, {\n    \"existingSelected\": { type: Boolean, ...{ required: true } },\n    \"existingSelectedModifiers\": {},\n    \"incomingSelected\": { type: Boolean, ...{ required: true } },\n    \"incomingSelectedModifiers\": {}\n  }),\n  emits: [\"update:existingSelected\", \"update:incomingSelected\"],\n  setup(__props, { expose: __expose }) {\n    const existingSelected = useModel(__props, \"existingSelected\");\n    const incomingSelected = useModel(__props, \"incomingSelected\");\n    const props = __props;\n    __expose({ validate });\n    const isFileSystemEntry = (o) => \"FileSystemEntry\" in window && o instanceof window.FileSystemEntry;\n    const isFileSystemFileEntry = (o) => \"FileSystemFileEntry\" in window && o instanceof window.FileSystemFileEntry;\n    const validationMessage = ref(\"\");\n    const incomingPreview = ref();\n    const existingPreview = ref();\n    const incomingMTime = ref();\n    const existingMTime = ref();\n    const incomingSize = ref();\n    const existingSize = ref();\n    const conflictResolved = computed(() => incomingSelected.value || existingSelected.value);\n    const isExistingFolder = computed(() => props.existing.type === FileType.Folder);\n    const isIncomingFolder = computed(() => {\n      if (isFileSystemEntry(props.incoming)) {\n        return props.incoming.isDirectory;\n      } else if (props.incoming instanceof File) {\n        return false;\n      }\n      return props.incoming.type === FileType.Folder;\n    });\n    watch(() => props.existing, async () => {\n      existingMTime.value = getMTime(props.existing);\n      existingSize.value = getSize(props.existing);\n      existingPreview.value = await getPreview(props.existing);\n    });\n    watch(() => props.incoming, async () => {\n      const file = await getFileOrNode(props.incoming);\n      if (file === null) {\n        return;\n      }\n      incomingMTime.value = getMTime(file);\n      incomingSize.value = getSize(file);\n      incomingPreview.value = await getPreview(file);\n    });\n    async function getFileOrNode(input) {\n      if (isFileSystemFileEntry(input)) {\n        return await new Promise((resolve, reject) => input.file(resolve, reject));\n      } else if (isFileSystemEntry(input)) {\n        return null;\n      }\n      return input;\n    }\n    function getSize(input) {\n      return input.size;\n    }\n    function getMTime(input) {\n      if (input instanceof File) {\n        const mtime = input.lastModified;\n        if (mtime > 0) {\n          return new Date(mtime);\n        }\n      } else {\n        return input.mtime;\n      }\n    }\n    async function getPreview(input) {\n      if (input instanceof File) {\n        return await getFilePreview(input);\n      }\n      return getPreviewURL(input, { size: PREVIEW_SIZE })?.toString();\n    }\n    async function getFilePreview(file) {\n      if (!file.type.startsWith(\"image/\")) {\n        return void 0;\n      }\n      const { resolve, promise } = Promise.withResolvers();\n      const reader = new FileReader();\n      reader.onload = async (e) => {\n        const result = e?.target?.result;\n        if (result instanceof ArrayBuffer) {\n          const blob = new Blob([result], { type: file.type });\n          const url = URL.createObjectURL(blob);\n          resolve(url);\n          return;\n        }\n        resolve(void 0);\n      };\n      reader.readAsArrayBuffer(file);\n      return promise;\n    }\n    function validate() {\n      validationMessage.value = !incomingSelected.value && !existingSelected.value ? t(\"You need to choose at least one conflict solution\") : \"\";\n    }\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"fieldset\", {\n        class: normalizeClass(_ctx.$style.pickerEntry)\n      }, [\n        createElementVNode(\"legend\", null, toDisplayString(__props.existing.basename), 1),\n        createVNode(unref(NcCheckboxRadioSwitch), {\n          modelValue: incomingSelected.value,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => incomingSelected.value = $event),\n          error: !!validationMessage.value,\n          \"helper-text\": validationMessage.value,\n          required: !conflictResolved.value\n        }, {\n          default: withCtx(() => [\n            createElementVNode(\"span\", {\n              class: normalizeClass(_ctx.$style.pickerEntryItem)\n            }, [\n              !incomingPreview.value ? (openBlock(), createBlock(unref(NcIconSvgWrapper), {\n                key: 0,\n                class: normalizeClass([_ctx.$style.pickerEntryIcon, { [_ctx.$style.pickerEntryIcon_folder]: isExistingFolder.value }]),\n                path: isIncomingFolder.value ? unref(mdiFolder) : unref(mdiFile),\n                size: 48\n              }, null, 8, [\"class\", \"path\"])) : (openBlock(), createElementBlock(\"img\", {\n                key: 1,\n                class: normalizeClass(_ctx.$style.pickerEntryPreview),\n                src: incomingPreview.value,\n                alt: \"\",\n                loading: \"lazy\"\n              }, null, 10, _hoisted_1$1)),\n              createElementVNode(\"span\", {\n                class: normalizeClass(_ctx.$style.pickerEntryDescription)\n              }, [\n                createElementVNode(\"span\", null, toDisplayString(unref(t)(\"New version\")), 1),\n                incomingMTime.value ? (openBlock(), createBlock(unref(NcDateTime), {\n                  key: 0,\n                  timestamp: incomingMTime.value,\n                  \"relative-time\": false,\n                  format: { timeStyle: \"short\", dateStyle: \"medium\" }\n                }, null, 8, [\"timestamp\"])) : (openBlock(), createElementBlock(\"span\", _hoisted_2$1, toDisplayString(unref(t)(\"Last modified date unknown\")), 1)),\n                createElementVNode(\"span\", null, toDisplayString(incomingSize.value), 1)\n              ], 2)\n            ], 2)\n          ]),\n          _: 1\n        }, 8, [\"modelValue\", \"error\", \"helper-text\", \"required\"]),\n        createVNode(unref(NcCheckboxRadioSwitch), {\n          modelValue: existingSelected.value,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event) => existingSelected.value = $event),\n          error: !!validationMessage.value,\n          \"helper-text\": validationMessage.value,\n          required: !conflictResolved.value\n        }, {\n          default: withCtx(() => [\n            createElementVNode(\"span\", {\n              class: normalizeClass(_ctx.$style.pickerEntryItem)\n            }, [\n              !existingPreview.value ? (openBlock(), createBlock(unref(NcIconSvgWrapper), {\n                key: 0,\n                class: normalizeClass([_ctx.$style.pickerEntryIcon, { [_ctx.$style.pickerEntryIcon_folder]: isExistingFolder.value }]),\n                path: isExistingFolder.value ? unref(mdiFolder) : unref(mdiFile),\n                size: 48\n              }, null, 8, [\"class\", \"path\"])) : (openBlock(), createElementBlock(\"img\", {\n                key: 1,\n                class: normalizeClass(_ctx.$style.pickerEntryPreview),\n                src: existingPreview.value,\n                alt: \"\",\n                loading: \"lazy\"\n              }, null, 10, _hoisted_3)),\n              createElementVNode(\"span\", {\n                class: normalizeClass(_ctx.$style.pickerEntryDescription)\n              }, [\n                createElementVNode(\"span\", null, toDisplayString(unref(t)(\"Existing version\")), 1),\n                existingMTime.value ? (openBlock(), createBlock(unref(NcDateTime), {\n                  key: 0,\n                  timestamp: existingMTime.value,\n                  \"relative-time\": false,\n                  format: { timeStyle: \"short\", dateStyle: \"medium\" }\n                }, null, 8, [\"timestamp\"])) : (openBlock(), createElementBlock(\"span\", _hoisted_4, toDisplayString(unref(t)(\"Last modified date unknown\")), 1)),\n                createElementVNode(\"span\", null, toDisplayString(existingSize.value), 1)\n              ], 2)\n            ], 2)\n          ]),\n          _: 1\n        }, 8, [\"modelValue\", \"error\", \"helper-text\", \"required\"])\n      ], 2);\n    };\n  }\n});\nconst pickerEntry = \"_pickerEntry_xk2pl_1\";\nconst pickerEntryItem = \"_pickerEntryItem_xk2pl_5\";\nconst pickerEntryIcon = \"_pickerEntryIcon_xk2pl_11\";\nconst pickerEntryPreview = \"_pickerEntryPreview_xk2pl_12\";\nconst pickerEntryIcon_folder = \"_pickerEntryIcon_folder_xk2pl_24\";\nconst pickerEntryDescription = \"_pickerEntryDescription_xk2pl_34\";\nconst style0$1 = {\n  pickerEntry,\n  pickerEntryItem,\n  pickerEntryIcon,\n  pickerEntryPreview,\n  pickerEntryIcon_folder,\n  pickerEntryDescription\n};\nconst cssModules$1 = {\n  \"$style\": style0$1\n};\nconst ConflictPickerEntry = /* @__PURE__ */ _export_sfc(_sfc_main$1, [[\"__cssModules\", cssModules$1]]);\nconst _hoisted_1 = { class: \"hidden-visually\" };\nconst _hoisted_2 = {\n  key: 0,\n  class: \"hidden-visually\"\n};\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"ConflictPicker\",\n  props: {\n    container: {},\n    dirname: {},\n    existing: {},\n    incoming: {},\n    recursiveUpload: { type: Boolean }\n  },\n  emits: [\"close\"],\n  setup(__props, { emit: __emit }) {\n    const props = __props;\n    const emit = __emit;\n    const blockedTitle = t(\"You need to select at least one version of each file to continue.\");\n    const formElement = useTemplateRef(\"form\");\n    const conflictEntries = useTemplateRef(\"conflictEntry\");\n    const newSelected = shallowRef([]);\n    const oldSelected = shallowRef([]);\n    const isNoNewSelected = computed(() => newSelected.value.length === 0);\n    const areAllNewSelected = computed(() => newSelected.value.length === props.incoming.length);\n    const areSomeNewSelected = computed(() => !areAllNewSelected.value && !isNoNewSelected.value);\n    const areAllOldSelected = computed(() => oldSelected.value.length === props.existing.length);\n    const areSomeOldSelected = computed(() => !areAllOldSelected.value && !isNoNewSelected.value);\n    const areConflictsResolved = computed(() => {\n      for (const conflict of props.incoming) {\n        if (oldSelected.value.includes(conflict) || newSelected.value.includes(conflict)) {\n          continue;\n        }\n        return false;\n      }\n      return true;\n    });\n    const dialogName = computed(() => props.dirname?.trim() !== \"\" ? n(\"%n file conflict in {dirname}\", \"%n file conflicts in {dirname}\", props.incoming.length, { dirname: props.dirname }) : n(\"%n file conflict\", \"%n files conflict\", props.incoming.length));\n    function onCancel() {\n      emit(\"close\", null);\n    }\n    function onSkipAll() {\n      logger.debug(\"Conflict skipped. Ignoring all conflicting files\");\n      emit(\"close\", {\n        selected: [],\n        renamed: [],\n        skipped: [...props.incoming]\n      });\n    }\n    function onSelectAllNew(selected) {\n      if (selected) {\n        logger.debug(\"Selected all new files\");\n        newSelected.value = [...props.incoming];\n      } else {\n        logger.debug(\"Cleared new selection\");\n        newSelected.value = [];\n      }\n    }\n    function onSelectAllOld(selected) {\n      if (selected) {\n        logger.debug(\"Selected all existing files\");\n        oldSelected.value = [...props.incoming];\n      } else {\n        logger.debug(\"Cleared old selection\");\n        oldSelected.value = [];\n      }\n    }\n    function toggleOldSelected(conflict) {\n      if (oldSelected.value.includes(conflict)) {\n        oldSelected.value = oldSelected.value.filter((entry) => entry !== conflict);\n      } else {\n        oldSelected.value = [...oldSelected.value, conflict];\n      }\n    }\n    function toggleNewSelected(conflict) {\n      if (newSelected.value.includes(conflict)) {\n        newSelected.value = newSelected.value.filter((entry) => entry !== conflict);\n      } else {\n        newSelected.value = [...newSelected.value, conflict];\n      }\n    }\n    function onSubmit() {\n      if (!areConflictsResolved.value) {\n        for (const entry of conflictEntries.value) {\n          entry.validate();\n        }\n        formElement.value.reportValidity();\n        showError(blockedTitle);\n        return;\n      }\n      const selected = newSelected.value.filter((entry) => !oldSelected.value.includes(entry));\n      const renamed = newSelected.value.filter((entry) => oldSelected.value.includes(entry));\n      const skipped = oldSelected.value.filter((entry) => !newSelected.value.includes(entry));\n      emit(\"close\", {\n        renamed,\n        selected,\n        skipped\n      });\n    }\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(NcDialog), {\n        container: __props.container,\n        class: normalizeClass(_ctx.$style.picker),\n        name: dialogName.value,\n        size: \"large\",\n        onClosing: onCancel\n      }, {\n        actions: withCtx(() => [\n          createVNode(unref(NcButton), {\n            title: unref(t)(\"Cancel the entire operation\"),\n            \"data-cy-conflict-picker-cancel\": \"\",\n            variant: \"tertiary\",\n            onClick: onCancel\n          }, {\n            icon: withCtx(() => [\n              createVNode(unref(NcIconSvgWrapper), { path: unref(mdiClose) }, null, 8, [\"path\"])\n            ]),\n            default: withCtx(() => [\n              createTextVNode(\" \" + toDisplayString(unref(t)(\"Cancel\")), 1)\n            ]),\n            _: 1\n          }, 8, [\"title\"]),\n          createElementVNode(\"span\", {\n            class: normalizeClass(_ctx.$style.pickerActionSeparator)\n          }, null, 2),\n          createVNode(unref(NcButton), { onClick: onSkipAll }, {\n            icon: withCtx(() => [\n              createVNode(unref(NcIconSvgWrapper), { path: unref(mdiClose) }, null, 8, [\"path\"])\n            ]),\n            default: withCtx(() => [\n              createTextVNode(\" \" + toDisplayString(__props.incoming.length === 1 ? unref(t)(\"Skip this file\") : unref(n)(\"Skip %n file\", \"Skip %n files\", __props.incoming.length)), 1)\n            ]),\n            _: 1\n          }),\n          createVNode(unref(NcButton), {\n            \"aria-disabled\": !areConflictsResolved.value,\n            class: normalizeClass([\n              _ctx.$style.pickerActionSubmit,\n              {\n                [_ctx.$style.pickerActionSubmit_disabled]: !areConflictsResolved.value\n              }\n            ]),\n            title: areConflictsResolved.value ? \"\" : unref(blockedTitle),\n            type: \"submit\",\n            variant: \"primary\",\n            onClick: withModifiers(onSubmit, [\"stop\", \"prevent\"])\n          }, {\n            icon: withCtx(() => [\n              createVNode(unref(NcIconSvgWrapper), {\n                directional: \"\",\n                path: unref(mdiArrowRight)\n              }, null, 8, [\"path\"])\n            ]),\n            default: withCtx(() => [\n              createTextVNode(\" \" + toDisplayString(unref(t)(\"Continue\")) + \" \", 1),\n              !areConflictsResolved.value ? (openBlock(), createElementBlock(\"span\", _hoisted_2, toDisplayString(unref(blockedTitle)), 1)) : createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }, 8, [\"aria-disabled\", \"class\", \"title\"])\n        ]),\n        default: withCtx(() => [\n          createElementVNode(\"div\", {\n            class: normalizeClass(_ctx.$style.pickerHeader)\n          }, [\n            createElementVNode(\"p\", {\n              id: \"conflict-picker-description\",\n              class: normalizeClass(_ctx.$style.pickerDescription)\n            }, [\n              createTextVNode(toDisplayString(unref(t)(\"Which files do you want to keep?\")), 1),\n              _cache[0] || (_cache[0] = createElementVNode(\"br\", null, null, -1)),\n              createTextVNode(\" \" + toDisplayString(unref(t)(\"If you select both versions, the incoming file will have a number added to its name.\")), 1),\n              _cache[1] || (_cache[1] = createElementVNode(\"br\", null, null, -1)),\n              __props.recursiveUpload ? (openBlock(), createElementBlock(Fragment, { key: 0 }, [\n                createTextVNode(toDisplayString(unref(t)(\"When an incoming folder is selected, the content is written into the existing folder and a recursive conflict resolution is performed.\")), 1)\n              ], 64)) : (openBlock(), createElementBlock(Fragment, { key: 1 }, [\n                createTextVNode(toDisplayString(unref(t)(\"When an incoming folder is selected, any conflicting files within it will also be overwritten.\")), 1)\n              ], 64))\n            ], 2)\n          ], 2),\n          createElementVNode(\"form\", {\n            ref: \"form\",\n            \"aria-labelledby\": \"conflict-picker-description\",\n            class: normalizeClass(_ctx.$style.pickerForm),\n            onSubmit: withModifiers(onSubmit, [\"prevent\", \"stop\"])\n          }, [\n            createElementVNode(\"fieldset\", {\n              class: normalizeClass(_ctx.$style.pickerSelectAll)\n            }, [\n              createElementVNode(\"legend\", _hoisted_1, toDisplayString(unref(t)(\"Select all checkboxes\")), 1),\n              createVNode(unref(NcCheckboxRadioSwitch), {\n                \"model-value\": areAllNewSelected.value,\n                indeterminate: areSomeNewSelected.value,\n                \"onUpdate:modelValue\": onSelectAllNew\n              }, {\n                default: withCtx(() => [\n                  createTextVNode(toDisplayString(unref(t)(\"Select all new files\")), 1)\n                ]),\n                _: 1\n              }, 8, [\"model-value\", \"indeterminate\"]),\n              createVNode(unref(NcCheckboxRadioSwitch), {\n                \"model-value\": areAllOldSelected.value,\n                indeterminate: areSomeOldSelected.value,\n                \"onUpdate:modelValue\": onSelectAllOld\n              }, {\n                default: withCtx(() => [\n                  createTextVNode(toDisplayString(unref(t)(\"Select all existing files\")), 1)\n                ]),\n                _: 1\n              }, 8, [\"model-value\", \"indeterminate\"])\n            ], 2),\n            (openBlock(true), createElementBlock(Fragment, null, renderList(__props.existing, (node, index) => {\n              return openBlock(), createBlock(ConflictPickerEntry, {\n                ref_for: true,\n                ref: \"conflictEntry\",\n                key: node.fileid,\n                incoming: __props.incoming[index],\n                existing: node,\n                \"incoming-selected\": newSelected.value.includes(__props.incoming[index]),\n                \"existing-selected\": oldSelected.value.includes(__props.incoming[index]),\n                \"onUpdate:existingSelected\": ($event) => toggleOldSelected(__props.incoming[index]),\n                \"onUpdate:incomingSelected\": ($event) => toggleNewSelected(__props.incoming[index])\n              }, null, 8, [\"incoming\", \"existing\", \"incoming-selected\", \"existing-selected\", \"onUpdate:existingSelected\", \"onUpdate:incomingSelected\"]);\n            }), 128))\n          ], 34)\n        ]),\n        _: 1\n      }, 8, [\"container\", \"class\", \"name\"]);\n    };\n  }\n});\nconst picker = \"_picker_6q4ek_1\";\nconst pickerHeader = \"_pickerHeader_6q4ek_6\";\nconst pickerForm = \"_pickerForm_6q4ek_15\";\nconst pickerActionSubmit_disabled = \"_pickerActionSubmit_disabled_6q4ek_22\";\nconst pickerSelectAll = \"_pickerSelectAll_6q4ek_27\";\nconst style0 = {\n  picker,\n  pickerHeader,\n  pickerForm,\n  pickerActionSubmit_disabled,\n  pickerSelectAll,\n  \"conflict-picker__all\": \"_conflict-picker__all_6q4ek_40\"\n};\nconst cssModules = {\n  \"$style\": style0\n};\nconst ConflictPicker = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__cssModules\", cssModules]]);\nexport {\n  ConflictPicker as default\n};\n//# sourceMappingURL=ConflictPicker-D11j2xek.mjs.map\n","import { FileType } from \"@nextcloud/files\";\nimport { generateUrl } from \"@nextcloud/router\";\nimport { ref, watchEffect, toValue } from \"vue\";\nimport PQueue from \"p-queue\";\nconst queue = new PQueue({ concurrency: 5 });\nfunction preloadImage(url) {\n  const { resolve, promise } = Promise.withResolvers();\n  queue.add(() => {\n    const image = new Image();\n    image.onerror = () => resolve(false);\n    image.onload = () => resolve(true);\n    image.src = url;\n    return promise;\n  });\n  return promise;\n}\nfunction getPreviewURL(node, options = {}) {\n  options = { size: 32, cropPreview: false, mimeFallback: true, ...options };\n  try {\n    const previewUrl = node.attributes?.previewUrl || generateUrl(\"/core/preview?fileId={fileid}\", {\n      fileid: node.fileid\n    });\n    let url;\n    try {\n      url = new URL(previewUrl);\n    } catch {\n      url = new URL(previewUrl, window.location.origin);\n    }\n    url.searchParams.set(\"x\", `${options.size}`);\n    url.searchParams.set(\"y\", `${options.size}`);\n    url.searchParams.set(\"mimeFallback\", `${options.mimeFallback}`);\n    url.searchParams.set(\"a\", options.cropPreview === true ? \"0\" : \"1\");\n    url.searchParams.set(\"c\", `${node.attributes.etag}`);\n    return url;\n  } catch {\n    return null;\n  }\n}\nfunction usePreviewURL(node, options) {\n  const previewURL = ref(null);\n  const previewLoaded = ref(false);\n  watchEffect(() => {\n    previewLoaded.value = false;\n    previewURL.value = getPreviewURL(toValue(node), toValue(options || {}));\n    if (previewURL.value && toValue(node).type === FileType.File) {\n      preloadImage(previewURL.value.href).then((success) => {\n        previewLoaded.value = success;\n      });\n    }\n  });\n  return {\n    previewURL,\n    previewLoaded\n  };\n}\nexport {\n  getPreviewURL as g,\n  usePreviewURL as u\n};\n//# sourceMappingURL=preview-BIbJGxXF.mjs.map\n","import { N } from \"../../chunks/NcButton-DkC5k3Lb.mjs\";\nexport {\n  N as default\n};\n//# sourceMappingURL=index.mjs.map\n","import { N } from \"../../chunks/NcCheckboxRadioSwitch-BWumYbec.mjs\";\nexport {\n  N as default\n};\n//# sourceMappingURL=index.mjs.map\n","import { _ } from \"../../chunks/NcDateTime.vue_vue_type_script_setup_true_lang-BhB8yA4U.mjs\";\nexport {\n  _ as default\n};\n//# sourceMappingURL=index.mjs.map\n","import { N } from \"../../chunks/NcIconSvgWrapper-5AA93z-F.mjs\";\nexport {\n  N as default\n};\n//# sourceMappingURL=index.mjs.map\n"],"names":[],"ignoreList":[],"sourceRoot":""}