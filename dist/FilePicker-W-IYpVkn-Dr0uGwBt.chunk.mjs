import{f as Xe,v as b,o as g,c as B,x as G,e as $,p as qt,w as k,q as He,B as T,y as fe,g as be,t as x,s as ie,H as Re,F as oe,ah as It,a8 as pe,k as Ei,r as P,a6 as bi,a3 as _e,b as me,n as O,a7 as st,j as Qt,Y as Kt,z as Ie,u as w,l as _i,C as ke,m as wi,i as Nt,J as yi,A as Ti,a5 as Ii,K as Ni}from"./index-B3fM9XzM.chunk.mjs";import{u as Ai,s as Ci,g as Li,a as $e,b as Di,o as Ri,r as Oi,c as Si,p as ki,e as Fi}from"./string_decoder-CW7-7cc6.chunk.mjs";import{h as lt,Q as $i,R as A,N as Pi,S as ye,s as ct}from"./index-JpgrUA2Z-Bk1urlYU.chunk.mjs";import{N as At}from"./index-BdHmWgGI.chunk.mjs";import{B as je,g as Bi}from"./index-BMztHQmx.chunk.mjs";import{i as Ne,g as xi,j as Mi,C as Ui,D as Zt,h as Ce,s as Te,e as zi,f as Jt,l as ei,E as Gi,F as Vi,G as Xi,H as Hi,I as ji,J as Wi,K as Ct,y as Yi,c as qi}from"./mdi-C6koAnlx.chunk.mjs";import{_ as Pe,d as Qi,a as Ki,c as ut}from"./createElementId-DhjFt1I9-DYB7_VOD.chunk.mjs";import{a as Zi,u as Ji}from"./index-Bo08n8Cz.chunk.mjs";import{c as we,a as ti}from"./NcNoteCard-CVhtNL04-NCMYExJH.chunk.mjs";import{N as ii}from"./NcCheckboxRadioSwitch-BCSKF7Tk-DXNr2PG3.chunk.mjs";import{N as Lt,c as Dt,a as Rt,_ as er}from"./NcDateTime.vue_vue_type_script_setup_true_lang-BhB8yA4U-DJmI9Yye.chunk.mjs";import{S as Ot}from"./ShareType-suoNfd7y.chunk.mjs";import{P as tr,a as ir}from"./NcBreadcrumbs-DYfGaSjT-CltSOjzZ.chunk.mjs";import{c as ri}from"./index-Bis6vWHp.chunk.mjs";import{N as rr}from"./NcSelect-Czzsi3P_-j-TCAwKy.chunk.mjs";import{_ as ar}from"./TrashCanOutline-Dk8zzxc0.chunk.mjs";import"./PencilOutline-BIuFAr5N.chunk.mjs";import"./NcPasswordField-djttkA5Q-e7dmiHhR.chunk.mjs";import"./NcInputField-Bwsh2aHY-kFLkLvp0.chunk.mjs";const nr={name:"ChevronRightIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},sr=["aria-hidden","aria-label"],or=["fill","width","height"],lr={d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"},cr={key:0};function ur(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon chevron-right-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",lr,[i.title?(g(),b("title",cr,x(i.title),1)):G("",!0)])],8,or))],16,sr)}const dr=Pe(nr,[["render",ur]]),pr={name:"NcBreadcrumb",components:{NcActions:lt,ChevronRight:dr,NcButton:we},inheritAttrs:!1,props:{name:{type:String,required:!0},title:{type:String,default:null},to:{type:[String,Object],default:void 0},href:{type:String,default:void 0},icon:{type:String,default:""},forceIconText:{type:Boolean,default:!1},disableDrop:{type:Boolean,default:!1},forceMenu:{type:Boolean,default:!1},open:{type:Boolean,default:!1},class:{type:[String,Array,Object],default:""}},emits:["dragenter","dragleave","dropped","update:open"],setup(){const e=Qi();return{actionsContainer:`.vue-crumb[data-crumb-id="${e}"]`,crumbId:e}},data(){return{hovering:!1}},computed:{linkAttributes(){return this.to?{to:this.to,...this.$attrs}:this.href?{href:this.href,...this.$attrs}:this.$attrs}},methods:{onOpenChange(e){this.$emit("update:open",e)},dropped(e){return this.disableDrop||(this.$emit("dropped",e,this.to||this.href),this.$parent.$emit("dropped",e,this.to||this.href),this.hovering=!1),!1},dragEnter(e){this.$emit("dragenter",e),!this.disableDrop&&(this.hovering=!0)},dragLeave(e){this.$emit("dragleave",e),!this.disableDrop&&(e.target.contains(e.relatedTarget)||this.$refs.crumb.contains(e.relatedTarget)||(this.hovering=!1))}}},mr=["data-crumb-id"];function hr(e,r,i,n,c,m){const u=Xe("NcButton"),f=Xe("NcActions"),d=Xe("ChevronRight");return g(),b("li",{ref:"crumb",class:fe(["vue-crumb",[{"vue-crumb--hovered":c.hovering},e.$props.class]]),"data-crumb-id":n.crumbId,draggable:"false",onDragstart:Re(()=>{},["prevent"]),onDrop:r[0]||(r[0]=Re((...p)=>m.dropped&&m.dropped(...p),["prevent"])),onDragover:Re(()=>{},["prevent"]),onDragenter:r[1]||(r[1]=(...p)=>m.dragEnter&&m.dragEnter(...p)),onDragleave:r[2]||(r[2]=(...p)=>m.dragLeave&&m.dragLeave(...p))},[(i.name||i.icon||e.$slots.icon)&&!e.$slots.default?(g(),B(u,ie({key:0,"aria-label":i.icon?i.name:void 0,variant:"tertiary"},m.linkAttributes),qt({_:2},[e.$slots.icon||i.icon?{name:"icon",fn:k(()=>[He(e.$slots,"icon",{},()=>[T("span",{class:fe([i.icon,"icon"])},null,2)],!0)]),key:"0"}:void 0,!(e.$slots.icon||i.icon)||i.forceIconText?{name:"default",fn:k(()=>[be(x(i.name),1)]),key:"1"}:void 0]),1040,["aria-label"])):G("",!0),e.$slots.default?(g(),B(f,{key:1,ref:"actions",container:n.actionsContainer,"force-menu":i.forceMenu,"force-name":"","menu-name":i.name,open:i.open,title:i.title,variant:"tertiary","onUpdate:open":m.onOpenChange},{icon:k(()=>[He(e.$slots,"menu-icon",{},void 0,!0)]),default:k(()=>[He(e.$slots,"default",{},void 0,!0)]),_:3},8,["container","force-menu","menu-name","open","title","onUpdate:open"])):G("",!0),$(d,{class:"vue-crumb__separator",size:20})],42,mr)}const Fe=Pe(pr,[["render",hr],["__scopeId","data-v-28ef52a4"]]),fr={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},gr=["aria-hidden","aria-label"],vr=["fill","width","height"],Er={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},br={key:0};function _r(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon folder-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",Er,[i.title?(g(),b("title",br,x(i.title),1)):G("",!0)])],8,vr))],16,gr)}const St=Pe(fr,[["render",_r]]),Y="vue-crumb",wr={name:"NcBreadcrumbs",components:{NcActions:lt,NcActionButton:Rt,NcActionRouter:Dt,NcActionLink:Lt,NcBreadcrumb:Fe,IconFolder:St},props:{rootIcon:{type:String,default:"icon-home"},ariaLabel:{type:String,default:null}},emits:["dropped"],data(){return{hiddenIndices:[],menuBreadcrumbProps:{name:"",forceMenu:!0,disableDrop:!0,open:!1},breadcrumbsRefs:[]}},created(){window.addEventListener("resize",Ei(()=>{this.handleWindowResize()},100)),Ci("navigation-toggled",this.delayedResize)},mounted(){this.handleWindowResize()},updated(){this.delayedResize(),this.$nextTick(()=>{this.hideCrumbs()})},beforeUnmount(){window.removeEventListener("resize",this.handleWindowResize),Ai("navigation-toggled",this.delayedResize)},methods:{closeActions(e){this.$refs.actionsBreadcrumb.$el.contains(e.relatedTarget)||(this.menuBreadcrumbProps.open=!1)},async delayedResize(){await this.$nextTick(),this.handleWindowResize()},handleWindowResize(){if(!this.$refs.container)return;const e=this.breadcrumbsRefs.length,r=[],i=this.$refs.container.offsetWidth;let n=this.getTotalWidth();this.$refs.breadcrumb__actions&&(n+=this.$refs.breadcrumb__actions.offsetWidth);let c=n-i;c+=c>0?64:0;let m=0;const u=Math.floor(e/2);for(;c>0&&m<e-2;){const f=u+(m%2?m+1:m)/2*Math.pow(-1,m+e%2);c-=this.getWidth(this.breadcrumbsRefs[f]?.$el,f===this.breadcrumbsRefs.length-1),r.push(f),m++}this.arraysEqual(this.hiddenIndices,r.sort((f,d)=>f-d))||(this.hiddenIndices=r)},arraysEqual(e,r){if(e.length!==r.length)return!1;if(e===r)return!0;if(e===null||r===null)return!1;for(let i=0;i<e.length;++i)if(e[i]!==r[i])return!1;return!0},getTotalWidth(){return this.breadcrumbsRefs.reduce((e,r,i)=>e+this.getWidth(r.$el,i===this.breadcrumbsRefs.length-1),0)},getWidth(e,r){if(!e?.classList)return 0;const i=e.classList.contains(`${Y}--hidden`);e.style.minWidth="auto",r&&(e.style.maxWidth="210px"),e.classList.remove(`${Y}--hidden`);const n=e.offsetWidth;return i&&e.classList.add(`${Y}--hidden`),e.style.minWidth="",e.style.maxWidth="",n},preventDefault(e){return e.preventDefault&&e.preventDefault(),!1},dragStart(e){return this.preventDefault(e)},dropped(e,r,i){i||this.$emit("dropped",e,r),this.menuBreadcrumbProps.open=!1;const n=document.querySelectorAll(`.${Y}`);for(const c of n)c.classList.remove(`${Y}--hovered`);return this.preventDefault(e)},dragOver(e){return this.preventDefault(e)},dragEnter(e,r){if(!r&&e.target.closest){const i=e.target.closest(`.${Y}`);if(i.classList&&i.classList.contains(Y)){const n=document.querySelectorAll(`.${Y}`);for(const c of n)c.classList.remove(`${Y}--hovered`);i.classList.add(`${Y}--hovered`)}}},dragLeave(e,r){if(!r&&!e.target.contains(e.relatedTarget)&&e.target.closest){const i=e.target.closest(`.${Y}`);if(i.contains(e.relatedTarget))return;i.classList&&i.classList.contains(Y)&&i.classList.remove(`${Y}--hovered`)}},hideCrumbs(){this.breadcrumbsRefs.forEach((e,r)=>{e?.$el?.classList&&(this.hiddenIndices.includes(r)?e.$el.classList.add(`${Y}--hidden`):e.$el.classList.remove(`${Y}--hidden`))})},isBreadcrumb(e){return e?.type?.name==="NcBreadcrumb"}},render(){let e=[];if(this.$slots.default?.().forEach(c=>{if(this.isBreadcrumb(c)){e.push(c);return}c?.type===oe&&c?.children?.forEach?.(m=>{this.isBreadcrumb(m)&&e.push(m)})}),e.length===0)return;e[0]=It(e[0],{icon:this.rootIcon,ref:"breadcrumbs"});const r=[];e=e.map((c,m)=>It(c,{ref:u=>{r[m]=u}}));const i=[...e];this.hiddenIndices.length&&i.splice(Math.round(e.length/2),0,pe(Fe,{class:"dropdown",...this.menuBreadcrumbProps,"aria-hidden":!0,ref:"actionsBreadcrumb",key:"actions-breadcrumb-1",onDragenter:()=>{this.menuBreadcrumbProps.open=!0},onDragleave:this.closeActions,"onUpdate:open":c=>{this.menuBreadcrumbProps.open=c}},{default:()=>this.hiddenIndices.filter(c=>c<=e.length-1).map(c=>{const m=e[c],{to:u,href:f,disableDrop:d,name:p,...l}=m.props;delete l.ref;let v=Rt,E="";f&&(v=Lt,E=f),u&&(v=Dt,E=u);const I=pe(St,{size:20});return pe(v,{...l,class:Y,href:f||null,to:u||null,draggable:!1,onDragstart:this.dragStart,onDrop:V=>this.dropped(V,E,d),onDragover:this.dragOver,onDragenter:V=>this.dragEnter(V,d),onDragleave:V=>this.dragLeave(V,d)},{default:()=>p,icon:()=>I})})}));const n=[pe("nav",{"aria-label":this.ariaLabel},[pe("ul",{class:"breadcrumb__crumbs"},[i])])];return $i(this.$slots.actions?.())&&n.push(pe("div",{class:"breadcrumb__actions",ref:"breadcrumb__actions"},this.$slots.actions?.())),this.breadcrumbsRefs=r,pe("div",{class:["breadcrumb",{"breadcrumb--collapsed":this.hiddenIndices.length===e.length-2}],ref:"container"},n)}},yr=Pe(wr,[["__scopeId","data-v-af2b1226"]]);function ue(e,r,i){return r in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i,e}function kt(e,r,i){Tr(e,r),r.set(e,i)}function Tr(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j(e,r){var i=ai(e,r,"get");return Ir(e,i)}function Ir(e,r){return r.get?r.get.call(e):r.value}function Ft(e,r,i){var n=ai(e,r,"set");return Nr(e,n,i),i}function ai(e,r,i){if(!r.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return r.get(e)}function Nr(e,r,i){if(r.set)r.set.call(e,i);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=i}}var Ar=typeof Symbol<"u"?Symbol.toStringTag:"@@toStringTag",q=new WeakMap,ve=new WeakMap;class Be{constructor(r){var{executor:i=()=>{},internals:n=pt(),promise:c=new Promise((m,u)=>i(m,u,f=>{n.onCancelList.push(f)}))}=r;kt(this,q,{writable:!0,value:void 0}),kt(this,ve,{writable:!0,value:void 0}),ue(this,Ar,"CancelablePromise"),this.cancel=this.cancel.bind(this),Ft(this,q,n),Ft(this,ve,c||new Promise((m,u)=>i(m,u,f=>{n.onCancelList.push(f)})))}then(r,i){return Oe(j(this,ve).then(Le(r,j(this,q)),Le(i,j(this,q))),j(this,q))}catch(r){return Oe(j(this,ve).catch(Le(r,j(this,q))),j(this,q))}finally(r,i){return i&&j(this,q).onCancelList.push(r),Oe(j(this,ve).finally(Le(()=>{if(r)return i&&(j(this,q).onCancelList=j(this,q).onCancelList.filter(n=>n!==r)),r()},j(this,q))),j(this,q))}cancel(){j(this,q).isCanceled=!0;var r=j(this,q).onCancelList;j(this,q).onCancelList=[];for(var i of r)if(typeof i=="function")try{i()}catch(n){console.error(n)}}isCanceled(){return j(this,q).isCanceled===!0}}class re extends Be{constructor(r){super({executor:r})}}ue(re,"all",function(e){return De(e,Promise.all(e))}),ue(re,"allSettled",function(e){return De(e,Promise.allSettled(e))}),ue(re,"any",function(e){return De(e,Promise.any(e))}),ue(re,"race",function(e){return De(e,Promise.race(e))}),ue(re,"resolve",function(e){return $t(Promise.resolve(e))}),ue(re,"reject",function(e){return $t(Promise.reject(e))}),ue(re,"isCancelable",dt);function $t(e){return Oe(e,pt())}function dt(e){return e instanceof re||e instanceof Be}function Le(e,r){if(e)return i=>{if(!r.isCanceled){var n=e(i);return dt(n)&&r.onCancelList.push(n.cancel),n}return i}}function Oe(e,r){return new Be({internals:r,promise:e})}function De(e,r){var i=pt();return i.onCancelList.push(()=>{for(var n of e)dt(n)&&n.cancel()}),new Be({internals:i,promise:r})}function pt(){return{isCanceled:!1,onCancelList:[]}}const Cr=Li().setApp("@nextcloud/files").detectUser().build();var le=(e=>(e.Folder="folder",e.File="file",e))(le||{}),ee=(e=>(e[e.NONE=0]="NONE",e[e.CREATE=4]="CREATE",e[e.READ=1]="READ",e[e.UPDATE=2]="UPDATE",e[e.DELETE=8]="DELETE",e[e.SHARE=16]="SHARE",e[e.ALL=31]="ALL",e))(ee||{});const ni=function(e,r){return e.match(r)!==null},ce=(e,r)=>{if(e.id&&typeof e.id!="number")throw new Error("Invalid id type of value");if(!e.source)throw new Error("Missing mandatory source");try{new URL(e.source)}catch{throw new Error("Invalid source format, source must be a valid URL")}if(!e.source.startsWith("http"))throw new Error("Invalid source format, only http(s) is supported");if(e.displayname&&typeof e.displayname!="string")throw new Error("Invalid displayname type");if(e.mtime&&!(e.mtime instanceof Date))throw new Error("Invalid mtime type");if(e.crtime&&!(e.crtime instanceof Date))throw new Error("Invalid crtime type");if(!e.mime||typeof e.mime!="string"||!e.mime.match(/^[-\w.]+\/[-+\w.]+$/gi))throw new Error("Missing or invalid mandatory mime");if("size"in e&&typeof e.size!="number"&&e.size!==void 0)throw new Error("Invalid size type");if("permissions"in e&&e.permissions!==void 0&&!(typeof e.permissions=="number"&&e.permissions>=ee.NONE&&e.permissions<=ee.ALL))throw new Error("Invalid permissions");if(e.owner&&e.owner!==null&&typeof e.owner!="string")throw new Error("Invalid owner type");if(e.attributes&&typeof e.attributes!="object")throw new Error("Invalid attributes type");if(e.root&&typeof e.root!="string")throw new Error("Invalid root type");if(e.root&&!e.root.startsWith("/"))throw new Error("Root must start with a leading slash");if(e.root&&!e.source.includes(e.root))throw new Error("Root must be part of the source");if(e.root&&ni(e.source,r)){const i=e.source.match(r)[0];if(!e.source.includes(Te(i,e.root)))throw new Error("The root must be relative to the service. e.g /files/emma")}if(e.status&&!Object.values(mt).includes(e.status))throw new Error("Status must be a valid NodeStatus")};var mt=(e=>(e.NEW="new",e.FAILED="failed",e.LOADING="loading",e.LOCKED="locked",e))(mt||{});class xe{_data;_attributes;_knownDavService=/(remote|public)\.php\/(web)?dav/i;readonlyAttributes=Object.entries(Object.getOwnPropertyDescriptors(xe.prototype)).filter(r=>typeof r[1].get=="function"&&r[0]!=="__proto__").map(r=>r[0]);handler={set:(r,i,n)=>this.readonlyAttributes.includes(i)?!1:Reflect.set(r,i,n),deleteProperty:(r,i)=>this.readonlyAttributes.includes(i)?!1:Reflect.deleteProperty(r,i),get:(r,i,n)=>this.readonlyAttributes.includes(i)?(Cr.warn(`Accessing "Node.attributes.${i}" is deprecated, access it directly on the Node instance.`),Reflect.get(this,i)):Reflect.get(r,i,n)};constructor(r,i){r.mime||(r.mime="application/octet-stream"),ce(r,i||this._knownDavService),this._data={displayname:r.attributes?.displayname,...r,attributes:{}},this._attributes=new Proxy(this._data.attributes,this.handler),this.update(r.attributes??{}),i&&(this._knownDavService=i)}get source(){return this._data.source.replace(/\/$/i,"")}get encodedSource(){const{origin:r}=new URL(this.source);return r+Mi(this.source.slice(r.length))}get basename(){return Ui(this.source)}get displayname(){return this._data.displayname||this.basename}set displayname(r){ce({...this._data,displayname:r},this._knownDavService),this._data.displayname=r}get extension(){return Zt(this.source)}get dirname(){if(this.root){let i=this.source;this.isDavResource&&(i=i.split(this._knownDavService).pop());const n=i.indexOf(this.root),c=this.root.replace(/\/$/,"");return Ce(i.slice(n+c.length)||"/")}const r=new URL(this.source);return Ce(r.pathname)}get mime(){return this._data.mime||"application/octet-stream"}set mime(r){r??="application/octet-stream",ce({...this._data,mime:r},this._knownDavService),this._data.mime=r}get mtime(){return this._data.mtime}set mtime(r){ce({...this._data,mtime:r},this._knownDavService),this._data.mtime=r}get crtime(){return this._data.crtime}get size(){return this._data.size}set size(r){ce({...this._data,size:r},this._knownDavService),this.updateMtime(),this._data.size=r}get attributes(){return this._attributes}get permissions(){return this.owner===null&&!this.isDavResource?ee.READ:this._data.permissions!==void 0?this._data.permissions:ee.NONE}set permissions(r){ce({...this._data,permissions:r},this._knownDavService),this.updateMtime(),this._data.permissions=r}get owner(){return this.isDavResource?this._data.owner:null}get isDavResource(){return ni(this.source,this._knownDavService)}get isDavRessource(){return this.isDavResource}get root(){return this._data.root?this._data.root.replace(/^(.+)\/$/,"$1"):this.isDavResource&&Ce(this.source).split(this._knownDavService).pop()||null}get path(){if(this.root){let r=this.source;this.isDavResource&&(r=r.split(this._knownDavService).pop());const i=r.indexOf(this.root),n=this.root.replace(/\/$/,"");return r.slice(i+n.length)||"/"}return(this.dirname+"/"+this.basename).replace(/\/\//g,"/")}get fileid(){return this._data?.id}get status(){return this._data?.status}set status(r){ce({...this._data,status:r},this._knownDavService),this._data.status=r}get data(){return structuredClone(this._data)}move(r){ce({...this._data,source:r},this._knownDavService);const i=this.basename;this._data.source=r,this.displayname===i&&this.basename!==i&&(this.displayname=this.basename)}rename(r){if(r.includes("/"))throw new Error("Invalid basename");this.move(Ce(this.source)+"/"+r)}updateMtime(){this._data.mtime&&(this._data.mtime=new Date)}update(r){for(const[i,n]of Object.entries(r))try{n===void 0?delete this.attributes[i]:this.attributes[i]=n}catch(c){if(c instanceof TypeError)continue;throw c}}}class ht extends xe{get type(){return le.File}clone(){return new ht(this.data)}}class ft extends xe{constructor(r){super({...r,mime:"httpd/unix-directory"})}get type(){return le.Folder}get extension(){return null}get mime(){return"httpd/unix-directory"}clone(){return new ft(this.data)}}const Lr=function(e=""){let r=ee.NONE;return e&&((e.includes("C")||e.includes("K"))&&(r|=ee.CREATE),e.includes("G")&&(r|=ee.READ),(e.includes("W")||e.includes("N")||e.includes("V"))&&(r|=ee.UPDATE),e.includes("D")&&(r|=ee.DELETE),e.includes("R")&&(r|=ee.SHARE)),r},Dr=["d:getcontentlength","d:getcontenttype","d:getetag","d:getlastmodified","d:creationdate","d:displayname","d:quota-available-bytes","d:resourcetype","nc:has-preview","nc:is-encrypted","nc:mount-type","oc:comments-unread","oc:favorite","oc:fileid","oc:owner-display-name","oc:owner-id","oc:permissions","oc:size"],Rr={d:"DAV:",nc:"http://nextcloud.org/ns",oc:"http://owncloud.org/ns",ocs:"http://open-collaboration-services.org/ns"},gt=function(){return typeof window._nc_dav_properties>"u"&&(window._nc_dav_properties=[...Dr]),window._nc_dav_properties.map(e=>`<${e} />`).join(" ")},vt=function(){return typeof window._nc_dav_namespaces>"u"&&(window._nc_dav_namespaces={...Rr}),Object.keys(window._nc_dav_namespaces).map(e=>`xmlns:${e}="${window._nc_dav_namespaces?.[e]}"`).join(" ")},si=function(){return`<?xml version="1.0"?>
		<d:propfind ${vt()}>
			<d:prop>
				${gt()}
			</d:prop>
		</d:propfind>`},Or=function(){return`<?xml version="1.0"?>
		<oc:filter-files ${vt()}>
			<d:prop>
				${gt()}
			</d:prop>
			<oc:filter-rules>
				<oc:favorite>1</oc:favorite>
			</oc:filter-rules>
		</oc:filter-files>`},Sr=function(e){return`<?xml version="1.0" encoding="UTF-8"?>
<d:searchrequest ${vt()}
	xmlns:ns="https://github.com/icewind1991/SearchDAV/ns">
	<d:basicsearch>
		<d:select>
			<d:prop>
				${gt()}
			</d:prop>
		</d:select>
		<d:from>
			<d:scope>
				<d:href>/files/${$e()?.uid}/</d:href>
				<d:depth>infinity</d:depth>
			</d:scope>
		</d:from>
		<d:where>
			<d:and>
				<d:or>
					<d:not>
						<d:eq>
							<d:prop>
								<d:getcontenttype/>
							</d:prop>
							<d:literal>httpd/unix-directory</d:literal>
						</d:eq>
					</d:not>
					<d:eq>
						<d:prop>
							<oc:size/>
						</d:prop>
						<d:literal>0</d:literal>
					</d:eq>
				</d:or>
				<d:gt>
					<d:prop>
						<d:getlastmodified/>
					</d:prop>
					<d:literal>${e}</d:literal>
				</d:gt>
			</d:and>
		</d:where>
		<d:orderby>
			<d:order>
				<d:prop>
					<d:getlastmodified/>
				</d:prop>
				<d:descending/>
			</d:order>
		</d:orderby>
		<d:limit>
			<d:nresults>100</d:nresults>
			<ns:firstresult>0</ns:firstresult>
		</d:limit>
	</d:basicsearch>
</d:searchrequest>`};function kr(){return Ne()?`/files/${xi()}`:`/files/${$e()?.uid}`}const Ae=kr();function Fr(){const e=Ki("dav");return Ne()?e.replace("remote.php","public.php"):e}const oi=Fr(),$r=function(e=oi,r={}){const i=Zi(e,{headers:r});function n(c){i.setHeaders({...r,"X-Requested-With":"XMLHttpRequest",requesttoken:c??""})}return Ri(n),n(Di()),Ji().patch("fetch",(c,m)=>{const u=m.headers;return u?.method&&(m.method=u.method,delete u.method),fetch(c,m)}),i},Pr=(e,r="/",i=Ae)=>{const n=new AbortController;return new re(async(c,m,u)=>{u(()=>n.abort());try{const f=(await e.getDirectoryContents(`${i}${r}`,{signal:n.signal,details:!0,data:Or(),headers:{method:"REPORT"},includeSelf:!0})).data.filter(d=>d.filename!==r).map(d=>Me(d,i));c(f)}catch(f){m(f)}})},Me=function(e,r=Ae,i=oi){let n=$e()?.uid;if(Ne())n=n??"anonymous";else if(!n)throw new Error("No user id found");const c=e.props,m=Lr(c?.permissions),u=String(c?.["owner-id"]||n),f=c.fileid||0,d=new Date(Date.parse(e.lastmod)),p=new Date(Date.parse(c.creationdate)),l={id:f,source:`${i}${e.filename}`,mtime:!isNaN(d.getTime())&&d.getTime()!==0?d:void 0,crtime:!isNaN(p.getTime())&&p.getTime()!==0?p:void 0,mime:e.mime||"application/octet-stream",displayname:c.displayname!==void 0?String(c.displayname):void 0,size:c?.size||Number.parseInt(c.getcontentlength||"0"),status:f<0?mt.FAILED:void 0,permissions:m,owner:u,root:r,attributes:{...e,...c,hasPreview:c?.["has-preview"]}};return delete l.attributes?.props,e.type==="file"?new ht(l):new ft(l)};var Br=Oi();const xr=Si(Br);var We={},Pt,Bt;function li(){return Bt||(Bt=1,Pt=typeof ki=="object"&&We&&We.NODE_DEBUG&&/\bsemver\b/i.test(We.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{}),Pt}var Ye,xt;function ci(){if(xt)return Ye;xt=1;const e="2.0.0",r=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,n=16,c=r-6;return Ye={MAX_LENGTH:r,MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:c,MAX_SAFE_INTEGER:i,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:e,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},Ye}var qe={exports:{}},Mt;function Mr(){return Mt||(Mt=1,(function(e,r){const{MAX_SAFE_COMPONENT_LENGTH:i,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:c}=ci(),m=li();r=e.exports={};const u=r.re=[],f=r.safeRe=[],d=r.src=[],p=r.safeSrc=[],l=r.t={};let v=0;const E="[a-zA-Z0-9-]",I=[["\\s",1],["\\d",c],[E,n]],V=W=>{for(const[X,te]of I)W=W.split(`${X}*`).join(`${X}{0,${te}}`).split(`${X}+`).join(`${X}{1,${te}}`);return W},_=(W,X,te)=>{const J=V(X),C=v++;m(W,C,X),l[W]=C,d[C]=X,p[C]=J,u[C]=new RegExp(X,te?"g":void 0),f[C]=new RegExp(J,te?"g":void 0)};_("NUMERICIDENTIFIER","0|[1-9]\\d*"),_("NUMERICIDENTIFIERLOOSE","\\d+"),_("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${E}*`),_("MAINVERSION",`(${d[l.NUMERICIDENTIFIER]})\\.(${d[l.NUMERICIDENTIFIER]})\\.(${d[l.NUMERICIDENTIFIER]})`),_("MAINVERSIONLOOSE",`(${d[l.NUMERICIDENTIFIERLOOSE]})\\.(${d[l.NUMERICIDENTIFIERLOOSE]})\\.(${d[l.NUMERICIDENTIFIERLOOSE]})`),_("PRERELEASEIDENTIFIER",`(?:${d[l.NONNUMERICIDENTIFIER]}|${d[l.NUMERICIDENTIFIER]})`),_("PRERELEASEIDENTIFIERLOOSE",`(?:${d[l.NONNUMERICIDENTIFIER]}|${d[l.NUMERICIDENTIFIERLOOSE]})`),_("PRERELEASE",`(?:-(${d[l.PRERELEASEIDENTIFIER]}(?:\\.${d[l.PRERELEASEIDENTIFIER]})*))`),_("PRERELEASELOOSE",`(?:-?(${d[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${d[l.PRERELEASEIDENTIFIERLOOSE]})*))`),_("BUILDIDENTIFIER",`${E}+`),_("BUILD",`(?:\\+(${d[l.BUILDIDENTIFIER]}(?:\\.${d[l.BUILDIDENTIFIER]})*))`),_("FULLPLAIN",`v?${d[l.MAINVERSION]}${d[l.PRERELEASE]}?${d[l.BUILD]}?`),_("FULL",`^${d[l.FULLPLAIN]}$`),_("LOOSEPLAIN",`[v=\\s]*${d[l.MAINVERSIONLOOSE]}${d[l.PRERELEASELOOSE]}?${d[l.BUILD]}?`),_("LOOSE",`^${d[l.LOOSEPLAIN]}$`),_("GTLT","((?:<|>)?=?)"),_("XRANGEIDENTIFIERLOOSE",`${d[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),_("XRANGEIDENTIFIER",`${d[l.NUMERICIDENTIFIER]}|x|X|\\*`),_("XRANGEPLAIN",`[v=\\s]*(${d[l.XRANGEIDENTIFIER]})(?:\\.(${d[l.XRANGEIDENTIFIER]})(?:\\.(${d[l.XRANGEIDENTIFIER]})(?:${d[l.PRERELEASE]})?${d[l.BUILD]}?)?)?`),_("XRANGEPLAINLOOSE",`[v=\\s]*(${d[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${d[l.XRANGEIDENTIFIERLOOSE]})(?:${d[l.PRERELEASELOOSE]})?${d[l.BUILD]}?)?)?`),_("XRANGE",`^${d[l.GTLT]}\\s*${d[l.XRANGEPLAIN]}$`),_("XRANGELOOSE",`^${d[l.GTLT]}\\s*${d[l.XRANGEPLAINLOOSE]}$`),_("COERCEPLAIN",`(^|[^\\d])(\\d{1,${i}})(?:\\.(\\d{1,${i}}))?(?:\\.(\\d{1,${i}}))?`),_("COERCE",`${d[l.COERCEPLAIN]}(?:$|[^\\d])`),_("COERCEFULL",d[l.COERCEPLAIN]+`(?:${d[l.PRERELEASE]})?(?:${d[l.BUILD]})?(?:$|[^\\d])`),_("COERCERTL",d[l.COERCE],!0),_("COERCERTLFULL",d[l.COERCEFULL],!0),_("LONETILDE","(?:~>?)"),_("TILDETRIM",`(\\s*)${d[l.LONETILDE]}\\s+`,!0),r.tildeTrimReplace="$1~",_("TILDE",`^${d[l.LONETILDE]}${d[l.XRANGEPLAIN]}$`),_("TILDELOOSE",`^${d[l.LONETILDE]}${d[l.XRANGEPLAINLOOSE]}$`),_("LONECARET","(?:\\^)"),_("CARETTRIM",`(\\s*)${d[l.LONECARET]}\\s+`,!0),r.caretTrimReplace="$1^",_("CARET",`^${d[l.LONECARET]}${d[l.XRANGEPLAIN]}$`),_("CARETLOOSE",`^${d[l.LONECARET]}${d[l.XRANGEPLAINLOOSE]}$`),_("COMPARATORLOOSE",`^${d[l.GTLT]}\\s*(${d[l.LOOSEPLAIN]})$|^$`),_("COMPARATOR",`^${d[l.GTLT]}\\s*(${d[l.FULLPLAIN]})$|^$`),_("COMPARATORTRIM",`(\\s*)${d[l.GTLT]}\\s*(${d[l.LOOSEPLAIN]}|${d[l.XRANGEPLAIN]})`,!0),r.comparatorTrimReplace="$1$2$3",_("HYPHENRANGE",`^\\s*(${d[l.XRANGEPLAIN]})\\s+-\\s+(${d[l.XRANGEPLAIN]})\\s*$`),_("HYPHENRANGELOOSE",`^\\s*(${d[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${d[l.XRANGEPLAINLOOSE]})\\s*$`),_("STAR","(<|>)?=?\\s*\\*"),_("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),_("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(qe,qe.exports)),qe.exports}var Qe,Ut;function Ur(){if(Ut)return Qe;Ut=1;const e=Object.freeze({loose:!0}),r=Object.freeze({});return Qe=i=>i?typeof i!="object"?e:i:r,Qe}var Ke,zt;function zr(){if(zt)return Ke;zt=1;const e=/^[0-9]+$/,r=(i,n)=>{if(typeof i=="number"&&typeof n=="number")return i===n?0:i<n?-1:1;const c=e.test(i),m=e.test(n);return c&&m&&(i=+i,n=+n),i===n?0:c&&!m?-1:m&&!c?1:i<n?-1:1};return Ke={compareIdentifiers:r,rcompareIdentifiers:(i,n)=>r(n,i)},Ke}var Ze,Gt;function ui(){if(Gt)return Ze;Gt=1;const e=li(),{MAX_LENGTH:r,MAX_SAFE_INTEGER:i}=ci(),{safeRe:n,t:c}=Mr(),m=Ur(),{compareIdentifiers:u}=zr();class f{constructor(p,l){if(l=m(l),p instanceof f){if(p.loose===!!l.loose&&p.includePrerelease===!!l.includePrerelease)return p;p=p.version}else if(typeof p!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof p}".`);if(p.length>r)throw new TypeError(`version is longer than ${r} characters`);e("SemVer",p,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;const v=p.trim().match(l.loose?n[c.LOOSE]:n[c.FULL]);if(!v)throw new TypeError(`Invalid Version: ${p}`);if(this.raw=p,this.major=+v[1],this.minor=+v[2],this.patch=+v[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");v[4]?this.prerelease=v[4].split(".").map(E=>{if(/^[0-9]+$/.test(E)){const I=+E;if(I>=0&&I<i)return I}return E}):this.prerelease=[],this.build=v[5]?v[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(p){if(e("SemVer.compare",this.version,this.options,p),!(p instanceof f)){if(typeof p=="string"&&p===this.version)return 0;p=new f(p,this.options)}return p.version===this.version?0:this.compareMain(p)||this.comparePre(p)}compareMain(p){return p instanceof f||(p=new f(p,this.options)),this.major<p.major?-1:this.major>p.major?1:this.minor<p.minor?-1:this.minor>p.minor?1:this.patch<p.patch?-1:this.patch>p.patch?1:0}comparePre(p){if(p instanceof f||(p=new f(p,this.options)),this.prerelease.length&&!p.prerelease.length)return-1;if(!this.prerelease.length&&p.prerelease.length)return 1;if(!this.prerelease.length&&!p.prerelease.length)return 0;let l=0;do{const v=this.prerelease[l],E=p.prerelease[l];if(e("prerelease compare",l,v,E),v===void 0&&E===void 0)return 0;if(E===void 0)return 1;if(v===void 0)return-1;if(v!==E)return u(v,E)}while(++l)}compareBuild(p){p instanceof f||(p=new f(p,this.options));let l=0;do{const v=this.build[l],E=p.build[l];if(e("build compare",l,v,E),v===void 0&&E===void 0)return 0;if(E===void 0)return 1;if(v===void 0)return-1;if(v!==E)return u(v,E)}while(++l)}inc(p,l,v){if(p.startsWith("pre")){if(!l&&v===!1)throw new Error("invalid increment argument: identifier is empty");if(l){const E=`-${l}`.match(this.options.loose?n[c.PRERELEASELOOSE]:n[c.PRERELEASE]);if(!E||E[1]!==l)throw new Error(`invalid identifier: ${l}`)}}switch(p){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",l,v);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",l,v);break;case"prepatch":this.prerelease.length=0,this.inc("patch",l,v),this.inc("pre",l,v);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",l,v),this.inc("pre",l,v);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const E=Number(v)?1:0;if(this.prerelease.length===0)this.prerelease=[E];else{let I=this.prerelease.length;for(;--I>=0;)typeof this.prerelease[I]=="number"&&(this.prerelease[I]++,I=-2);if(I===-1){if(l===this.prerelease.join(".")&&v===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(E)}}if(l){let I=[l,E];v===!1&&(I=[l]),u(this.prerelease[0],l)===0?isNaN(this.prerelease[1])&&(this.prerelease=I):this.prerelease=I}break}default:throw new Error(`invalid increment argument: ${p}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return Ze=f,Ze}var Je,Vt;function Gr(){if(Vt)return Je;Vt=1;const e=ui();return Je=(r,i)=>new e(r,i).major,Je}Gr();var et,Xt;function Vr(){if(Xt)return et;Xt=1;const e=ui();return et=(r,i,n=!1)=>{if(r instanceof e)return r;try{return new e(r,i)}catch(c){if(!n)return null;throw c}},et}var tt,Ht;function Xr(){if(Ht)return tt;Ht=1;const e=Vr();return tt=(r,i)=>{const n=e(r,i);return n?n.version:null},tt}Xr();var jt={},Wt;function Hr(){return Wt||(Wt=1,(function(e){(function(r){r.parser=function(a,t){return new n(a,t)},r.SAXParser=n,r.SAXStream=l,r.createStream=p,r.MAX_BUFFER_LENGTH=64*1024;var i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(a,t){if(!(this instanceof n))return new n(a,t);var h=this;m(h),h.q=h.c="",h.bufferCheckPosition=r.MAX_BUFFER_LENGTH,h.opt=t||{},h.opt.lowercase=h.opt.lowercase||h.opt.lowercasetags,h.looseCase=h.opt.lowercase?"toLowerCase":"toUpperCase",h.tags=[],h.closed=h.closedRoot=h.sawRoot=!1,h.tag=h.error=null,h.strict=!!a,h.noscript=!!(a||h.opt.noscript),h.state=o.BEGIN,h.strictEntities=h.opt.strictEntities,h.ENTITIES=h.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),h.attribList=[],h.opt.xmlns&&(h.ns=Object.create(_)),h.opt.unquotedAttributeValues===void 0&&(h.opt.unquotedAttributeValues=!a),h.trackPosition=h.opt.position!==!1,h.trackPosition&&(h.position=h.line=h.column=0),y(h,"onready")}Object.create||(Object.create=function(a){function t(){}t.prototype=a;var h=new t;return h}),Object.keys||(Object.keys=function(a){var t=[];for(var h in a)a.hasOwnProperty(h)&&t.push(h);return t});function c(a){for(var t=Math.max(r.MAX_BUFFER_LENGTH,10),h=0,s=0,L=i.length;s<L;s++){var U=a[i[s]].length;if(U>t)switch(i[s]){case"textNode":ne(a);break;case"cdata":N(a,"oncdata",a.cdata),a.cdata="";break;case"script":N(a,"onscript",a.script),a.script="";break;default:ge(a,"Max buffer length exceeded: "+i[s])}h=Math.max(h,U)}var z=r.MAX_BUFFER_LENGTH-h;a.bufferCheckPosition=z+a.position}function m(a){for(var t=0,h=i.length;t<h;t++)a[i[t]]=""}function u(a){ne(a),a.cdata!==""&&(N(a,"oncdata",a.cdata),a.cdata=""),a.script!==""&&(N(a,"onscript",a.script),a.script="")}n.prototype={end:function(){bt(this)},write:gi,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){u(this)}};var f;try{f=require("stream").Stream}catch{f=function(){}}f||(f=function(){});var d=r.EVENTS.filter(function(a){return a!=="error"&&a!=="end"});function p(a,t){return new l(a,t)}function l(a,t){if(!(this instanceof l))return new l(a,t);f.apply(this),this._parser=new n(a,t),this.writable=!0,this.readable=!0;var h=this;this._parser.onend=function(){h.emit("end")},this._parser.onerror=function(s){h.emit("error",s),h._parser.error=null},this._decoder=null,d.forEach(function(s){Object.defineProperty(h,"on"+s,{get:function(){return h._parser["on"+s]},set:function(L){if(!L)return h.removeAllListeners(s),h._parser["on"+s]=L,L;h.on(s,L)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(f.prototype,{constructor:{value:l}}),l.prototype.write=function(a){if(typeof je=="function"&&typeof je.isBuffer=="function"&&je.isBuffer(a)){if(!this._decoder){var t=xr.StringDecoder;this._decoder=new t("utf8")}a=this._decoder.write(a)}return this._parser.write(a.toString()),this.emit("data",a),!0},l.prototype.end=function(a){return a&&a.length&&this.write(a),this._parser.end(),!0},l.prototype.on=function(a,t){var h=this;return!h._parser["on"+a]&&d.indexOf(a)!==-1&&(h._parser["on"+a]=function(){var s=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);s.splice(0,0,a),h.emit.apply(h,s)}),f.prototype.on.call(h,a,t)};var v="[CDATA[",E="DOCTYPE",I="http://www.w3.org/XML/1998/namespace",V="http://www.w3.org/2000/xmlns/",_={xml:I,xmlns:V},W=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,X=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,te=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,J=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function C(a){return a===" "||a===`
`||a==="\r"||a==="	"}function F(a){return a==='"'||a==="'"}function M(a){return a===">"||C(a)}function D(a,t){return a.test(t)}function ae(a,t){return!D(a,t)}var o=0;r.STATE={BEGIN:o++,BEGIN_WHITESPACE:o++,TEXT:o++,TEXT_ENTITY:o++,OPEN_WAKA:o++,SGML_DECL:o++,SGML_DECL_QUOTED:o++,DOCTYPE:o++,DOCTYPE_QUOTED:o++,DOCTYPE_DTD:o++,DOCTYPE_DTD_QUOTED:o++,COMMENT_STARTING:o++,COMMENT:o++,COMMENT_ENDING:o++,COMMENT_ENDED:o++,CDATA:o++,CDATA_ENDING:o++,CDATA_ENDING_2:o++,PROC_INST:o++,PROC_INST_BODY:o++,PROC_INST_ENDING:o++,OPEN_TAG:o++,OPEN_TAG_SLASH:o++,ATTRIB:o++,ATTRIB_NAME:o++,ATTRIB_NAME_SAW_WHITE:o++,ATTRIB_VALUE:o++,ATTRIB_VALUE_QUOTED:o++,ATTRIB_VALUE_CLOSED:o++,ATTRIB_VALUE_UNQUOTED:o++,ATTRIB_VALUE_ENTITY_Q:o++,ATTRIB_VALUE_ENTITY_U:o++,CLOSE_TAG:o++,CLOSE_TAG_SAW_WHITE:o++,SCRIPT:o++,SCRIPT_ENDING:o++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(a){var t=r.ENTITIES[a],h=typeof t=="number"?String.fromCharCode(t):t;r.ENTITIES[a]=h});for(var S in r.STATE)r.STATE[r.STATE[S]]=S;o=r.STATE;function y(a,t,h){a[t]&&a[t](h)}function N(a,t,h){a.textNode&&ne(a),y(a,t,h)}function ne(a){a.textNode=Et(a.opt,a.textNode),a.textNode&&y(a,"ontext",a.textNode),a.textNode=""}function Et(a,t){return a.trim&&(t=t.trim()),a.normalize&&(t=t.replace(/\s+/g," ")),t}function ge(a,t){return ne(a),a.trackPosition&&(t+=`
Line: `+a.line+`
Column: `+a.column+`
Char: `+a.c),t=new Error(t),a.error=t,y(a,"onerror",t),a}function bt(a){return a.sawRoot&&!a.closedRoot&&R(a,"Unclosed root tag"),a.state!==o.BEGIN&&a.state!==o.BEGIN_WHITESPACE&&a.state!==o.TEXT&&ge(a,"Unexpected end"),ne(a),a.c="",a.closed=!0,y(a,"onend"),n.call(a,a.strict,a.opt),a}function R(a,t){if(typeof a!="object"||!(a instanceof n))throw new Error("bad call to strictFail");a.strict&&ge(a,t)}function hi(a){a.strict||(a.tagName=a.tagName[a.looseCase]());var t=a.tags[a.tags.length-1]||a,h=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(h.ns=t.ns),a.attribList.length=0,N(a,"onopentagstart",h)}function Ue(a,t){var h=a.indexOf(":"),s=h<0?["",a]:a.split(":"),L=s[0],U=s[1];return t&&a==="xmlns"&&(L="xmlns",U=""),{prefix:L,local:U}}function ze(a){if(a.strict||(a.attribName=a.attribName[a.looseCase]()),a.attribList.indexOf(a.attribName)!==-1||a.tag.attributes.hasOwnProperty(a.attribName)){a.attribName=a.attribValue="";return}if(a.opt.xmlns){var t=Ue(a.attribName,!0),h=t.prefix,s=t.local;if(h==="xmlns")if(s==="xml"&&a.attribValue!==I)R(a,"xml: prefix must be bound to "+I+`
Actual: `+a.attribValue);else if(s==="xmlns"&&a.attribValue!==V)R(a,"xmlns: prefix must be bound to "+V+`
Actual: `+a.attribValue);else{var L=a.tag,U=a.tags[a.tags.length-1]||a;L.ns===U.ns&&(L.ns=Object.create(U.ns)),L.ns[s]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,N(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function de(a,t){if(a.opt.xmlns){var h=a.tag,s=Ue(a.tagName);h.prefix=s.prefix,h.local=s.local,h.uri=h.ns[s.prefix]||"",h.prefix&&!h.uri&&(R(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName)),h.uri=s.prefix);var L=a.tags[a.tags.length-1]||a;h.ns&&L.ns!==h.ns&&Object.keys(h.ns).forEach(function(Tt){N(a,"onopennamespace",{prefix:Tt,uri:h.ns[Tt]})});for(var U=0,z=a.attribList.length;U<z;U++){var Q=a.attribList[U],K=Q[0],he=Q[1],H=Ue(K,!0),se=H.prefix,vi=H.local,yt=se===""?"":h.ns[se]||"",Ve={name:K,value:he,prefix:se,local:vi,uri:yt};se&&se!=="xmlns"&&!yt&&(R(a,"Unbound namespace prefix: "+JSON.stringify(se)),Ve.uri=se),a.tag.attributes[K]=Ve,N(a,"onattribute",Ve)}a.attribList.length=0}a.tag.isSelfClosing=!!t,a.sawRoot=!0,a.tags.push(a.tag),N(a,"onopentag",a.tag),t||(!a.noscript&&a.tagName.toLowerCase()==="script"?a.state=o.SCRIPT:a.state=o.TEXT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function Ge(a){if(!a.tagName){R(a,"Weird empty close tag."),a.textNode+="</>",a.state=o.TEXT;return}if(a.script){if(a.tagName!=="script"){a.script+="</"+a.tagName+">",a.tagName="",a.state=o.SCRIPT;return}N(a,"onscript",a.script),a.script=""}var t=a.tags.length,h=a.tagName;a.strict||(h=h[a.looseCase]());for(var s=h;t--;){var L=a.tags[t];if(L.name!==s)R(a,"Unexpected close tag");else break}if(t<0){R(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",a.state=o.TEXT;return}a.tagName=h;for(var U=a.tags.length;U-- >t;){var z=a.tag=a.tags.pop();a.tagName=a.tag.name,N(a,"onclosetag",a.tagName);var Q={};for(var K in z.ns)Q[K]=z.ns[K];var he=a.tags[a.tags.length-1]||a;a.opt.xmlns&&z.ns!==he.ns&&Object.keys(z.ns).forEach(function(H){var se=z.ns[H];N(a,"onclosenamespace",{prefix:H,uri:se})})}t===0&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=o.TEXT}function fi(a){var t=a.entity,h=t.toLowerCase(),s,L="";return a.ENTITIES[t]?a.ENTITIES[t]:a.ENTITIES[h]?a.ENTITIES[h]:(t=h,t.charAt(0)==="#"&&(t.charAt(1)==="x"?(t=t.slice(2),s=parseInt(t,16),L=s.toString(16)):(t=t.slice(1),s=parseInt(t,10),L=s.toString(10))),t=t.replace(/^0+/,""),isNaN(s)||L.toLowerCase()!==t?(R(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCodePoint(s))}function _t(a,t){t==="<"?(a.state=o.OPEN_WAKA,a.startTagPosition=a.position):C(t)||(R(a,"Non-whitespace before first tag."),a.textNode=t,a.state=o.TEXT)}function wt(a,t){var h="";return t<a.length&&(h=a.charAt(t)),h}function gi(a){var t=this;if(this.error)throw this.error;if(t.closed)return ge(t,"Cannot write after close. Assign an onready handler.");if(a===null)return bt(t);typeof a=="object"&&(a=a.toString());for(var h=0,s="";s=wt(a,h++),t.c=s,!!s;)switch(t.trackPosition&&(t.position++,s===`
`?(t.line++,t.column=0):t.column++),t.state){case o.BEGIN:if(t.state=o.BEGIN_WHITESPACE,s==="\uFEFF")continue;_t(t,s);continue;case o.BEGIN_WHITESPACE:_t(t,s);continue;case o.TEXT:if(t.sawRoot&&!t.closedRoot){for(var L=h-1;s&&s!=="<"&&s!=="&";)s=wt(a,h++),s&&t.trackPosition&&(t.position++,s===`
`?(t.line++,t.column=0):t.column++);t.textNode+=a.substring(L,h-1)}s==="<"&&!(t.sawRoot&&t.closedRoot&&!t.strict)?(t.state=o.OPEN_WAKA,t.startTagPosition=t.position):(!C(s)&&(!t.sawRoot||t.closedRoot)&&R(t,"Text data outside of root node."),s==="&"?t.state=o.TEXT_ENTITY:t.textNode+=s);continue;case o.SCRIPT:s==="<"?t.state=o.SCRIPT_ENDING:t.script+=s;continue;case o.SCRIPT_ENDING:s==="/"?t.state=o.CLOSE_TAG:(t.script+="<"+s,t.state=o.SCRIPT);continue;case o.OPEN_WAKA:if(s==="!")t.state=o.SGML_DECL,t.sgmlDecl="";else if(!C(s))if(D(W,s))t.state=o.OPEN_TAG,t.tagName=s;else if(s==="/")t.state=o.CLOSE_TAG,t.tagName="";else if(s==="?")t.state=o.PROC_INST,t.procInstName=t.procInstBody="";else{if(R(t,"Unencoded <"),t.startTagPosition+1<t.position){var U=t.position-t.startTagPosition;s=new Array(U).join(" ")+s}t.textNode+="<"+s,t.state=o.TEXT}continue;case o.SGML_DECL:if(t.sgmlDecl+s==="--"){t.state=o.COMMENT,t.comment="",t.sgmlDecl="";continue}t.doctype&&t.doctype!==!0&&t.sgmlDecl?(t.state=o.DOCTYPE_DTD,t.doctype+="<!"+t.sgmlDecl+s,t.sgmlDecl=""):(t.sgmlDecl+s).toUpperCase()===v?(N(t,"onopencdata"),t.state=o.CDATA,t.sgmlDecl="",t.cdata=""):(t.sgmlDecl+s).toUpperCase()===E?(t.state=o.DOCTYPE,(t.doctype||t.sawRoot)&&R(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):s===">"?(N(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=o.TEXT):(F(s)&&(t.state=o.SGML_DECL_QUOTED),t.sgmlDecl+=s);continue;case o.SGML_DECL_QUOTED:s===t.q&&(t.state=o.SGML_DECL,t.q=""),t.sgmlDecl+=s;continue;case o.DOCTYPE:s===">"?(t.state=o.TEXT,N(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=s,s==="["?t.state=o.DOCTYPE_DTD:F(s)&&(t.state=o.DOCTYPE_QUOTED,t.q=s));continue;case o.DOCTYPE_QUOTED:t.doctype+=s,s===t.q&&(t.q="",t.state=o.DOCTYPE);continue;case o.DOCTYPE_DTD:s==="]"?(t.doctype+=s,t.state=o.DOCTYPE):s==="<"?(t.state=o.OPEN_WAKA,t.startTagPosition=t.position):F(s)?(t.doctype+=s,t.state=o.DOCTYPE_DTD_QUOTED,t.q=s):t.doctype+=s;continue;case o.DOCTYPE_DTD_QUOTED:t.doctype+=s,s===t.q&&(t.state=o.DOCTYPE_DTD,t.q="");continue;case o.COMMENT:s==="-"?t.state=o.COMMENT_ENDING:t.comment+=s;continue;case o.COMMENT_ENDING:s==="-"?(t.state=o.COMMENT_ENDED,t.comment=Et(t.opt,t.comment),t.comment&&N(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+s,t.state=o.COMMENT);continue;case o.COMMENT_ENDED:s!==">"?(R(t,"Malformed comment"),t.comment+="--"+s,t.state=o.COMMENT):t.doctype&&t.doctype!==!0?t.state=o.DOCTYPE_DTD:t.state=o.TEXT;continue;case o.CDATA:s==="]"?t.state=o.CDATA_ENDING:t.cdata+=s;continue;case o.CDATA_ENDING:s==="]"?t.state=o.CDATA_ENDING_2:(t.cdata+="]"+s,t.state=o.CDATA);continue;case o.CDATA_ENDING_2:s===">"?(t.cdata&&N(t,"oncdata",t.cdata),N(t,"onclosecdata"),t.cdata="",t.state=o.TEXT):s==="]"?t.cdata+="]":(t.cdata+="]]"+s,t.state=o.CDATA);continue;case o.PROC_INST:s==="?"?t.state=o.PROC_INST_ENDING:C(s)?t.state=o.PROC_INST_BODY:t.procInstName+=s;continue;case o.PROC_INST_BODY:if(!t.procInstBody&&C(s))continue;s==="?"?t.state=o.PROC_INST_ENDING:t.procInstBody+=s;continue;case o.PROC_INST_ENDING:s===">"?(N(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=o.TEXT):(t.procInstBody+="?"+s,t.state=o.PROC_INST_BODY);continue;case o.OPEN_TAG:D(X,s)?t.tagName+=s:(hi(t),s===">"?de(t):s==="/"?t.state=o.OPEN_TAG_SLASH:(C(s)||R(t,"Invalid character in tag name"),t.state=o.ATTRIB));continue;case o.OPEN_TAG_SLASH:s===">"?(de(t,!0),Ge(t)):(R(t,"Forward-slash in opening tag not followed by >"),t.state=o.ATTRIB);continue;case o.ATTRIB:if(C(s))continue;s===">"?de(t):s==="/"?t.state=o.OPEN_TAG_SLASH:D(W,s)?(t.attribName=s,t.attribValue="",t.state=o.ATTRIB_NAME):R(t,"Invalid attribute name");continue;case o.ATTRIB_NAME:s==="="?t.state=o.ATTRIB_VALUE:s===">"?(R(t,"Attribute without value"),t.attribValue=t.attribName,ze(t),de(t)):C(s)?t.state=o.ATTRIB_NAME_SAW_WHITE:D(X,s)?t.attribName+=s:R(t,"Invalid attribute name");continue;case o.ATTRIB_NAME_SAW_WHITE:if(s==="=")t.state=o.ATTRIB_VALUE;else{if(C(s))continue;R(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",N(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",s===">"?de(t):D(W,s)?(t.attribName=s,t.state=o.ATTRIB_NAME):(R(t,"Invalid attribute name"),t.state=o.ATTRIB)}continue;case o.ATTRIB_VALUE:if(C(s))continue;F(s)?(t.q=s,t.state=o.ATTRIB_VALUE_QUOTED):(t.opt.unquotedAttributeValues||ge(t,"Unquoted attribute value"),t.state=o.ATTRIB_VALUE_UNQUOTED,t.attribValue=s);continue;case o.ATTRIB_VALUE_QUOTED:if(s!==t.q){s==="&"?t.state=o.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=s;continue}ze(t),t.q="",t.state=o.ATTRIB_VALUE_CLOSED;continue;case o.ATTRIB_VALUE_CLOSED:C(s)?t.state=o.ATTRIB:s===">"?de(t):s==="/"?t.state=o.OPEN_TAG_SLASH:D(W,s)?(R(t,"No whitespace between attributes"),t.attribName=s,t.attribValue="",t.state=o.ATTRIB_NAME):R(t,"Invalid attribute name");continue;case o.ATTRIB_VALUE_UNQUOTED:if(!M(s)){s==="&"?t.state=o.ATTRIB_VALUE_ENTITY_U:t.attribValue+=s;continue}ze(t),s===">"?de(t):t.state=o.ATTRIB;continue;case o.CLOSE_TAG:if(t.tagName)s===">"?Ge(t):D(X,s)?t.tagName+=s:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=o.SCRIPT):(C(s)||R(t,"Invalid tagname in closing tag"),t.state=o.CLOSE_TAG_SAW_WHITE);else{if(C(s))continue;ae(W,s)?t.script?(t.script+="</"+s,t.state=o.SCRIPT):R(t,"Invalid tagname in closing tag."):t.tagName=s}continue;case o.CLOSE_TAG_SAW_WHITE:if(C(s))continue;s===">"?Ge(t):R(t,"Invalid characters in closing tag");continue;case o.TEXT_ENTITY:case o.ATTRIB_VALUE_ENTITY_Q:case o.ATTRIB_VALUE_ENTITY_U:var z,Q;switch(t.state){case o.TEXT_ENTITY:z=o.TEXT,Q="textNode";break;case o.ATTRIB_VALUE_ENTITY_Q:z=o.ATTRIB_VALUE_QUOTED,Q="attribValue";break;case o.ATTRIB_VALUE_ENTITY_U:z=o.ATTRIB_VALUE_UNQUOTED,Q="attribValue";break}if(s===";"){var K=fi(t);t.opt.unparsedEntities&&!Object.values(r.XML_ENTITIES).includes(K)?(t.entity="",t.state=z,t.write(K)):(t[Q]+=K,t.entity="",t.state=z)}else D(t.entity.length?J:te,s)?t.entity+=s:(R(t,"Invalid character in entity name"),t[Q]+="&"+t.entity+s,t.entity="",t.state=z);continue;default:throw new Error(t,"Unknown state: "+t.state)}return t.position>=t.bufferCheckPosition&&c(t),t}String.fromCodePoint||(function(){var a=String.fromCharCode,t=Math.floor,h=function(){var s=16384,L=[],U,z,Q=-1,K=arguments.length;if(!K)return"";for(var he="";++Q<K;){var H=Number(arguments[Q]);if(!isFinite(H)||H<0||H>1114111||t(H)!==H)throw RangeError("Invalid code point: "+H);H<=65535?L.push(H):(H-=65536,U=(H>>10)+55296,z=H%1024+56320,L.push(U,z)),(Q+1===K||L.length>s)&&(he+=a.apply(null,L),L.length=0)}return he};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:h,configurable:!0,writable:!0}):String.fromCodePoint=h})()})(e)})(jt)),jt}Hr();var Se=(e=>(e.ReservedName="reserved name",e.Character="character",e.Extension="extension",e))(Se||{});class Ee extends Error{constructor(r){super(`Invalid ${r.reason} '${r.segment}' in filename '${r.filename}'`,{cause:r})}get filename(){return this.cause.filename}get reason(){return this.cause.reason}get segment(){return this.cause.segment}}function jr(e){const r=Bi().files,i=r.forbidden_filename_characters??window._oc_config?.forbidden_filenames_characters??["/","\\"];for(const u of i)if(e.includes(u))throw new Ee({segment:u,reason:"character",filename:e});if(e=e.toLocaleLowerCase(),(r.forbidden_filenames??[".htaccess"]).includes(e))throw new Ee({filename:e,segment:e,reason:"reserved name"});const n=e.indexOf(".",1),c=e.substring(0,n===-1?void 0:n);if((r.forbidden_filename_basenames??[]).includes(c))throw new Ee({filename:e,segment:c,reason:"reserved name"});const m=r.forbidden_filename_extensions??[".part",".filepart"];for(const u of m)if(e.length>u.length&&e.endsWith(u))throw new Ee({segment:u,reason:"extension",filename:e})}const it=["B","KB","MB","GB","TB","PB"],rt=["B","KiB","MiB","GiB","TiB","PiB"];function Wr(e,r=!1,i=!1,n=!1){i=i&&!n,typeof e=="string"&&(e=Number(e));let c=e>0?Math.floor(Math.log(e)/Math.log(n?1e3:1024)):0;c=Math.min((i?rt.length:it.length)-1,c);const m=i?rt[c]:it[c];let u=(e/Math.pow(n?1e3:1024,c)).toFixed(1);return r===!0&&c===0?(u!=="0.0"?"< 1 ":"0 ")+(i?rt[1]:it[1]):(c<2?u=parseFloat(u).toFixed(0):u=parseFloat(u).toLocaleString(Jt()),u+" "+m)}function Yt(e){return e instanceof Date?e.toISOString():String(e)}function Yr(e,r,i){r=r??[m=>m],i=i??[];const n=r.map((m,u)=>(i[u]??"asc")==="asc"?1:-1),c=Intl.Collator([zi(),Jt()],{numeric:!0,usage:"sort"});return[...e].sort((m,u)=>{for(const[f,d]of r.entries()){const p=c.compare(Yt(d(m)),Yt(d(u)));if(p!==0)return p*n[f]}return 0})}function qr(e,r={}){const i={sortingMode:"basename",sortingOrder:"asc",...r};function n(u){const f=u.displayname||u.attributes?.displayname||u.basename||"";return u.type===le.Folder?f:f.lastIndexOf(".")>0?f.slice(0,f.lastIndexOf(".")):f}const c=[...i.sortFavoritesFirst?[u=>u.attributes?.favorite!==1]:[],...i.sortFoldersFirst?[u=>u.type!=="folder"]:[],...i.sortingMode!=="basename"?[u=>u[i.sortingMode]??u.attributes[i.sortingMode]]:[],u=>n(u),u=>u.basename],m=[...i.sortFavoritesFirst?["asc"]:[],...i.sortFoldersFirst?["asc"]:[],...i.sortingMode==="mtime"?[i.sortingOrder==="asc"?"desc":"asc"]:[],...i.sortingMode!=="mtime"&&i.sortingMode!=="basename"?[i.sortingOrder]:[],i.sortingOrder,i.sortingOrder];return Yr(e,c,m)}const Qr=new tr({concurrency:5});function Kr(e){const{resolve:r,promise:i}=Promise.withResolvers();return Qr.add(()=>{const n=new Image;return n.onerror=()=>r(!1),n.onload=()=>r(!0),n.src=e,i}),i}function Zr(e,r={}){r={size:32,cropPreview:!1,mimeFallback:!0,...r};try{const i=e.attributes?.previewUrl||ut("/core/preview?fileId={fileid}",{fileid:e.fileid});let n;try{n=new URL(i)}catch{n=new URL(i,window.location.origin)}return n.searchParams.set("x",`${r.size}`),n.searchParams.set("y",`${r.size}`),n.searchParams.set("mimeFallback",`${r.mimeFallback}`),n.searchParams.set("a",r.cropPreview===!0?"0":"1"),n.searchParams.set("c",`${e.attributes.etag}`),n}catch{return null}}function Jr(e,r){const i=P(null),n=P(!1);return bi(()=>{n.value=!1,i.value=Zr(_e(e),_e(r||{})),i.value&&_e(e).type===le.File&&Kr(i.value.href).then(c=>{n.value=c})}),{previewURL:i,previewLoaded:n}}const Z=(e,r)=>{const i=e.__vccOpts||e;for(const[n,c]of r)i[n]=c;return i},ea={name:"FileIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ta=["aria-hidden","aria-label"],ia=["fill","width","height"],ra={d:"M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"},aa={key:0};function na(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon file-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",ra,[i.title?(g(),b("title",aa,x(i.title),1)):G("",!0)])],8,ia))],16,ta)}const ot=Z(ea,[["render",na]]),sa={name:"MenuDownIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},oa=["aria-hidden","aria-label"],la=["fill","width","height"],ca={d:"M7,10L12,15L17,10H7Z"},ua={key:0};function da(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon menu-down-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",ca,[i.title?(g(),b("title",ua,x(i.title),1)):G("",!0)])],8,la))],16,oa)}const at=Z(sa,[["render",da]]),pa={name:"MenuUpIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ma=["aria-hidden","aria-label"],ha=["fill","width","height"],fa={d:"M7,15L12,10L17,15H7Z"},ga={key:0};function va(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon menu-up-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",fa,[i.title?(g(),b("title",ga,x(i.title),1)):G("",!0)])],8,ha))],16,ma)}const nt=Z(pa,[["render",va]]),Ea={name:"FolderIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ba=["aria-hidden","aria-label"],_a=["fill","width","height"],wa={d:"M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"},ya={key:0};function Ta(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon folder-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",wa,[i.title?(g(),b("title",ya,x(i.title),1)):G("",!0)])],8,_a))],16,ba)}const di=Z(Ea,[["render",Ta]]),pi={"file-picker__file-icon":"_file-picker__file-icon_3v9zx_9","file-picker__file-icon--primary":"_file-picker__file-icon--primary_3v9zx_21","file-picker__file-icon-overlay":"_file-picker__file-icon-overlay_3v9zx_25"},Ia=me({__name:"FilePreview",props:{node:{},cropImagePreviews:{type:Boolean}},setup(e){const r=e,i=P(pi),{previewURL:n,previewLoaded:c}=Jr(Kt(r,"node"),O(()=>({cropPreview:r.cropImagePreviews}))),m=O(()=>r.node.type===le.File),u=O(()=>{if(r.node.type!==le.Folder)return null;if(r.node.attributes?.["is-encrypted"]===1)return Hi;if(r.node.attributes?.["is-tag"])return ji;const f=Object.values(r.node.attributes?.["share-types"]||{}).flat();if(f.some(d=>d===Ot.Link||d===Ot.Email))return Wi;if(f.length>0)return Ct;switch(r.node.attributes?.["mount-type"]){case"external":case"external-session":return qi;case"group":return Yi;case"shared":return Ct}return null});return(f,d)=>(g(),b("div",{style:Ni(w(c)?{backgroundImage:`url(${w(n)})`}:void 0),class:fe(i.value["file-picker__file-icon"])},[w(c)?G("",!0):(g(),b(oe,{key:0},[m.value?(g(),B(ot,{key:0,size:32})):(g(),b(oe,{key:1},[u.value?(g(),B(w(ti),{key:0,class:fe(i.value["file-picker__file-icon-overlay"]),inline:"",path:u.value,size:16},null,8,["class","path"])):G("",!0),$(di,{class:fe(i.value["file-picker__file-icon--primary"]),size:32},null,8,["class"])],64))],64))],6))}}),Na=["tabindex","aria-selected","data-filename"],Aa={class:"row-name"},Ca={class:"file-picker__name-container","data-testid":"row-name"},La=["title","textContent"],Da=["textContent"],Ra={class:"row-size"},Oa={class:"row-modified"},Sa=me({__name:"FileListRow",props:{allowPickDirectory:{type:Boolean},selected:{type:Boolean},showCheckbox:{type:Boolean},canPick:{type:Boolean},node:{},cropImagePreviews:{type:Boolean}},emits:["update:selected","enterDirectory"],setup(e,{emit:r}){const i=e,n=r,c=O(()=>i.node.mtime??0),m=O(()=>Zt(i.node.displayname)),u=O(()=>i.node.displayname.slice(0,m.value?-m.value.length:void 0)),f=O(()=>i.node.type===le.Folder),d=O(()=>i.canPick&&(i.allowPickDirectory||!f.value)),p=O(()=>(i.node.permissions&ee.READ)===ee.READ);function l(){d.value&&n("update:selected",!i.selected)}function v(){f.value?p.value&&n("enterDirectory",i.node):l()}function E(I){I.key==="Enter"&&v()}return(I,V)=>(g(),b("tr",ie({tabindex:e.showCheckbox&&!f.value?void 0:0,"aria-selected":d.value?e.selected:void 0,class:["file-picker__row",[{"file-picker__row--selected":e.selected&&!e.showCheckbox,"file-picker__row--not-navigatable":f.value&&!p.value,"file-picker__row--not-pickable":!d.value}]],"data-filename":e.node.basename,"data-testid":"file-list-row"},Ii({click:v,...!e.showCheckbox||f.value?{keydown:E}:{}},!0)),[e.showCheckbox?(g(),b("td",{key:0,class:"row-checkbox",onClick:Re(()=>{},["stop"])},[$(w(ii),{"aria-label":w(A)("Select the row for {nodename}",{nodename:u.value}),disabled:!d.value,"data-testid":"row-checkbox","model-value":e.selected,"onUpdate:modelValue":l},null,8,["aria-label","disabled","model-value"])])):G("",!0),T("td",Aa,[T("div",Ca,[$(Ia,{node:e.node,"crop-image-previews":e.cropImagePreviews},null,8,["node","crop-image-previews"]),T("div",{class:"file-picker__file-name",title:u.value,textContent:x(u.value)},null,8,La),T("div",{class:"file-picker__file-extension",textContent:x(m.value)},null,8,Da)])]),T("td",Ra,x(w(Wr)(e.node.size||0)),1),T("td",Oa,[$(w(er),{timestamp:c.value,"ignore-seconds":""},null,8,["timestamp"])])],16,Na))}}),ka=Z(Sa,[["__scopeId","data-v-2af740c4"]]),Fa={"aria-hidden":"true",class:"file-picker__row loading-row"},$a={key:0,class:"row-checkbox"},Pa={class:"row-name"},Ba={class:"row-wrapper"},xa=me({__name:"LoadingTableRow",props:{showCheckbox:{type:Boolean}},setup(e){return(r,i)=>(g(),b("tr",Fa,[e.showCheckbox?(g(),b("td",$a,[...i[0]||(i[0]=[T("span",null,null,-1)])])):G("",!0),T("td",Pa,[T("div",Ba,[T("span",{class:fe(w(pi)["file-picker__file-icon"])},null,2),i[1]||(i[1]=T("span",null,null,-1))])]),i[2]||(i[2]=T("td",{class:"row-size"},[T("span")],-1)),i[3]||(i[3]=T("td",{class:"row-modified"},[T("span")],-1))]))}}),Ma=Z(xa,[["__scopeId","data-v-1f96131b"]]);function mi(){const e=ei("files","config",null),r=P(e?.show_hidden??!0),i=P(e?.sort_favorites_first??!0),n=P(e?.crop_image_previews??!0);return Ie(async()=>{if(Ne())ye.debug("Skip loading files settings - currently on public share");else try{const{data:c}=await ri.get(ut("/apps/files/api/v1/configs"));r.value=c?.data?.show_hidden??!1,i.value=c?.data?.sort_favorites_first??!0,n.value=c?.data?.crop_image_previews??!0}catch(c){ye.error("Could not load files settings",{error:c}),ct(A("Could not load files settings"))}}),{showHiddenFiles:r,sortFavoritesFirst:i,cropImagePreviews:n}}function Ua(e){const r=p=>p==="asc"?"ascending":p==="desc"?"descending":"none",i=ei("files","viewConfigs",null),n=P({sortBy:i?.files?.sorting_mode??"basename",order:r(i?.files?.sorting_direction??"asc")}),c=P({sortBy:i?.recent?.sorting_mode??"basename",order:r(i?.recent?.sorting_direction??"asc")}),m=P({sortBy:i?.favorites?.sorting_mode??"basename",order:r(i?.favorites?.sorting_direction??"asc")});Ie(async()=>{if(Ne())ye.debug("Skip loading files views - currently on public share");else try{const{data:p}=await ri.get(ut("/apps/files/api/v1/views"));n.value={sortBy:p?.data?.files?.sorting_mode??"basename",order:r(p?.data?.files?.sorting_direction)},m.value={sortBy:p?.data?.favorites?.sorting_mode??"basename",order:r(p?.data?.favorites?.sorting_direction)},c.value={sortBy:p?.data?.recent?.sorting_mode??"basename",order:r(p?.data?.recent?.sorting_direction)}}catch(p){ye.error("Could not load files views",{error:p}),ct(A("Could not load files views"))}});const u=O(()=>_e(e||"files")==="files"?n.value:_e(e)==="recent"?c.value:m.value),f=O(()=>u.value.sortBy),d=O(()=>u.value.order);return{filesViewConfig:n,favoritesViewConfig:m,recentViewConfig:c,currentConfig:u,sortBy:f,order:d}}const za={key:0,class:"row-checkbox"},Ga={class:"hidden-visually"},Va=["aria-sort"],Xa={class:"header-wrapper"},Ha={key:2,style:{width:"44px"}},ja=["aria-sort"],Wa={key:2,style:{width:"44px"}},Ya=["aria-sort"],qa={key:2,style:{width:"44px"}},Qa=me({__name:"FileList",props:wi({currentView:{},multiselect:{type:Boolean},allowPickDirectory:{type:Boolean},loading:{type:Boolean},files:{},canPick:{type:Function}},{path:{required:!0},pathModifiers:{},selectedFiles:{required:!0},selectedFilesModifiers:{}}),emits:["update:path","update:selectedFiles"],setup(e){const r=Nt(e,"path"),i=Nt(e,"selectedFiles"),n=e,c=P(),{currentConfig:m}=Ua(n.currentView),u=O(()=>c.value??m.value),f=O(()=>u.value.sortBy==="basename"?u.value.order==="none"?void 0:u.value.order:void 0),d=O(()=>u.value.sortBy==="size"?u.value.order==="none"?void 0:u.value.order:void 0),p=O(()=>u.value.sortBy==="mtime"?u.value.order==="none"?void 0:u.value.order:void 0);function l(F){u.value.sortBy===F?u.value.order==="ascending"?c.value={sortBy:u.value.sortBy,order:"descending"}:c.value={sortBy:u.value.sortBy,order:"ascending"}:c.value={sortBy:F,order:"ascending"}}const{sortFavoritesFirst:v,cropImagePreviews:E}=mi(),I=O(()=>qr(n.files,{sortFoldersFirst:!0,sortFavoritesFirst:v.value,sortingOrder:u.value.order==="descending"?"desc":"asc",sortingMode:u.value.sortBy})),V=O(()=>n.files.filter(F=>n.allowPickDirectory||F.type!==le.Folder)),_=O(()=>!n.loading&&i.value.length>0&&i.value.length>=V.value.length);function W(){i.value.length<V.value.length?i.value=[...V.value]:i.value=[]}function X(F){i.value.includes(F)?i.value=i.value.filter(M=>M.path!==F.path):n.multiselect?i.value=[...i.value,F]:i.value=[F]}function te(F){r.value=F.path}const J=P(4),C=P();{const F=()=>yi(()=>{const M=C.value?.parentElement?.children||[];let D=C.value?.parentElement?.clientHeight||450;for(let ae=0;ae<M.length;ae++)C.value?.isSameNode(M[ae])||(D-=M[ae].clientHeight);J.value=Math.max(1,Math.floor((D-50)/50))});Ie(()=>{window.addEventListener("resize",F),F()}),Ti(()=>{window.removeEventListener("resize",F)})}return(F,M)=>(g(),b("div",{ref_key:"fileContainer",ref:C,class:"file-picker__files"},[T("table",null,[T("thead",null,[T("tr",null,[e.multiselect?(g(),b("th",za,[T("span",Ga,x(w(A)("Select entry")),1),e.multiselect?(g(),B(w(ii),{key:0,"aria-label":w(A)("Select all entries"),"data-testid":"select-all-checkbox","model-value":_.value,"onUpdate:modelValue":W},null,8,["aria-label","model-value"])):G("",!0)])):G("",!0),T("th",{"aria-sort":f.value,class:"row-name"},[T("div",Xa,[M[3]||(M[3]=T("span",{class:"file-picker__header-preview"},null,-1)),$(w(we),{"data-test":"file-picker_sort-name",variant:"tertiary",wide:"",onClick:M[0]||(M[0]=D=>l("basename"))},{icon:k(()=>[f.value==="ascending"?(g(),B(nt,{key:0,size:20})):f.value==="descending"?(g(),B(at,{key:1,size:20})):(g(),b("span",Ha))]),default:k(()=>[be(" "+x(w(A)("Name")),1)]),_:1})])],8,Va),T("th",{"aria-sort":d.value,class:"row-size"},[$(w(we),{variant:"tertiary",wide:"",onClick:M[1]||(M[1]=D=>l("size"))},{icon:k(()=>[d.value==="ascending"?(g(),B(nt,{key:0,size:20})):d.value==="descending"?(g(),B(at,{key:1,size:20})):(g(),b("span",Wa))]),default:k(()=>[be(" "+x(w(A)("Size")),1)]),_:1})],8,ja),T("th",{"aria-sort":p.value,class:"row-modified"},[$(w(we),{variant:"tertiary",wide:"",onClick:M[2]||(M[2]=D=>l("mtime"))},{icon:k(()=>[p.value==="ascending"?(g(),B(nt,{key:0,size:20})):p.value==="descending"?(g(),B(at,{key:1,size:20})):(g(),b("span",qa))]),default:k(()=>[be(" "+x(w(A)("Modified")),1)]),_:1})],8,Ya)])]),T("tbody",null,[e.loading?(g(!0),b(oe,{key:0},ke(J.value,D=>(g(),B(Ma,{key:D,"show-checkbox":e.multiselect},null,8,["show-checkbox"]))),128)):(g(!0),b(oe,{key:1},ke(I.value,D=>(g(),B(ka,{key:D.fileid||D.path,"allow-pick-directory":e.allowPickDirectory,"show-checkbox":e.multiselect,"can-pick":(e.multiselect||i.value.length===0||i.value.includes(D))&&(e.canPick===void 0||e.canPick(D)),selected:i.value.includes(D),node:D,"crop-image-previews":w(E),"onUpdate:selected":ae=>X(D),onEnterDirectory:te},null,8,["allow-pick-directory","show-checkbox","can-pick","selected","node","crop-image-previews","onUpdate:selected"]))),128))])])],512))}}),Ka=Z(Qa,[["__scopeId","data-v-68ec5c33"]]),Za={name:"HomeIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ja=["aria-hidden","aria-label"],en=["fill","width","height"],tn={d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"},rn={key:0};function an(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon home-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",tn,[i.title?(g(),b("title",rn,x(i.title),1)):G("",!0)])],8,en))],16,Ja)}const nn=Z(Za,[["render",an]]),sn={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},on=["aria-hidden","aria-label"],ln=["fill","width","height"],cn={d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"},un={key:0};function dn(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon plus-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",cn,[i.title?(g(),b("title",un,x(i.title),1)):G("",!0)])],8,ln))],16,on)}const pn=Z(sn,[["render",dn]]),mn=me({__name:"FilePickerBreadcrumbs",props:{path:{},showMenu:{type:Boolean}},emits:["update:path","create-node"],setup(e,{emit:r}){const i=e,n=r,c=P(!1),m=P(""),u=_i("nameInput");function f(){const l=m.value.trim(),v=u.value?.$el?.querySelector("input");let E="";try{jr(l)}catch(I){if(!(I instanceof Ee))throw I;switch(I.reason){case Se.Character:E=A('"{char}" is not allowed inside a folder name.',{char:I.segment});break;case Se.ReservedName:E=A('"{segment}" is a reserved name and not allowed for folder names.',{segment:I.segment});break;case Se.Extension:E=A('Folder names must not end with "{extension}".',{extension:I.segment});break;default:E=A("Invalid folder name.")}}return v&&v.setCustomValidity(E),E===""}function d(){const l=m.value.trim();f()&&(c.value=!1,n("create-node",l),m.value="")}const p=O(()=>i.path.split("/").filter(l=>l!=="").map((l,v,E)=>({name:l,path:"/"+E.slice(0,v+1).join("/")})));return(l,v)=>(g(),B(w(yr),{class:"file-picker__breadcrumbs"},qt({default:k(()=>[$(w(Fe),{name:w(A)("All files"),title:w(A)("Home"),onClick:v[0]||(v[0]=E=>n("update:path","/"))},{icon:k(()=>[$(nn,{size:20})]),_:1},8,["name","title"]),(g(!0),b(oe,null,ke(p.value,E=>(g(),B(w(Fe),{key:E.path,name:E.name,title:E.path,onClick:I=>n("update:path",E.path)},null,8,["name","title","onClick"]))),128))]),_:2},[e.showMenu?{name:"actions",fn:k(()=>[$(w(lt),{open:c.value,"onUpdate:open":v[2]||(v[2]=E=>c.value=E),"aria-label":w(A)("Create directory"),"force-menu":!0,"force-name":!0,"menu-name":w(A)("New"),variant:"secondary",onClose:v[3]||(v[3]=E=>m.value="")},{icon:k(()=>[$(pn,{size:20})]),default:k(()=>[$(w(ir),{ref_key:"nameInput",ref:u,modelValue:m.value,"onUpdate:modelValue":[v[1]||(v[1]=E=>m.value=E),f],label:w(A)("New folder"),placeholder:w(A)("New folder name"),onSubmit:d},{icon:k(()=>[$(di,{size:20})]),_:1},8,["modelValue","label","placeholder"])]),_:1},8,["open","aria-label","menu-name"])]),key:"0"}:void 0]),1024))}}),hn=Z(mn,[["__scopeId","data-v-4ce40fd0"]]),fn={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},gn=["aria-hidden","aria-label"],vn=["fill","width","height"],En={d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},bn={key:0};function _n(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon close-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",En,[i.title?(g(),b("title",bn,x(i.title),1)):G("",!0)])],8,vn))],16,gn)}const wn=Z(fn,[["render",_n]]),yn={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Tn=["aria-hidden","aria-label"],In=["fill","width","height"],Nn={d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},An={key:0};function Cn(e,r,i,n,c,m){return g(),b("span",ie(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon magnify-icon",role:"img",onClick:r[0]||(r[0]=u=>e.$emit("click",u))}),[(g(),b("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[T("path",Nn,[i.title?(g(),b("title",An,x(i.title),1)):G("",!0)])],8,In))],16,Tn)}const Ln=Z(yn,[["render",Cn]]);function Dn(e){const r=[{id:"files",label:A("All files"),icon:Gi},{id:"recent",label:A("Recent"),icon:Vi},{id:"favorites",label:A("Favorites"),icon:Xi}],i=e.value?r.filter(({id:n})=>n==="files"):r;return{allViews:r,availableViews:i}}const Rn={key:0,class:"file-picker__side"},On=me({__name:"FilePickerNavigation",props:{currentView:{},filterString:{},isCollapsed:{type:Boolean},disabledNavigation:{type:Boolean}},emits:["update:currentView","update:filterString"],setup(e,{emit:r}){const i=e,n=r,{availableViews:c}=Dn(P($e()===null)),m=O(()=>c.filter(f=>f.id===i.currentView)[0]??c[0]),u=f=>n("update:filterString",f.toString());return(f,d)=>(g(),b(oe,null,[$(w(ar),{class:"file-picker__filter-input",label:w(A)("Filter file list"),"show-trailing-button":!!e.filterString,"model-value":e.filterString,"onUpdate:modelValue":u,onTrailingButtonClick:d[0]||(d[0]=p=>u(""))},{"trailing-button-icon":k(()=>[$(wn,{size:16})]),default:k(()=>[$(Ln,{size:16})]),_:1},8,["label","show-trailing-button","model-value"]),w(c).length>1&&!e.disabledNavigation?(g(),b(oe,{key:0},[e.isCollapsed?(g(),B(w(rr),{key:1,"aria-label":w(A)("Current view selector"),clearable:!1,searchable:!1,options:w(c),"model-value":m.value,"onUpdate:modelValue":d[1]||(d[1]=p=>n("update:currentView",p.id))},null,8,["aria-label","options","model-value"])):(g(),b("ul",Rn,[(g(!0),b(oe,null,ke(w(c),p=>(g(),b("li",{key:p.id},[$(w(we),{variant:e.currentView===p.id?"primary":"tertiary",wide:!0,onClick:l=>f.$emit("update:currentView",p.id)},{icon:k(()=>[$(w(ti),{path:p.icon,size:20},null,8,["path"])]),default:k(()=>[be(" "+x(p.label),1)]),_:2},1032,["variant","onClick"])]))),128))]))],64)):G("",!0)],64))}}),Sn=Z(On,[["__scopeId","data-v-b91fd905"]]);function kn(e){const r=new AbortController,i=Math.round(Date.now()/1e3)-3600*24*14;return new re(async(n,c,m)=>{m(()=>r.abort());try{const{data:u}=await e.search("/",{signal:r.signal,details:!0,data:Sr(i)}),f=u.results.map(d=>Me(d));n(f)}catch(u){c(u)}})}function Fn(e,r){const i=new AbortController;return new re(async(n,c,m)=>{m(()=>i.abort());try{const u=(await e.getDirectoryContents(Te(Ae,r),{signal:i.signal,details:!0,includeSelf:!0,data:si()})).data.map(f=>Me(f));n({contents:u.filter(({path:f})=>f!==r),folder:u.find(({path:f})=>f===r)})}catch(u){c(u)}})}async function $n(e,r){const{data:i}=await e.stat(Te(Ae,r),{details:!0,data:si()});return Me(i)}function Pn(e,r){const i=$r(),n=st([]),c=st(null),m=P(!0),u=P(null);async function f(p){const l=Te(r.value,p);await i.createDirectory(Te(Ae,l));const v=await $n(i,l);return n.value=[...n.value,v],v}async function d(){u.value&&u.value.cancel(),m.value=!0,e.value==="favorites"?u.value=Pr(i,r.value):e.value==="recent"?u.value=kn(i):u.value=Fn(i,r.value);const p=await u.value;if(p)"folder"in p?(c.value=p.folder,n.value=p.contents):(c.value=null,n.value=p);else return;u.value=null,m.value=!1}return Qt([e,r],()=>d()),Ie(()=>d()),{isLoading:m,files:n,folder:c,loadFiles:d,createDirectory:f}}function Bn(e){const r=O(()=>e.value.map(i=>i.split("/")));return{isSupportedMimeType:i=>{const n=i.split("/");return r.value.some(([c,m])=>(n[0]===c||c==="*")&&(n[1]===m||m==="*"))}}}const xn={class:"file-picker__main"},Mn={key:1,class:"file-picker__view"},Un=me({__name:"FilePicker",props:{buttons:{},name:{},allowPickDirectory:{type:Boolean,default:!1},noMenu:{type:Boolean,default:!1},disabledNavigation:{type:Boolean,default:!1},filterFn:{type:Function,default:void 0},canPickFn:{type:Function,default:void 0},mimetypeFilter:{default:()=>[]},multiselect:{type:Boolean,default:!1},path:{default:void 0}},emits:["close"],setup(e,{emit:r}){const i=e,n=r,c=P(!0),m=P("files"),u=P(window?.sessionStorage.getItem("NC.FilePicker.LastPath")||"/"),f=P(""),d=O({get:()=>m.value==="files"?f.value||i.path||u.value:"/",set:S=>{f.value=S}}),p=st([]),{files:l,folder:v,isLoading:E,loadFiles:I,createDirectory:V}=Pn(m,d);Qt([f],()=>{i.path===void 0&&f.value&&window.sessionStorage.setItem("NC.FilePicker.LastPath",f.value),p.value=[]});let _=!1;const W=O(()=>{const S=p.value.length===0&&i.allowPickDirectory&&v.value?[v.value]:p.value;return(typeof i.buttons=="function"?i.buttons(S,d.value,m.value):i.buttons).map(y=>({...y,disabled:y.disabled||E.value,callback:()=>{_=!0,X(y.callback,S)}}))});async function X(S,y){await S(y),n("close",y),_=!1}const te=O(()=>m.value==="favorites"?A("Favorites"):m.value==="recent"?A("Recent"):""),J=P(""),{isSupportedMimeType:C}=Bn(Kt(i,"mimetypeFilter"));Ie(()=>I());const{showHiddenFiles:F}=mi(),M=O(()=>{let S=l.value;return F.value||(S=S.filter(y=>!y.basename.startsWith("."))),i.mimetypeFilter.length>0&&(S=S.filter(y=>y.type==="folder"||y.mime&&C(y.mime))),J.value&&(S=S.filter(y=>y.basename.toLowerCase().includes(J.value.toLowerCase()))),i.filterFn&&(S=S.filter(y=>i.filterFn(y))),S}),D=O(()=>m.value==="files"?A("Upload some content or sync with your devices!"):m.value==="recent"?A("Files and folders you recently modified will show up here."):A("Files and folders you mark as favorite will show up here."));async function ae(S){try{const y=await V(S);f.value=y.path,Fi("files:node:created",l.value.filter(N=>N.basename===S)[0])}catch(y){ye.warn("Could not create new folder",{name:S,error:y}),ct(A("Could not create the new folder"))}}function o(S){!S&&!_&&n("close")}return(S,y)=>(g(),B(w(Pi),{open:c.value,"onUpdate:open":[y[6]||(y[6]=N=>c.value=N),o],buttons:W.value,name:e.name,size:"large","content-classes":"file-picker__content","dialog-classes":"file-picker","navigation-classes":"file-picker__navigation"},{navigation:k(({isCollapsed:N})=>[$(Sn,{"current-view":m.value,"onUpdate:currentView":y[0]||(y[0]=ne=>m.value=ne),"filter-string":J.value,"onUpdate:filterString":y[1]||(y[1]=ne=>J.value=ne),"is-collapsed":N,"disabled-navigation":e.disabledNavigation},null,8,["current-view","filter-string","is-collapsed","disabled-navigation"])]),default:k(()=>[T("div",xn,[m.value==="files"?(g(),B(hn,{key:0,path:d.value,"onUpdate:path":y[2]||(y[2]=N=>d.value=N),"show-menu":!e.noMenu,onCreateNode:ae},null,8,["path","show-menu"])):(g(),b("div",Mn,[T("h3",null,x(te.value),1)])),w(E)||M.value.length>0?(g(),B(Ka,{key:2,path:d.value,"onUpdate:path":[y[3]||(y[3]=N=>d.value=N),y[5]||(y[5]=N=>m.value="files")],"selected-files":p.value,"onUpdate:selectedFiles":y[4]||(y[4]=N=>p.value=N),"allow-pick-directory":e.allowPickDirectory,"current-view":m.value,files:M.value,multiselect:e.multiselect,loading:w(E),name:te.value,"can-pick":e.canPickFn},null,8,["path","selected-files","allow-pick-directory","current-view","files","multiselect","loading","name","can-pick"])):J.value?(g(),B(w(At),{key:3,name:w(A)("No matching files"),description:w(A)("No files matching your filter were found.")},{icon:k(()=>[$(ot)]),_:1},8,["name","description"])):(g(),B(w(At),{key:4,name:w(A)("No files in here"),description:D.value},{icon:k(()=>[$(ot)]),_:1},8,["name","description"]))])]),_:1},8,["open","buttons","name"]))}}),ss=Z(Un,[["__scopeId","data-v-303416d3"]]);export{ss as default};
//# sourceMappingURL=FilePicker-W-IYpVkn-Dr0uGwBt.chunk.mjs.map
